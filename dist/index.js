!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=44)}([function(e,t,r){"use strict";var n=r(11);function i(e,t){for(;;){var r=t,a=e,o=a.length,s=o||1,u=s-r.length|0;if(u){if(u<0){t=n.caml_array_sub(r,s,0|-u),e=a.apply(null,n.caml_array_sub(r,0,s));continue}return function(e,t){return function(r){return i(e,t.concat([r]))}}(a,r)}return a.apply(null,r)}}function a(e,t,r){if(r>7||r<0)return i(e,[t]);switch(r){case 0:case 1:return e(t);case 2:return function(r){return e(t,r)};case 3:return function(r,n){return e(t,r,n)};case 4:return function(r,n,i){return e(t,r,n,i)};case 5:return function(r,n,i,a){return e(t,r,n,i,a)};case 6:return function(r,n,i,a,o){return e(t,r,n,i,a,o)};case 7:return function(r,n,i,a,o,s){return e(t,r,n,i,a,o,s)}}}function o(e,t){var r=e.length;return 1===r?e(t):a(e,t,r)}function s(e,t,r,n){if(n>7||n<0)return i(e,[t,r]);switch(n){case 0:case 1:return i(e(t),[r]);case 2:return e(t,r);case 3:return function(n){return e(t,r,n)};case 4:return function(n,i){return e(t,r,n,i)};case 5:return function(n,i,a){return e(t,r,n,i,a)};case 6:return function(n,i,a,o){return e(t,r,n,i,a,o)};case 7:return function(n,i,a,o,s){return e(t,r,n,i,a,o,s)}}}function u(e,t,r){var n=e.length;return 2===n?e(t,r):s(e,t,r,n)}function c(e,t,r,n,a){var o=0;if(a>7||a<0)return i(e,[t,r,n]);switch(a){case 0:case 1:o=1;break;case 2:return i(e(t,r),[n]);case 3:return e(t,r,n);case 4:return function(i){return e(t,r,n,i)};case 5:return function(i,a){return e(t,r,n,i,a)};case 6:return function(i,a,o){return e(t,r,n,i,a,o)};case 7:return function(i,a,o,s){return e(t,r,n,i,a,o,s)}}return 1===o?i(e(t),[r,n]):void 0}function l(e,t,r,n){var i=e.length;return 3===i?e(t,r,n):c(e,t,r,n,i)}function f(e,t,r,n,a,o){var s=0;if(o>7||o<0)return i(e,[t,r,n,a]);switch(o){case 0:case 1:s=1;break;case 2:return i(e(t,r),[n,a]);case 3:return i(e(t,r,n),[a]);case 4:return e(t,r,n,a);case 5:return function(i){return e(t,r,n,a,i)};case 6:return function(i,o){return e(t,r,n,a,i,o)};case 7:return function(i,o,s){return e(t,r,n,a,i,o,s)}}return 1===s?i(e(t),[r,n,a]):void 0}function p(e,t,r,n,i){var a=e.length;return 4===a?e(t,r,n,i):f(e,t,r,n,i,a)}function h(e,t,r,n,a,o,s){var u=0;if(s>7||s<0)return i(e,[t,r,n,a,o]);switch(s){case 0:case 1:u=1;break;case 2:return i(e(t,r),[n,a,o]);case 3:return i(e(t,r,n),[a,o]);case 4:return i(e(t,r,n,a),[o]);case 5:return e(t,r,n,a,o);case 6:return function(i){return e(t,r,n,a,o,i)};case 7:return function(i,s){return e(t,r,n,a,o,i,s)}}return 1===u?i(e(t),[r,n,a,o]):void 0}function d(e,t,r,n,i,a){var o=e.length;return 5===o?e(t,r,n,i,a):h(e,t,r,n,i,a,o)}function m(e,t,r,n,a,o,s,u){var c=0;if(u>7||u<0)return i(e,[t,r,n,a,o,s]);switch(u){case 0:case 1:c=1;break;case 2:return i(e(t,r),[n,a,o,s]);case 3:return i(e(t,r,n),[a,o,s]);case 4:return i(e(t,r,n,a),[o,s]);case 5:return i(e(t,r,n,a,o),[s]);case 6:return e(t,r,n,a,o,s);case 7:return function(i){return e(t,r,n,a,o,s,i)}}return 1===c?i(e(t),[r,n,a,o,s]):void 0}function g(e,t,r,n,i,a,o){var s=e.length;return 6===s?e(t,r,n,i,a,o):m(e,t,r,n,i,a,o,s)}function v(e,t,r,n,a,o,s,u,c){var l=0;if(c>7||c<0)return i(e,[t,r,n,a,o,s,u]);switch(c){case 0:case 1:l=1;break;case 2:return i(e(t,r),[n,a,o,s,u]);case 3:return i(e(t,r,n),[a,o,s,u]);case 4:return i(e(t,r,n,a),[o,s,u]);case 5:return i(e(t,r,n,a,o),[s,u]);case 6:return i(e(t,r,n,a,o,s),[u]);case 7:return e(t,r,n,a,o,s,u)}return 1===l?i(e(t),[r,n,a,o,s,u]):void 0}function _(e,t,r,n,i,a,o,s){var u=e.length;return 7===u?e(t,r,n,i,a,o,s):v(e,t,r,n,i,a,o,s,u)}function y(e,t,r,n,a,o,s,u,c,l){var f=0;if(l>7||l<0)return i(e,[t,r,n,a,o,s,u,c]);switch(l){case 0:case 1:f=1;break;case 2:return i(e(t,r),[n,a,o,s,u,c]);case 3:return i(e(t,r,n),[a,o,s,u,c]);case 4:return i(e(t,r,n,a),[o,s,u,c]);case 5:return i(e(t,r,n,a,o),[s,u,c]);case 6:return i(e(t,r,n,a,o,s),[u,c]);case 7:return i(e(t,r,n,a,o,s,u),[c])}return 1===f?i(e(t),[r,n,a,o,s,u,c]):void 0}function b(e,t,r,n,i,a,o,s,u){var c=e.length;return 8===c?e(t,r,n,i,a,o,s,u):y(e,t,r,n,i,a,o,s,u,c)}t.app=i,t.curry_1=a,t._1=o,t.__1=function(e){return 1===e.length?e:function(t){return o(e,t)}},t.curry_2=s,t._2=u,t.__2=function(e){return 2===e.length?e:function(t,r){return u(e,t,r)}},t.curry_3=c,t._3=l,t.__3=function(e){return 3===e.length?e:function(t,r,n){return l(e,t,r,n)}},t.curry_4=f,t._4=p,t.__4=function(e){return 4===e.length?e:function(t,r,n,i){return p(e,t,r,n,i)}},t.curry_5=h,t._5=d,t.__5=function(e){return 5===e.length?e:function(t,r,n,i,a){return d(e,t,r,n,i,a)}},t.curry_6=m,t._6=g,t.__6=function(e){return 6===e.length?e:function(t,r,n,i,a,o){return g(e,t,r,n,i,a,o)}},t.curry_7=v,t._7=_,t.__7=function(e){return 7===e.length?e:function(t,r,n,i,a,o,s){return _(e,t,r,n,i,a,o,s)}},t.curry_8=y,t._8=b,t.__8=function(e){return 8===e.length?e:function(t,r,n,i,a,o,s,u){return b(e,t,r,n,i,a,o,s,u)}}},function(e,t,r){"use strict";var n=["Out_of_memory",0],i=["Sys_error",-1],a=["Failure",-2],o=["Invalid_argument",-3],s=["End_of_file",-4],u=["Division_by_zero",-5],c=["Not_found",-6],l=["Match_failure",-7],f=["Stack_overflow",-8],p=["Sys_blocked_io",-9],h=["Assert_failure",-10],d=["Undefined_recursive_module",-11];n.tag=248,i.tag=248,a.tag=248,o.tag=248,s.tag=248,u.tag=248,c.tag=248,l.tag=248,f.tag=248,p.tag=248,h.tag=248,d.tag=248,t.out_of_memory=n,t.sys_error=i,t.failure=a,t.invalid_argument=o,t.end_of_file=s,t.division_by_zero=u,t.not_found=c,t.match_failure=l,t.stack_overflow=f,t.sys_blocked_io=p,t.assert_failure=h,t.undefined_recursive_module=d},function(e,t,r){"use strict";var n=[0];function i(){return n[0]+=1,n[0]}t.caml_set_oo_id=function(e){return e[1]=n[0],n[0]+=1,e},t.get_id=i,t.create=function(e){var t=[e,i()];return t.tag=248,t},t.isCamlExceptionOrOpenVariant=function(e){if(void 0===e)return 0;if(248===e.tag)return 1;var t=e[0];return void 0!==t?+(248===t.tag):0}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,r){"use strict";var n=r(46),i=r(5),a=r(7),o=r(0),s=r(16),u=r(12),c=r(34),l=r(37),f=r(10),p=r(2),h=r(54),d=r(1),m=n.Make([s.compare]),g=[2];function v(){return 2===g[0]?"#version 300 es":""}var _="\n#define VARYING out\n\n",y="\n#extension GL_OES_standard_derivatives : enable\n\n#define VARYING varying\n",b="\n#define VARYING in",x="\n#extension GL_OES_standard_derivatives : enable\n\n#define VARYING varying",w="highp",$="precision highp float;precision highp int;",E="\n",M="  ",T=p.create("GLSL-Rts.GLSLTypeError");function S(e){return e.tag?e[0]:e[1]}function A(e){if(e.tag)throw[T,"type mismatch"];return e[0]}function z(e,t){return a.__(0,[h.protoScalar,t])}function R(e,t){return a.__(0,[A(e),t])}function C(e,t,r){return a.__(0,[A(e),r])}function L(e){switch(e){case 0:return"void";case 1:return"int";case 2:return"uint";case 3:return"float";case 4:return"vec2";case 5:return"vec3";case 6:return"vec4";case 7:return"mat2";case 8:return"mat3";case 9:return"mat4";case 10:return"sampler2D";case 11:return"samplerCube"}}function P(e,t){return i.fold_left(function(e,t){return e+t},"",t)}function U(e,t){return t[2]}function I(e,t){return o._2(e[1],e,[o._2(e[1],e,t),0])}function O(e,t){var r;return r=t.tag?[t[0][2],[".",[h.fmtSwizzle(t[1]),0]]]:[o._2(e[0],e,t[0]),0],o._2(e[1],e,r)}function N(e,t){var r;switch(0|t.tag){case 0:r=[o._2(e[0],e,t[0]),0];break;case 1:r=[o._2(e[4],e,t[0]),[".",[h.fmtSwizzle(t[1]),0]]];break;case 2:r=[f.string_of_float(t[0]),0];break;case 3:r=[f.string_of_int(t[0]),0];break;case 4:r=["(",[o._2(e[4],e,t[0]),["++)",0]]];break;case 5:r=["(",[o._2(e[4],e,t[0]),["--)",0]]];break;case 6:r=["(++",[o._2(e[4],e,t[0]),[")",0]]];break;case 7:r=["(--",[o._2(e[4],e,t[0]),[")",0]]];break;case 8:r=["(!",[o._2(e[4],e,t[0]),[")",0]]];break;case 9:r=["(",[o._2(e[4],e,t[0]),[" * ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 10:r=["(",[o._2(e[4],e,t[0]),[" / ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 11:r=["(",[o._2(e[4],e,t[0]),[" + ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 12:r=["(",[o._2(e[4],e,t[0]),[" - ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 13:r=["(",[o._2(e[4],e,t[0]),[" < ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 14:r=["(",[o._2(e[4],e,t[0]),[" > ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 15:r=["(",[o._2(e[4],e,t[0]),[" <= ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 16:r=["(",[o._2(e[4],e,t[0]),[" >= ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 17:r=["(",[o._2(e[4],e,t[0]),[" == ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 18:r=["(",[o._2(e[4],e,t[0]),[" != ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 19:r=["(",[o._2(e[4],e,t[0]),[" && ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 20:r=["(",[o._2(e[4],e,t[0]),[" || ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 21:r=["(",[o._2(e[4],e,t[0]),[" ^^ ",[o._2(e[4],e,t[1]),[")",0]]]]];break;case 22:r=["(",[o._2(e[4],e,t[0]),[" ? ",[o._2(e[4],e,t[1]),[" : ",[o._2(e[4],e,t[2]),[")",0]]]]]]];break;case 23:r=[o._2(e[4],e,t[0]),[", ",[o._2(e[4],e,t[1]),0]]];break;case 24:var n=i.map(function(t){return o._2(e[4],e,t)},t[1]),a=i.fold_left(function(e,t){return i.concat([e,[[",",[t,0]],0]])},[i.hd(n),0],i.tl(n));r=i.concat([[t[0],["(",0]],[a,[[")",0],0]]]);break;case 25:r=[t[0],["(",[o._2(e[4],e,t[1]),[")",0]]]];break;case 26:r=[t[0],["(",[o._2(e[4],e,t[1]),[", ",[o._2(e[4],e,t[2]),[")",0]]]]]];break;case 27:r=[t[0],["(",[o._2(e[4],e,t[1]),[", ",[o._2(e[4],e,t[2]),[", ",[o._2(e[4],e,t[3]),[")",0]]]]]]]];break;case 28:r=[t[0],["(",[o._2(e[4],e,t[1]),[", ",[o._2(e[4],e,t[2]),[", ",[o._2(e[4],e,t[3]),[", ",[o._2(e[4],e,t[4]),[")",0]]]]]]]]]];break;case 29:var s=i.map(function(t){return o._2(e[4],e,t)},t[1]),u=i.fold_left(function(e,t){return i.concat([e,[[",",[t,0]],0]])},[i.hd(s),0],i.tl(s));r=i.concat([[t[0][1],["(",0]],[u,[[")",0],0]]])}return o._2(e[2],e,r)}function k(e,t){return o._2(e[1],e,i.map(function(t){var r;if("number"==typeof t)r=t?"discard":o._2(e[1],e,["return;",0]);else switch(0|t.tag){case 0:r=t[0];break;case 1:r=o._2(e[1],e,[o._2(e[3],e,t[0]),[" = ",[o._2(e[4],e,t[1]),0]]]);break;case 2:r=o._2(e[1],e,[L(t[0]),[" ",[o._2(e[3],e,t[1]),[" = ",[o._2(e[4],e,t[2]),0]]]]]);break;case 3:var n=o._2(e[5],e,t[3]);r=o._2(e[1],e,["for (",[s.map(function(e){return 59!==e?e:32},o._2(e[5],e,t[0])),[";",[o._2(e[4],e,t[1]),[";",[s.map(function(e){return 59!==e?e:32},o._2(e[5],e,t[2])),[") {",[E,[n,[E,["}",0]]]]]]]]]]]);break;case 4:var i=o._2(e[5],e,t[1]);r=o._2(e[1],e,["if (",[o._2(e[4],e,t[0]),[") {",[E,[i,[E,["}",0]]]]]]]);break;case 5:var a=o._2(e[5],e,t[1]),u=o._2(e[5],e,t[2]);r=o._2(e[1],e,["if (",[o._2(e[4],e,t[0]),[") {",[E,[a,[E,["} else {",[E,[u,[E,["}",0]]]]]]]]]]]);break;case 6:r=o._2(e[1],e,["return ",[o._2(e[4],e,t[0]),[";",0]]])}return o._2(e[1],e,[M,[r,[";",[E,0]]]])},t))}function D(e,t){return o._2(e[1],e,["void main() {",[E,[o._2(e[5],e,t),["}",0]]]])}var F=[U,P,I,O,N,k,D];function B(e,t){return i.map(e,i.sort_uniq(function(e,t){return u.caml_compare(t[1],e[1])},t))}function G(e,t){var r=[0],n=D,i=[function(t,n){return n[0]===e&&(r[0]=[[n[1],n[2]],r[0]]),o._2(U,t,n)},P,I,O,function(e,t){return 29===t.tag&&o._2(e[5],e,t[0][3]),o._2(N,e,t)},k,n];return o._2(n,i,t),r[0]}function V(e){var t=[0],r=F.slice();return r[4]=function(e,r){if(29===r.tag){var n=r[0],i=n[3];t[0]=[[n[0],n[1],n[2],i],t[0]],o._2(e[5],e,i)}return o._2(N,e,r)},o._2(r[6],r,e),t[0]}function H(e){var t=[m[0]];return s.concat(E,i.map(function(e){var r=i.map(function(e){if(e.tag)return"";var t=e[0];return P(0,[L(t[1]),[" ",[t[2],0]]])},e[2]),n=i.fold_left(function(e,t){return i.concat([e,[[",",[t,0]],0]])},[i.hd(r),0],i.tl(r)),a=o._2(k,F,e[3]),s=P(0,i.concat([[L(e[0]),[" ",[e[1],["(",0]]]],[n,[[") {",[E,[a,[E,["}",0]]]]],0]]]));try{return o._2(m[24],s,t[0]),""}catch(e){if(e===d.not_found)return t[0]=o._2(m[3],s,t[0]),s;throw e}},e))}function j(e){return s.concat(E,B(function(e){return(2===g[0]?"in ":"attribute ")+L(e[0])+" "+e[1]+";"},e))}function W(e){return s.concat(E,B(function(e){return"VARYING "+L(e[0])+" "+e[1]+";"},e))}function q(e){var t=i.partition(function(e){return e[0]>=10?0:1},e),r=2===g[0]?["layout(std140) uniform u_PerScene {","};"]:["",""];return r[0]+(E+(s.concat(E,i.map(function(e){return M+((2===g[0]?w:"uniform")+" ")+L(e[0])+" "+e[1]+";"},t[0]))+(E+(r[1]+(E+(s.concat(E,i.map(function(e){return"uniform "+L(e[0])+" "+e[1]+";"},t[1]))+E))))))}function X(e){return 2===g[0]?s.concat(E,B(function(e){return"out "+L(e[0])+" "+e[1]+";"},e)):"\n// no output vars in WebGL 1\n"}function Y(e,t,r,n,i){var a=v()+(E+(E+(e+(E+($+(j(G(1,n))+(2!==g[0]&&i?"\n\n\nattribute highp float a_VertexIDFloat;\n\n#define gl_VertexID (int(a_VertexIDFloat))\n#define gl_VertexID2F (a_VertexIDFloat.y)\n":"")))))))+(E+(E+(W(r)+(E+(E+(q(t)+(E+(E+(X(G(5,n))+(E+(E+(H(V(n))+(E+(E+o._2(D,F,n)))))))))))))));return 2===g[0]?a:a.replace(/outColor/g,"gl_FragColor").replace(/texture/g,"texture2D")}function J(e){switch(0|e.tag){case 0:var t=e[0];return[t,a.__(0,[t])];case 1:var r=e[0];if(r.tag)throw[T,"invalid left hand side"];var n=r[0];return[n,a.__(1,[n,e[1]])];default:throw[T,"invalid left hand side"]}}function Z(e,t,r,n){var i=J(r),s=i[1],u=i[0],c=u[2],l=u[0];return o._1(e,c)||4!==l?a.__(1,[s,n]):(4===l&&o._1(t,c),a.__(2,[u[1],s,n]))}var K=[0];function Q(){return K[0]=K[0]+1|0,"v_"+f.string_of_int(K[0])}function ee(e){return a.__(0,[h.protoFloat,a.__(0,[[4,3,e]])])}function te(e){return a.__(0,[h.protoVec3,a.__(0,[[4,5,e]])])}function re(e){return a.__(0,[h.protoVec4,a.__(0,[[1,6,e]])])}var ne=re(l.positionAttrName),ie=a.__(0,[[0,1,"gl_VertexID"]]),ae=a.__(0,[3654863,ie]),oe=a.__(0,[[0,3,"gl_VertexID2F"]]),se=a.__(0,[h.protoFloat,oe]),ue=a.__(0,[[0,6,"gl_Position"]]),ce=a.__(0,[h.protoVec4,ue]),le=a.__(0,[[0,6,"gl_FragCoord"]]),fe=a.__(0,[h.protoVec4,le]),pe=a.__(0,[[5,6,"outColor"]]),he=a.__(0,[h.protoVec4,pe]),de=a.__(0,[[2,3,"u_time"]]),me=a.__(0,[h.protoFloat,de]),ge=a.__(0,[[1,4,"a_uv"]]),ve=a.__(0,[h.protoVec2,ge]),_e=a.__(0,[[1,2,"a_IndexId"]]),ye=a.__(0,[946268058,_e]),be=a.__(0,[[3,4,"v_uv"]]),xe=a.__(0,[h.protoVec2,be]),we=a.__(0,[[2,9,"modelMatrix"]]),$e=a.__(0,[h.protoMat4,we]),Ee=a.__(0,[[2,9,"modelViewMatrix"]]),Me=a.__(0,[h.protoMat4,Ee]),Te=a.__(0,[[2,9,"projectionMatrix"]]),Se=a.__(0,[h.protoMat4,Te]),Ae=[0],ze=[0],Re=[m[0]];function Ce(e){return ze[0]=[e,ze[0]],0}function Le(){return ze[0]=0,Re[0]=m[0],0}function Pe(){return Ae[0]=[ze[0],Ae[0]],ze[0]=0,0}function Ue(){var e=i.rev(ze[0]);return ze[0]=i.hd(Ae[0]),Ae[0]=i.tl(Ae[0]),e}function Ie(e){try{return o._2(m[24],e,Re[0]),1}catch(e){if(e===d.not_found)return 0;throw e}}function Oe(e){return Re[0]=o._2(m[3],e,Re[0]),0}function Ne(e,t){return Ce(Z(Ie,Oe,S(e),S(t)))}function ke(e,t){return a.__(0,[c.$star(A(e),A(t)),a.__(9,[S(e),S(t)])])}function De(e,t){return a.__(0,[c.$slash(A(e),A(t)),a.__(10,[S(e),S(t)])])}function Fe(e,t){return a.__(0,[c.$plus(A(e),A(t)),a.__(11,[S(e),S(t)])])}function Be(e,t){return a.__(0,[c.$neg(A(e),A(t)),a.__(12,[S(e),S(t)])])}function Ge(e){return R(e,a.__(25,["sin",S(e)]))}function Ve(e){return a.__(0,[h.protoVec2,a.__(24,["vec2",i.map(S,[e,0])])])}function He(e,t){return a.__(0,[h.protoVec2,a.__(24,["vec2",i.map(S,[e,[t,0]])])])}function je(e,t,r){return a.__(0,[h.protoVec3,a.__(24,["vec3",i.map(S,[e,[t,[r,0]]])])])}function We(e,t){return He(a.__(0,[h.protoScalar,a.__(2,[e])]),a.__(0,[h.protoScalar,a.__(2,[t])]))}var qe=We(0,0),Xe=a.__(2,[0]),Ye=a.__(0,[h.protoScalar,Xe]),Je=a.__(0,[[4,9,"amat"]]),Ze=a.__(0,[h.protoMat4,Je]),Ke=Ge(qe),Qe=Ge(Ye),et=a.__(0,[[4,4,"c"]]),tt=a.__(0,[h.protoVec2,et]),rt=Ve(Qe);Ne(tt,Ve(Qe)),Ne(tt,rt),i.rev(ze[0]);var nt=h.PhantomAlgebra,it=h.protoScalar,at=h.protoFloat,ot=h.protoVec2,st=h.protoVec3,ut=h.protoVec4,ct=h.protoMat2,lt=h.protoMat3,ft=h.protoMat4,pt=h.fmtSwizzle,ht=h.accept1,dt=h.accept2,mt=h.accept3,gt=h.accept4,vt=h.a$prime,_t=h.aa$prime,yt=h.aaa$prime,bt=h.aaaa$prime,xt=h.aaab$prime,wt=h.aaag$prime,$t=h.aaar$prime,Et=h.aab$prime,Mt=h.aaba$prime,Tt=h.aabb$prime,St=h.aabg$prime,At=h.aabr$prime,zt=h.aag$prime,Rt=h.aaga$prime,Ct=h.aagb$prime,Lt=h.aagg$prime,Pt=h.aagr$prime,Ut=h.aar$prime,It=h.aara$prime,Ot=h.aarb$prime,Nt=h.aarg$prime,kt=h.aarr$prime,Dt=h.ab$prime,Ft=h.aba$prime,Bt=h.abaa$prime,Gt=h.abab$prime,Vt=h.abag$prime,Ht=h.abar$prime,jt=h.abb$prime,Wt=h.abba$prime,qt=h.abbb$prime,Xt=h.abbg$prime,Yt=h.abbr$prime,Jt=h.abg$prime,Zt=h.abga$prime,Kt=h.abgb$prime,Qt=h.abgg$prime,er=h.abgr$prime,tr=h.abr$prime,rr=h.abra$prime,nr=h.abrb$prime,ir=h.abrg$prime,ar=h.abrr$prime,or=h.ag$prime,sr=h.aga$prime,ur=h.agaa$prime,cr=h.agab$prime,lr=h.agag$prime,fr=h.agar$prime,pr=h.agb$prime,hr=h.agba$prime,dr=h.agbb$prime,mr=h.agbg$prime,gr=h.agbr$prime,vr=h.agg$prime,_r=h.agga$prime,yr=h.aggb$prime,br=h.aggg$prime,xr=h.aggr$prime,wr=h.agr$prime,$r=h.agra$prime,Er=h.agrb$prime,Mr=h.agrg$prime,Tr=h.agrr$prime,Sr=h.ar$prime,Ar=h.ara$prime,zr=h.araa$prime,Rr=h.arab$prime,Cr=h.arag$prime,Lr=h.arar$prime,Pr=h.arb$prime,Ur=h.arba$prime,Ir=h.arbb$prime,Or=h.arbg$prime,Nr=h.arbr$prime,kr=h.arg$prime,Dr=h.arga$prime,Fr=h.argb$prime,Br=h.argg$prime,Gr=h.argr$prime,Vr=h.arr$prime,Hr=h.arra$prime,jr=h.arrb$prime,Wr=h.arrg$prime,qr=h.arrr$prime,Xr=h.b$prime,Yr=h.ba$prime,Jr=h.baa$prime,Zr=h.baaa$prime,Kr=h.baab$prime,Qr=h.baag$prime,en=h.baar$prime,tn=h.bab$prime,rn=h.baba$prime,nn=h.babb$prime,an=h.babg$prime,on=h.babr$prime,sn=h.bag$prime,un=h.baga$prime,cn=h.bagb$prime,ln=h.bagg$prime,fn=h.bagr$prime,pn=h.bar$prime,hn=h.bara$prime,dn=h.barb$prime,mn=h.barg$prime,gn=h.barr$prime,vn=h.bb$prime,_n=h.bba$prime,yn=h.bbaa$prime,bn=h.bbab$prime,xn=h.bbag$prime,wn=h.bbar$prime,$n=h.bbb$prime,En=h.bbba$prime,Mn=h.bbbb$prime,Tn=h.bbbg$prime,Sn=h.bbbr$prime,An=h.bbg$prime,zn=h.bbga$prime,Rn=h.bbgb$prime,Cn=h.bbgg$prime,Ln=h.bbgr$prime,Pn=h.bbr$prime,Un=h.bbra$prime,In=h.bbrb$prime,On=h.bbrg$prime,Nn=h.bbrr$prime,kn=h.bg$prime,Dn=h.bga$prime,Fn=h.bgaa$prime,Bn=h.bgab$prime,Gn=h.bgag$prime,Vn=h.bgar$prime,Hn=h.bgb$prime,jn=h.bgba$prime,Wn=h.bgbb$prime,qn=h.bgbg$prime,Xn=h.bgbr$prime,Yn=h.bgg$prime,Jn=h.bgga$prime,Zn=h.bggb$prime,Kn=h.bggg$prime,Qn=h.bggr$prime,ei=h.bgr$prime,ti=h.bgra$prime,ri=h.bgrb$prime,ni=h.bgrg$prime,ii=h.bgrr$prime,ai=h.br$prime,oi=h.bra$prime,si=h.braa$prime,ui=h.brab$prime,ci=h.brag$prime,li=h.brar$prime,fi=h.brb$prime,pi=h.brba$prime,hi=h.brbb$prime,di=h.brbg$prime,mi=h.brbr$prime,gi=h.brg$prime,vi=h.brga$prime,_i=h.brgb$prime,yi=h.brgg$prime,bi=h.brgr$prime,xi=h.brr$prime,wi=h.brra$prime,$i=h.brrb$prime,Ei=h.brrg$prime,Mi=h.brrr$prime,Ti=h.g$prime,Si=h.ga$prime,Ai=h.gaa$prime,zi=h.gaaa$prime,Ri=h.gaab$prime,Ci=h.gaag$prime,Li=h.gaar$prime,Pi=h.gab$prime,Ui=h.gaba$prime,Ii=h.gabb$prime,Oi=h.gabg$prime,Ni=h.gabr$prime,ki=h.gag$prime,Di=h.gaga$prime,Fi=h.gagb$prime,Bi=h.gagg$prime,Gi=h.gagr$prime,Vi=h.gar$prime,Hi=h.gara$prime,ji=h.garb$prime,Wi=h.garg$prime,qi=h.garr$prime,Xi=h.gb$prime,Yi=h.gba$prime,Ji=h.gbaa$prime,Zi=h.gbab$prime,Ki=h.gbag$prime,Qi=h.gbar$prime,ea=h.gbb$prime,ta=h.gbba$prime,ra=h.gbbb$prime,na=h.gbbg$prime,ia=h.gbbr$prime,aa=h.gbg$prime,oa=h.gbga$prime,sa=h.gbgb$prime,ua=h.gbgg$prime,ca=h.gbgr$prime,la=h.gbr$prime,fa=h.gbra$prime,pa=h.gbrb$prime,ha=h.gbrg$prime,da=h.gbrr$prime,ma=h.gg$prime,ga=h.gga$prime,va=h.ggaa$prime,_a=h.ggab$prime,ya=h.ggag$prime,ba=h.ggar$prime,xa=h.ggb$prime,wa=h.ggba$prime,$a=h.ggbb$prime,Ea=h.ggbg$prime,Ma=h.ggbr$prime,Ta=h.ggg$prime,Sa=h.ggga$prime,Aa=h.gggb$prime,za=h.gggg$prime,Ra=h.gggr$prime,Ca=h.ggr$prime,La=h.ggra$prime,Pa=h.ggrb$prime,Ua=h.ggrg$prime,Ia=h.ggrr$prime,Oa=h.gr$prime,Na=h.gra$prime,ka=h.graa$prime,Da=h.grab$prime,Fa=h.grag$prime,Ba=h.grar$prime,Ga=h.grb$prime,Va=h.grba$prime,Ha=h.grbb$prime,ja=h.grbg$prime,Wa=h.grbr$prime,qa=h.grg$prime,Xa=h.grga$prime,Ya=h.grgb$prime,Ja=h.grgg$prime,Za=h.grgr$prime,Ka=h.grr$prime,Qa=h.grra$prime,eo=h.grrb$prime,to=h.grrg$prime,ro=h.grrr$prime,no=h.r$prime,io=h.ra$prime,ao=h.raa$prime,oo=h.raaa$prime,so=h.raab$prime,uo=h.raag$prime,co=h.raar$prime,lo=h.rab$prime,fo=h.raba$prime,po=h.rabb$prime,ho=h.rabg$prime,mo=h.rabr$prime,go=h.rag$prime,vo=h.raga$prime,_o=h.ragb$prime,yo=h.ragg$prime,bo=h.ragr$prime,xo=h.rar$prime,wo=h.rara$prime,$o=h.rarb$prime,Eo=h.rarg$prime,Mo=h.rarr$prime,To=h.rb$prime,So=h.rba$prime,Ao=h.rbaa$prime,zo=h.rbab$prime,Ro=h.rbag$prime,Co=h.rbar$prime,Lo=h.rbb$prime,Po=h.rbba$prime,Uo=h.rbbb$prime,Io=h.rbbg$prime,Oo=h.rbbr$prime,No=h.rbg$prime,ko=h.rbga$prime,Do=h.rbgb$prime,Fo=h.rbgg$prime,Bo=h.rbgr$prime,Go=h.rbr$prime,Vo=h.rbra$prime,Ho=h.rbrb$prime,jo=h.rbrg$prime,Wo=h.rbrr$prime,qo=h.rg$prime,Xo=h.rga$prime,Yo=h.rgaa$prime,Jo=h.rgab$prime,Zo=h.rgag$prime,Ko=h.rgar$prime,Qo=h.rgb$prime,es=h.rgba$prime,ts=h.rgbb$prime,rs=h.rgbg$prime,ns=h.rgbr$prime,is=h.rgg$prime,as=h.rgga$prime,os=h.rggb$prime,ss=h.rggg$prime,us=h.rggr$prime,cs=h.rgr$prime,ls=h.rgra$prime,fs=h.rgrb$prime,ps=h.rgrg$prime,hs=h.rgrr$prime,ds=h.rr$prime,ms=h.rra$prime,gs=h.rraa$prime,vs=h.rrab$prime,_s=h.rrag$prime,ys=h.rrar$prime,bs=h.rrb$prime,xs=h.rrba$prime,ws=h.rrbb$prime,$s=h.rrbg$prime,Es=h.rrbr$prime,Ms=h.rrg$prime,Ts=h.rrga$prime,Ss=h.rrgb$prime,As=h.rrgg$prime,zs=h.rrgr$prime,Rs=h.rrr$prime,Cs=h.rrra$prime,Ls=h.rrrb$prime,Ps=h.rrrg$prime,Us=h.rrrr$prime,Is=h.w$prime,Os=h.ww$prime,Ns=h.www$prime,ks=h.wwww$prime,Ds=h.wwwx$prime,Fs=h.wwwy$prime,Bs=h.wwwz$prime,Gs=h.wwx$prime,Vs=h.wwxw$prime,Hs=h.wwxx$prime,js=h.wwxy$prime,Ws=h.wwxz$prime,qs=h.wwy$prime,Xs=h.wwyw$prime,Ys=h.wwyx$prime,Js=h.wwyy$prime,Zs=h.wwyz$prime,Ks=h.wwz$prime,Qs=h.wwzw$prime,eu=h.wwzx$prime,tu=h.wwzy$prime,ru=h.wwzz$prime,nu=h.wx$prime,iu=h.wxw$prime,au=h.wxww$prime,ou=h.wxwx$prime,su=h.wxwy$prime,uu=h.wxwz$prime,cu=h.wxx$prime,lu=h.wxxw$prime,fu=h.wxxx$prime,pu=h.wxxy$prime,hu=h.wxxz$prime,du=h.wxy$prime,mu=h.wxyw$prime,gu=h.wxyx$prime,vu=h.wxyy$prime,_u=h.wxyz$prime,yu=h.wxz$prime,bu=h.wxzw$prime,xu=h.wxzx$prime,wu=h.wxzy$prime,$u=h.wxzz$prime,Eu=h.wy$prime,Mu=h.wyw$prime,Tu=h.wyww$prime,Su=h.wywx$prime,Au=h.wywy$prime,zu=h.wywz$prime,Ru=h.wyx$prime,Cu=h.wyxw$prime,Lu=h.wyxx$prime,Pu=h.wyxy$prime,Uu=h.wyxz$prime,Iu=h.wyy$prime,Ou=h.wyyw$prime,Nu=h.wyyx$prime,ku=h.wyyy$prime,Du=h.wyyz$prime,Fu=h.wyz$prime,Bu=h.wyzw$prime,Gu=h.wyzx$prime,Vu=h.wyzy$prime,Hu=h.wyzz$prime,ju=h.wz$prime,Wu=h.wzw$prime,qu=h.wzww$prime,Xu=h.wzwx$prime,Yu=h.wzwy$prime,Ju=h.wzwz$prime,Zu=h.wzx$prime,Ku=h.wzxw$prime,Qu=h.wzxx$prime,ec=h.wzxy$prime,tc=h.wzxz$prime,rc=h.wzy$prime,nc=h.wzyw$prime,ic=h.wzyx$prime,ac=h.wzyy$prime,oc=h.wzyz$prime,sc=h.wzz$prime,uc=h.wzzw$prime,cc=h.wzzx$prime,lc=h.wzzy$prime,fc=h.wzzz$prime,pc=h.x$prime,hc=h.xw$prime,dc=h.xww$prime,mc=h.xwww$prime,gc=h.xwwx$prime,vc=h.xwwy$prime,_c=h.xwwz$prime,yc=h.xwx$prime,bc=h.xwxw$prime,xc=h.xwxx$prime,wc=h.xwxy$prime,$c=h.xwxz$prime,Ec=h.xwy$prime,Mc=h.xwyw$prime,Tc=h.xwyx$prime,Sc=h.xwyy$prime,Ac=h.xwyz$prime,zc=h.xwz$prime,Rc=h.xwzw$prime,Cc=h.xwzx$prime,Lc=h.xwzy$prime,Pc=h.xwzz$prime,Uc=h.xx$prime,Ic=h.xxw$prime,Oc=h.xxww$prime,Nc=h.xxwx$prime,kc=h.xxwy$prime,Dc=h.xxwz$prime,Fc=h.xxx$prime,Bc=h.xxxw$prime,Gc=h.xxxx$prime,Vc=h.xxxy$prime,Hc=h.xxxz$prime,jc=h.xxy$prime,Wc=h.xxyw$prime,qc=h.xxyx$prime,Xc=h.xxyy$prime,Yc=h.xxyz$prime,Jc=h.xxz$prime,Zc=h.xxzw$prime,Kc=h.xxzx$prime,Qc=h.xxzy$prime,el=h.xxzz$prime,tl=h.xy$prime,rl=h.xyw$prime,nl=h.xyww$prime,il=h.xywx$prime,al=h.xywy$prime,ol=h.xywz$prime,sl=h.xyx$prime,ul=h.xyxw$prime,cl=h.xyxx$prime,ll=h.xyxy$prime,fl=h.xyxz$prime,pl=h.xyy$prime,hl=h.xyyw$prime,dl=h.xyyx$prime,ml=h.xyyy$prime,gl=h.xyyz$prime,vl=h.xyz$prime,_l=h.xyzw$prime,yl=h.xyzx$prime,bl=h.xyzy$prime,xl=h.xyzz$prime,wl=h.xz$prime,$l=h.xzw$prime,El=h.xzww$prime,Ml=h.xzwx$prime,Tl=h.xzwy$prime,Sl=h.xzwz$prime,Al=h.xzx$prime,zl=h.xzxw$prime,Rl=h.xzxx$prime,Cl=h.xzxy$prime,Ll=h.xzxz$prime,Pl=h.xzy$prime,Ul=h.xzyw$prime,Il=h.xzyx$prime,Ol=h.xzyy$prime,Nl=h.xzyz$prime,kl=h.xzz$prime,Dl=h.xzzw$prime,Fl=h.xzzx$prime,Bl=h.xzzy$prime,Gl=h.xzzz$prime,Vl=h.y$prime,Hl=h.yw$prime,jl=h.yww$prime,Wl=h.ywww$prime,ql=h.ywwx$prime,Xl=h.ywwy$prime,Yl=h.ywwz$prime,Jl=h.ywx$prime,Zl=h.ywxw$prime,Kl=h.ywxx$prime,Ql=h.ywxy$prime,ef=h.ywxz$prime,tf=h.ywy$prime,rf=h.ywyw$prime,nf=h.ywyx$prime,af=h.ywyy$prime,of=h.ywyz$prime,sf=h.ywz$prime,uf=h.ywzw$prime,cf=h.ywzx$prime,lf=h.ywzy$prime,ff=h.ywzz$prime,pf=h.yx$prime,hf=h.yxw$prime,df=h.yxww$prime,mf=h.yxwx$prime,gf=h.yxwy$prime,vf=h.yxwz$prime,_f=h.yxx$prime,yf=h.yxxw$prime,bf=h.yxxx$prime,xf=h.yxxy$prime,wf=h.yxxz$prime,$f=h.yxy$prime,Ef=h.yxyw$prime,Mf=h.yxyx$prime,Tf=h.yxyy$prime,Sf=h.yxyz$prime,Af=h.yxz$prime,zf=h.yxzw$prime,Rf=h.yxzx$prime,Cf=h.yxzy$prime,Lf=h.yxzz$prime,Pf=h.yy$prime,Uf=h.yyw$prime,If=h.yyww$prime,Of=h.yywx$prime,Nf=h.yywy$prime,kf=h.yywz$prime,Df=h.yyx$prime,Ff=h.yyxw$prime,Bf=h.yyxx$prime,Gf=h.yyxy$prime,Vf=h.yyxz$prime,Hf=h.yyy$prime,jf=h.yyyw$prime,Wf=h.yyyx$prime,qf=h.yyyy$prime,Xf=h.yyyz$prime,Yf=h.yyz$prime,Jf=h.yyzw$prime,Zf=h.yyzx$prime,Kf=h.yyzy$prime,Qf=h.yyzz$prime,ep=h.yz$prime,tp=h.yzw$prime,rp=h.yzww$prime,np=h.yzwx$prime,ip=h.yzwy$prime,ap=h.yzwz$prime,op=h.yzx$prime,sp=h.yzxw$prime,up=h.yzxx$prime,cp=h.yzxy$prime,lp=h.yzxz$prime,fp=h.yzy$prime,pp=h.yzyw$prime,hp=h.yzyx$prime,dp=h.yzyy$prime,mp=h.yzyz$prime,gp=h.yzz$prime,vp=h.yzzw$prime,_p=h.yzzx$prime,yp=h.yzzy$prime,bp=h.yzzz$prime,xp=h.z$prime,wp=h.zw$prime,$p=h.zww$prime,Ep=h.zwww$prime,Mp=h.zwwx$prime,Tp=h.zwwy$prime,Sp=h.zwwz$prime,Ap=h.zwx$prime,zp=h.zwxw$prime,Rp=h.zwxx$prime,Cp=h.zwxy$prime,Lp=h.zwxz$prime,Pp=h.zwy$prime,Up=h.zwyw$prime,Ip=h.zwyx$prime,Op=h.zwyy$prime,Np=h.zwyz$prime,kp=h.zwz$prime,Dp=h.zwzw$prime,Fp=h.zwzx$prime,Bp=h.zwzy$prime,Gp=h.zwzz$prime,Vp=h.zx$prime,Hp=h.zxw$prime,jp=h.zxww$prime,Wp=h.zxwx$prime,qp=h.zxwy$prime,Xp=h.zxwz$prime,Yp=h.zxx$prime,Jp=h.zxxw$prime,Zp=h.zxxx$prime,Kp=h.zxxy$prime,Qp=h.zxxz$prime,eh=h.zxy$prime,th=h.zxyw$prime,rh=h.zxyx$prime,nh=h.zxyy$prime,ih=h.zxyz$prime,ah=h.zxz$prime,oh=h.zxzw$prime,sh=h.zxzx$prime,uh=h.zxzy$prime,ch=h.zxzz$prime,lh=h.zy$prime,fh=h.zyw$prime,ph=h.zyww$prime,hh=h.zywx$prime,dh=h.zywy$prime,mh=h.zywz$prime,gh=h.zyx$prime,vh=h.zyxw$prime,_h=h.zyxx$prime,yh=h.zyxy$prime,bh=h.zyxz$prime,xh=h.zyy$prime,wh=h.zyyw$prime,$h=h.zyyx$prime,Eh=h.zyyy$prime,Mh=h.zyyz$prime,Th=h.zyz$prime,Sh=h.zyzw$prime,Ah=h.zyzx$prime,zh=h.zyzy$prime,Rh=h.zyzz$prime,Ch=h.zz$prime,Lh=h.zzw$prime,Ph=h.zzww$prime,Uh=h.zzwx$prime,Ih=h.zzwy$prime,Oh=h.zzwz$prime,Nh=h.zzx$prime,kh=h.zzxw$prime,Dh=h.zzxx$prime,Fh=h.zzxy$prime,Bh=h.zzxz$prime,Gh=h.zzy$prime,Vh=h.zzyw$prime,Hh=h.zzyx$prime,jh=h.zzyy$prime,Wh=h.zzyz$prime,qh=h.zzz$prime,Xh=h.zzzw$prime,Yh=h.zzzx$prime,Jh=h.zzzy$prime,Zh=h.zzzz$prime,Kh=S,Qh=he,ed=R,td=C,rd=C,nd=z;t.SS=m,t.webGLVersion=g,t.isGL2=function(){return+(2===g[0])},t.getVersion=v,t.vertexPrelude=_,t.vertexPrelude1=y,t.extraAttributes1="\nattribute highp float a_VertexIDFloat;\n\n#define gl_VertexID (int(a_VertexIDFloat))\n#define gl_VertexID2F (a_VertexIDFloat.y)\n",t.fragmentPrelude=b,t.fragmentPrelude1=x,t.precisionQuantifier=w,t.precision=$,t.newline=E,t.indent=M,t.GLSLTypeError=T,t.PhantomAlgebra=nt,t.protoScalar=it,t.protoFloat=at,t.protoVec2=ot,t.protoVec3=st,t.protoVec4=ut,t.protoMat2=ct,t.protoMat3=lt,t.protoMat4=ft,t.fmtSwizzle=pt,t.accept1=ht,t.accept2=dt,t.accept3=mt,t.accept4=gt,t.a$prime=vt,t.aa$prime=_t,t.aaa$prime=yt,t.aaaa$prime=bt,t.aaab$prime=xt,t.aaag$prime=wt,t.aaar$prime=$t,t.aab$prime=Et,t.aaba$prime=Mt,t.aabb$prime=Tt,t.aabg$prime=St,t.aabr$prime=At,t.aag$prime=zt,t.aaga$prime=Rt,t.aagb$prime=Ct,t.aagg$prime=Lt,t.aagr$prime=Pt,t.aar$prime=Ut,t.aara$prime=It,t.aarb$prime=Ot,t.aarg$prime=Nt,t.aarr$prime=kt,t.ab$prime=Dt,t.aba$prime=Ft,t.abaa$prime=Bt,t.abab$prime=Gt,t.abag$prime=Vt,t.abar$prime=Ht,t.abb$prime=jt,t.abba$prime=Wt,t.abbb$prime=qt,t.abbg$prime=Xt,t.abbr$prime=Yt,t.abg$prime=Jt,t.abga$prime=Zt,t.abgb$prime=Kt,t.abgg$prime=Qt,t.abgr$prime=er,t.abr$prime=tr,t.abra$prime=rr,t.abrb$prime=nr,t.abrg$prime=ir,t.abrr$prime=ar,t.ag$prime=or,t.aga$prime=sr,t.agaa$prime=ur,t.agab$prime=cr,t.agag$prime=lr,t.agar$prime=fr,t.agb$prime=pr,t.agba$prime=hr,t.agbb$prime=dr,t.agbg$prime=mr,t.agbr$prime=gr,t.agg$prime=vr,t.agga$prime=_r,t.aggb$prime=yr,t.aggg$prime=br,t.aggr$prime=xr,t.agr$prime=wr,t.agra$prime=$r,t.agrb$prime=Er,t.agrg$prime=Mr,t.agrr$prime=Tr,t.ar$prime=Sr,t.ara$prime=Ar,t.araa$prime=zr,t.arab$prime=Rr,t.arag$prime=Cr,t.arar$prime=Lr,t.arb$prime=Pr,t.arba$prime=Ur,t.arbb$prime=Ir,t.arbg$prime=Or,t.arbr$prime=Nr,t.arg$prime=kr,t.arga$prime=Dr,t.argb$prime=Fr,t.argg$prime=Br,t.argr$prime=Gr,t.arr$prime=Vr,t.arra$prime=Hr,t.arrb$prime=jr,t.arrg$prime=Wr,t.arrr$prime=qr,t.b$prime=Xr,t.ba$prime=Yr,t.baa$prime=Jr,t.baaa$prime=Zr,t.baab$prime=Kr,t.baag$prime=Qr,t.baar$prime=en,t.bab$prime=tn,t.baba$prime=rn,t.babb$prime=nn,t.babg$prime=an,t.babr$prime=on,t.bag$prime=sn,t.baga$prime=un,t.bagb$prime=cn,t.bagg$prime=ln,t.bagr$prime=fn,t.bar$prime=pn,t.bara$prime=hn,t.barb$prime=dn,t.barg$prime=mn,t.barr$prime=gn,t.bb$prime=vn,t.bba$prime=_n,t.bbaa$prime=yn,t.bbab$prime=bn,t.bbag$prime=xn,t.bbar$prime=wn,t.bbb$prime=$n,t.bbba$prime=En,t.bbbb$prime=Mn,t.bbbg$prime=Tn,t.bbbr$prime=Sn,t.bbg$prime=An,t.bbga$prime=zn,t.bbgb$prime=Rn,t.bbgg$prime=Cn,t.bbgr$prime=Ln,t.bbr$prime=Pn,t.bbra$prime=Un,t.bbrb$prime=In,t.bbrg$prime=On,t.bbrr$prime=Nn,t.bg$prime=kn,t.bga$prime=Dn,t.bgaa$prime=Fn,t.bgab$prime=Bn,t.bgag$prime=Gn,t.bgar$prime=Vn,t.bgb$prime=Hn,t.bgba$prime=jn,t.bgbb$prime=Wn,t.bgbg$prime=qn,t.bgbr$prime=Xn,t.bgg$prime=Yn,t.bgga$prime=Jn,t.bggb$prime=Zn,t.bggg$prime=Kn,t.bggr$prime=Qn,t.bgr$prime=ei,t.bgra$prime=ti,t.bgrb$prime=ri,t.bgrg$prime=ni,t.bgrr$prime=ii,t.br$prime=ai,t.bra$prime=oi,t.braa$prime=si,t.brab$prime=ui,t.brag$prime=ci,t.brar$prime=li,t.brb$prime=fi,t.brba$prime=pi,t.brbb$prime=hi,t.brbg$prime=di,t.brbr$prime=mi,t.brg$prime=gi,t.brga$prime=vi,t.brgb$prime=_i,t.brgg$prime=yi,t.brgr$prime=bi,t.brr$prime=xi,t.brra$prime=wi,t.brrb$prime=$i,t.brrg$prime=Ei,t.brrr$prime=Mi,t.g$prime=Ti,t.ga$prime=Si,t.gaa$prime=Ai,t.gaaa$prime=zi,t.gaab$prime=Ri,t.gaag$prime=Ci,t.gaar$prime=Li,t.gab$prime=Pi,t.gaba$prime=Ui,t.gabb$prime=Ii,t.gabg$prime=Oi,t.gabr$prime=Ni,t.gag$prime=ki,t.gaga$prime=Di,t.gagb$prime=Fi,t.gagg$prime=Bi,t.gagr$prime=Gi,t.gar$prime=Vi,t.gara$prime=Hi,t.garb$prime=ji,t.garg$prime=Wi,t.garr$prime=qi,t.gb$prime=Xi,t.gba$prime=Yi,t.gbaa$prime=Ji,t.gbab$prime=Zi,t.gbag$prime=Ki,t.gbar$prime=Qi,t.gbb$prime=ea,t.gbba$prime=ta,t.gbbb$prime=ra,t.gbbg$prime=na,t.gbbr$prime=ia,t.gbg$prime=aa,t.gbga$prime=oa,t.gbgb$prime=sa,t.gbgg$prime=ua,t.gbgr$prime=ca,t.gbr$prime=la,t.gbra$prime=fa,t.gbrb$prime=pa,t.gbrg$prime=ha,t.gbrr$prime=da,t.gg$prime=ma,t.gga$prime=ga,t.ggaa$prime=va,t.ggab$prime=_a,t.ggag$prime=ya,t.ggar$prime=ba,t.ggb$prime=xa,t.ggba$prime=wa,t.ggbb$prime=$a,t.ggbg$prime=Ea,t.ggbr$prime=Ma,t.ggg$prime=Ta,t.ggga$prime=Sa,t.gggb$prime=Aa,t.gggg$prime=za,t.gggr$prime=Ra,t.ggr$prime=Ca,t.ggra$prime=La,t.ggrb$prime=Pa,t.ggrg$prime=Ua,t.ggrr$prime=Ia,t.gr$prime=Oa,t.gra$prime=Na,t.graa$prime=ka,t.grab$prime=Da,t.grag$prime=Fa,t.grar$prime=Ba,t.grb$prime=Ga,t.grba$prime=Va,t.grbb$prime=Ha,t.grbg$prime=ja,t.grbr$prime=Wa,t.grg$prime=qa,t.grga$prime=Xa,t.grgb$prime=Ya,t.grgg$prime=Ja,t.grgr$prime=Za,t.grr$prime=Ka,t.grra$prime=Qa,t.grrb$prime=eo,t.grrg$prime=to,t.grrr$prime=ro,t.r$prime=no,t.ra$prime=io,t.raa$prime=ao,t.raaa$prime=oo,t.raab$prime=so,t.raag$prime=uo,t.raar$prime=co,t.rab$prime=lo,t.raba$prime=fo,t.rabb$prime=po,t.rabg$prime=ho,t.rabr$prime=mo,t.rag$prime=go,t.raga$prime=vo,t.ragb$prime=_o,t.ragg$prime=yo,t.ragr$prime=bo,t.rar$prime=xo,t.rara$prime=wo,t.rarb$prime=$o,t.rarg$prime=Eo,t.rarr$prime=Mo,t.rb$prime=To,t.rba$prime=So,t.rbaa$prime=Ao,t.rbab$prime=zo,t.rbag$prime=Ro,t.rbar$prime=Co,t.rbb$prime=Lo,t.rbba$prime=Po,t.rbbb$prime=Uo,t.rbbg$prime=Io,t.rbbr$prime=Oo,t.rbg$prime=No,t.rbga$prime=ko,t.rbgb$prime=Do,t.rbgg$prime=Fo,t.rbgr$prime=Bo,t.rbr$prime=Go,t.rbra$prime=Vo,t.rbrb$prime=Ho,t.rbrg$prime=jo,t.rbrr$prime=Wo,t.rg$prime=qo,t.rga$prime=Xo,t.rgaa$prime=Yo,t.rgab$prime=Jo,t.rgag$prime=Zo,t.rgar$prime=Ko,t.rgb$prime=Qo,t.rgba$prime=es,t.rgbb$prime=ts,t.rgbg$prime=rs,t.rgbr$prime=ns,t.rgg$prime=is,t.rgga$prime=as,t.rggb$prime=os,t.rggg$prime=ss,t.rggr$prime=us,t.rgr$prime=cs,t.rgra$prime=ls,t.rgrb$prime=fs,t.rgrg$prime=ps,t.rgrr$prime=hs,t.rr$prime=ds,t.rra$prime=ms,t.rraa$prime=gs,t.rrab$prime=vs,t.rrag$prime=_s,t.rrar$prime=ys,t.rrb$prime=bs,t.rrba$prime=xs,t.rrbb$prime=ws,t.rrbg$prime=$s,t.rrbr$prime=Es,t.rrg$prime=Ms,t.rrga$prime=Ts,t.rrgb$prime=Ss,t.rrgg$prime=As,t.rrgr$prime=zs,t.rrr$prime=Rs,t.rrra$prime=Cs,t.rrrb$prime=Ls,t.rrrg$prime=Ps,t.rrrr$prime=Us,t.w$prime=Is,t.ww$prime=Os,t.www$prime=Ns,t.wwww$prime=ks,t.wwwx$prime=Ds,t.wwwy$prime=Fs,t.wwwz$prime=Bs,t.wwx$prime=Gs,t.wwxw$prime=Vs,t.wwxx$prime=Hs,t.wwxy$prime=js,t.wwxz$prime=Ws,t.wwy$prime=qs,t.wwyw$prime=Xs,t.wwyx$prime=Ys,t.wwyy$prime=Js,t.wwyz$prime=Zs,t.wwz$prime=Ks,t.wwzw$prime=Qs,t.wwzx$prime=eu,t.wwzy$prime=tu,t.wwzz$prime=ru,t.wx$prime=nu,t.wxw$prime=iu,t.wxww$prime=au,t.wxwx$prime=ou,t.wxwy$prime=su,t.wxwz$prime=uu,t.wxx$prime=cu,t.wxxw$prime=lu,t.wxxx$prime=fu,t.wxxy$prime=pu,t.wxxz$prime=hu,t.wxy$prime=du,t.wxyw$prime=mu,t.wxyx$prime=gu,t.wxyy$prime=vu,t.wxyz$prime=_u,t.wxz$prime=yu,t.wxzw$prime=bu,t.wxzx$prime=xu,t.wxzy$prime=wu,t.wxzz$prime=$u,t.wy$prime=Eu,t.wyw$prime=Mu,t.wyww$prime=Tu,t.wywx$prime=Su,t.wywy$prime=Au,t.wywz$prime=zu,t.wyx$prime=Ru,t.wyxw$prime=Cu,t.wyxx$prime=Lu,t.wyxy$prime=Pu,t.wyxz$prime=Uu,t.wyy$prime=Iu,t.wyyw$prime=Ou,t.wyyx$prime=Nu,t.wyyy$prime=ku,t.wyyz$prime=Du,t.wyz$prime=Fu,t.wyzw$prime=Bu,t.wyzx$prime=Gu,t.wyzy$prime=Vu,t.wyzz$prime=Hu,t.wz$prime=ju,t.wzw$prime=Wu,t.wzww$prime=qu,t.wzwx$prime=Xu,t.wzwy$prime=Yu,t.wzwz$prime=Ju,t.wzx$prime=Zu,t.wzxw$prime=Ku,t.wzxx$prime=Qu,t.wzxy$prime=ec,t.wzxz$prime=tc,t.wzy$prime=rc,t.wzyw$prime=nc,t.wzyx$prime=ic,t.wzyy$prime=ac,t.wzyz$prime=oc,t.wzz$prime=sc,t.wzzw$prime=uc,t.wzzx$prime=cc,t.wzzy$prime=lc,t.wzzz$prime=fc,t.x$prime=pc,t.xw$prime=hc,t.xww$prime=dc,t.xwww$prime=mc,t.xwwx$prime=gc,t.xwwy$prime=vc,t.xwwz$prime=_c,t.xwx$prime=yc,t.xwxw$prime=bc,t.xwxx$prime=xc,t.xwxy$prime=wc,t.xwxz$prime=$c,t.xwy$prime=Ec,t.xwyw$prime=Mc,t.xwyx$prime=Tc,t.xwyy$prime=Sc,t.xwyz$prime=Ac,t.xwz$prime=zc,t.xwzw$prime=Rc,t.xwzx$prime=Cc,t.xwzy$prime=Lc,t.xwzz$prime=Pc,t.xx$prime=Uc,t.xxw$prime=Ic,t.xxww$prime=Oc,t.xxwx$prime=Nc,t.xxwy$prime=kc,t.xxwz$prime=Dc,t.xxx$prime=Fc,t.xxxw$prime=Bc,t.xxxx$prime=Gc,t.xxxy$prime=Vc,t.xxxz$prime=Hc,t.xxy$prime=jc,t.xxyw$prime=Wc,t.xxyx$prime=qc,t.xxyy$prime=Xc,t.xxyz$prime=Yc,t.xxz$prime=Jc,t.xxzw$prime=Zc,t.xxzx$prime=Kc,t.xxzy$prime=Qc,t.xxzz$prime=el,t.xy$prime=tl,t.xyw$prime=rl,t.xyww$prime=nl,t.xywx$prime=il,t.xywy$prime=al,t.xywz$prime=ol,t.xyx$prime=sl,t.xyxw$prime=ul,t.xyxx$prime=cl,t.xyxy$prime=ll,t.xyxz$prime=fl,t.xyy$prime=pl,t.xyyw$prime=hl,t.xyyx$prime=dl,t.xyyy$prime=ml,t.xyyz$prime=gl,t.xyz$prime=vl,t.xyzw$prime=_l,t.xyzx$prime=yl,t.xyzy$prime=bl,t.xyzz$prime=xl,t.xz$prime=wl,t.xzw$prime=$l,t.xzww$prime=El,t.xzwx$prime=Ml,t.xzwy$prime=Tl,t.xzwz$prime=Sl,t.xzx$prime=Al,t.xzxw$prime=zl,t.xzxx$prime=Rl,t.xzxy$prime=Cl,t.xzxz$prime=Ll,t.xzy$prime=Pl,t.xzyw$prime=Ul,t.xzyx$prime=Il,t.xzyy$prime=Ol,t.xzyz$prime=Nl,t.xzz$prime=kl,t.xzzw$prime=Dl,t.xzzx$prime=Fl,t.xzzy$prime=Bl,t.xzzz$prime=Gl,t.y$prime=Vl,t.yw$prime=Hl,t.yww$prime=jl,t.ywww$prime=Wl,t.ywwx$prime=ql,t.ywwy$prime=Xl,t.ywwz$prime=Yl,t.ywx$prime=Jl,t.ywxw$prime=Zl,t.ywxx$prime=Kl,t.ywxy$prime=Ql,t.ywxz$prime=ef,t.ywy$prime=tf,t.ywyw$prime=rf,t.ywyx$prime=nf,t.ywyy$prime=af,t.ywyz$prime=of,t.ywz$prime=sf,t.ywzw$prime=uf,t.ywzx$prime=cf,t.ywzy$prime=lf,t.ywzz$prime=ff,t.yx$prime=pf,t.yxw$prime=hf,t.yxww$prime=df,t.yxwx$prime=mf,t.yxwy$prime=gf,t.yxwz$prime=vf,t.yxx$prime=_f,t.yxxw$prime=yf,t.yxxx$prime=bf,t.yxxy$prime=xf,t.yxxz$prime=wf,t.yxy$prime=$f,t.yxyw$prime=Ef,t.yxyx$prime=Mf,t.yxyy$prime=Tf,t.yxyz$prime=Sf,t.yxz$prime=Af,t.yxzw$prime=zf,t.yxzx$prime=Rf,t.yxzy$prime=Cf,t.yxzz$prime=Lf,t.yy$prime=Pf,t.yyw$prime=Uf,t.yyww$prime=If,t.yywx$prime=Of,t.yywy$prime=Nf,t.yywz$prime=kf,t.yyx$prime=Df,t.yyxw$prime=Ff,t.yyxx$prime=Bf,t.yyxy$prime=Gf,t.yyxz$prime=Vf,t.yyy$prime=Hf,t.yyyw$prime=jf,t.yyyx$prime=Wf,t.yyyy$prime=qf,t.yyyz$prime=Xf,t.yyz$prime=Yf,t.yyzw$prime=Jf,t.yyzx$prime=Zf,t.yyzy$prime=Kf,t.yyzz$prime=Qf,t.yz$prime=ep,t.yzw$prime=tp,t.yzww$prime=rp,t.yzwx$prime=np,t.yzwy$prime=ip,t.yzwz$prime=ap,t.yzx$prime=op,t.yzxw$prime=sp,t.yzxx$prime=up,t.yzxy$prime=cp,t.yzxz$prime=lp,t.yzy$prime=fp,t.yzyw$prime=pp,t.yzyx$prime=hp,t.yzyy$prime=dp,t.yzyz$prime=mp,t.yzz$prime=gp,t.yzzw$prime=vp,t.yzzx$prime=_p,t.yzzy$prime=yp,t.yzzz$prime=bp,t.z$prime=xp,t.zw$prime=wp,t.zww$prime=$p,t.zwww$prime=Ep,t.zwwx$prime=Mp,t.zwwy$prime=Tp,t.zwwz$prime=Sp,t.zwx$prime=Ap,t.zwxw$prime=zp,t.zwxx$prime=Rp,t.zwxy$prime=Cp,t.zwxz$prime=Lp,t.zwy$prime=Pp,t.zwyw$prime=Up,t.zwyx$prime=Ip,t.zwyy$prime=Op,t.zwyz$prime=Np,t.zwz$prime=kp,t.zwzw$prime=Dp,t.zwzx$prime=Fp,t.zwzy$prime=Bp,t.zwzz$prime=Gp,t.zx$prime=Vp,t.zxw$prime=Hp,t.zxww$prime=jp,t.zxwx$prime=Wp,t.zxwy$prime=qp,t.zxwz$prime=Xp,t.zxx$prime=Yp,t.zxxw$prime=Jp,t.zxxx$prime=Zp,t.zxxy$prime=Kp,t.zxxz$prime=Qp,t.zxy$prime=eh,t.zxyw$prime=th,t.zxyx$prime=rh,t.zxyy$prime=nh,t.zxyz$prime=ih,t.zxz$prime=ah,t.zxzw$prime=oh,t.zxzx$prime=sh,t.zxzy$prime=uh,t.zxzz$prime=ch,t.zy$prime=lh,t.zyw$prime=fh,t.zyww$prime=ph,t.zywx$prime=hh,t.zywy$prime=dh,t.zywz$prime=mh,t.zyx$prime=gh,t.zyxw$prime=vh,t.zyxx$prime=_h,t.zyxy$prime=yh,t.zyxz$prime=bh,t.zyy$prime=xh,t.zyyw$prime=wh,t.zyyx$prime=$h,t.zyyy$prime=Eh,t.zyyz$prime=Mh,t.zyz$prime=Th,t.zyzw$prime=Sh,t.zyzx$prime=Ah,t.zyzy$prime=zh,t.zyzz$prime=Rh,t.zz$prime=Ch,t.zzw$prime=Lh,t.zzww$prime=Ph,t.zzwx$prime=Uh,t.zzwy$prime=Ih,t.zzwz$prime=Oh,t.zzx$prime=Nh,t.zzxw$prime=kh,t.zzxx$prime=Dh,t.zzxy$prime=Fh,t.zzxz$prime=Bh,t.zzy$prime=Gh,t.zzyw$prime=Vh,t.zzyx$prime=Hh,t.zzyy$prime=jh,t.zzyz$prime=Wh,t.zzz$prime=qh,t.zzzw$prime=Xh,t.zzzx$prime=Yh,t.zzzy$prime=Jh,t.zzzz$prime=Zh,t.unused=function(e){return e},t.u=S,t.untyped=Kh,t.getType=A,t.genericexprlist=z,t.genericexpr1=R,t.genericexpr1float=function(e,t){return a.__(0,[h.protoScalar,t])},t.genericexpr2=C,t.genericexpr2float=function(e,t,r){return a.__(0,[c.scalar(0),r])},t.mixexpr3=function(e,t,r,n){return a.__(0,[A(e),n])},t.oldgenericexprlist=function(e,t){var r=i.hd(e);if(r.tag)throw[T,"type mismatch"];var n=r[0];return n>=958747519?n>=958747520?a.__(0,[958747520,t]):a.__(0,[958747519,t]):n>=958747518?a.__(0,[958747518,t]):a.__(0,[365180284,t])},t.oldgenericexpr1=function(e,t){if(e.tag)throw[T,"type mismatch"];var r=e[0];return r>=958747519?r>=958747520?a.__(0,[958747520,t]):a.__(0,[958747519,t]):r>=958747518?a.__(0,[958747518,t]):a.__(0,[365180284,t])},t.oldgenericexpr1float=function(e,t){if(e.tag)throw[T,"type mismatch"];return a.__(0,[365180284,t])},t.oldgenericmath2=function(e,t,r){if(e.tag)throw[T,"type mismatch"];var n=e[0];if(t.tag)throw[T,"type mismatch"];return t[0],a.__(0,[n,r])},t.oldgenericexpr2=function(e,t,r){if(e.tag)throw[T,"type mismatch"];if(t.tag)throw[T,"type mismatch"];return a.__(0,[e[0],r])},t.oldgenericexpr2float=function(e,t,r){if(e.tag)throw[T,"type mismatch"];if(t.tag)throw[T,"type mismatch"];return a.__(0,[365180284,r])},t.glslTypeString=L,t.combine=P,t.fmtTransformer=F,t.fmtFun=function(e){return o._2(D,F,e)},t.orderVars=B,t.getVarOfType=G,t.getFunctions=V,t.getAttributes=function(e){return G(1,e)},t.getVaryings=function(e){return G(3,e)},t.getUniforms=function(e){return G(2,e)},t.getOutputs=function(e){return G(5,e)},t.formatFunctions=H,t.formatAttributes=j,t.formatVaryings=W,t.formatUniforms=q,t.formatOutputs=X,t.getShader=Y,t.rightToLeft=J,t.getProgram=function(e,t,r){var n=i.map(function(e){var t=J(e[0])[0];return[t[1],t[2]]},e),a=i.concat([G(3,t),[G(3,r),0]]),o=2===g[0]?_:y,s=2===g[0]?b:x;return[G(1,t),n,a,G(5,r),Y(o,n,a,t,1),Y(s,n,a,r,0)]},t.assign=Z,t.symCounter=K,t.genSym=Q,t.wrap=function(e,t){return a.__(0,[e,t])},t.unwrap=function(e){var t;if(e.tag)throw[T,"untyped expression"];var r=e[0];return t=[r>=858746292?958747518!==r?r>=958747520?r>=959246196?0:6:r>=958747519?5:9:4:3654863!==r?r>=858746290?r>=858746291?8:7:r>=365180284?3:10:1,e[1]],a.__(0,[t[0],t[1]])},t.fundecl1=function(e,t,r,n){var i;if(e.tag)throw[T,"type mismatch"];var o=e[1];if(o.tag)throw[T,"type mismatch"];var s=o[0];if(!(s[0]>=7))throw[T,"type mismatch"];return i=[e[0],s[1],s[2]],a.__(0,[i[0],a.__(29,[[i[1],i[2],[S(t),0],r],[S(n),0]])])},t.fundecl2=function(e,t,r,n,i){var o;if(e.tag)throw[T,"type mismatch"];var s=e[1];if(s.tag)throw[T,"type mismatch"];var u=s[0];if(!(u[0]>=7))throw[T,"type mismatch"];return o=[e[0],u[1],u[2]],a.__(0,[o[0],a.__(29,[[o[1],o[2],[S(t[0]),[S(t[1]),0]],r],[S(n),[S(i),0]]])])},t.fundecl3=function(e,t,r,n,i,o){var s;if(e.tag)throw[T,"type mismatch"];var u=e[1];if(u.tag)throw[T,"type mismatch"];var c=u[0];if(!(c[0]>=7))throw[T,"type mismatch"];return s=[e[0],c[1],c[2]],a.__(0,[s[0],a.__(29,[[s[1],s[2],[S(t[0]),[S(t[1]),[S(t[2]),0]]],r],[S(n),[S(i),[S(o),0]]]])])},t.fundecl4=function(e,t,r,n,i,o,s){var u;if(e.tag)throw[T,"type mismatch"];var c=e[1];if(c.tag)throw[T,"type mismatch"];var l=c[0];if(!(l[0]>=7))throw[T,"type mismatch"];return u=[e[0],l[1],l[2]],a.__(0,[u[0],a.__(29,[[u[1],u[2],[S(t[0]),[S(t[1]),[S(t[2]),[S(t[3]),0]]]],r],[S(n),[S(i),[S(o),[S(s),0]]]]])])},t.floatfun=function(e){return a.__(0,[h.protoFloat,a.__(0,[[7,3,e]])])},t.floatattr=function(e){return a.__(0,[h.protoFloat,a.__(0,[[1,3,e]])])},t.floatvarying=function(e){return a.__(0,[h.protoFloat,a.__(0,[[3,3,e]])])},t.floatbuiltin=function(e){return a.__(0,[h.protoFloat,a.__(0,[[0,3,e]])])},t.floatuniform=function(e){return a.__(0,[h.protoFloat,a.__(0,[[2,3,e]])])},t.floatvar=ee,t.floatoutput=function(e){return a.__(0,[h.protoFloat,a.__(0,[[5,3,e]])])},t.floatarg=function(e){return a.__(0,[h.protoFloat,a.__(0,[[6,3,e]])])},t.vec2fun=function(e){return a.__(0,[h.protoVec2,a.__(0,[[7,4,e]])])},t.vec2attr=function(e){return a.__(0,[h.protoVec2,a.__(0,[[1,4,e]])])},t.vec2varying=function(e){return a.__(0,[h.protoVec2,a.__(0,[[3,4,e]])])},t.vec2builtin=function(e){return a.__(0,[h.protoVec2,a.__(0,[[0,4,e]])])},t.vec2uniform=function(e){return a.__(0,[h.protoVec2,a.__(0,[[2,4,e]])])},t.vec2var=function(e){return a.__(0,[h.protoVec2,a.__(0,[[4,4,e]])])},t.vec2output=function(e){return a.__(0,[h.protoVec2,a.__(0,[[5,4,e]])])},t.vec2arg=function(e){return a.__(0,[h.protoVec2,a.__(0,[[6,4,e]])])},t.vec3fun=function(e){return a.__(0,[h.protoVec3,a.__(0,[[7,5,e]])])},t.vec3attr=function(e){return a.__(0,[h.protoVec3,a.__(0,[[1,5,e]])])},t.vec3varying=function(e){return a.__(0,[h.protoVec3,a.__(0,[[3,5,e]])])},t.vec3builtin=function(e){return a.__(0,[h.protoVec3,a.__(0,[[0,5,e]])])},t.vec3uniform=function(e){return a.__(0,[h.protoVec3,a.__(0,[[2,5,e]])])},t.vec3var=te,t.vec3output=function(e){return a.__(0,[h.protoVec3,a.__(0,[[5,5,e]])])},t.vec3arg=function(e){return a.__(0,[h.protoVec3,a.__(0,[[6,5,e]])])},t.vec4fun=function(e){return a.__(0,[h.protoVec4,a.__(0,[[7,6,e]])])},t.vec4attr=re,t.vec4varying=function(e){return a.__(0,[h.protoVec4,a.__(0,[[3,6,e]])])},t.vec4builtin=function(e){return a.__(0,[h.protoVec4,a.__(0,[[0,6,e]])])},t.vec4uniform=function(e){return a.__(0,[h.protoVec4,a.__(0,[[2,6,e]])])},t.vec4var=function(e){return a.__(0,[h.protoVec4,a.__(0,[[4,6,e]])])},t.vec4output=function(e){return a.__(0,[h.protoVec4,a.__(0,[[5,6,e]])])},t.vec4arg=function(e){return a.__(0,[h.protoVec4,a.__(0,[[6,6,e]])])},t.mat2fun=function(e){return a.__(0,[h.protoMat2,a.__(0,[[7,7,e]])])},t.mat2attr=function(e){return a.__(0,[h.protoMat2,a.__(0,[[1,7,e]])])},t.mat2varying=function(e){return a.__(0,[h.protoMat2,a.__(0,[[3,7,e]])])},t.mat2builtin=function(e){return a.__(0,[h.protoMat2,a.__(0,[[0,7,e]])])},t.mat2uniform=function(e){return a.__(0,[h.protoMat2,a.__(0,[[2,7,e]])])},t.mat2var=function(e){return a.__(0,[h.protoMat2,a.__(0,[[4,7,e]])])},t.mat2output=function(e){return a.__(0,[h.protoMat2,a.__(0,[[5,7,e]])])},t.mat2arg=function(e){return a.__(0,[h.protoMat2,a.__(0,[[6,7,e]])])},t.mat3fun=function(e){return a.__(0,[h.protoMat3,a.__(0,[[7,8,e]])])},t.mat3attr=function(e){return a.__(0,[h.protoMat3,a.__(0,[[1,8,e]])])},t.mat3varying=function(e){return a.__(0,[h.protoMat3,a.__(0,[[3,8,e]])])},t.mat3builtin=function(e){return a.__(0,[h.protoMat3,a.__(0,[[0,8,e]])])},t.mat3uniform=function(e){return a.__(0,[h.protoMat3,a.__(0,[[2,8,e]])])},t.mat3var=function(e){return a.__(0,[h.protoMat3,a.__(0,[[4,8,e]])])},t.mat3output=function(e){return a.__(0,[h.protoMat3,a.__(0,[[5,8,e]])])},t.mat3arg=function(e){return a.__(0,[h.protoMat3,a.__(0,[[6,8,e]])])};t.mat4fun=function(e){return a.__(0,[h.protoMat4,a.__(0,[[7,9,e]])])},t.mat4attr=function(e){return a.__(0,[h.protoMat4,a.__(0,[[1,9,e]])])},t.mat4varying=function(e){return a.__(0,[h.protoMat4,a.__(0,[[3,9,e]])])},t.mat4builtin=function(e){return a.__(0,[h.protoMat4,a.__(0,[[0,9,e]])])},t.mat4uniform=function(e){return a.__(0,[h.protoMat4,a.__(0,[[2,9,e]])])},t.mat4var=function(e){return a.__(0,[h.protoMat4,a.__(0,[[4,9,e]])])},t.mat4output=function(e){return a.__(0,[h.protoMat4,a.__(0,[[5,9,e]])])},t.mat4arg=function(e){return a.__(0,[h.protoMat4,a.__(0,[[6,9,e]])])},t.intattr=function(e){return a.__(0,[946268058,a.__(0,[[1,2,e]])])},t.intbuiltin=function(e){return a.__(0,[3654863,a.__(0,[[0,1,e]])])},t.int2float=function(e){return a.__(0,[h.protoScalar,a.__(25,["float",S(e)])])},t.sampler2Duniform=function(e){return a.__(0,[-10607942,a.__(0,[[2,10,e]])])},t.samplerCubeUniform=function(e){return a.__(0,[949611005,a.__(0,[[2,11,e]])])},t.gl_Vertex=ne,t.gl_VertexId=ae,t.gl_VertexIdFloat=se,t.gl_Position=ce,t.gl_FragCoord=fe,t.outColor=he,t.gl_FragColor=Qh,t.u_time=me,t.a_uv=ve,t.a_IndexId=ye,t.v_uv=xe,t.u_modelMatrix=$e,t.u_modelViewMatrix=Me,t.u_projectionMatrix=Se,t.arStack=Ae,t.ar=ze,t.vars=Re,t.add=Ce,t.start=Le,t.finish=function(){return i.rev(ze[0])},t.push=Pe,t.pop=Ue,t.hasVar=Ie,t.addVar=Oe,t.body=function(e){return Le(),o._1(e,0),i.rev(ze[0])},t.g1=ed,t.g2=td,t.g2b=rd,t.glist=nd,t.$eq$at=Ne,t.$caret=function(e){return R(e,a.__(4,[S(e)]))},t.$neg$neg=function(e){return R(e,a.__(5,[S(e)]))},t.$plus$plus$plus=function(e){return R(e,a.__(6,[S(e)]))},t.$neg$neg$neg=function(e){return R(e,a.__(7,[S(e)]))},t.not=function(e){return R(e,a.__(8,[S(e)]))},t.$star=ke,t.$star$eq=function(e,t){return Ne(e,ke(e,t))},t.$slash=De,t.$slash$eq=function(e,t){return Ne(e,De(e,t))},t.$plus=Fe,t.$plus$eq=function(e,t){return Ne(e,Fe(e,t))},t.$neg=Be,t.$neg$eq=function(e,t){return Ne(e,Be(e,t))},t.$less=function(e,t){var r=S(e),n=S(t),i=a.__(13,[r,n]);return a.__(0,[A(e),i])},t.$great=function(e,t){var r=S(e),n=S(t),i=a.__(14,[r,n]);return a.__(0,[A(e),i])},t.$less$eq=function(e,t){var r=S(e),n=S(t),i=a.__(15,[r,n]);return a.__(0,[A(e),i])},t.$great$eq=function(e,t){var r=S(e),n=S(t),i=a.__(16,[r,n]);return a.__(0,[A(e),i])},t.$eq=function(e,t){var r=S(e),n=S(t),i=a.__(17,[r,n]);return a.__(0,[A(e),i])},t.$less$great=function(e,t){var r=S(e),n=S(t),i=a.__(18,[r,n]);return a.__(0,[A(e),i])},t.$unknown$unknown=function(e,t){var r=S(e),n=S(t),i=a.__(19,[r,n]);return a.__(0,[A(e),i])},t.$pipe$pipe=function(e,t){var r=S(e),n=S(t),i=a.__(20,[r,n]);return a.__(0,[A(e),i])},t.$caret$caret=function(e,t){var r=S(e),n=S(t),i=a.__(21,[r,n]);return a.__(0,[A(e),i])},t.$star$star$dot=function(e,t){var r=t[0],n=a.__(1,[S(e),t[1]]),i=a.__(0,[r,n]);return o._1(t[2],A(e)),i},t.ternary=function(e,t,r){return a.__(0,[A(t),a.__(22,[S(e),S(t),S(r)])])},t.max=function(e,t){var r=S(e),n=S(t),i=a.__(26,["max",r,n]);return a.__(0,[A(e),i])},t.min=function(e,t){var r=S(e),n=S(t),i=a.__(26,["min",r,n]);return a.__(0,[A(e),i])},t.fmod=function(e,t){return a.__(0,[A(e),a.__(26,["mod",S(e),S(t)])])},t.imod=function(e,t){return a.__(0,[A(e),a.__(26,["mod",S(e),S(t)])])},t.iminus=function(e,t){return a.__(0,[A(e),a.__(12,[S(e),S(t)])])},t.idiv=function(e,t){return a.__(0,[A(e),a.__(10,[S(e),S(t)])])},t.mix=function(e,t,r){var n=S(e),i=S(t),o=S(r),s=a.__(27,["mix",n,i,o]);return a.__(0,[A(e),s])},t.clamp=function(e,t,r){return a.__(0,[A(e),a.__(27,["clamp",S(e),S(t),S(r)])])},t.sqrt=function(e){return R(e,a.__(25,["sqrt",S(e)]))},t.sin=Ge,t.cos=function(e){return R(e,a.__(25,["cos",S(e)]))},t.abs=function(e){return R(e,a.__(25,["abs",S(e)]))},t.exp=function(e){return R(e,a.__(25,["exp",S(e)]))},t.dFdx=function(e){return R(e,a.__(25,["dFdx",S(e)]))},t.dFdy=function(e){return R(e,a.__(25,["dFdy",S(e)]))},t.length=function(e){var t=S(e),r=a.__(25,["length",t]);return a.__(0,[h.protoScalar,r])},t.normalize=function(e){return R(e,a.__(25,["normalize",S(e)]))},t.floor=function(e){return R(e,a.__(25,["floor",S(e)]))},t.fract=function(e){return R(e,a.__(25,["fract",S(e)]))},t.pow=function(e,t){var r=S(e),n=S(t),i=a.__(26,["pow",r,n]);return a.__(0,[A(e),i])},t.cross=function(e,t){var r=S(e),n=S(t),i=a.__(26,["cross",r,n]);return a.__(0,[A(e),i])},t.dot=function(e,t){var r=S(e),n=S(t),i=a.__(26,["dot",r,n]);return a.__(0,[c.scalar(0),i])},t.texture=function(e,t){return a.__(0,[h.protoVec4,a.__(26,["texture",S(e),S(t)])])},t.textureCube=function(e,t){return a.__(0,[h.protoVec4,a.__(26,["texture",S(e),S(t)])])},t.refract=function(e,t,r){var n=S(e),i=S(t),o=S(r),s=a.__(27,["refract",n,i,o]);return a.__(0,[A(e),s])},t.reflect=function(e,t){var r=S(e),n=S(t),i=a.__(26,["reflect",r,n]);return a.__(0,[A(e),i])},t.vec21f=Ve,t.vec22f=He,t.vec31f=function(e){return a.__(0,[h.protoVec3,a.__(24,["vec3",i.map(S,[e,0])])])},t.vec33f=je,t.$pipe$plus$pipe=function(e,t){return a.__(0,[c.$pipe$plus$pipe(A(e),A(t)),a.__(23,[S(e),S(t)])])},t.vec2=function(e){return a.__(0,[h.protoVec2,a.__(24,["vec2",i.map(S,[e,0])])])},t.vec3=function(e){return a.__(0,[h.protoVec3,a.__(24,["vec3",i.map(S,[e,0])])])},t.vec4=function(e){return a.__(0,[h.protoVec4,a.__(24,["vec4",i.map(S,[e,0])])])},t.vec41f=function(e){return a.__(0,[h.protoVec4,a.__(24,["vec4",i.map(S,[e,0])])])},t.vec44f=function(e,t,r,n){return a.__(0,[h.protoVec4,a.__(24,["vec4",i.map(S,[e,[t,[r,[n,0]]]])])])},t.forstmt=function(e,t,r,n){Pe(),o._1(e,0);var i=Ue();Pe(),o._1(r,0);var s=Ue();Pe(),o._1(n,0);var u=Ue();return Ce(a.__(3,[i,S(t),s,u]))},t.ifstmt=function(e,t){Pe(),o._1(t,0);var r=Ue();return Ce(a.__(4,[S(e),r]))},t.ifelsestmt=function(e,t,r){Pe(),o._1(t,0);var n=Ue();Pe(),o._1(r,0);var i=Ue();return Ce(a.__(5,[S(e),n,i]))},t.f=function(e){return a.__(0,[h.protoScalar,a.__(2,[e])])},t.i=function(e){return a.__(0,[3654863,a.__(3,[e])])},t.$$return=function(e){return Ce(a.__(6,[S(e)]))},t.returnVoid=function(){return Ce(0)},t.discard=function(){return Ce(1)},t.inline=function(e){return Ce(a.__(0,[e]))},t.floatif=function(e){return a.__(0,[h.protoScalar,a.__(2,[e])])},t.vec3i3f=function(e,t,r){return je(a.__(0,[h.protoScalar,a.__(2,[e])]),a.__(0,[h.protoScalar,a.__(2,[t])]),a.__(0,[h.protoScalar,a.__(2,[r])]))},t.floati1=function(e){var t=ee(Q());return Ne(t,e),t},t.vec3i1=function(e){var t=te(Q());return Ne(t,e),t},t.$$const=function(e){return e},t.nvec2init=We,t.i1=qe,t.i2=Ye,t.d=Ze,t.a=Ke,t.b=Qe,t.c=tt,t.tmp=rt},function(e,t,r){"use strict";var n=r(0),i=r(12),a=r(10),o=r(1);function s(e){for(var t=0,r=e;;){var n=r,i=t;if(!n)return i;r=n[1],t=i+1|0}}function u(e,t){for(;;){var r=t,n=e;if(!n)return r;t=[n[0],r],e=n[1]}}function c(e){return e?a.$at(e[0],c(e[1])):0}function l(e){return function(t){for(var r=0,i=t;;){var a=i,o=r;if(!a)return u(o,0);var s=a[1],c=a[0];n._1(e,c)?(i=s,r=[c,o]):i=s}}}function f(e,t){for(;;){var r=t,n=e;if(n){if(r){t=r[1],e=n-1|0;continue}throw[o.assert_failure,["list.ml",223,11]]}return r}}function p(e,t){var r=function(t,r){var a=0;if(2!==t)if(3!==t)a=1;else if(r){var o=r[1];if(o){var s=o[1];if(s){var c=s[0],l=o[0],p=r[0];return n._2(e,p,l)<=0?n._2(e,l,c)<=0?[p,[l,[c,0]]]:n._2(e,p,c)<=0?[p,[c,[l,0]]]:[c,[p,[l,0]]]:n._2(e,p,c)<=0?[l,[p,[c,0]]]:n._2(e,l,c)<=0?[l,[c,[p,0]]]:[c,[l,[p,0]]]}a=1}else a=1}else a=1;else if(r){var h=r[1];if(h){var d=h[0],m=r[0];return n._2(e,m,d)<=0?[m,[d,0]]:[d,[m,0]]}a=1}else a=1;if(1===a)for(var g=t>>1,v=t-g|0,_=f(g,r),y=i(g,r),b=i(v,_),x=0;;){var w=x,$=b,E=y;if(E){if($){var M=$[0],T=E[0];if(n._2(e,T,M)>0){x=[T,w],y=E[1];continue}x=[M,w],b=$[1];continue}return u(E,w)}return u($,w)}},i=function(t,i){var a=0;if(2!==t)if(3!==t)a=1;else if(i){var o=i[1];if(o){var s=o[1];if(s){var c=s[0],l=o[0],p=i[0];return n._2(e,p,l)>0?n._2(e,l,c)>0?[p,[l,[c,0]]]:n._2(e,p,c)>0?[p,[c,[l,0]]]:[c,[p,[l,0]]]:n._2(e,p,c)>0?[l,[p,[c,0]]]:n._2(e,l,c)>0?[l,[c,[p,0]]]:[c,[l,[p,0]]]}a=1}else a=1}else a=1;else if(i){var h=i[1];if(h){var d=h[0],m=i[0];return n._2(e,m,d)>0?[m,[d,0]]:[d,[m,0]]}a=1}else a=1;if(1===a)for(var g=t>>1,v=t-g|0,_=f(g,i),y=r(g,i),b=r(v,_),x=0;;){var w=x,$=b,E=y;if(E){if($){var M=$[0],T=E[0];if(n._2(e,T,M)<=0){x=[T,w],y=E[1];continue}x=[M,w],b=$[1];continue}return u(E,w)}return u($,w)}},a=s(t);return a<2?t:r(a,t)}var h=a.$at,d=c,m=l,g=p,v=p;t.length=s,t.hd=function(e){if(e)return e[0];throw[o.failure,"hd"]},t.tl=function(e){if(e)return e[1];throw[o.failure,"tl"]},t.nth=function(e,t){if(t<0)throw[o.invalid_argument,"List.nth"];for(var r=e,n=t;;){var i=r;if(i){if(n){n=n-1|0,r=i[1];continue}return i[0]}throw[o.failure,"nth"]}},t.rev=function(e){return u(e,0)},t.append=h,t.rev_append=u,t.concat=d,t.flatten=c,t.iter=function(e,t){for(;;){var r=t;if(!r)return 0;n._1(e,r[0]),t=r[1]}},t.iteri=function(e,t){for(var r=0,i=e,a=t;;){var o=a,s=r;if(!o)return 0;n._2(i,s,o[0]),a=o[1],r=s+1|0}},t.map=function e(t,r){return r?[n._1(t,r[0]),e(t,r[1])]:0},t.mapi=function(e,t){return function e(t,r,i){return i?[n._2(r,t,i[0]),e(t+1|0,r,i[1])]:0}(0,e,t)},t.rev_map=function(e,t){for(var r=0,i=t;;){var a=i,o=r;if(!a)return o;i=a[1],r=[n._1(e,a[0]),o]}},t.fold_left=function(e,t,r){for(;;){var i=r,a=t;if(!i)return a;r=i[1],t=n._2(e,a,i[0])}},t.fold_right=function e(t,r,i){return r?n._2(t,r[0],e(t,r[1],i)):i},t.iter2=function(e,t,r){for(;;){var i=r,a=t;if(a){if(i){n._2(e,a[0],i[0]),r=i[1],t=a[1];continue}throw[o.invalid_argument,"List.iter2"]}if(i)throw[o.invalid_argument,"List.iter2"];return 0}},t.map2=function e(t,r,i){if(r){if(i)return[n._2(t,r[0],i[0]),e(t,r[1],i[1])];throw[o.invalid_argument,"List.map2"]}if(i)throw[o.invalid_argument,"List.map2"];return 0},t.rev_map2=function(e,t,r){for(var i=0,a=t,s=r;;){var u=s,c=a,l=i;if(c){if(u){s=u[1],a=c[1],i=[n._2(e,c[0],u[0]),l];continue}throw[o.invalid_argument,"List.rev_map2"]}if(u)throw[o.invalid_argument,"List.rev_map2"];return l}},t.fold_left2=function(e,t,r,i){for(;;){var a=i,s=r,u=t;if(s){if(a){i=a[1],r=s[1],t=n._3(e,u,s[0],a[0]);continue}throw[o.invalid_argument,"List.fold_left2"]}if(a)throw[o.invalid_argument,"List.fold_left2"];return u}},t.fold_right2=function e(t,r,i,a){if(r){if(i)return n._3(t,r[0],i[0],e(t,r[1],i[1],a));throw[o.invalid_argument,"List.fold_right2"]}if(i)throw[o.invalid_argument,"List.fold_right2"];return a},t.for_all=function(e,t){for(;;){var r=t;if(r){if(n._1(e,r[0])){t=r[1];continue}return 0}return 1}},t.exists=function(e,t){for(;;){var r=t;if(!r)return 0;if(n._1(e,r[0]))return 1;t=r[1]}},t.for_all2=function(e,t,r){for(;;){var i=r,a=t;if(a){if(i){if(n._2(e,a[0],i[0])){r=i[1],t=a[1];continue}return 0}throw[o.invalid_argument,"List.for_all2"]}if(i)throw[o.invalid_argument,"List.for_all2"];return 1}},t.exists2=function(e,t,r){for(;;){var i=r,a=t;if(a){if(i){if(n._2(e,a[0],i[0]))return 1;r=i[1],t=a[1];continue}throw[o.invalid_argument,"List.exists2"]}if(i)throw[o.invalid_argument,"List.exists2"];return 0}},t.mem=function(e,t){for(;;){var r=t;if(r){if(i.caml_compare(r[0],e)){t=r[1];continue}return 1}return 0}},t.memq=function(e,t){for(;;){var r=t;if(!r)return 0;if(r[0]===e)return 1;t=r[1]}},t.find=function(e,t){for(;;){var r=t;if(!r)throw o.not_found;var i=r[0];if(n._1(e,i))return i;t=r[1]}},t.filter=m,t.find_all=l,t.partition=function(e,t){for(var r=0,i=0,a=t;;){var o=a,s=i,c=r;if(!o)return[u(c,0),u(s,0)];var l=o[1],f=o[0];n._1(e,f)?(a=l,r=[f,c]):(a=l,i=[f,s])}},t.assoc=function(e,t){for(;;){var r=t;if(r){var n=r[0];if(i.caml_compare(n[0],e)){t=r[1];continue}return n[1]}throw o.not_found}},t.assq=function(e,t){for(;;){var r=t;if(!r)throw o.not_found;var n=r[0];if(n[0]===e)return n[1];t=r[1]}},t.mem_assoc=function(e,t){for(;;){var r=t;if(r){if(i.caml_compare(r[0][0],e)){t=r[1];continue}return 1}return 0}},t.mem_assq=function(e,t){for(;;){var r=t;if(!r)return 0;if(r[0][0]===e)return 1;t=r[1]}},t.remove_assoc=function e(t,r){if(r){var n=r[1],a=r[0];return i.caml_compare(a[0],t)?[a,e(t,n)]:n}return 0},t.remove_assq=function e(t,r){if(r){var n=r[1],i=r[0];return i[0]===t?n:[i,e(t,n)]}return 0},t.split=function e(t){if(t){var r=t[0],n=e(t[1]);return[[r[0],n[0]],[r[1],n[1]]]}return[0,0]},t.combine=function e(t,r){if(t){if(r)return[[t[0],r[0]],e(t[1],r[1])];throw[o.invalid_argument,"List.combine"]}if(r)throw[o.invalid_argument,"List.combine"];return 0},t.sort=g,t.stable_sort=p,t.fast_sort=v,t.sort_uniq=function(e,t){var r=function(t,r){var a=0;if(2!==t)if(3!==t)a=1;else if(r){var o=r[1];if(o){var s=o[1];if(s){var c=s[0],l=o[0],p=r[0],h=n._2(e,p,l);if(h){if(h<0){var d=n._2(e,l,c);if(d){if(d<0)return[p,[l,[c,0]]];var m=n._2(e,p,c);return m?m<0?[p,[c,[l,0]]]:[c,[p,[l,0]]]:[p,[l,0]]}return[p,[l,0]]}var g=n._2(e,p,c);if(g){if(g<0)return[l,[p,[c,0]]];var v=n._2(e,l,c);return v?v<0?[l,[c,[p,0]]]:[c,[l,[p,0]]]:[l,[p,0]]}return[l,[p,0]]}var _=n._2(e,l,c);return _?_<0?[l,[c,0]]:[c,[l,0]]:[l,0]}a=1}else a=1}else a=1;else if(r){var y=r[1];if(y){var b=y[0],x=r[0],w=n._2(e,x,b);return w?w<0?[x,[b,0]]:[b,[x,0]]:[x,0]}a=1}else a=1;if(1===a)for(var $=t>>1,E=t-$|0,M=f($,r),T=i($,r),S=i(E,M),A=0;;){var z=A,R=S,C=T;if(C){if(R){var L=R[1],P=R[0],U=C[1],I=C[0],O=n._2(e,I,P);if(O){if(O>0){A=[I,z],T=U;continue}A=[P,z],S=L;continue}A=[I,z],S=L,T=U;continue}return u(C,z)}return u(R,z)}},i=function(t,i){var a=0;if(2!==t)if(3!==t)a=1;else if(i){var o=i[1];if(o){var s=o[1];if(s){var c=s[0],l=o[0],p=i[0],h=n._2(e,p,l);if(h){if(h>0){var d=n._2(e,l,c);if(d){if(d>0)return[p,[l,[c,0]]];var m=n._2(e,p,c);return m?m>0?[p,[c,[l,0]]]:[c,[p,[l,0]]]:[p,[l,0]]}return[p,[l,0]]}var g=n._2(e,p,c);if(g){if(g>0)return[l,[p,[c,0]]];var v=n._2(e,l,c);return v?v>0?[l,[c,[p,0]]]:[c,[l,[p,0]]]:[l,[p,0]]}return[l,[p,0]]}var _=n._2(e,l,c);return _?_>0?[l,[c,0]]:[c,[l,0]]:[l,0]}a=1}else a=1}else a=1;else if(i){var y=i[1];if(y){var b=y[0],x=i[0],w=n._2(e,x,b);return w?w>0?[x,[b,0]]:[b,[x,0]]:[x,0]}a=1}else a=1;if(1===a)for(var $=t>>1,E=t-$|0,M=f($,i),T=r($,i),S=r(E,M),A=0;;){var z=A,R=S,C=T;if(C){if(R){var L=R[1],P=R[0],U=C[1],I=C[0],O=n._2(e,I,P);if(O){if(O<0){A=[I,z],T=U;continue}A=[P,z],S=L;continue}A=[I,z],S=L,T=U;continue}return u(C,z)}return u(R,z)}},a=s(t);return a<2?t:r(a,t)},t.merge=function e(t,r,i){if(r){if(i){var a=i[0],o=r[0];return n._2(t,o,a)<=0?[o,e(t,r[1],i)]:[a,e(t,r,i[1])]}return r}return i}},function(e,t,r){"use strict";function n(e,t){return e<t?-1:e===t?0:1}var i=n,a=n;t.caml_int_compare=n,t.caml_float_compare=function(e,t){return e===t?0:e<t?-1:e>t||e==e?1:t==t?-1:0},t.caml_nativeint_compare=i,t.caml_string_compare=function(e,t){return e===t?0:e<t?-1:1},t.caml_int32_compare=a,t.caml_int_min=function(e,t){return e<t?e:t},t.caml_float_min=function(e,t){return e<t?e:t},t.caml_string_min=function(e,t){return e<t?e:t},t.caml_nativeint_min=function(e,t){return e<t?e:t},t.caml_int32_min=function(e,t){return e<t?e:t},t.caml_int_max=function(e,t){return e>t?e:t},t.caml_float_max=function(e,t){return e>t?e:t},t.caml_string_max=function(e,t){return e>t?e:t},t.caml_nativeint_max=function(e,t){return e>t?e:t},t.caml_int32_max=function(e,t){return e>t?e:t}},function(e,t,r){"use strict";t.__=function(e,t){return t.tag=e,t}},function(e,t,r){"use strict";var n=r(1);function i(e){return(255&e)<<24|(65280&e)<<8|(16711680&e)>>>8|(4278190080&e)>>>24}var a=Math.imul||function(e,t){return((e>>16)*(t|=0)<<16)+(65535&e)*t|0},o=i;t.div=function(e,t){if(0===t)throw n.division_by_zero;return e/t|0},t.mod_=function(e,t){if(0===t)throw n.division_by_zero;return e%t},t.caml_bswap16=function(e){return(255&e)<<8|(65280&e)>>>8},t.caml_int32_bswap=i,t.caml_nativeint_bswap=o,t.imul=a},function(e,t,r){"use strict";var n=r(1);function i(e,t,r,n,i){if(i>0){if(e===r){var a=e,o=t,s=n,u=i;if(o<s){for(var c=(a.length-s|0)-1|0,l=u-1|0,f=c>l?l:c;f>=0;--f)a[s+f|0]=a[o+f|0];return 0}if(o>s){for(var p=(a.length-o|0)-1|0,h=u-1|0,d=p>h?h:p,m=0;m<=d;++m)a[s+m|0]=a[o+m|0];return 0}return 0}var g=e.length-t|0;if(i<=g){for(var v=0,_=i-1|0;v<=_;++v)r[n+v|0]=e[t+v|0];return 0}for(var y=0,b=g-1|0;y<=b;++y)r[n+y|0]=e[t+y|0];for(var x=g,w=i-1|0;x<=w;++x)r[n+x|0]=0;return 0}return 0}function a(e){var t=e,r=e.length,n="",a=r;if(r<=4096&&r===t.length)return String.fromCharCode.apply(null,t);for(var o=0;a>0;){var s=a<1024?a:1024,u=new Array(s);i(t,o,u,0,s),n+=String.fromCharCode.apply(null,u),a=a-s|0,o=o+s|0}return n}t.bytes_of_string=function(e){for(var t=e.length,r=new Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e.charCodeAt(n);return r},t.bytes_to_string=a,t.caml_is_printable=function(e){return e>31?+(e<127):0},t.caml_string_of_char_array=function(e){for(var t=e.length,r=new Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e[n];return a(r)},t.caml_string_get=function(e,t){if(t>=e.length||t<0)throw[n.invalid_argument,"index out of bounds"];return e.charCodeAt(t)},t.caml_create_string=function(e){if(e<0)throw[n.invalid_argument,"String.create"];return new Array(e)},t.caml_fill_string=function(e,t,r,n){if(r>0){for(var i=t,a=(r+t|0)-1|0;i<=a;++i)e[i]=n;return 0}return 0},t.caml_blit_string=function(e,t,r,n,i){if(i>0){var a=e.length-t|0;if(i<=a){for(var o=0,s=i-1|0;o<=s;++o)r[n+o|0]=e.charCodeAt(t+o|0);return 0}for(var u=0,c=a-1|0;u<=c;++u)r[n+u|0]=e.charCodeAt(t+u|0);for(var l=a,f=i-1|0;l<=f;++l)r[n+l|0]=0;return 0}return 0},t.caml_blit_bytes=i,t.caml_string_get16=function(e,t){return e.charCodeAt(t)+(e.charCodeAt(t+1|0)<<8)|0},t.caml_string_get32=function(e,t){return((e.charCodeAt(t)+(e.charCodeAt(t+1|0)<<8)|0)+(e.charCodeAt(t+2|0)<<16)|0)+(e.charCodeAt(t+3|0)<<24)|0},t.string_of_char=function(e){return String.fromCharCode(e)},t.get=function(e,t){if(t<0||t>=e.length)throw[n.invalid_argument,"index out of bounds"];return e.charCodeAt(t)}},function(e,t,r){"use strict";var n=r(0),i=r(23),a=r(47),o=r(24),s=r(9),u=r(2),c=r(25),l=r(1),f=r(32);var p=u.create("Pervasives.Exit");function h(e){for(var t=e.length,r=0;;){var n=r;if(n>=t)return e+".";var i=s.get(e,n);if(i>=48){if(i>=58)return e;r=n+1|0}else{if(45!==i)return e;r=n+1|0}}}var d=i.stdin,m=i.stdout,g=i.stderr;function v(e,t,r){return i.caml_ml_open_descriptor_out(c.not_implemented("caml_sys_open not implemented by bucklescript yet\n"))}function _(){for(var e=i.caml_ml_out_channels_list(0);;){var t=e;if(!t)return 0;try{i.caml_ml_flush(t[0])}catch(e){}e=t[1]}}function y(e,t){return i.caml_ml_output(e,t,0,t.length)}function b(e,t){return i.caml_ml_output(e,t,0,t.length)}function x(e,t,r){return i.caml_ml_open_descriptor_in(c.not_implemented("caml_sys_open not implemented by bucklescript yet\n"))}function w(e,t,r,n){for(;;){var i=n,a=r;if(i<=0)return 0;var o=c.not_implemented("caml_ml_input not implemented by bucklescript yet\n");if(!o)throw l.end_of_file;n=i-o|0,r=a+o|0}}function $(e,t,r,n){if(r<0||n<0||r>(t.length-n|0))throw[l.invalid_argument,"really_input"];return w(0,0,r,n)}function E(e){var t=function(e,t,r){for(;;){var n=r,i=t;if(!n)return e;var a=n[0],o=a.length;s.caml_blit_bytes(a,0,e,i-o|0,o),r=n[1],t=i-o|0}};return s.bytes_to_string(function(r,n){for(;;){var a=n,o=r,u=c.not_implemented("caml_ml_input_scan_line not implemented by bucklescript yet\n");if(!u){if(o)return t(s.caml_create_string(a),a,o);throw l.end_of_file}if(u>0){var f=s.caml_create_string(u-1|0);if(c.not_implemented("caml_ml_input not implemented by bucklescript yet\n"),i.caml_ml_input_char(e),o){var p=(a+u|0)-1|0;return t(s.caml_create_string(p),p,[f,o])}return f}var h=s.caml_create_string(0|-u);c.not_implemented("caml_ml_input not implemented by bucklescript yet\n"),n=a-u|0,r=[h,o]}}(0,0))}var M=[_];function T(){return n._1(M[0],0)}var S=Number.MAX_VALUE,A=Number.MIN_VALUE,z=i.caml_ml_flush,R=i.caml_ml_output_char,C=i.caml_ml_output_char;var L=i.caml_ml_input_char,P=i.caml_ml_input_char;var U=[function(e,t){return c.not_implemented("caml_ml_seek_out_64 not implemented by bucklescript yet\n")},function(){return c.not_implemented("caml_ml_pos_out_64 not implemented by bucklescript yet\n")},function(){return c.not_implemented("caml_ml_channel_size_64 not implemented by bucklescript yet\n")},function(e,t){return c.not_implemented("caml_ml_seek_in_64 not implemented by bucklescript yet\n")},function(){return c.not_implemented("caml_ml_pos_in_64 not implemented by bucklescript yet\n")},function(){return c.not_implemented("caml_ml_channel_size_64 not implemented by bucklescript yet\n")}];t.invalid_arg=function(e){throw[l.invalid_argument,e]},t.failwith=function(e){throw[l.failure,e]},t.Exit=p,t.abs=function(e){return e>=0?e:0|-e},t.max_int=2147483647,t.min_int=-2147483648,t.lnot=function(e){return-1^e},t.infinity=1/0,t.neg_infinity=-1/0,t.nan=NaN,t.max_float=S,t.min_float=A,t.epsilon_float=2.220446049250313e-16,t.char_of_int=function(e){if(e<0||e>255)throw[l.invalid_argument,"char_of_int"];return e},t.string_of_bool=function(e){return e?"true":"false"},t.bool_of_string=function(e){switch(e){case"false":return 0;case"true":return 1;default:throw[l.invalid_argument,"bool_of_string"]}},t.string_of_int=function(e){return""+e},t.string_of_float=function(e){return h(o.caml_format_float("%.12g",e))},t.$at=function e(t,r){return t?[t[0],e(t[1],r)]:r},t.stdin=d,t.stdout=m,t.stderr=g,t.print_char=function(e){return i.caml_ml_output_char(m,e)},t.print_string=function(e){return b(m,e)},t.print_bytes=function(e){return y(m,e)},t.print_int=function(e){return b(m,""+e)},t.print_float=function(e){return b(m,h(o.caml_format_float("%.12g",e)))},t.print_endline=function(e){return console.log(e),0},t.print_newline=function(){return i.caml_ml_output_char(m,10),i.caml_ml_flush(m)},t.prerr_char=function(e){return i.caml_ml_output_char(g,e)},t.prerr_string=function(e){return b(g,e)},t.prerr_bytes=function(e){return y(g,e)},t.prerr_int=function(e){return b(g,""+e)},t.prerr_float=function(e){return b(g,h(o.caml_format_float("%.12g",e)))},t.prerr_endline=function(e){return console.error(e),0},t.prerr_newline=function(){return i.caml_ml_output_char(g,10),i.caml_ml_flush(g)},t.read_line=function(){return i.caml_ml_flush(m),E(d)},t.read_int=function(){return o.caml_int_of_string((i.caml_ml_flush(m),E(d)))},t.read_float=function(){return o.caml_float_of_string((i.caml_ml_flush(m),E(d)))},t.open_out=function(e){return v()},t.open_out_bin=function(e){return v()},t.open_out_gen=v,t.flush=z,t.flush_all=_,t.output_char=R,t.output_string=b,t.output_bytes=y,t.output=function(e,t,r,n){if(r<0||n<0||r>(t.length-n|0))throw[l.invalid_argument,"output"];return i.caml_ml_output(e,t,r,n)},t.output_substring=function(e,t,r,n){if(r<0||n<0||r>(t.length-n|0))throw[l.invalid_argument,"output_substring"];return i.caml_ml_output(e,t,r,n)},t.output_byte=C,t.output_binary_int=function(e,t){return c.not_implemented("caml_ml_output_int not implemented by bucklescript yet\n")},t.output_value=function(e,t){return c.not_implemented("caml_output_value not implemented by bucklescript yet\n")},t.seek_out=function(e,t){return c.not_implemented("caml_ml_seek_out not implemented by bucklescript yet\n")},t.pos_out=function(){return c.not_implemented("caml_ml_pos_out not implemented by bucklescript yet\n")},t.out_channel_length=function(){return c.not_implemented("caml_ml_channel_size not implemented by bucklescript yet\n")},t.close_out=function(e){return i.caml_ml_flush(e),c.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")},t.close_out_noerr=function(e){try{i.caml_ml_flush(e)}catch(e){}try{return c.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")}catch(e){return 0}},t.set_binary_mode_out=function(e,t){return c.not_implemented("caml_ml_set_binary_mode not implemented by bucklescript yet\n")},t.open_in=function(e){return x()},t.open_in_bin=function(e){return x()},t.open_in_gen=x,t.input_char=L,t.input_line=E,t.input=function(e,t,r,n){if(r<0||n<0||r>(t.length-n|0))throw[l.invalid_argument,"input"];return c.not_implemented("caml_ml_input not implemented by bucklescript yet\n")},t.really_input=$,t.really_input_string=function(e,t){var r=s.caml_create_string(t);return $(0,r,0,t),s.bytes_to_string(r)},t.input_byte=P,t.input_binary_int=function(){return c.not_implemented("caml_ml_input_int not implemented by bucklescript yet\n")},t.input_value=function(){return c.not_implemented("caml_input_value not implemented by bucklescript yet\n")},t.seek_in=function(e,t){return c.not_implemented("caml_ml_seek_in not implemented by bucklescript yet\n")},t.pos_in=function(){return c.not_implemented("caml_ml_pos_in not implemented by bucklescript yet\n")},t.in_channel_length=function(){return c.not_implemented("caml_ml_channel_size not implemented by bucklescript yet\n")},t.close_in=function(){return c.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")},t.close_in_noerr=function(){try{return c.not_implemented("caml_ml_close_channel not implemented by bucklescript yet\n")}catch(e){return 0}},t.set_binary_mode_in=function(e,t){return c.not_implemented("caml_ml_set_binary_mode not implemented by bucklescript yet\n")},t.LargeFile=U,t.string_of_format=function(e){return e[1]},t.$caret$caret=function(e,t){return[f.concat_fmt(e[0],t[0]),e[1]+"%,"+t[1]]},t.exit=function(e){return T(),a.caml_sys_exit(e)},t.at_exit=function(e){var t=M[0];return M[0]=function(){return n._1(e,0),n._1(t,0)},0},t.valid_float_lexem=h,t.unsafe_really_input=w,t.do_at_exit=T},function(e,t,r){"use strict";var n=r(1);t.caml_array_sub=function(e,t,r){for(var n=new Array(r),i=0,a=t;i<r;)n[i]=e[a],i=i+1|0,a=a+1|0;return n},t.caml_array_concat=function(e){var t=function(e,t){for(;;){var r=t,n=e;if(!r)return n;t=r[1],e=r[0].length+n|0}}(0,e),r=new Array(t);return function(e,t,r){for(;;){var n=r,i=t;if(!n)return 0;for(var a=n[0],o=a.length,s=i,u=0;u<o;)e[s]=a[u],s=s+1|0,u=u+1|0;r=n[1],t=s}}(r,0,e),r},t.caml_make_vect=function(e,t){for(var r=new Array(e),n=0,i=e-1|0;n<=i;++n)r[n]=t;return r},t.caml_array_blit=function(e,t,r,n,i){if(n<=t){for(var a=0,o=i-1|0;a<=o;++a)r[a+n|0]=e[a+t|0];return 0}for(var s=i-1|0;s>=0;--s)r[s+n|0]=e[s+t|0];return 0},t.caml_array_get=function(e,t){if(t<0||t>=e.length)throw[n.invalid_argument,"index out of bounds"];return e[t]},t.caml_array_set=function(e,t,r){if(t<0||t>=e.length)throw[n.invalid_argument,"index out of bounds"];return e[t]=r,0}},function(e,t,r){"use strict";var n=r(7),i=r(6),a=r(1);function o(e,t){for(;;){var r=t,n=e;if(n===r)return 0;var s=typeof n,u=typeof r;if("string"===s)return i.caml_string_compare(n,r);var c=+("number"===u);if(0!==+("number"===s))return 0!==c?i.caml_int_compare(n,r):-1;if(0!==c)return 1;if("boolean"===s||"undefined"===s||null===n){return n===r?0:n<r?-1:1}if("function"===s||"function"===u)throw[a.invalid_argument,"compare: functional value"];var l=0|n.tag,f=0|r.tag;if(250!==l)if(250!==f){if(248===l)return i.caml_int_compare(n[1],r[1]);if(251===l)throw[a.invalid_argument,"equal: abstract value"];if(l!==f)return l<f?-1:1;var p=0|n.length,h=0|r.length;if(p===h)for(var d=n,m=r,g=0,v=p;;){var _=g;if(_===v)return 0;var y=o(d[_],m[_]);if(0!==y)return y;g=_+1|0}else if(p<h)for(var b=n,x=r,w=0,$=p;;){var E=w;if(E===$)return-1;var M=o(b[E],x[E]);if(0!==M)return M;w=E+1|0}else for(var T=n,S=r,A=0,z=h;;){var R=A;if(R===z)return 1;var C=o(T[R],S[R]);if(0!==C)return C;A=R+1|0}}else t=r[0];else e=n[0]}}function s(e,t){for(;;){var r=t,n=e;if(n===r)return 1;var i=typeof n;if("string"===i||"number"===i||"boolean"===i||"undefined"===i||null===n)return 0;var o=typeof r;if("function"===i||"function"===o)throw[a.invalid_argument,"equal: functional value"];if("number"===o||"undefined"===o||null===r)return 0;var u=0|n.tag,c=0|r.tag;if(250!==u)if(250!==c){if(248===u)return+(n[1]===r[1]);if(251===u)throw[a.invalid_argument,"equal: abstract value"];if(u!==c)return 0;var l=0|n.length;if(l!==(0|r.length))return 0;for(var f=n,p=r,h=0,d=l;;){var m=h;if(m===d)return 1;if(!s(f[m],p[m]))return 0;h=m+1|0}}else t=r[0];else e=n[0]}}t.caml_obj_block=function(e,t){var r=new Array(t);return r.tag=e,r},t.caml_obj_dup=function(e){for(var t=0|e.length,r=new Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e[n];return r.tag=0|e.tag,r},t.caml_obj_truncate=function(e,t){var r=0|e.length;if(t<=0||t>r)throw[a.invalid_argument,"Obj.truncate"];if(r!==t){for(var n=t,i=r-1|0;n<=i;++n)e[n]=0;return e.length=t,0}return 0},t.caml_lazy_make_forward=function(e){return n.__(250,[e])},t.caml_update_dummy=function(e,t){for(var r=0,n=(0|t.length)-1|0;r<=n;++r)e[r]=t[r];var i=0|t.tag;return 0!==i?(e.tag=i,0):0},t.caml_compare=o,t.caml_equal=s,t.caml_equal_null=function(e,t){return null!==t?s(e,t):+(e===t)},t.caml_equal_undefined=function(e,t){return void 0!==t?s(e,t):+(e===t)},t.caml_equal_nullable=function(e,t){return null==t?+(e===t):s(e,t)},t.caml_notequal=function(e,t){return 1-s(e,t)},t.caml_greaterequal=function(e,t){return+(o(e,t)>=0)},t.caml_greaterthan=function(e,t){return+(o(e,t)>0)},t.caml_lessthan=function(e,t){return+(o(e,t)<0)},t.caml_lessequal=function(e,t){return+(o(e,t)<=0)},t.caml_min=function(e,t){return o(e,t)<=0?e:t},t.caml_max=function(e,t){return o(e,t)>=0?e:t}},function(e,t,r){"use strict";var n=r(5),i=r(21),a=r(7),o=r(0),s=r(4),u=r(2),c=r(39),l=r(1),f=u.create("GLSLUniforms-Rts.NotImplementedException");function p(e,t){var r=e.TEXTURE_2D;e.bindTexture(r,t),e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(r,e.TEXTURE_MAG_FILTER,e.NEAREST);var n=e.RGBA,i=e.RGBA,a=e.UNSIGNED_BYTE,o=new Uint8Array([255,0,0,255]);return e.texImage2D(r,0,n,1,1,0,i,a,o),0}function h(e,t,r){var n=e.TEXTURE_2D;e.bindTexture(n,t),e.texParameteri(n,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(n,e.TEXTURE_WRAP_T,e.REPEAT);var i=e.RGBA,a=e.RGBA,o=e.UNSIGNED_BYTE;return e.texImage2D(n,0,i,a,o,r),e.generateMipmap(n),e.texParameteri(n,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),0}t.NotImplementedException=f,t.registerUniform=function(e,t){return[s.untyped(e),a.__(0,[t])]},t.registerTextureUniform=function(e,t){var r,n=s.untyped(e);if(n.tag)throw[s.GLSLTypeError,"bad uniform"];return r=n[0][2],[n,a.__(1,[r,t])]},t.setupTexture=p,t.uploadImage=h,t.computeUniformBlock=function(e,t,r,a,u,c,p,h,d,m){var g=[e,t,0,r,a,c,p,h,u,d],v=n.fold_left(function(e,t){var r,n=t[1],a=t[0];if(a.tag)throw[s.GLSLTypeError,"not rvar"];return r=a[0][1],n.tag?e:i.concat([function(e){switch(r){case 2:throw[l.match_failure,["GLSLUniforms.re",204,10]];case 5:var t=e,n=t.length%4;if(n>3||n<0)throw[s.GLSLTypeError,"can't happen"];switch(n){case 0:return t;case 1:return i.concat([t,[[0,0,0],0]]);case 2:return i.concat([t,[[0,0],0]]);case 3:return i.concat([t,[[0],0]])}case 4:case 6:var a=e,o=a.length%2;if(0!==o){if(1!==o)throw[s.GLSLTypeError,"can't happen"];return i.concat([a,[[0],0]])}return a;case 0:case 1:case 3:case 7:case 8:case 9:case 10:case 11:return e}}(e),[o._1(n[0],g),0]])},[],m);return[function(t){return e.MY_VERSION<2?(n.iter(function(r){var n,a=r[1],u=r[0];if(u.tag)throw[s.GLSLTypeError,"not rvar"];var c=u[0];n=[c[1],c[2]];var l=e.getUniformLocation(t,n[1]);if(a.tag)return 0;var p=a[0];switch(n[0]){case 0:return 0;case 1:return e.uniform1iv(l,i.map(function(e){return 0|e},o._1(p,g))),0;case 3:return e.uniform1fv(l,o._1(p,g)),0;case 4:return e.uniform2fv(l,o._1(p,g)),0;case 5:return e.uniform3fv(l,o._1(p,g)),0;case 6:return e.uniform4fv(l,o._1(p,g)),0;case 9:return e.uniformMatrix4fv(l,0,o._1(p,g)),0;case 2:case 7:case 8:case 10:case 11:throw f}},m),0):0},new Float32Array(v),n.fold_right(function(e,t){var r=e[1];return r.tag?[[r[0],o._1(r[1],g)],t]:t},m,0)]},t.getNewTexture=function(e,t){var r=new Image,n=e.createTexture();return p(e,n),r.onload=function(){return h(e,n,r)},r.src=t,n},t.getNewRandomTexture=function(e,t){var r=e.createTexture();p(e,r);for(var n=e.TEXTURE_2D,i=2===e.MY_VERSION?e.RGBA32F:e.RGBA,a=e.RGBA,s=e.FLOAT,u=new Float32Array(262144),l=0;l<=262144;++l)u[l]=o._1(t,l);return e.texImage2D(n,0,i,256,256,0,a,s,c.from_opt([u])),r}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,r){"use strict";var n=r(5),i=r(20),a=r(8),o=r(9);function s(e){var t=e-9|0;return t>4||t<0?23!==t?0:1:2!==t?1:0}var u=r(6).caml_string_compare,c=i.fill,l=i.blit_string;t.make=function(e,t){return o.bytes_to_string(i.make(e,t))},t.init=function(e,t){return o.bytes_to_string(i.init(e,t))},t.copy=function(e){return o.bytes_to_string(i.copy(o.bytes_of_string(e)))},t.sub=function(e,t,r){return o.bytes_to_string(i.sub(o.bytes_of_string(e),t,r))},t.fill=c,t.blit=l,t.concat=function(e,t){if(t){var r=t[0],i=[0],s=[0];n.iter(function(e){return i[0]=i[0]+1|0,s[0]=s[0]+e.length|0,0},t);var u=o.caml_create_string(s[0]+a.imul(e.length,i[0]-1|0)|0);o.caml_blit_string(r,0,u,0,r.length);var c=[r.length];return n.iter(function(t){return o.caml_blit_string(e,0,u,c[0],e.length),c[0]=c[0]+e.length|0,o.caml_blit_string(t,0,u,c[0],t.length),c[0]=c[0]+t.length|0,0},t[1]),o.bytes_to_string(u)}return""},t.iter=function(e,t){return i.iter(e,o.bytes_of_string(t))},t.iteri=function(e,t){return i.iteri(e,o.bytes_of_string(t))},t.map=function(e,t){return o.bytes_to_string(i.map(e,o.bytes_of_string(t)))},t.mapi=function(e,t){return o.bytes_to_string(i.mapi(e,o.bytes_of_string(t)))},t.trim=function(e){return""===e||!s(e.charCodeAt(0))&&!s(e.charCodeAt(e.length-1|0))?e:o.bytes_to_string(i.trim(o.bytes_of_string(e)))},t.escaped=function(e){return function(t){for(;;){var r=t;if(r>=e.length)return 0;var n=e.charCodeAt(r);if(!(n>=32))return 1;var i=n-34|0;if(i>58||i<0){if(i>=93)return 1;t=r+1|0}else{if(i>57||i<1)return 1;t=r+1|0}}}(0)?o.bytes_to_string(i.escaped(o.bytes_of_string(e))):e},t.index=function(e,t){return i.index(o.bytes_of_string(e),t)},t.rindex=function(e,t){return i.rindex(o.bytes_of_string(e),t)},t.index_from=function(e,t,r){return i.index_from(o.bytes_of_string(e),t,r)},t.rindex_from=function(e,t,r){return i.rindex_from(o.bytes_of_string(e),t,r)},t.contains=function(e,t){return i.contains(o.bytes_of_string(e),t)},t.contains_from=function(e,t,r){return i.contains_from(o.bytes_of_string(e),t,r)},t.rcontains_from=function(e,t,r){return i.rcontains_from(o.bytes_of_string(e),t,r)},t.uppercase=function(e){return o.bytes_to_string(i.uppercase(o.bytes_of_string(e)))},t.lowercase=function(e){return o.bytes_to_string(i.lowercase(o.bytes_of_string(e)))},t.capitalize=function(e){return o.bytes_to_string(i.capitalize(o.bytes_of_string(e)))},t.uncapitalize=function(e){return o.bytes_to_string(i.uncapitalize(o.bytes_of_string(e)))},t.compare=u},function(e,t,r){"use strict";var n=r(4),i=r(38);var a=n.f(.1),o=n.$slash(a,i.maxHeight);function s(e){var t=n.f(1),r=n.fmod(e,t),i=n.floor(n.$slash(e,t));return n.vec22f(r,i)}t.sz=2,t.width=2,t.height=2,t.tiles=1,t.tileWidth=1,t.tileHeight=1,t.getWidth=function(){return 2},t.getHeight=function(){return 2},t.getTileWidth=function(){return 1},t.getTileHeight=function(){return 1},t.heightBaseMultiplier=a,t.heightMultiplier=o,t.getHMMul=function(){return n.vec22f(n.$slash(n.f(1),n.f(1)),n.$slash(n.f(1),n.f(1)))},t.getIXY=s,t.getTiledOffset=function(e){var t=n.f(1);return n.$plus(n.$star(n.$neg(s(e),n.$slash(t,n.f(2))),n.f(2)),n.f(1))}},function(e,t,r){"use strict";var n=r(4),i=n.vec3arg("x"),a=n.vec2arg("x"),o=n.vec3arg("x"),s=n.body(function(){return n.$$return(n.$neg(a,n.$star(n.floor(n.$star(a,n.$slash(n.f(1),n.f(289)))),n.f(289))))}),u=n.body(function(){return n.$$return(n.$neg(o,n.$star(n.floor(n.$star(o,n.$slash(n.f(1),n.f(289)))),n.f(289))))});function c(e){return n.fundecl1(n.vec2fun("mod289"),a,s,e)}function l(e){return n.fundecl1(n.vec3fun("mod289"),o,u,e)}var f=n.body(function(){return n.$$return(l(n.$star(n.$plus(n.$star(i,n.f(34)),n.f(1)),i)))});function p(e){return n.fundecl1(n.vec3fun("permute"),i,f,e)}var h=n.vec2arg("v"),d=n.body(function(){var e=n.vec4var("C");n.$eq$at(e,n.vec44f(n.f(.211324865405187),n.f(.366025403784439),n.f(-.577350269189626),n.f(.024390243902439)));var t=n.vec2var("i");n.$eq$at(t,n.floor(n.$plus(h,n.dot(h,n.$star$star$dot(e,n.yy$prime)))));var r=n.vec2var("x0");n.$eq$at(r,n.$plus(n.$neg(h,t),n.dot(t,n.$star$star$dot(e,n.xx$prime))));var i=n.vec2var("i1");n.$eq$at(i,n.ternary(n.$great(n.$star$star$dot(r,n.x$prime),n.$star$star$dot(r,n.y$prime)),n.vec22f(n.f(1),n.f(0)),n.vec22f(n.f(0),n.f(1))));var a=n.vec4var("x12");n.$eq$at(a,n.$plus(n.$star$star$dot(r,n.xyxy$prime),n.$star$star$dot(e,n.xxzz$prime))),n.$neg$eq(n.$star$star$dot(a,n.xy$prime),i),n.$eq$at(t,c(t));var o=n.vec3var("p");n.$eq$at(o,p(n.$plus(n.$plus(p(n.$plus(n.$star$star$dot(t,n.y$prime),n.vec33f(n.f(0),n.$star$star$dot(i,n.y$prime),n.f(1)))),n.$star$star$dot(t,n.x$prime)),n.vec33f(n.f(0),n.$star$star$dot(i,n.x$prime),n.f(1)))));var s=n.vec3var("m");n.$eq$at(s,n.max(n.$neg(n.f(.5),n.vec33f(n.dot(r,r),n.dot(n.$star$star$dot(a,n.xy$prime),n.$star$star$dot(a,n.xy$prime)),n.dot(n.$star$star$dot(a,n.zw$prime),n.$star$star$dot(a,n.zw$prime)))),n.vec31f(n.f(0)))),n.$eq$at(s,n.$star(s,s)),n.$eq$at(s,n.$star(s,s));var u=n.vec3var("x"),l=n.vec3var("h"),f=n.vec3var("ox"),d=n.vec3var("a0");n.$eq$at(u,n.$neg(n.$star(n.f(2),n.fract(n.$star(o,n.$star$star$dot(e,n.www$prime)))),n.f(1))),n.$eq$at(l,n.$neg(n.abs(u),n.f(.5))),n.$eq$at(f,n.floor(n.$plus(u,n.f(.5)))),n.$eq$at(d,n.$neg(u,f)),n.$star$eq(s,n.$neg(n.f(1.79284291400159),n.$star(n.f(.85373472095314),n.$plus(n.$star(d,d),n.$star(l,l)))));var m=n.vec3var("g");return n.$eq$at(m,n.vec31f(n.f(0))),n.$eq$at(n.$star$star$dot(m,n.x$prime),n.$plus(n.$star(n.$star$star$dot(d,n.x$prime),n.$star$star$dot(r,n.x$prime)),n.$star(n.$star$star$dot(l,n.x$prime),n.$star$star$dot(r,n.y$prime)))),n.$eq$at(n.$star$star$dot(m,n.yz$prime),n.$plus(n.$star(n.$star$star$dot(d,n.yz$prime),n.$star$star$dot(a,n.xz$prime)),n.$star(n.$star$star$dot(l,n.yz$prime),n.$star$star$dot(a,n.yw$prime)))),n.$$return(n.$star(n.f(130),n.dot(s,m)))});t.x=i,t.x2=a,t.x3=o,t.mod289_2_body=s,t.mod289_3_body=u,t.mod289_2=c,t.mod289_3=l,t.permute_body=f,t.permute=p,t.v=h,t.snoise_body=d,t.snoise=function(e){return n.fundecl1(n.floatfun("snoise"),h,d,e)}},function(e,t,r){"use strict";var n=r(0),i=r(41);t.js=function(e,t,r,a){var o=i.caml_get_public_method(r,e,t);return n.app(o,a)},t.js1=function(e,t,r){return n._1(i.caml_get_public_method(r,e,t),r)},t.js2=function(e,t,r,a){return n._2(i.caml_get_public_method(r,e,t),r,a)},t.js3=function(e,t,r,a,o){return n._3(i.caml_get_public_method(r,e,t),r,a,o)},t.js4=function(e,t,r,a,o,s){return n._4(i.caml_get_public_method(r,e,t),r,a,o,s)},t.js5=function(e,t,r,a,o,s,u){return n._5(i.caml_get_public_method(r,e,t),r,a,o,s,u)},t.js6=function(e,t,r,a,o,s,u,c){return n._6(i.caml_get_public_method(r,e,t),r,a,o,s,u,c)},t.js7=function(e,t,r,a,o,s,u,c,l){return n._7(i.caml_get_public_method(r,e,t),r,a,o,s,u,c,l)},t.js8=function(e,t,r,a,o,s,u,c,l,f){return n._8(i.caml_get_public_method(r,e,t),r,a,o,s,u,c,l,f)}},function(e,t,r){"use strict";var n=r(33),i=r(5),a=r(0),o=r(12),s=r(8),u=r(9),c=r(6),l=r(1);var f=[];function p(e){var t=e.length,r=u.caml_create_string(t);return u.caml_blit_bytes(e,0,r,0,t),r}function h(e,t,r){if(t<0||r<0||t>(e.length-r|0))throw[l.invalid_argument,"String.sub / Bytes.sub"];var n=u.caml_create_string(r);return u.caml_blit_bytes(e,t,n,0,r),n}function d(e){var t=e-9|0;return t>4||t<0?23!==t?0:1:2!==t?1:0}function m(e,t){var r=t.length;if(r){for(var n=u.caml_create_string(r),i=0,o=r-1|0;i<=o;++i)n[i]=a._1(e,t[i]);return n}return t}function g(e,t){if(t.length){var r=p(t);return r[0]=a._1(e,t[0]),r}return t}function v(e,t,r,n){for(;;){var i=r;if(i>=t)throw l.not_found;if(e[i]===n)return i;r=i+1|0}}function _(e,t,r){for(;;){var n=t;if(n<0)throw l.not_found;if(e[n]===r)return n;t=n-1|0}}function y(e,t,r){var n=e.length;if(t<0||t>n)throw[l.invalid_argument,"String.contains_from / Bytes.contains_from"];try{return v(e,n,t,r),1}catch(e){if(e===l.not_found)return 0;throw e}}var b=o.caml_compare,x=u.bytes_to_string,w=u.bytes_of_string;t.make=function(e,t){var r=u.caml_create_string(e);return u.caml_fill_string(r,0,e,t),r},t.init=function(e,t){for(var r=u.caml_create_string(e),n=0,i=e-1|0;n<=i;++n)r[n]=a._1(t,n);return r},t.empty=f,t.copy=p,t.of_string=function(e){return p(u.bytes_of_string(e))},t.to_string=function(e){return u.bytes_to_string(p(e))},t.sub=h,t.sub_string=function(e,t,r){return u.bytes_to_string(h(e,t,r))},t.extend=function(e,t,r){var n=(e.length+t|0)+r|0,i=u.caml_create_string(n),a=t<0?[0|-t,0]:[0,t],o=a[1],s=a[0],l=c.caml_int_min(e.length-s|0,n-o|0);return l>0&&u.caml_blit_bytes(e,s,i,o,l),i},t.fill=function(e,t,r,n){if(t<0||r<0||t>(e.length-r|0))throw[l.invalid_argument,"String.fill / Bytes.fill"];return u.caml_fill_string(e,t,r,n)},t.blit=function(e,t,r,n,i){if(i<0||t<0||t>(e.length-i|0)||n<0||n>(r.length-i|0))throw[l.invalid_argument,"Bytes.blit"];return u.caml_blit_bytes(e,t,r,n,i)},t.blit_string=function(e,t,r,n,i){if(i<0||t<0||t>(e.length-i|0)||n<0||n>(r.length-i|0))throw[l.invalid_argument,"String.blit / Bytes.blit_string"];return u.caml_blit_string(e,t,r,n,i)},t.concat=function(e,t){if(t){var r=t[0],n=[0],a=[0];i.iter(function(e){return n[0]=n[0]+1|0,a[0]=a[0]+e.length|0,0},t);var o=u.caml_create_string(a[0]+s.imul(e.length,n[0]-1|0)|0);u.caml_blit_bytes(r,0,o,0,r.length);var c=[r.length];return i.iter(function(t){return u.caml_blit_bytes(e,0,o,c[0],e.length),c[0]=c[0]+e.length|0,u.caml_blit_bytes(t,0,o,c[0],t.length),c[0]=c[0]+t.length|0,0},t[1]),o}return f},t.cat=function(e,t){return e.concat(t)},t.iter=function(e,t){for(var r=0,n=t.length-1|0;r<=n;++r)a._1(e,t[r]);return 0},t.iteri=function(e,t){for(var r=0,n=t.length-1|0;r<=n;++r)a._2(e,r,t[r]);return 0},t.map=m,t.mapi=function(e,t){var r=t.length;if(r){for(var n=u.caml_create_string(r),i=0,o=r-1|0;i<=o;++i)n[i]=a._2(e,i,t[i]);return n}return t},t.trim=function(e){for(var t=e.length,r=0;r<t&&d(e[r]);)r=r+1|0;for(var n=t-1|0;n>=r&&d(e[n]);)n=n-1|0;return n>=r?h(e,r,1+(n-r|0)|0):f},t.escaped=function(e){for(var t=0,r=0,n=e.length-1|0;r<=n;++r){var i,a=e[r];if(a>=32){var o=a-34|0;i=o>58||o<0?o>=93?4:1:o>57||o<1?2:1}else i=a>=11?13!==a?4:2:a>=8?2:4;t=t+i|0}if(t===e.length)return p(e);var s=u.caml_create_string(t);t=0;for(var c=0,l=e.length-1|0;c<=l;++c){var f=e[c],h=0;if(f>=35)92!==f?f>=127?h=1:s[t]=f:h=2;else if(f>=32)f>=34?h=2:s[t]=f;else if(f>=14)h=1;else switch(f){case 8:s[t]=92,s[t=t+1|0]=98;break;case 9:s[t]=92,s[t=t+1|0]=116;break;case 10:s[t]=92,s[t=t+1|0]=110;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:h=1;break;case 13:s[t]=92,s[t=t+1|0]=114}switch(h){case 1:s[t]=92,s[t=t+1|0]=48+(f/100|0)|0,s[t=t+1|0]=48+(f/10|0)%10|0,s[t=t+1|0]=48+f%10|0;break;case 2:s[t]=92,s[t=t+1|0]=f}t=t+1|0}return s},t.index=function(e,t){return v(e,e.length,0,t)},t.rindex=function(e,t){return _(e,e.length-1|0,t)},t.index_from=function(e,t,r){var n=e.length;if(t<0||t>n)throw[l.invalid_argument,"String.index_from / Bytes.index_from"];return v(e,n,t,r)},t.rindex_from=function(e,t,r){if(t<-1||t>=e.length)throw[l.invalid_argument,"String.rindex_from / Bytes.rindex_from"];return _(e,t,r)},t.contains=function(e,t){return y(e,0,t)},t.contains_from=y,t.rcontains_from=function(e,t,r){if(t<0||t>=e.length)throw[l.invalid_argument,"String.rcontains_from / Bytes.rcontains_from"];try{return _(e,t,r),1}catch(e){if(e===l.not_found)return 0;throw e}},t.uppercase=function(e){return m(n.uppercase,e)},t.lowercase=function(e){return m(n.lowercase,e)},t.capitalize=function(e){return g(n.uppercase,e)},t.uncapitalize=function(e){return g(n.lowercase,e)},t.compare=b,t.unsafe_to_string=x,t.unsafe_of_string=w},function(e,t,r){"use strict";var n=r(0),i=r(35),a=r(11),o=r(2),s=r(1);function u(e,t,r){for(var n=a.caml_make_vect(e,[]),i=0,o=e-1|0;i<=o;++i)n[i]=a.caml_make_vect(t,r);return n}function c(e){var t=e.length;return t?a.caml_array_sub(e,0,t):[]}function l(e,t,r,n,i){if(i<0||t<0||t>(e.length-i|0)||n<0||n>(r.length-i|0))throw[s.invalid_argument,"Array.blit"];return a.caml_array_blit(e,t,r,n,i)}var f=o.create("Array.Bottom");function p(e,t){var r=function(r,i,o,s,u,c,f){for(var p=r+i|0,h=s+u|0,d=r,m=a.caml_array_get(t,r),g=s,v=a.caml_array_get(o,s),_=f;;){var y=_,b=v,x=g,w=m,$=d;if(n._2(e,w,b)<=0){a.caml_array_set(c,y,w);var E=$+1|0;if(E<p){_=y+1|0,m=a.caml_array_get(t,E),d=E;continue}return l(o,x,c,y+1|0,h-x|0)}a.caml_array_set(c,y,b);var M=x+1|0;if(!(M<h))return l(t,$,c,y+1|0,p-$|0);_=y+1|0,v=a.caml_array_get(o,M),g=M}},i=function(r,i,o,s){for(var u=0,c=s-1|0;u<=c;++u){for(var l=a.caml_array_get(t,r+u|0),f=(o+u|0)-1|0;f>=o&&n._2(e,a.caml_array_get(i,f),l)>0;)a.caml_array_set(i,f+1|0,a.caml_array_get(i,f)),f=f-1|0;a.caml_array_set(i,f+1|0,l)}return 0},o=function(e,n,a,s){if(s<=5)return i(e,n,a,s);var u=s/2|0,c=s-u|0;return o(e+u|0,n,a+u|0,c),o(e,t,e+c|0,u),r(e+c|0,u,n,a+u|0,c,n,a)},s=t.length;if(s<=5)return i(0,t,0,s);var u=s/2|0,c=s-u|0,f=a.caml_make_vect(c,a.caml_array_get(t,0));return o(u,f,0,c),o(0,t,c,u),r(c,u,f,0,c,t,0)}var h=u,d=a.caml_array_concat,m=p;t.init=function(e,t){if(e){if(e<0)throw[s.invalid_argument,"Array.init"];for(var r=a.caml_make_vect(e,n._1(t,0)),i=1,o=e-1|0;i<=o;++i)r[i]=n._1(t,i);return r}return[]},t.make_matrix=u,t.create_matrix=h,t.append=function(e,t){var r=e.length;return r?t.length?e.concat(t):a.caml_array_sub(e,0,r):c(t)},t.concat=d,t.sub=function(e,t,r){if(r<0||t>(e.length-r|0))throw[s.invalid_argument,"Array.sub"];return a.caml_array_sub(e,t,r)},t.copy=c,t.fill=function(e,t,r,n){if(t<0||r<0||t>(e.length-r|0))throw[s.invalid_argument,"Array.fill"];for(var i=t,a=(t+r|0)-1|0;i<=a;++i)e[i]=n;return 0},t.blit=l,t.to_list=function(e){for(var t=e.length-1|0,r=0;;){var n=r,i=t;if(i<0)return n;r=[e[i],n],t=i-1|0}},t.of_list=function(e){if(!e)return[];for(var t=a.caml_make_vect(function(e,t){for(;;){var r=t,n=e;if(!r)return n;t=r[1],e=n+1|0}}(0,e),e[0]),r=1,n=e[1];;){var i=n,o=r;if(!i)return t;t[o]=i[0],n=i[1],r=o+1|0}},t.iter=function(e,t){for(var r=0,i=t.length-1|0;r<=i;++r)n._1(e,t[r]);return 0},t.map=function(e,t){var r=t.length;if(r){for(var i=a.caml_make_vect(r,n._1(e,t[0])),o=1,s=r-1|0;o<=s;++o)i[o]=n._1(e,t[o]);return i}return[]},t.iteri=function(e,t){for(var r=0,i=t.length-1|0;r<=i;++r)n._2(e,r,t[r]);return 0},t.mapi=function(e,t){var r=t.length;if(r){for(var i=a.caml_make_vect(r,n._2(e,0,t[0])),o=1,s=r-1|0;o<=s;++o)i[o]=n._2(e,o,t[o]);return i}return[]},t.fold_left=function(e,t,r){for(var i=t,a=0,o=r.length-1|0;a<=o;++a)i=n._2(e,i,r[a]);return i},t.fold_right=function(e,t,r){for(var i=r,a=t.length-1|0;a>=0;--a)i=n._2(e,t[a],i);return i},t.sort=function(e,t){for(var r=function(r,i){var o=1+((i+i|0)+i|0)|0,s=o;if((o+2|0)<r)return n._2(e,a.caml_array_get(t,o),a.caml_array_get(t,o+1|0))<0&&(s=o+1|0),n._2(e,a.caml_array_get(t,s),a.caml_array_get(t,o+2|0))<0&&(s=o+2|0),s;if((o+1|0)<r&&n._2(e,a.caml_array_get(t,o),a.caml_array_get(t,o+1|0))<0)return o+1|0;if(o<r)return o;throw[f,i]},o=function(o,s,u){try{for(var c=o,l=s,p=u;;){var h=l,d=r(c,h);if(!(n._2(e,a.caml_array_get(t,d),p)>0))return a.caml_array_set(t,h,p);a.caml_array_set(t,h,a.caml_array_get(t,d)),l=d}}catch(e){var m=i.internalToOCamlException(e);if(m[0]===f)return a.caml_array_set(t,m[1],u);throw m}},u=function(e,n){try{for(var o=e,s=n;;){var u=s,c=r(o,u);a.caml_array_set(t,u,a.caml_array_get(t,c)),s=c}}catch(e){var l=i.internalToOCamlException(e);if(l[0]===f)return l[1];throw l}},c=function(r,i){for(;;){var o=r,u=(o-1|0)/3|0;if(o===u)throw[s.assert_failure,["array.ml",168,4]];if(n._2(e,a.caml_array_get(t,u),i)<0){if(a.caml_array_set(t,o,a.caml_array_get(t,u)),u>0){r=u;continue}return a.caml_array_set(t,0,i)}return a.caml_array_set(t,o,i)}},l=t.length,p=((l+1|0)/3|0)-1|0;p>=0;--p)o(l,p,a.caml_array_get(t,p));for(var h=l-1|0;h>=2;--h){var d=a.caml_array_get(t,h);a.caml_array_set(t,h,a.caml_array_get(t,0)),c(u(h,0),d)}if(l>1){var m=a.caml_array_get(t,1);return a.caml_array_set(t,1,a.caml_array_get(t,0)),a.caml_array_set(t,0,m)}return 0},t.stable_sort=p,t.fast_sort=m},function(e,t,r){"use strict";var n=r(0),i=r(27);function a(e){return null!==e?e.h:0}function o(e,t,r,n){var i=a(e),o=a(n);return{left:e,key:t,value:r,right:n,h:i>=o?i+1|0:o+1|0}}function s(e,t){return{left:null,key:e,value:t,right:null,h:1}}function u(e,t){return null!==t?null!==e?+(e.h>=t.h):0:1}function c(e,t,r,n){var i=null!==e?e.h:0,s=null!==n?n.h:0;if(i>(s+2|0)){var u=e.left,c=e.key,l=e.value,f=e.right;if(a(u)>=a(f))return o(u,c,l,o(f,t,r,n));var p=f.left,h=f.key,d=f.value,m=f.right;return o(o(u,c,l,p),h,d,o(m,t,r,n))}if(s>(i+2|0)){var g=n.left,v=n.key,_=n.value,y=n.right;if(a(y)>=a(g))return o(o(e,t,r,g),v,_,y);var b=g.left,x=g.key,w=g.value,$=g.right;return o(o(e,t,r,b),x,w,o($,v,_,y))}return{left:e,key:t,value:r,right:n,h:i>=s?i+1|0:s+1|0}}function l(e){for(;;){var t=e,r=t.left;if(null===r)return t.key;e=r}}function f(e){for(;;){var t=e,r=t.right;if(null===r)return t.key;e=r}}function p(e){for(;;){var t=e,r=t.left;if(null===r)return[t.key,t.value];e=r}}function h(e){for(;;){var t=e,r=t.right;if(null===r)return[t.key,t.value];e=r}}function d(e,t,r){var n=e.left,i=e.right,a=e.key,o=e.value;return null!==n?c(d(n,t,r),a,o,i):(t[0]=a,r[0]=o,i)}function m(e,t){for(;;){var r=t,n=e;if(null===n)return r;t=[n,r],e=n.left}}function g(e,t){for(;;){var r=e;if(null===r)return 0;g(r.left,t),t(r.key,r.value),e=r.right}}function v(e,t){if(null!==e){var r=v(e.left,t),n=t(e.value),i=v(e.right,t);return{left:r,key:e.key,value:n,right:i,h:e.h}}return null}function _(e,t){if(null!==e){var r=e.key;return{left:_(e.left,t),key:r,value:t(r,e.value),right:_(e.right,t),h:e.h}}return null}function y(e,t,r){for(;;){var n=t,i=e;if(null===i)return n;var a=i.left,o=i.key,s=i.value,u=i.right;t=r(y(a,n,r),o,s),e=u}}function b(e,t){for(;;){var r=e;if(null!==r){if(t(r.key,r.value)){if(b(r.left,t)){e=r.right;continue}return 0}return 0}return 1}}function x(e,t){for(;;){var r=e;if(null===r)return 0;if(t(r.key,r.value))return 1;if(x(r.left,t))return 1;e=r.right}}function w(e,t,r,n){if(null!==e){if(null!==n){var i=e.left,a=e.key,u=e.value,l=e.right,f=e.h,p=n.left,h=n.key,d=n.value,m=n.right,g=n.h;return f>(g+2|0)?c(i,a,u,w(l,t,r,n)):g>(f+2|0)?c(w(e,t,r,p),h,d,m):o(e,t,r,n)}return function e(t,r,n){return null!==t?c(t.left,t.key,t.value,e(t.right,r,n)):s(r,n)}(e,t,r)}return function e(t,r,n){return null!==t?c(e(t.left,r,n),t.key,t.value,t.right):s(r,n)}(n,t,r)}function $(e,t){if(null!==e){if(null!==t){var r=[t.key],n=[t.value],i=d(t,r,n);return w(e,r[0],n[0],i)}return e}return t}function E(e,t){if(null!==e){var r=e.key,n=e.value,i=E(e.left,t),a=t(r,n),o=E(e.right,t);return a?w(i,r,n,o):$(i,o)}return null}function M(e,t){if(null!==e){var r=e.key,n=e.value,i=M(e.left,t),a=t(r,n),o=M(e.right,t);return a?w(i,r,a[0],o):$(i,o)}return null}function T(e,t){if(null!==e){var r=e.key,n=e.value,i=T(e.left,t),a=i[1],o=i[0],s=t(r,n),u=T(e.right,t),c=u[1],l=u[0];return s?[w(o,r,n,l),$(a,c)]:[$(o,l),w(a,r,n,c)]}return[null,null]}function S(e){var t=e.left,r=e.right;return(1+(null!==t?S(t):0)|0)+(null!==r?S(r):0)|0}function A(e){return null!==e?S(e):0}function z(e,t,r){for(;;){var n=t,i=e,a=i.left,o=i.key,s=i.right,u=null!==a?z(a,n,r):n;r[u]=[o,i.value];var c=u+1|0;if(null===s)return c;t=c,e=s}}function R(e,t,r){if(r>3||r<0){var n=r/2|0,i=R(e,t,n),a=e[t-n|0],u=R(e,(t-n|0)-1|0,(r-n|0)-1|0);return o(i,a[0],a[1],u)}switch(r){case 0:return null;case 1:var c=e[t];return s(c[0],c[1]);case 2:var l=e[t],f=e[t-1|0],p=l;return{left:s(p[0],p[1]),key:f[0],value:f[1],right:null,h:2};case 3:var h=e[t],d=e[t-1|0],m=e[t-2|0],g=d,v=h;return{left:s(v[0],v[1]),key:g[0],value:g[1],right:s(m[0],m[1]),h:2}}}function C(e,t,r){if(r>3||r<0){var n=r/2|0,i=C(e,t,n),a=e[t+n|0],u=C(e,1+(t+n|0)|0,(r-n|0)-1|0);return o(i,a[0],a[1],u)}switch(r){case 0:return null;case 1:var c=e[t];return s(c[0],c[1]);case 2:var l=e[t],f=e[t+1|0],p=l;return{left:s(p[0],p[1]),key:f[0],value:f[1],right:null,h:2};case 3:var h=e[t],d=e[t+1|0],m=e[t+2|0],g=d,v=h;return{left:s(v[0],v[1]),key:g[0],value:g[1],right:s(m[0],m[1]),h:2}}}function L(e,t,r,n){var i=A(e),a=A(t);if(i!==a)return i<a?-1:1;for(var o=m(e,0),s=m(t,0),u=r,c=n;;){var l=s,f=o;if(f){if(l){var p=l[0],h=f[0],d=u(h.key,p.key);if(d)return d;var g=c(h.value,p.value);if(g)return g;s=m(p.right,l[1]),o=m(h.right,f[1]);continue}return 0}return 0}}function P(e,t,r,n){if(A(e)!==A(t))return 0;for(var i=m(e,0),a=m(t,0),o=r,s=n;;){var u=a,c=i;if(c){if(u){var l=u[0],f=c[0];if(0===o(f.key,l.key)&&s(f.value,l.value)){a=m(l.right,u[1]),i=m(f.right,c[1]);continue}return 0}return 1}return 1}}function U(e){var t=e.left;e.left=t.right,t.right=e;var r=a(e.left),n=a(e.right);e.h=(r>n?r:n)+1|0;var i=a(t.left),o=e.h;return t.h=(i>o?i:o)+1|0,t}function I(e){var t=e.right;e.right=t.left,t.left=e;var r=a(e.left),n=a(e.right);e.h=(r>n?r:n)+1|0;var i=a(t.right),o=e.h;return t.h=(i>o?i:o)+1|0,t}function O(e){var t=a(e.left),r=a(e.right);return e.h=(t>r?t:r)+1|0,e}function N(e){var t,r,n=e.left,i=e.right,o=a(n),s=a(i);if(o>(2+s|0))return u(n.left,n.right)?O(U(e)):O((r=I((t=e).left),t.left=r,U(t)));if(s>(2+o|0)){var c=i.left;return u(i.right,c)?O(I(e)):O(function(e){var t=U(e.right);return e.right=t,I(e)}(e))}return e.h=(o>s?o:s)+1|0,e}function k(e,t,r,n){if(null!==e){var i=n(t,e.key);if(i){var a=e.left,o=e.right;if(i<0){var u=k(a,t,r,n);e.left=u}else e.right=k(o,t,r,n);return N(e)}return e.value=r,e}return s(t,r)}t.copy=function e(t){if(null!==t){var r=t.left,n=t.right;return{left:e(r),key:t.key,value:t.value,right:e(n),h:t.h}}return t},t.create=o,t.bal=c,t.singleton=s,t.updateValue=function(e,t){return e.value===t?e:{left:e.left,key:e.key,value:t,right:e.right,h:e.h}},t.minKey=function(e){return null!==e?[l(e)]:0},t.minKeyUndefined=function(e){return null!==e?l(e):void 0},t.maxKey=function(e){return null!==e?[f(e)]:0},t.maxKeyUndefined=function(e){return null!==e?f(e):void 0},t.minimum=function(e){return null!==e?[p(e)]:0},t.minUndefined=function(e){return null!==e?p(e):void 0},t.maximum=function(e){return null!==e?[h(e)]:0},t.maxUndefined=function(e){return null!==e?h(e):void 0},t.removeMinAuxWithRef=d,t.empty=null,t.isEmpty=function(e){return null!==e?0:1},t.stackAllLeft=m,t.forEachU=g,t.forEach=function(e,t){return g(e,n.__2(t))},t.mapU=v,t.map=function(e,t){return v(e,n.__1(t))},t.mapWithKeyU=_,t.mapWithKey=function(e,t){return _(e,n.__2(t))},t.reduceU=y,t.reduce=function(e,t,r){return y(e,t,n.__3(r))},t.everyU=b,t.every=function(e,t){return b(e,n.__2(t))},t.someU=x,t.some=function(e,t){return x(e,n.__2(t))},t.join=w,t.concat=$,t.concatOrJoin=function(e,t,r,n){return r?w(e,t,r[0],n):$(e,n)},t.keepSharedU=E,t.keepShared=function(e,t){return E(e,n.__2(t))},t.keepMapU=M,t.keepMap=function(e,t){return M(e,n.__2(t))},t.partitionSharedU=T,t.partitionShared=function(e,t){return T(e,n.__2(t))},t.lengthNode=S,t.size=A,t.toList=function(e){return function e(t,r){for(;;){var n=r,i=t;if(null===n)return i;r=n.left,t=[[n.key,n.value],e(i,n.right)]}}(0,e)},t.checkInvariantInternal=function e(t){for(;;){var r=t;if(null===r)return 0;var n=r.left,i=r.right,o=a(n)-a(i)|0;if(!(o<=2&&o>=-2))throw new Error('File "belt_internalAVLtree.ml", line 368, characters 6-12');e(n),t=i}},t.fillArray=z,t.toArray=function(e){if(null!==e){var t=S(e),r=new Array(t);return z(e,0,r),r}return[]},t.keysToArray=function(e){if(null!==e){var t=S(e),r=new Array(t);return function e(t,r,n){for(;;){var i=r,a=t,o=a.left,s=a.key,u=a.right,c=null!==o?e(o,i,n):i;n[c]=s;var l=c+1|0;if(null===u)return l;r=l,t=u}}(e,0,r),r}return[]},t.valuesToArray=function(e){if(null!==e){var t=S(e),r=new Array(t);return function e(t,r,n){for(;;){var i=r,a=t,o=a.left,s=a.right,u=null!==o?e(o,i,n):i;n[u]=a.value;var c=u+1|0;if(null===s)return c;r=c,t=s}}(e,0,r),r}return[]},t.ofSortedArrayAux=C,t.ofSortedArrayRevAux=R,t.ofSortedArrayUnsafe=function(e){return C(e,0,e.length)},t.cmpU=L,t.cmp=function(e,t,r,i){return L(e,t,r,n.__2(i))},t.eqU=P,t.eq=function(e,t,r,i){return P(e,t,r,n.__2(i))},t.get=function(e,t,r){for(;;){var n=e;if(null!==n){var i=r(t,n.key);if(i){e=i<0?n.left:n.right;continue}return[n.value]}return 0}},t.getUndefined=function(e,t,r){for(;;){var n=e;if(null!==n){var i=r(t,n.key);if(i){e=i<0?n.left:n.right;continue}return n.value}return}},t.getWithDefault=function(e,t,r,n){for(;;){var i=e;if(null!==i){var a=n(t,i.key);if(a){e=a<0?i.left:i.right;continue}return i.value}return r}},t.getExn=function(e,t,r){for(;;){var n=e;if(null!==n){var i=r(t,n.key);if(i){e=i<0?n.left:n.right;continue}return n.value}throw new Error("getExn0")}},t.has=function(e,t,r){for(;;){var n=e;if(null!==n){var i=r(t,n.key);if(i){e=i<0?n.left:n.right;continue}return 1}return 0}},t.ofArray=function(e,t){var r=e.length;if(r){var n,a=i.strictlySortedLengthU(e,function(e,r){return+(t(e[0],r[0])<0)});n=a>=0?C(e,0,a):R(e,(a=0|-a)-1|0,a);for(var o=a,s=r-1|0;o<=s;++o){var u=e[o];n=k(n,u[0],u[1],t)}return n}return null},t.updateMutate=k,t.balMutate=N,t.removeMinAuxWithRootMutate=function e(t,r){var n=r.right,i=r.left;return null!==i?(r.left=e(t,i),N(r)):(t.key=r.key,n)}},function(e,t,r){"use strict";(function(e){var n=r(0),i=r(1);var a=["",function(t,r){var n=r.length-1|0;return void 0!==e&&e.stdout&&e.stdout.write?e.stdout.write(r):"\n"===r[n]?(console.log(r.slice(0,n)),0):(console.log(r),0)}],o=["",function(e,t){var r=t.length-1|0;return"\n"===t[r]?(console.log(t.slice(0,r)),0):(console.log(t),0)}];function s(e){return""!==e[0]?(n._2(e[1],e,e[0]),e[0]="",0):0}function u(t,r,n,i){var o=0===n&&i===r.length?r:r.slice(n,i);if(void 0!==e&&e.stdout&&e.stdout.write&&t===a)return e.stdout.write(o);var u=o.lastIndexOf("\n");return u<0?(t[0]=t[0]+o,0):(t[0]=t[0]+o.slice(0,u+1|0),s(t),t[0]=t[0]+o.slice(u+1|0),0)}t.$caret=function(e,t){return e+t},t.stdin=void 0,t.stdout=a,t.stderr=o,t.caml_ml_open_descriptor_in=function(){throw[i.failure,"caml_ml_open_descriptor_in not implemented"]},t.caml_ml_open_descriptor_out=function(){throw[i.failure,"caml_ml_open_descriptor_out not implemented"]},t.caml_ml_flush=s,t.node_std_output=function(t){return void 0!==e&&e.stdout&&(e.stdout.write(t),!0)},t.caml_ml_output=u,t.caml_ml_output_char=function(e,t){return u(e,String.fromCharCode(t),0,1)},t.caml_ml_input=function(e,t,r,n){throw[i.failure,"caml_ml_input ic not implemented"]},t.caml_ml_input_char=function(){throw[i.failure,"caml_ml_input_char not implemnted"]},t.caml_ml_out_channels_list=function(){return[a,[o,0]]}}).call(t,r(30))},function(e,t,r){"use strict";var n=r(0),i=r(8),a=r(48),o=r(31),s=r(1);function u(e){throw[s.failure,e]}function c(e){return e>=65?e>=97?e>=123?-1:e-87|0:e>=91?-1:e-55|0:e>57||e<48?-1:e-48|0}function l(e){switch(e){case 0:return 8;case 1:return 16;case 2:return 10;case 3:return 2}}function f(e){var t=1,r=2,n=0;"-"===e[n]&&(t=-1,n=n+1|0);var i=e.charCodeAt(n),a=e.charCodeAt(n+1|0);return 48===i&&(a>=89?98!==a?111!==a?120===a&&(r=1,n=n+2|0):(r=0,n=n+2|0):(r=3,n=n+2|0):66!==a?79!==a?a>=88&&(r=1,n=n+2|0):(r=0,n=n+2|0):(r=3,n=n+2|0)),[n,t,r]}function p(e){var t=f(e),r=t[0],n=l(t[2]),i=e.length,a=c(r<i?e.charCodeAt(r):0);if(a<0||a>=n)throw[s.failure,"int_of_string"];var o=t[1]*function(t,r){for(;;){var a=r,o=t;if(a===i)return o;var u=e.charCodeAt(a);if(95!==u){var l=c(u);if(l<0||l>=n)throw[s.failure,"int_of_string"];var f=n*o+l;if(f>4294967295)throw[s.failure,"int_of_string"];r=a+1|0,t=f}else r=a+1|0}}(a,r+1|0),u=0|o;if(10===n&&o!==u)throw[s.failure,"int_of_string"];return u}function h(e){return e>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e}function d(e){var t=e.length;if(t>31)throw[s.invalid_argument,"format_int: format too long"];for(var r=["+","-"," ",0,2,0,0,0,1,-1,"f"],n=0;;){var a=n;if(a>=t)return r;var o=e.charCodeAt(a),u=0;if(o>=69)if(o>=88)if(o>=121)u=1;else switch(o-88|0){case 0:r[4]=1,r[7]=1,n=a+1|0;continue;case 13:case 14:case 15:u=5;break;case 12:case 17:u=4;break;case 23:r[4]=0,n=a+1|0;continue;case 29:r[4]=2,n=a+1|0;continue;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:u=1;break;case 32:r[4]=1,n=a+1|0;continue}else{if(!(o>=72)){r[5]=1,r[7]=1,r[10]=String.fromCharCode(h(o)),n=a+1|0;continue}u=1}else{var c=o-32|0;if(c>25||c<0)u=1;else switch(c){case 3:r[3]=1,n=a+1|0;continue;case 0:case 11:u=2;break;case 13:r[0]="-",n=a+1|0;continue;case 14:r[9]=0;for(var l=a+1|0;function(t){return function(){var r=e.charCodeAt(t)-48|0;return+(r>=0&&r<=9)}}(l)();)r[9]=(i.imul(r[9],10)+e.charCodeAt(l)|0)-48|0,l=l+1|0;n=l;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 15:u=1;break;case 16:r[2]="0",n=a+1|0;continue;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:u=3}}switch(u){case 1:n=a+1|0;continue;case 2:r[1]=String.fromCharCode(o),n=a+1|0;continue;case 3:r[6]=0;for(var f=a;function(t){return function(){var r=e.charCodeAt(t)-48|0;return+(r>=0&&r<=9)}}(f)();)r[6]=(i.imul(r[6],10)+e.charCodeAt(f)|0)-48|0,f=f+1|0;n=f;continue;case 4:r[5]=1,r[4]=2,n=a+1|0;continue;case 5:r[5]=1,r[10]=String.fromCharCode(o),n=a+1|0;continue}}}function m(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=t.length;s&&(l<0||"-"!==n)&&(f=f+1|0),a&&(o?1===o&&(f=f+2|0):f=f+1|0);var p="";if("+"===r&&" "===i)for(var h=f,d=u-1|0;h<=d;++h)p+=i;if(s&&(l<0?p+="-":"-"!==n&&(p+=n)),a&&0===o&&(p+="0"),a&&1===o&&(p+="0x"),"+"===r&&"0"===i)for(var m=f,g=u-1|0;m<=g;++m)p+=i;if(p=c?p+t.toUpperCase():p+t,"-"===r)for(var v=f,_=u-1|0;v<=_;++v)p+=" ";return p}function g(e,t){if("%d"===e)return String(t);var r=d(e),n=t,i=(n<0?r[5]?(r[8]=-1,-n):n>>>0:n).toString(function(e){switch(e){case 0:return 8;case 1:return 16;case 2:return 10}}(r[4]));if(r[9]>=0){r[2]=" ";var a=r[9]-i.length|0;a>0&&(i=o.repeat(a,"0")+i)}return m(r,i)}var v=function(e,t){var r=+e;if(e.length>0&&r==r)return r;if(r=+(e=e.replace(/_/g,"")),e.length>0&&r==r||/^[+-]?nan$/i.test(e))return r;if(/^ *0x[0-9a-f_]+p[+-]?[0-9_]+/i.test(e)){var n=e.indexOf("p");n=-1==n?e.indexOf("P"):n;var i=+e.substring(n+1);return(r=+e.substring(0,n))*Math.pow(2,i)}return/^\+?inf(inity)?$/i.test(e)?1/0:/^-inf(inity)?$/i.test(e)?-1/0:void t("float_of_string")};var _=g,y=g,b=p,x=p;t.caml_format_float=function(e,t){var r=d(e),n=r[9]<0?6:r[9],i=t<0?(r[8]=-1,-t):t,a="";if(isNaN(i))a="nan",r[2]=" ";else if(isFinite(i))switch(r[10]){case"e":var o=(a=i.toExponential(n)).length;"e"===a[o-3|0]&&(a=a.slice(0,o-1|0)+"0"+a.slice(o-1|0));break;case"f":a=i.toFixed(n);break;case"g":var s=0!==n?n:1,u=(a=i.toExponential(s-1|0)).indexOf("e"),c=0|Number(a.slice(u+1|0));if(c<-4||i>=1e21||i.toFixed().length>s){for(var l=u-1|0;"0"===a[l];)l=l-1|0;"."===a[l]&&(l=l-1|0);var f=(a=a.slice(0,l+1|0)+a.slice(u)).length;"e"===a[f-3|0]&&(a=a.slice(0,f-1|0)+"0"+a.slice(f-1|0))}else{var p=s;if(c<0)p=p-(c+1|0)|0,a=i.toFixed(p);else for(;+((a=i.toFixed(p)).length>(s+1|0));)p=p-1|0;if(0!==p){for(var h=a.length-1|0;"0"===a[h];)h=h-1|0;"."===a[h]&&(h=h-1|0),a=a.slice(0,h+1|0)}}}else a="inf",r[2]=" ";return m(r,a)},t.caml_format_int=g,t.caml_nativeint_format=_,t.caml_int32_format=y,t.caml_float_of_string=function(e){return n._2(v,e,u)},t.caml_int64_format=function(e,t){var r=d(e),n=r[5]&&a.lt(t,[0,0])?(r[8]=-1,a.neg(t)):t,i="";switch(r[4]){case 0:var s=[0,8],u="01234567";if(a.lt(n,[0,0])){var c=a.discard_sign(n),l=a.div_mod(c,s),f=a.add([268435456,0],l[0]),p=l[1];for(i=String.fromCharCode(u.charCodeAt(0|p[1]))+i;a.neq(f,[0,0]);){var h=a.div_mod(f,s);f=h[0],p=h[1],i=String.fromCharCode(u.charCodeAt(0|p[1]))+i}}else{var g=a.div_mod(n,s),v=g[0],_=g[1];for(i=String.fromCharCode(u.charCodeAt(0|_[1]))+i;a.neq(v,[0,0]);){var y=a.div_mod(v,s);v=y[0],_=y[1],i=String.fromCharCode(u.charCodeAt(0|_[1]))+i}}break;case 1:i=a.to_hex(n)+i;break;case 2:var b=[0,10];if(a.lt(n,[0,0])){var x=a.discard_sign(n),w=a.div_mod(x,b),$=a.div_mod(a.add([0,8],w[1]),b),E=a.add(a.add([214748364,3435973836],w[0]),$[0]),M=$[1];for(i=String.fromCharCode("0123456789".charCodeAt(0|M[1]))+i;a.neq(E,[0,0]);){var T=a.div_mod(E,b);E=T[0],M=T[1],i=String.fromCharCode("0123456789".charCodeAt(0|M[1]))+i}}else{var S=a.div_mod(n,b),A=S[0],z=S[1];for(i=String.fromCharCode("0123456789".charCodeAt(0|z[1]))+i;a.neq(A,[0,0]);){var R=a.div_mod(A,b);A=R[0],z=R[1],i=String.fromCharCode("0123456789".charCodeAt(0|z[1]))+i}}}if(r[9]>=0){r[2]=" ";var C=r[9]-i.length|0;C>0&&(i=o.repeat(C,"0")+i)}return m(r,i)},t.caml_int_of_string=p,t.caml_int32_of_string=b,t.caml_int64_of_string=function(e){var t,r=f(e),n=r[2],i=r[0],o=a.of_int32(l(n)),u=a.of_int32(r[1]);switch(n){case 0:t=[536870911,4294967295];break;case 1:t=[268435455,4294967295];break;case 2:t=[429496729,2576980377];break;case 3:t=[2147483647,4294967295]}var p=e.length,h=i<p?e.charCodeAt(i):0,d=a.of_int32(c(h));if(a.lt(d,[0,0])||a.ge(d,o))throw[s.failure,"int64_of_string"];var m=a.mul(u,function(r,n){for(;;){var i=n,u=r;if(i===p)return u;var l=e.charCodeAt(i);if(95!==l){var f=a.of_int32(c(l));if(a.lt(f,[0,0])||a.ge(f,o)||a.gt(u,t))throw[s.failure,"int64_of_string"];n=i+1|0,r=a.add(a.mul(o,u),f)}else n=i+1|0}}(d,i+1|0)),g=a.or_(m,[0,0]);if(a.eq(o,[0,10])&&a.neq(m,g))throw[s.failure,"int64_of_string"];return g},t.caml_nativeint_of_string=x},function(e,t,r){"use strict";t.not_implemented=function(e){throw new Error(e)}},function(e,t,r){"use strict";var n=r(0),i=window,a=window.document,o=window.document.body;t.$$window=i,t.$$document=a,t.body=o,t.onReady=function(e){return+("complete"===a.readyState)?n._1(e,0):(i.addEventListener("DOMContentLoaded",function(){return n._1(e,0)}),0)}},function(e,t,r){"use strict";var n=r(0),i=r(78);function a(e,t){var r=e.length;if(0===r||1===r)return r;var n=e[0],i=e[1];if(!t(n,i))return t(i,n)?0|-function(e,t,r,n,i){for(;;){var a=r,o=t;if(a>=n)return a;var s=e[a];if(!i(s,o))return a;r=a+1|0,t=s}}(e,i,2,r,t):1;for(var a=e,o=i,s=2,u=r,c=t;;){var l=s,f=o;if(l>=u)return l;var p=a[l];if(!c(f,p))return l;s=l+1|0,o=p}}function o(e,t){var r=e.length;if(!r)return 1;for(var n=e,i=0,a=t,o=r-1|0;;){var s=i;if(s===o)return 1;if(!(a(n[s],n[s+1|0])<=0))return 0;i=s+1|0}}function s(e,t,r,n,a,o,s,u,c){for(var l=t+r|0,f=a+o|0,p=t,h=e[t],d=a,m=n[a],g=u;;){var v=g,_=m,y=d,b=h,x=p;if(c(b,_)<=0){s[v]=b;var w=x+1|0;if(w<l){g=v+1|0,h=e[w],p=w;continue}return i.blitUnsafe(n,y,s,v+1|0,f-y|0)}s[v]=_;var $=y+1|0;if(!($<f))return i.blitUnsafe(e,x,s,v+1|0,l-x|0);g=v+1|0,m=n[$],d=$}}function u(e,t,r,n,a,o,s,u,c){for(var l=t+r|0,f=a+o|0,p=t,h=e[t],d=a,m=n[a],g=u;;){var v=g,_=m,y=d,b=h,x=p,w=c(b,_);if(w<0){s[v]=b;var $=x+1|0,E=v+1|0;if($<l){g=E,h=e[$],p=$;continue}return i.blitUnsafe(n,y,s,E,f-y|0),(E+f|0)-y|0}if(w){s[v]=_;var M=y+1|0,T=v+1|0;if(M<f){g=T,m=n[M],d=M;continue}return i.blitUnsafe(e,x,s,T,l-x|0),(T+l|0)-x|0}s[v]=b;var S=x+1|0,A=y+1|0,z=v+1|0;if(!(S<l&&A<f))return S===l?(i.blitUnsafe(n,A,s,z,f-A|0),(z+f|0)-A|0):(i.blitUnsafe(e,S,s,z,l-S|0),(z+l|0)-S|0);g=z,m=n[A],d=A,h=e[S],p=S}}function c(e,t,r,n,i,a,o,s,u){for(var c=t+r|0,l=i+a|0,f=t,p=e[t],h=i,d=n[i],m=s;;){var g=m,v=h,_=p,y=f,b=u(_,d);if(b<0){var x=y+1|0;if(x<c){p=e[x],f=x;continue}return g}if(b){var w=v+1|0;if(w<l){d=n[w],h=w;continue}return g}o[g]=_;var $=y+1|0,E=v+1|0,M=g+1|0;if(!($<c&&E<l))return M;m=M,d=n[E],h=E,p=e[$],f=$}}function l(e,t,r,n,a,o,s,u,c){for(var l=t+r|0,f=a+o|0,p=t,h=e[t],d=a,m=n[a],g=u;;){var v=g,_=d,y=h,b=p,x=c(y,m);if(x<0){s[v]=y;var w=v+1|0,$=b+1|0;if($<l){g=w,h=e[$],p=$;continue}return w}if(x){var E=_+1|0;if(E<f){m=n[E],d=E;continue}return i.blitUnsafe(e,b,s,v,l-b|0),(v+l|0)-b|0}var M=b+1|0,T=_+1|0;if(!(M<l&&T<f))return M===l?v:(i.blitUnsafe(e,M,s,v,l-M|0),(v+l|0)-M|0);m=n[T],d=T,h=e[M],p=M}}function f(e,t,r,n,i,a){for(var o=0,s=i-1|0;o<=s;++o){for(var u=e[t+o|0],c=(n+o|0)-1|0;c>=n&&a(r[c],u)>0;)r[c+1|0]=r[c],c=c-1|0;r[c+1|0]=u}return 0}function p(e,t,r,n,i,a){if(i<=5)return f(e,t,r,n,i,a);var o=i/2|0,u=i-o|0;return p(e,t+o|0,r,n+o|0,u,a),p(e,t,e,t+u|0,o,a),s(e,t+u|0,o,r,n+o|0,u,r,n,a)}function h(e,t){var r=e.length;if(r<=5)return f(e,0,e,0,r,t);var n=r/2|0,i=r-n|0,a=new Array(i);return p(e,n,a,0,i,t),p(e,0,e,i,n,t),s(e,i,n,a,0,i,e,0,t)}function d(e,t){var r=i.copy(e);return h(r,t),r}function m(e,t,r){var n=e.length;if(!n)return-1;if(r(t,e[0])<0)return-1;if(r(t,e[n-1|0])>0)return 0|-(n+1|0);for(var i=e,a=0,o=n-1|0,s=t,u=r;;){var c=o,l=a,f=(l+c|0)/2|0,p=u(s,i[f]);if(!p)return f;if(p<0){if(c===f)return u(i[l],s)?0|-(c+1|0):l;o=f}else{if(l===f)return u(i[c],s)?0|-(c+1|0):c;a=f}}}t.Int=0,t.$$String=0,t.strictlySortedLengthU=a,t.strictlySortedLength=function(e,t){return a(e,n.__2(t))},t.isSortedU=o,t.isSorted=function(e,t){return o(e,n.__2(t))},t.stableSortInPlaceByU=h,t.stableSortInPlaceBy=function(e,t){return h(e,n.__2(t))},t.stableSortByU=d,t.stableSortBy=function(e,t){return d(e,n.__2(t))},t.binarySearchByU=m,t.binarySearchBy=function(e,t,r){return m(e,t,n.__2(r))},t.unionU=u,t.union=function(e,t,r,i,a,o,s,c,l){return u(e,t,r,i,a,o,s,c,n.__2(l))},t.intersectU=c,t.intersect=function(e,t,r,i,a,o,s,u,l){return c(e,t,r,i,a,o,s,u,n.__2(l))},t.diffU=l,t.diff=function(e,t,r,i,a,o,s,u,c){return l(e,t,r,i,a,o,s,u,n.__2(c))}},function(e,t,r){"use strict";var n=r(7),i=r(40),a=i.stringConfigVar(["object",["geometry",0]],"Plane",[n.__(0,[["Box","Sphere","Plane"]])],0),o=i.colorConfigVar(["object",["color1",0]],[0,0,0,1])(0,0),s=i.colorConfigVar(["object",["color2",0]],[0,0,0,1])(0,0),u=i.stringConfigVar(["object",["seed",0]],"hello",0,0),c=i.floatConfigVar(["object",["spread",0]],0,0,0),l=i.floatConfigVar(["object",["rotationSpread",0]],0,0,0),f=i.floatConfigVar(["object",["rotationSpeed",0]],0,0,0),p=i.intConfigVar(["object",["count",0]],1,0,0),h=i.floatConfigVar(["object",["size",0]],1,0,0),d=i.floatConfigVar(["camera",["rotation",["x",0]]],0,0,0),m=i.floatConfigVar(["camera",["rotation",["y",0]]],0,0,0),g=i.floatConfigVar(["camera",["rotation",["z",0]]],0,0,0),v=i.floatConfigVar(["camera",["position",["x",0]]],0,0,0),_=i.floatConfigVar(["camera",["position",["y",0]]],2,0,0),y=i.floatConfigVar(["camera",["position",["z",0]]],-2,0,0),b=i.floatConfigVar(["water",["height",0]],1,0,0),x=i.floatConfigVar(["water",["waveHeight",0]],.03,0,0),w=i.floatConfigVar(["object",["position",["x",0]]],.01,0,0),$=i.floatConfigVar(["object",["position",["y",0]]],.01,0,0),E=i.floatConfigVar(["object",["position",["z",0]]],.01,0,0),M=i.floatConfigVar(["light",["position",["x",0]]],.5,0,0),T=i.floatConfigVar(["light",["position",["y",0]]],1,0,0),S=i.floatConfigVar(["light",["position",["z",0]]],.2,0,0),A=i.floatConfigVar(["camera",["eye",["x",0]]],0,0,0),z=i.floatConfigVar(["camera",["eye",["y",0]]],3.5,0,0),R=i.floatConfigVar(["camera",["eye",["z",0]]],0,0,0),C=i.floatConfigVar(["water",["poolHeight",0]],1.5,0,0),L=i.floatConfigVar(["terrain",["scale",0]],.21,0,0);t.geometryType=a,t.backgroundColor=o,t.foregroundColor=s,t.seed=u,t.spread=c,t.rotationSpread=l,t.rotationSpeed=f,t.count=p,t.size=h,t.cameraRotationX=d,t.cameraRotationY=m,t.cameraRotationZ=g,t.cameraX=v,t.cameraY=_,t.cameraZ=y,t.waterHeight=b,t.waveHeight=x,t.objectX=w,t.objectY=$,t.objectZ=E,t.lightX=M,t.lightY=T,t.lightZ=S,t.eyeX=A,t.eyeY=z,t.eyeZ=R,t.poolHeight=C,t.terrainScale=L},function(e,t,r){"use strict";var n=r(4),i=n.vec2arg("co"),a=n.body(function(){return n.$$return(n.fract(n.$star(n.sin(n.dot(n.$star$star$dot(i,n.xy$prime),n.vec22f(n.f(12.9898),n.f(78.233)))),n.f(43758.5453))))});t.co=i,t.randBody=a,t.rand=function(e){return n.fundecl1(n.floatfun("rand"),i,a,e)},t.normalize=function(e,t,r){var n=Math.sqrt(e*e+t*t+r*r);return[e/n,t/n,r/n]}},function(e,t){var r,n,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var u,c=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){"use strict";var n=String.prototype.repeat&&function(e,t){return t.repeat(e)}||function(e,t){if(0==t.length||0==e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="";1==(1&e)&&(r+=t),0!=(e>>>=1);)t+=t;return r};t.repeat=n},function(e,t,r){"use strict";var n=r(7);t.concat_fmtty=function e(t,r){if("number"==typeof t)return r;switch(0|t.tag){case 0:return n.__(0,[e(t[0],r)]);case 1:return n.__(1,[e(t[0],r)]);case 2:return n.__(2,[e(t[0],r)]);case 3:return n.__(3,[e(t[0],r)]);case 4:return n.__(4,[e(t[0],r)]);case 5:return n.__(5,[e(t[0],r)]);case 6:return n.__(6,[e(t[0],r)]);case 7:return n.__(7,[e(t[0],r)]);case 8:return n.__(8,[t[0],e(t[1],r)]);case 9:return n.__(9,[t[0],t[1],e(t[2],r)]);case 10:return n.__(10,[e(t[0],r)]);case 11:return n.__(11,[e(t[0],r)]);case 12:return n.__(12,[e(t[0],r)]);case 13:return n.__(13,[e(t[0],r)]);case 14:return n.__(14,[e(t[0],r)])}},t.erase_rel=function e(t){if("number"==typeof t)return 0;switch(0|t.tag){case 0:return n.__(0,[e(t[0])]);case 1:return n.__(1,[e(t[0])]);case 2:return n.__(2,[e(t[0])]);case 3:return n.__(3,[e(t[0])]);case 4:return n.__(4,[e(t[0])]);case 5:return n.__(5,[e(t[0])]);case 6:return n.__(6,[e(t[0])]);case 7:return n.__(7,[e(t[0])]);case 8:return n.__(8,[t[0],e(t[1])]);case 9:var r=t[0];return n.__(9,[r,r,e(t[2])]);case 10:return n.__(10,[e(t[0])]);case 11:return n.__(11,[e(t[0])]);case 12:return n.__(12,[e(t[0])]);case 13:return n.__(13,[e(t[0])]);case 14:return n.__(14,[e(t[0])])}},t.concat_fmt=function e(t,r){if("number"==typeof t)return r;switch(0|t.tag){case 0:return n.__(0,[e(t[0],r)]);case 1:return n.__(1,[e(t[0],r)]);case 2:return n.__(2,[t[0],e(t[1],r)]);case 3:return n.__(3,[t[0],e(t[1],r)]);case 4:return n.__(4,[t[0],t[1],t[2],e(t[3],r)]);case 5:return n.__(5,[t[0],t[1],t[2],e(t[3],r)]);case 6:return n.__(6,[t[0],t[1],t[2],e(t[3],r)]);case 7:return n.__(7,[t[0],t[1],t[2],e(t[3],r)]);case 8:return n.__(8,[t[0],t[1],t[2],e(t[3],r)]);case 9:return n.__(9,[e(t[0],r)]);case 10:return n.__(10,[e(t[0],r)]);case 11:return n.__(11,[t[0],e(t[1],r)]);case 12:return n.__(12,[t[0],e(t[1],r)]);case 13:return n.__(13,[t[0],t[1],e(t[2],r)]);case 14:return n.__(14,[t[0],t[1],e(t[2],r)]);case 15:return n.__(15,[e(t[0],r)]);case 16:return n.__(16,[e(t[0],r)]);case 17:return n.__(17,[t[0],e(t[1],r)]);case 18:return n.__(18,[t[0],e(t[1],r)]);case 19:return n.__(19,[e(t[0],r)]);case 20:return n.__(20,[t[0],t[1],e(t[2],r)]);case 21:return n.__(21,[t[0],e(t[1],r)]);case 22:return n.__(22,[e(t[0],r)]);case 23:return n.__(23,[t[0],e(t[1],r)]);case 24:return n.__(24,[t[0],t[1],e(t[2],r)])}}},function(e,t,r){"use strict";var n=r(9),i=r(1);t.chr=function(e){if(e<0||e>255)throw[i.invalid_argument,"Char.chr"];return e},t.escaped=function(e){var t=0;if(e>=40){if(92===e)return"\\\\";t=e>=127?1:2}else if(e>=32){if(e>=39)return"\\'";t=2}else if(e>=14)t=1;else switch(e){case 8:return"\\b";case 9:return"\\t";case 10:return"\\n";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 11:case 12:t=1;break;case 13:return"\\r"}switch(t){case 1:var r=new Array(4);return r[0]=92,r[1]=48+(e/100|0)|0,r[2]=48+(e/10|0)%10|0,r[3]=48+e%10|0,n.bytes_to_string(r);case 2:var i=new Array(1);return i[0]=e,n.bytes_to_string(i)}},t.lowercase=function(e){return e>=65&&e<=90||e>=192&&e<=214||e>=216&&e<=222?e+32|0:e},t.uppercase=function(e){return e>=97&&e<=122||e>=224&&e<=246||e>=248&&e<=254?e-32|0:e},t.compare=function(e,t){return e-t|0}},function(e,t,r){"use strict";var n=r(21),i=r(7),a=r(0),o=r(49),s=r(11),u=r(8),c=r(53),l=r(6);function f(e){return 63&e>>>18}function p(e){var t=e[1].length;return 4!==t?9!==t?16!==t?0|Math.sqrt(t):4:3:2}function h(e,t,r){return[1,[e,t,r]]}function d(e,t){if(t[0]){var r=t[1].length,i=s.caml_make_vect(e,s.caml_array_get(t[1],r-1|0));return n.blit(t[1],0,i,0,r),[1,i]}return[1,s.caml_make_vect(2,s.caml_array_get(t[1],0))]}function m(e,t){return[t[0],n.map(e,t[1])]}function g(e,t,r){return n.init(l.caml_int_min(t.length,r.length),function(n){return a._2(e,s.caml_array_get(t,n),s.caml_array_get(r,n))})}function v(e,t,r){return[t[0],g(e,t[1],r[1])]}function _(e,t,r){return m(a._1(e,s.caml_array_get(t[1],0)),r)}function y(e,t){for(var r=0,n=0,i=e[1].length-1|0;n<=i;++n)r+=s.caml_array_get(e[1],n)*s.caml_array_get(t[1],n);return r}t.pp=function(e,t){var r=t[0];if(r>2||r<0)throw[c.Unexpected_ranks,[r,0]];switch(r){case 0:return o.pp_print_float(e,s.caml_array_get(t[1],0));case 1:a._1(o.fprintf(e,[i.__(18,[i.__(1,[[0,""]]),i.__(12,[40,i.__(8,[9,0,0,0])])]),"@[(%g"]),s.caml_array_get(t[1],0));for(var n=1,l=t[1].length-1|0;n<=l;++n)a._1(o.fprintf(e,[i.__(17,[i.__(0,["@ ",1,0]),i.__(8,[9,0,0,0])]),"@ %g"]),s.caml_array_get(t[1],n));return o.fprintf(e,[i.__(12,[41,i.__(17,[0,0])]),")@]"]);case 2:var f=p(t),h=function(r){a._1(o.fprintf(e,[i.__(18,[i.__(1,[[0,""]]),i.__(12,[124,i.__(8,[11,0,0,0])])]),"@[|% g"]),s.caml_array_get(t[1],u.imul(f,r)));for(var n=1,c=f-1|0;n<=c;++n)a._1(o.fprintf(e,[i.__(17,[i.__(0,["@,",0,0]),i.__(8,[11,0,0,0])]),"@,% g"]),s.caml_array_get(t[1],u.imul(f,r)+n|0));return o.fprintf(e,[i.__(11,[" |",i.__(17,[0,0])])," |@]"])};o.fprintf(e,[i.__(18,[i.__(1,[[i.__(11,["<v>",0]),"<v>"]]),0]),"@[<v>"]),h(0);for(var d=1,m=f-1|0;d<=m;++d)o.pp_print_cut(e,0),h(d);return o.fprintf(e,[i.__(17,[0,0]),"@]"])}},t.scalar=function(e){return[0,[e]]},t.vec2=function(e,t){return[1,[e,t]]},t.vec3=h,t.vec4=function(e,t,r,n){return[1,[e,t,r,n]]},t.vec2$prime=function(e){return e[0]?[1,n.copy(e[1])]:[1,s.caml_make_vect(2,s.caml_array_get(e[1],0))]},t.vec3$prime=function(e){return d(3,e)},t.vec4$prime=function(e){return d(4,e)},t.mat2=function(e,t){var r=t[1],n=e[1];return[2,[s.caml_array_get(n,0),s.caml_array_get(n,1),s.caml_array_get(r,0),s.caml_array_get(r,1)]]},t.mat3=function(e,t,r){var n=r[1],i=t[1],a=e[1];return[2,[s.caml_array_get(a,0),s.caml_array_get(a,1),s.caml_array_get(a,2),s.caml_array_get(i,0),s.caml_array_get(i,1),s.caml_array_get(i,2),s.caml_array_get(n,0),s.caml_array_get(n,1),s.caml_array_get(n,2)]]},t.mat4=function(e,t,r,n){var i=n[1],a=r[1],o=t[1],u=e[1];return[2,[s.caml_array_get(u,0),s.caml_array_get(u,1),s.caml_array_get(u,2),s.caml_array_get(u,3),s.caml_array_get(o,0),s.caml_array_get(o,1),s.caml_array_get(o,2),s.caml_array_get(o,3),s.caml_array_get(a,0),s.caml_array_get(a,1),s.caml_array_get(a,2),s.caml_array_get(a,3),s.caml_array_get(i,0),s.caml_array_get(i,1),s.caml_array_get(i,2),s.caml_array_get(i,3)]]},t.map=m,t.map2=v,t.$plus=function(e,t){return e[0]?t[0]?[e[0],g(function(e,t){return e+t},e[1],t[1])]:_(function(e,t){return e+t},t,e):_(function(e,t){return e+t},e,t)},t.$neg=function(e,t){return e[0]?t[0]?[e[0],g(function(e,t){return e+t},e[1],t[1])]:[e[0],n.init(t[1].length,function(r){return s.caml_array_get(t[1],r)-s.caml_array_get(e[1],0)})]:_(function(e,t){return e-t},e,t)},t.$star=function(e,t){var r=e[0],i=t[0],a=0;if(r>2||r<0)a=1;else switch(r){case 0:return _(function(e,t){return e*t},e,t);case 1:if(1===i)return v(function(e,t){return e*t},e,t);a=2!==i?1:2;break;case 2:if(1!==i){if(2===i){var o=p(e),f=e[1],h=t[1];return[2,n.init(f.length,function(e){for(var t=u.div(e,o),r=u.mod_(e,o),n=0,i=0,a=o-1|0;i<=a;++i)n+=s.caml_array_get(f,u.imul(t,o)+i|0)*s.caml_array_get(h,u.imul(i,o)+r|0);return n})]}a=1}else a=2}switch(a){case 1:if(0!==i)throw[c.Unexpected_ranks,[r,[i,0]]];return _(function(e,t){return e*t},t,e);case 2:var d=l.caml_int_min(e[1].length,t[1].length),m=1===e[0]?[e[1],t[1],d,1]:[t[1],e[1],1,d],g=m[3],y=m[2],b=m[1],x=m[0];return[1,n.init(d,function(e){for(var t=0,r=u.imul(e,y),n=0,i=d-1|0;n<=i;++n)t+=s.caml_array_get(x,n)*s.caml_array_get(b,r),r=g+r|0;return t})]}},t.$slash=function(e,t){return 1===e[0]&&1===t[0]?v(function(e,t){return e/t},e,t):_(function(e,t){return t/e},t,e)},t.$pipe$star$pipe=y,t.norm=function(e){return Math.sqrt(y(e,e))},t.$caret=function(e,t){for(var r=t[1],n=e[1],i=n.length,a=s.caml_make_vect(u.imul(i,i),0),o=0,c=i-1|0;o<=c;++o)for(var l=0,f=i-1|0;l<=f;++l){var p=s.caml_array_get(n,o)*s.caml_array_get(r,l)-s.caml_array_get(n,l)*s.caml_array_get(r,o);s.caml_array_set(a,u.imul(o,i)+l|0,p+s.caml_array_get(a,(o+i|0)+l|0)),s.caml_array_set(a,u.imul(l,i)+o|0,s.caml_array_get(a,(l+i|0)+o|0)-p)}return[2,a]},t.cross=function(e,t){var r=t[1],n=e[1];return 2===n.length?[0,[s.caml_array_get(n,0)*s.caml_array_get(r,1)-s.caml_array_get(n,1)*s.caml_array_get(r,0)]]:h(s.caml_array_get(n,1)*s.caml_array_get(r,2)-s.caml_array_get(n,2)*s.caml_array_get(r,1),s.caml_array_get(n,2)*s.caml_array_get(r,0)-s.caml_array_get(n,0)*s.caml_array_get(r,2),s.caml_array_get(n,0)*s.caml_array_get(r,1)-s.caml_array_get(n,1)*s.caml_array_get(r,0))},t.$pipe$plus$pipe=function(e,t){for(var r=t[1],n=e[1],i=n.length+r.length|0,a=n.length,o=s.caml_make_vect(i,0),u=0,c=a-1|0;u<=c;++u)s.caml_array_set(o,u,s.caml_array_get(n,u));for(var l=a,f=i-1|0;l<=f;++l)s.caml_array_set(o,l,s.caml_array_get(r,l-a|0));return[1,o]},t.floor=function(e){return 0|s.caml_array_get(e[1],0)},t.x=17039360,t.y=17039361,t.z=17039362,t.w=17039363,t.$unknown=function(e,t){return(e+((65535&t)<<function(e){return 255&e>>>16}(e))|0)+(16711680&t)|0},t.xx=33816576,t.yx=33816580,t.zx=33816584,t.wx=33816588,t.xy=33816577,t.yy=33816581,t.zy=33816585,t.wy=33816589,t.xz=33816578,t.yz=33816582,t.zz=33816586,t.wz=33816590,t.xw=33816579,t.yw=33816583,t.zw=33816587,t.ww=33816591,t.slice=function(e,t){var r,i,a,o=e[0];if(o>2||o<0)throw[c.Unexpected_ranks,[o,0]];switch(o){case 0:return[0,[s.caml_array_get(e[1],0)]];case 1:return 1===f(t)?[0,[s.caml_array_get(e[1],15&t)]]:[1,(r=e[1],i=t,a=f(i),n.init(a,function(e){var t=15&(i>>>(e<<2)|0);return s.caml_array_get(r,t)}))];case 2:var l=p(e),h=f(t);if(t>>>24==2)return 1===h?[0,[s.caml_array_get(e[1],u.imul(l,3&t)+(t>>>2&3)|0)]]:[1,n.init(h,function(r){var n=t>>>(r<<3)|0;return s.caml_array_get(e[1],u.imul(l,3&n)+(t>>>2&3)|0)})];if(1===h)return[1,n.init(l,function(r){return s.caml_array_get(e[1],r+u.imul(l,3&t)|0)})];for(var d=s.caml_make_vect(u.imul(l,l),0),m=0,g=l-1|0;m<=g;++m)for(var v=3&(t>>>(m<<3)|0),_=0,y=l-1|0;_<=y;++_)s.caml_array_set(d,u.imul(m,l)+_|0,s.caml_array_get(e[1],u.imul(v,l)+_|0));return[2,d]}},t.get=function(e,t){var r=e[0];if(r>2||r<0)throw[c.Unexpected_ranks,[r,0]];switch(r){case 0:return s.caml_array_get(e[1],0);case 1:return s.caml_array_get(e[1],3&t);case 2:return s.caml_array_get(e[1],(t>>>2&3)+u.imul(p(e),3&t)|0)}}},function(e,t,r){"use strict";var n=r(2),i=n.create("Js_exn.Error");t.$$Error=i,t.internalToOCamlException=function(e){return n.isCamlExceptionOrOpenVariant(e)?e:[i,e]},t.raiseError=function(e){throw new Error(e)},t.raiseEvalError=function(e){throw new EvalError(e)},t.raiseRangeError=function(e){throw new RangeError(e)},t.raiseReferenceError=function(e){throw new ReferenceError(e)},t.raiseSyntaxError=function(e){throw new SyntaxError(e)},t.raiseTypeError=function(e){throw new TypeError(e)},t.raiseUriError=function(e){throw new URIError(e)}},function(e,t,r){"use strict";var n=r(20),i=r(0),a=r(16),o=r(10),s=r(9),u=r(1);function c(e,t){for(var r=e[2];(e[1]+t|0)>r;)r<<=1;var i=s.caml_create_string(r);return n.blit(e[0],0,i,0,e[1]),e[0]=i,e[2]=r,0}function l(e,t){var r=e[1];return r>=e[2]&&c(e,1),e[0][r]=t,e[1]=r+1|0,0}function f(e,t,r,i){if(r<0||i<0||(r+i|0)>t.length)throw[u.invalid_argument,"Buffer.add_substring/add_subbytes"];var a=e[1]+i|0;return a>e[2]&&c(e,i),n.blit_string(t,r,e[0],e[1],i),e[1]=a,0}function p(e,t,r,n){return f(e,s.bytes_to_string(t),r,n)}function h(e,t){var r=t.length,i=e[1]+r|0;return i>e[2]&&c(e,r),n.blit_string(t,0,e[0],e[1],r),e[1]=i,0}function d(e,t,r){if(t>=r)throw u.not_found;var n=s.get(e,t),i=0;if(40!==n){if(123!==n){var o=function(e,t){for(var r=t,n=e.length;;){var i=r;if(i>=n)return n;var a=s.get(e,i),o=0;if(a>=91)if(a>=97){if(a>=123)return i;o=1}else{if(95!==a)return i;o=1}else if(a>=58){if(!(a>=65))return i;o=1}else{if(!(a>=48))return i;o=1}1!==o||(r=i+1|0)}}(e,t+1|0);return[a.sub(e,t,o-t|0),o]}i=1}else i=1;if(1===i){var c=t+1|0,l=function(e,t,r,n,i){for(var a=r,o=i,c=n.length;;){var l=o,f=a;if(l>=c)throw u.not_found;if(s.get(n,l)!==e){if(s.get(n,l)===t){if(f){o=l+1|0,a=f-1|0;continue}return l}o=l+1|0}else o=l+1|0,a=f+1|0}}(n,function(e){if(40!==e){if(123!==e)throw[u.assert_failure,["buffer.ml",126,9]];return 125}return 41}(n),0,e,c);return[a.sub(e,c,(l-t|0)-1|0),l+1|0]}}t.create=function(e){var t=e<1?1:e,r=s.caml_create_string(t);return[r,0,t,r]},t.contents=function(e){return n.sub_string(e[0],0,e[1])},t.to_bytes=function(e){return n.sub(e[0],0,e[1])},t.sub=function(e,t,r){if(t<0||r<0||t>(e[1]-r|0))throw[u.invalid_argument,"Buffer.sub"];return n.sub_string(e[0],t,r)},t.blit=function(e,t,r,i,a){if(a<0||t<0||t>(e[1]-a|0)||i<0||i>(r.length-a|0))throw[u.invalid_argument,"Buffer.blit"];return n.blit(e[0],t,r,i,a)},t.nth=function(e,t){if(t<0||t>=e[1])throw[u.invalid_argument,"Buffer.nth"];return e[0][t]},t.length=function(e){return e[1]},t.clear=function(e){return e[1]=0,0},t.reset=function(e){return e[1]=0,e[0]=e[3],e[2]=e[0].length,0},t.add_char=l,t.add_string=h,t.add_bytes=function(e,t){return h(e,s.bytes_to_string(t))},t.add_substring=f,t.add_subbytes=p,t.add_substitute=function(e,t,r){for(var n=r.length,a=32,o=0;;){var u=o,c=a;if(!(u<n))return 92===c?l(e,c):0;var f=s.get(r,u);if(36===f)if(92!==c){var p=d(r,u+1|0,n);h(e,i._1(t,p[0])),o=p[1],a=32}else l(e,f),o=u+1|0,a=32;else{if(92===c){l(e,92),l(e,f),o=u+1|0,a=32;continue}if(92!==f){l(e,f),o=u+1|0,a=f;continue}o=u+1|0,a=f}}},t.add_buffer=function(e,t){return p(e,t[0],0,t[1])},t.add_channel=function(e,t,r){if(r<0)throw[u.invalid_argument,"Buffer.add_channel"];return(e[1]+r|0)>e[2]&&c(e,r),o.really_input(t,e[0],e[1],r),e[1]=e[1]+r|0,0},t.output_buffer=function(e,t){return o.output(e,t[0],0,t[1])}},function(e,t,r){"use strict";t.positionAttrName="aa_position"},function(e,t,r){"use strict";var n=r(0),i=r(4),a=r(2),o=r(13),s=r(18),u=a.create("ShaderCopy-Rts.Bug"),c=i.vec2uniform("u_resolution"),l=i.sampler2Duniform("t_input"),f=i.body(function(){return i.$eq$at(i.gl_Position,i.$star(i.$star(i.u_projectionMatrix,i.u_modelViewMatrix),i.vec4(i.$pipe$plus$pipe(i.$star$star$dot(i.gl_Vertex,i.xyz$prime),i.f(1)))))}),p=i.body(function(){return i.$eq$at(i.gl_FragColor,i.texture(l,i.$slash(i.$star$star$dot(i.gl_FragCoord,i.xy$prime),c))),i.$eq$at(i.$star$star$dot(i.gl_FragColor,i.a$prime),i.f(1))}),h=i.f(.5),d=i.$star(i.$plus(i.$plus(i.$plus(i.f(.1),i.f(.002)),i.f(5e-4)),i.f(25e-5)),h),m=i.vec2arg("uv"),g=i.body(function(){var e=i.floatvar("value");return i.$eq$at(e,i.$plus(i.$plus(i.$plus(i.$plus(i.$star(s.snoise(i.$star(m,i.f(1.63))),i.f(.1)),i.$star(s.snoise(i.$star(m,i.f(10))),i.f(.002))),i.$star(s.snoise(i.$star(m,i.f(20))),i.f(5e-4))),i.$star(s.snoise(i.$star(m,i.f(40))),i.f(25e-5))),i.$star(s.snoise(i.$star(m,i.f(20))),i.f(.01)))),i.$$return(i.$star(e,i.f(2)))});function v(e){return i.fundecl1(i.floatfun("heightmap"),m,g,e)}var _=i.body(function(){var e=i.floatvar("value");i.$eq$at(e,i.$plus(i.$plus(i.$plus(i.$star(s.snoise(i.$star(m,i.f(1.63))),i.f(.1)),i.$star(s.snoise(i.$star(m,i.f(10))),i.f(.002))),i.$star(s.snoise(i.$star(m,i.f(20))),i.f(5e-4))),i.$star(s.snoise(i.$star(m,i.f(40))),i.f(25e-5))));var t=s.snoise(i.$star(m,i.f(1)));return i.ifstmt(i.$less(t,i.f(0)),function(){return i.$plus$eq(e,i.$star(s.snoise(i.$star(m,i.f(40))),i.f(.005)))}),i.$$return(i.$star(e,i.f(2)))});function y(e){return i.fundecl1(i.floatfun("heightmap"),m,_,e)}function b(e){return i.body(function(){var t=i.vec2var("uv");i.$eq$at(t,i.$slash(i.$star$star$dot(i.gl_FragCoord,i.xy$prime),c));var r=i.floatvar("value"),a=i.$slash(i.vec21f(i.f(1)),c),o=i.$star$star$dot(a,i.x$prime),s=e?v:y;i.$eq$at(r,n._1(s,t));var u=i.$neg(n._1(s,i.vec22f(i.$neg(i.$star$star$dot(t,i.x$prime),o),i.$star$star$dot(t,i.y$prime))),n._1(s,i.vec22f(i.$plus(i.$star$star$dot(t,i.x$prime),o),i.$star$star$dot(t,i.y$prime)))),l=i.$star(i.f(2),o),f=i.$neg(n._1(s,i.vec22f(i.$star$star$dot(t,i.x$prime),i.$neg(i.$star$star$dot(t,i.y$prime),o))),n._1(s,i.vec22f(i.$star$star$dot(t,i.x$prime),i.$plus(i.$star$star$dot(t,i.y$prime),o)))),p=i.vec3var("normal");return i.$eq$at(p,i.vec33f(u,l,f)),i.$eq$at(p,i.normalize(p)),e||i.$eq$at(p,i.vec31f(i.f(0))),i.$eq$at(i.gl_FragColor,i.vec44f(i.$star(r,h),i.$star$star$dot(p,i.x$prime),i.$star$star$dot(p,i.y$prime),i.$star$star$dot(p,i.z$prime)))})}function x(e){return[o.registerUniform(i.u_modelViewMatrix,function(e){return e[6]}),[o.registerUniform(i.u_projectionMatrix,function(e){return e[7]}),[o.registerUniform(c,function(e){return[e[3],e[4]]}),[o.registerTextureUniform(l,function(){var t=e[0];if(t)return t[0];throw[u,"uninitialized shader texture copy"]}),0]]]]}function w(){return[o.registerUniform(i.u_modelViewMatrix,function(e){return e[6]}),[o.registerUniform(i.u_projectionMatrix,function(e){return e[7]}),[o.registerUniform(c,function(e){return[e[3],e[4]]}),[o.registerUniform(i.u_time,function(e){return[e[1]]}),0]]]]}var $=window.partialMemoize0(function(){var e=w();return[e,i.getProgram(e,f,b(1))]}),E=window.partialMemoize0(function(){var e=w();return[e,i.getProgram(e,f,b(0))]}),M=o.registerUniform;t.Bug=u,t.u_resolution=c,t.input=l,t.vertexShader=f,t.fragmentShader=p,t.scale=h,t.maxHeight=d,t.uv=m,t.heightMapBody=g,t.heightMap=v,t.heightMapBody2=_,t.heightMap2=y,t.randomFragmentShader=b,t.r=M,t.getUniforms=x,t.getUniforms2=w,t.makeProgramSource=function(e){var t=x(e);return[t,i.getProgram(t,f,p)]},t.makeRandomProgramSource=$,t.makeRandomProgramSource2=E},function(e,t,r){"use strict";t.bind=function(e,t){return null==e?e:t(e)},t.iter=function(e,t){return null==e?0:t(e)},t.from_opt=function(e){return e?e[0]:void 0}},function(e,t,r){"use strict";var n=r(5),i=r(7),a=r(0),o=r(16),s=r(19),u=r(73),c=r(83),l=[0],f=[0];var p=[0,0,0];function h(e,t,r,i,c,h,d){var m,g=[(m=a._1(r,o.concat("/",e)),m?m[0]:t)];if(!p[0]){var v=u.create_table(["path","registerUpdate","choices","get","set","pathStr"]),_=u.new_variable(v,""),y=u.get_method_labels(v,["set","registerUpdate","pathStr","path","get","choices","blah"]),b=y[0],x=y[1],w=y[2],$=y[3],E=y[4],M=y[5],T=y[6];u.set_methods(v,[T,function(e){return e},$,function(e){return e[_][3]},w,function(e){return e[_][5]},E,function(e){return e[_][2]},b,function(e,t){var r=e[_];return r[6][0]=t,a._2(r[4],a._1(r[5],r[3]),t),n.iter(function(e){return a._1(e,t)},r[1][0])},x,function(e,t){var r=e[_];return a._1(t,a._1(r[2],0)),r[1][0]=[t,r[1][0]],0},M,function(e){return e[_][0]}]);u.init_class(v),p[0]=function(e){var t=u.create_object_opt(0,v);return t[_]=e,t}}var S=[h,[0],function(){return g[0]},e,i,function(e){return o.concat("/",e)},g],A=a._1(p[0],S);return s.js2(5741474,2,A,s.js2(5144726,1,A,0)),n.iter(function(e){return a._1(e,a._1(c,A))},f[0]),l[0]=[a._1(c,A),l[0]],A}t.configVars=l,t.createVarCallbacks=f,t.addCreateVarCallBack=function(e){return n.iter(a.__1(e),n.rev(l[0])),f[0]=[e,f[0]],0},t.configVar=h,t.colorConfigVar=function(e,t){var r=function(e){var t=c.getInt(e+".r"),r=c.getInt(e+".g"),n=c.getInt(e+".b"),i=c.getFloat(e+".a");return t&&r&&n&&i?[[t[0],r[0],n[0],i[0]]]:0},n=function(e,t){return c.setInt(e+".r",t[0]+0|0),c.setInt(e+".g",t[1]+0|0),c.setInt(e+".b",t[2]+0|0),c.setFloat(e+".a",t[3]),0},a=function(e){return i.__(3,[e])};return function(i,o){return h(e,t,r,n,a,i)}},t.intConfigVar=function(e,t,r,n){return h(e,t,c.getInt,c.setInt,function(e){return i.__(0,[e])},r)},t.floatConfigVar=function(e,t,r,n){return h(e,t,c.getFloat,c.setFloat,function(e){return i.__(1,[e])},r)},t.stringConfigVar=function(e,t,r,n){return h(e,t,c.getString,c.setString,function(e){return i.__(2,[e])},r)}},function(e,t,r){"use strict";var n=r(11),i=r(1),a=n.caml_make_vect(1e3,0);t.caml_get_public_method=function(e,t,r){var n=e[0],o=a[r];return n[o]===t?n[o-1|0]:n[function(e){for(;;){var o=e;if(o<3)throw[i.assert_failure,["caml_oo.ml",59,20]];if(n[o]===t)return a[r]=o,o;e=o-2|0}}(1+(n[0]<<1)|0)-1|0]}},function(e,t,r){"use strict";t.is_nil_undef=function(e){return null===e?1:+(void 0===e)},t.null_undefined_to_opt=function(e){return null===e||void 0===e?0:[e]},t.undefined_to_opt=function(e){return void 0===e?0:[e]},t.null_to_opt=function(e){return null===e?0:[e]},t.option_get=function(e){return e?e[0]:void 0},t.option_get_unwrap=function(e){return e?e[0][1]:void 0}},function(e,t,r){"use strict";var n=r(4),i=r(17),a=r(19),o=r(29),s=r(28),u=r(2),c=r(13),l=r(18),f=u.create("ShaderTerrain-Rts.Bug"),p=n.vec2attr("a_uv"),h=n.vec2varying("v_uv"),d=n.sampler2Duniform("t_input"),m=n.sampler2Duniform("t_input2"),g=n.sampler2Duniform("heightMap"),v=n.vec22f(n.$slash(n.f(2),n.f(i.getWidth(0))),n.$slash(n.f(2),n.f(i.getHeight(0)))),_=n.vec3varying("v_normal"),y=n.vec3uniform("light"),b=n.floatvarying("height"),x=n.floatuniform("u_terrainScale"),w=n.body(function(){n.$eq$at(h,p);var e=n.vec3var("position");n.$eq$at(e,n.$star$star$dot(n.gl_Vertex,n.xyz$prime));var t=n.vec2var("uv");n.$eq$at(t,n.$plus(n.$star(n.$star(n.$star$star$dot(e,n.xy$prime),n.f(.5)),v),n.f(.5)));var r=n.vec4var("heightNormal");n.$eq$at(r,n.texture(g,t));var i=n.vec3var("normal");return n.$eq$at(i,n.$star$star$dot(r,n.yzw$prime)),n.$eq$at(_,i),n.$eq$at(b,n.$star$star$dot(r,n.x$prime)),n.$star$eq(n.$star$star$dot(e,n.xy$prime),n.$star(x,v)),n.$eq$at(n.gl_Position,n.$star(n.$star(n.u_projectionMatrix,n.u_modelViewMatrix),n.vec4(n.$pipe$plus$pipe(e,n.f(1)))))});function $(e,t){return n.$plus(n.$star(l.snoise(n.$plus(n.$star(e,n.f(5)),l.snoise(n.$plus(e,n.$slash(t,n.f(10)))))),n.f(.5)),n.f(1.2))}var E=n.body(function(){var e=n.vec3var("color"),t=n.vec3var("diffuse"),r=n.vec2var("uv");n.$eq$at(r,h),n.$eq$at(e,n.$star$star$dot(n.texture(d,n.$star(r,n.f(10))),n.rgb$prime));var a=n.f(.015),s=n.max(n.$neg(a,b),n.f(0)),u=n.$star(n.$star(n.f(5),s),i.heightMultiplier);n.$plus$eq(n.$star$star$dot(e,n.r$prime),u),n.$eq$at(n.$star$star$dot(e,n.g$prime),n.mix(n.$star$star$dot(e,n.g$prime),n.$slash(n.$star$star$dot(e,n.r$prime),n.f(2.5)),n.min(n.$star(s,n.f(100)),n.f(1))));var c=n.dot(n.$star$star$dot(e,n.rgb$prime),n.vec33f(n.f(.299),n.f(.587),n.f(.114)));return n.$star$eq(e,n.$star(n.pow(c,o.rand(r)),n.f(2))),n.$eq$at(t,n.$star(e,n.clamp(n.$star(n.dot(_,y),$(r,n.u_time)),n.f(0),n.f(1.5)))),n.$eq$at(n.gl_FragColor,n.vec4(n.$pipe$plus$pipe(t,n.f(1))))}),M=[0],T=c.registerTextureUniform(d,function(e){var t=M[0],r=t?t[0]:c.getNewTexture(e[0],"resources/grass.jpg");return M[0]=[r],r}),S=[0],A=c.registerTextureUniform(m,function(e){var t=S[0],r=t?t[0]:c.getNewTexture(e[0],"resources/tiles.jpg");return S[0]=[r],r});function z(e){return[c.registerUniform(n.u_modelViewMatrix,function(e){return e[6]}),[c.registerUniform(n.u_projectionMatrix,function(e){return e[7]}),[c.registerUniform(n.u_time,function(e){return[e[1]]}),[c.registerUniform(x,function(){return[a.js2(5144726,1,s.terrainScale,0)]}),[c.registerUniform(y,function(){var e=a.js2(5144726,2,s.lightX,0),t=a.js2(5144726,3,s.lightY,0),r=a.js2(5144726,4,s.lightZ,0),n=o.normalize(e,t,r);return[n[0],n[1],n[2]]}),[T,[A,[c.registerTextureUniform(g,function(){var t=e[0];if(t)return t[0];throw[f,"uninitialized shader texture copy"]}),0]]]]]]]]}var R=window.partialMemoize1(function(e){var t=z(e);return[t,n.getProgram(t,w,E)]}),C=c.registerUniform;t.Bug=f,t.a_uv=p,t.v_uv=h,t.input=d,t.input2=m,t.heightMap=g,t.uvMul=v,t.vNormal=_,t.light=y,t.height=b,t.terrainScale=x,t.vertexShader=w,t.getClouds=$,t.fragmentShader=E,t.r=C,t.tilesTexture=M,t.registeredTiles=T,t.tiles2Texture=S,t.registeredTiles2=A,t.getUniforms=z,t.makeProgramSource=R},function(e,t,r){"use strict";function n(){this.cache=Object.create(null)}n.prototype.has=function(e){return e in this.cache},n.prototype.get=function(e){return this.cache[e]},n.prototype.set=function(e,t){this.cache[e]=t};window.partialMemoize0=function(e){var t=new n;return function(e,t){var r=JSON.stringify([]),n=e.get(r);return void 0===n&&(n=t(),e.set(r,n)),n}.bind(this,t,e)},window.partialMemoize1=function(e){var t=new n;return function(e,t,r){var n=[r],i=JSON.stringify(n),a=e.get(i);return void 0===a&&(a=t(r),e.set(i,a)),a}.bind(this,t,e)},window.partialMemoize2=function(e){var t=new n;return function(e,t,r,n){var i=[r,n],a=JSON.stringify(i),o=e.get(a);return void 0===o&&(o=t(r,n),e.set(a,o)),o}.bind(this,t,e)},window.partialMemoize3=function(e){var t=new n;return function(e,t,r,n,i){var a=[r,n,i],o=JSON.stringify(a),s=e.get(o);return void 0===s&&(s=t(r,n,i),e.set(o,s)),s}.bind(this,t,e)},window.partialMemoize4=function(e){var t=new n;return function(e,t,r,n,i,a){var o=[r,n,i,a],s=JSON.stringify(o),u=e.get(s);return void 0===u&&(u=t(r,n,i,a),e.set(s,u)),u}.bind(this,t,e)};var i=r(45);void 0===window.iteration&&(window.iteration=0),window.iteration++,void 0===window.memoizeId&&(window.memoizeId=0),void 0!==window.destroy&&window.destroy(),window.destroy=i.main()},function(e,t,r){"use strict";var n=r(0),i=r(4),a=r(55),o=r(56),s=r(58),u=r(8),c=r(10),l=r(60),f=r(69),p=r(71),h=r(17),d=r(72),m=r(26),g=r(42),v=r(86),_=r(19),y=r(28),b=r(38),x=r(87),w=r(2),$=r(89),E=r(13),M=r(90),T=r(43),S=r(91),A=[[0,0]],z=w.create("Demo-Rts.NoGL"),R=w.create("Demo-Rts.No2D"),C=w.create("Demo-Rts.NoProgram"),L=w.create("Demo-Rts.NoTimerQuery"),P=w.create("Demo-Rts.NoDerivativesExtension"),U=w.create("Demo-Rts.NoElementIndexExtension"),I=w.create("Demo-Rts.Bug"),O=window.partialMemoize2(M.makeProgramSource),N=window.partialMemoize1(function(e){return S.Water[7](e)}),k=window.partialMemoize1(function(e){return S.Water[8](e)}),D=window.partialMemoize1(b.makeProgramSource),F=window.partialMemoize3(function(e,t,r){var n=r[4],i=r[5],a=x.createShader(e,e.VERTEX_SHADER,n);a||(console.log("Vertex shader:"),console.log(v.lineNumbers(n)));var o=x.createShader(e,e.FRAGMENT_SHADER,i);return o||(console.log("Fragment shader:"),console.log(v.lineNumbers(i))),[t,a&&o?x.createProgram(e,a[0],o[0]):0]});function B(e){return m.body.innerHTML="<h1 style='color: red;'>"+e+"</h1>",0}function G(){m.body.style.margin="0px",m.body.style.overflow="hidden";var e=document.createElement("canvas");document.body.appendChild(e),console.log(navigator.userAgent);var t,r=-1!==navigator.userAgent.indexOf("Chromium/62")||-1===navigator.userAgent.indexOf("Windows")?[g.null_undefined_to_opt(e.getContext("webgl")),1]:[g.null_undefined_to_opt(e.getContext("webgl2")),2],n=r[0];if(n){var a=n[0];p.setMemoizeId(a),t=[a,r[1]]}else{var o=e.getContext("webgl");if(null==o)throw B("No WebGL2!"),z;p.setMemoizeId(o),t=[o,1]}var s=t[1],u=t[0];!function(){var e=document.createElement("div");document.body.appendChild(e);var t=e.style;t.position="fixed",t.top="80px",t.left="0px",e.innerHTML='<a href="https://github.com/emnh/rts-reasonml">GitHub</<a>'}(),function(){var e=document.createElement("div");document.body.appendChild(e);var t=e.style;t.position="fixed",t.top="100px",t.left="0px",e.innerHTML="Using WebGL ver: "+c.string_of_int(s)}(),u.MY_VERSION=s,i.webGLVersion[0]=s;var l=function(){var t=m.$$window.innerWidth,r=m.$$window.innerHeight;return e.width=t,e.height=r,A[0][0]=t,A[0][1]=r,0};return m.$$window.addEventListener("resize",l),l(),m.$$window.addEventListener("DOMContentLoaded",l),d.init(0),[e,u]}var V=window.partialMemoize2(function(e,t){var r;switch(t){case"BigPlane":r=s.createBigPlaneGeometry(0);break;case"Box":r=s.createBoxGeometry(0);break;case"Plane":r=s.createPlaneGeometry(0);break;case"Quad":r=s.createQuadGeometry(0);break;case"Sphere":r=s.createSphereGeometry(0);break;case"Trees":r=s.createTreesGeometry(0);break;default:r=s.createBoxGeometry(0)}return[r,x.createBuffers(e,r),0]});function H(e,t){var r=[_.js2(5144726,1,y.cameraX,0),_.js2(5144726,2,y.cameraY,0)*h.getTileWidth(0),_.js2(5144726,3,y.cameraZ,0)*h.getTileHeight(0)],i=[_.js2(5144726,4,y.cameraRotationX,0),_.js2(5144726,5,y.cameraRotationY,0),_.js2(5144726,6,y.cameraRotationZ,0)];return[n._4(s.getCamera,e,t,r,i),r]}function j(e,t,r,n,i,a,o,u,c,l,f,p,h,d,m){var g=s.getObjectMatrix(o,a,u),v=s.getViewMatrices(r[0],g[0],h),_=E.computeUniformBlock(e,f,c,l,r[1],g[0].elements,v[0],v[1],m,p);return x.renderObject(e,t,n,_[2],i,_[0],_[1],d)}var W=window.partialMemoize3(function(e,t,r){var n=function(){return 2*(Math.random()-.5)*r};return[n(),n(),0]}),q=window.partialMemoize3(function(e,t,r){var n=function(){return 2*Math.random()*r};return[n(),n(),n()]}),X=window.partialMemoize4(function(e,t,r,n){return x.createRenderTarget(e,t,r)});function Y(e,t,r,i,a,o,u){var c=r?0:1,l=function(){if(r)return r[0];throw I},f=c?A[0][0]:l()[0],h=c?A[0][1]:l()[1],d=n._3(F,e,i[0],i[1]),m=d[1];if(m){var g=m[0],v=d[0];p.setMemoizeId(g);var b=n._2(V,e,a),w=b[2],$=b[1];x.preRender(e,f,h),Math.seedrandom(_.js2(5144726,8,y.seed,0),{entropy:!0});for(var E=[0,0,0],M=function(r){return j(e,g,[n._4(s.getCamera,f,h,E,[0,0,0]),E],$,w,[2,2,2],[0,0,-1],[0,0,0],f,h,t,v,0,o,r)},T=0,S=u-1|0;T<=S;++T)c?M(T):x.renderToTarget(e,l(),function(e){return function(){return M(e)}}(T));return 0}throw C}function J(e,t,r,i,o,s){var u=A[0][0],c=A[0][1],l=n._3(F,e,r[0],r[1]),f=l[1];if(f){var d=f[0],g=l[0];p.setMemoizeId(d),m.$$window.debug=e,m.$$window.debug=g,Math.seedrandom(_.js2(5144726,19,y.seed,0),{entropy:!0});for(var v=n._2(V,e,o),b=v[2],x=v[1],w=1;w<=s;++w){var $=_.js2(5144726,20,y.objectX,0),E=_.js2(5144726,21,y.objectY,0),M=_.js2(5144726,22,y.objectZ,0),T=$+0*h.getWidth(0),S=M+0*h.getHeight(0),z=n._3(W,w,_.js2(5144726,24,y.seed,0),_.js2(5144726,23,y.spread,0)),R=T+z[0],L=E+z[1],P=S+z[2],U=n._3(q,w,_.js2(5144726,26,y.seed,0),_.js2(5144726,25,y.rotationSpread,0)),I=_.js2(5144726,27,y.rotationSpeed,0),O=I*Math.sin(t)*2*a.pi+U[0],N=I*Math.sin(.35*t)*2*a.pi+U[1],k=I*Math.sin(.73*t)*2*a.pi+U[2],D=_.js2(5144726,28,y.size,0),B=w,G=H(u,c),X=G[0];X.lookAt(0,0,0),j(e,d,[X,G[1]],x,b,[D,D,D],[R,L,P],[O,N,k],u,c,t*(1+B/s)+B,g,0,i,w-1|0)}return 0}throw C}var Z=[0],K=[0],Q=[0],ee=[0],te=[0],re=window.partialMemoize3(function(e,t,r){var i=e.createQuery(),a=function(r){return e.beginQuery(t.TIME_ELAPSED_EXT,i),n._1(r,0),e.endQuery(t.TIME_ELAPSED_EXT),0},o=[0];return a(function(){return 0}),[a,function(){var r=+e.getQueryParameter(i,e.QUERY_RESULT_AVAILABLE),n=+e.getParameter(t.GPU_DISJOINT_EXT);if(r&&!n){var a=e.getQueryParameter(i,e.QUERY_RESULT)/1e3|0;return o[0]=a,[a]}return 0},function(){return o[0]}]}),ne=window.partialMemoize0(function(){var e=document.createElement("div");document.body.appendChild(e);var t=e.style;return t.position="fixed",t.top="140px",t.left="0",e});function ie(e,t,r){if(t){var i=t[0],a=n._3(re,e,i,"Default"),o=n._3(re,e,i,r),s=n._1(ne,0),u=n._1(o[1],0);if(u){var l=document.createElement("p");return l.innerHTML=r+":"+c.string_of_int(u[0])+"ms",s.appendChild(l),o[0]}var f=document.createElement("p");return f.innerHTML=r+":"+c.string_of_int(n._1(o[2],0))+"ms",s.appendChild(f),a[0]}return function(e){return n._1(e,0)}}function ae(e,t,r){var i=h.getTileWidth(0)<<7,a=i<256?256:i,o=n._4(X,e,a,a,"wrt1"),s=n._4(X,e,a,a,"wrt2"),c=n._4(X,e,1024,1024,"wrt3"),l=n._4(X,e,1024,1024,"wrt4"),f=n._4(X,e,1024,1024,"wrt5"),p=function(){return Z[0]=(Z[0]+1|0)%2,0!==Z[0]?s:o},d=p();n._1(ne,0).innerHTML="",ee[0]||Y(e,r,[f],n._1(b.makeRandomProgramSource,0),"Quad",ie(e,t,"HeightMap"),1),ee[0]=[f[3]],K[0]||Y(e,r,[d],n._1(b.makeRandomProgramSource2,0),"Quad",ie(e,t,"Initial wave"),1),K[0]=[d[3]];var m=p();Y(e,r,[m],n._1(N,K),"Quad",ie(e,t,"Waves"),1),K[0]=[m[3]];var g=p();Y(e,r,[g],n._1(N,K),"Quad",ie(e,t,"Waves2"),1),K[0]=[g[3]];var v=p();Y(e,r,[v],n._1(k,K),"Quad",ie(e,t,"Normals"),1),K[0]=[v[3]],Y(e,r,[c],n._1(S.Renderer[75],K),"Plane",ie(e,t,"Caustics"),1),Q[0]=[c[3]],Y(e,r,[l],n._1(T.makeProgramSource,ee),"BigPlane",ie(e,t,"Render terrain"),1);var w=u.imul(h.getTileWidth(0),h.getTileHeight(0));te[0]=[l[3]],x.preRender(e,A[0][0],A[0][1]);var E=_.js2(5144726,29,y.geometryType,0);return J(e,r,n._4(S.Renderer[74],K,Q,te,ee),ie(e,t,"Render water"),E,w),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.enable(e.BLEND),J(e,r,n._1($.makeProgramSource,ee),ie(e,t,"Render trees"),"Trees",w),e.enable(e.DEPTH_TEST),e.disable(e.BLEND),0}function oe(e,t,r,n,i,a,o){var s=Date.now()-n;return r.begin(),ae(a,t,s/1e3),r.end(),m.$$window.iteration===o?(requestAnimationFrame(function(){return oe(e,t,r,n,i,a,o)}),0):(document.body.removeChild(i),console.log("exiting render loop "+c.string_of_int(o)+" due to hot reload"),0)}var se=ie;t.$$Date=[],t.state=A,t.twist=0,t.NoGL=z,t.No2D=R,t.NoProgram=C,t.NoTimerQuery=L,t.NoDerivativesExtension=P,t.NoElementIndexExtension=U,t.Bug=I,t.getShaderExampleProgram=O,t.getWaterProgram=N,t.getWaterNormalProgram=k,t.getCopyProgram=D,t.getShaderProgram=F,t.showError=B,t.setupDocument=G,t.getGeometryAndBuffers=V,t.getCamera=H,t.renderObj=j,t.seedrandom=function(e){return l.seedrandom(e),0},t.getPosition=W,t.getRotation=q,t.getWaterRT=X,t.runFrameBuffer=Y,t.run=J,t.targetIndex=Z,t.textureRef=K,t.causticsRef=Q,t.heightMapRef=ee,t.terrainRenderRef=te,t.getMeasure=re,t.reportElement=ne,t.doMeasure2=ie,t.doMeasure=se,t.runPipeline=ae,t.runDemo=function(e,t){var r=_.js2(5144726,30,y.foregroundColor,0),i=_.js2(5144726,31,y.backgroundColor,0),a=n._2(O,r,i);return function(r,n,i){return J(e,t,a,r,n,i)}},t.renderLoop=oe,t.main=function(){var e=G(),t=e[1],r=Date.now(),i=m.$$window.iteration,a=n._1(o.createStats,0),s=a.dom;document.body.appendChild(s),s.style.margin="10px";var u=t.getExtension("EXT_disjoint_timer_query_webgl2"),c=null==u?0:[u],l=f.createReset(t);if(1===t.MY_VERSION){if(null===t.getExtension("OES_standard_derivatives"))throw B("No OES_standard_derivatives extension to WebGL1!"),P;if(null===t.getExtension("OES_element_index_uint"))throw B("No OES_element_index_uint extension to WebGL1!"),U}return oe(l,c,a,r,e[0],t,i),function(){return console.log("destroying last app generation"),d.destroy(0)}}},function(e,t,r){"use strict";var n=r(5),i=r(0),a=r(1);t.Make=function(e){var t=function(e){return e?e[3]:0},r=function(e,t,r){var n=e?e[3]:0,i=r?r[3]:0;return[e,t,r,n>=i?n+1|0:i+1|0]},o=function(e,n,i){var o=e?e[3]:0,s=i?i[3]:0;if(o>(s+2|0)){if(e){var u=e[2],c=e[1],l=e[0];if(t(l)>=t(u))return r(l,c,r(u,n,i));if(u)return r(r(l,c,u[0]),u[1],r(u[2],n,i));throw[a.invalid_argument,"Set.bal"]}throw[a.invalid_argument,"Set.bal"]}if(s>(o+2|0)){if(i){var f=i[2],p=i[1],h=i[0];if(t(f)>=t(h))return r(r(e,n,h),p,f);if(h)return r(r(e,n,h[0]),h[1],r(h[2],p,f));throw[a.invalid_argument,"Set.bal"]}throw[a.invalid_argument,"Set.bal"]}return[e,n,i,o>=s?o+1|0:s+1|0]},s=function(t,r){if(r){var n=r[2],a=r[1],u=r[0],c=i._2(e[0],t,a);return c?c<0?o(s(t,u),a,n):o(u,a,s(t,n)):r}return[0,t,0,1]},u=function(e){return[0,e,0,1]},c=function(e,t){return t?o(c(e,t[0]),t[1],t[2]):u(e)},l=function(e,t){return t?o(t[0],t[1],l(e,t[2])):u(e)},f=function(e,t,n){if(e){if(n){var i=n[3],a=e[3];return a>(i+2|0)?o(e[0],e[1],f(e[2],t,n)):i>(a+2|0)?o(f(e,t,n[0]),n[1],n[2]):r(e,t,n)}return l(t,e)}return c(t,n)},p=function(e){for(;;){var t=e;if(t){var r=t[0];if(r){e=r;continue}return t[1]}throw a.not_found}},h=function(e){if(e){var t=e[0];return t?o(h(t),e[1],e[2]):e[2]}throw[a.invalid_argument,"Set.remove_min_elt"]},d=function(e,t){return e?t?f(e,p(t),h(t)):e:t},m=function(t,r){if(r){var n=r[2],a=r[1],o=r[0],s=i._2(e[0],t,a);if(s){if(s<0){var u=m(t,o);return[u[0],u[1],f(u[2],a,n)]}var c=m(t,n);return[f(o,a,c[0]),c[1],c[2]]}return[o,1,n]}return[0,0,0]},g=function(t,r){if(r){var n=r[2],a=r[1],s=r[0],u=i._2(e[0],t,a);if(u)return u<0?o(g(t,s),a,n):o(s,a,g(t,n));var c=s,l=n;return c?l?o(c,p(l),h(l)):c:l}return 0},v=function(e,t){if(e){if(t){var r=t[3],n=t[1],i=e[3],a=e[1];if(i>=r){if(1===r)return s(n,e);var o=m(a,t);return f(v(e[0],o[0]),a,v(e[2],o[2]))}if(1===i)return s(a,t);var u=m(n,e);return f(v(u[0],t[0]),n,v(u[2],t[2]))}return e}return t},_=function(e,t){if(e){if(t){var r=e[2],n=e[1],i=e[0],a=m(n,t),o=a[0];return 0!==a[1]?f(_(i,o),n,_(r,a[2])):d(_(i,o),_(r,a[2]))}return 0}return 0},y=function(e,t){if(e){if(t){var r=e[2],n=e[1],i=e[0],a=m(n,t),o=a[0];return 0!==a[1]?d(y(i,o),y(r,a[2])):f(y(i,o),n,y(r,a[2]))}return e}return 0},b=function(e,t){for(;;){var r=t,n=e;if(!n)return r;t=[n[1],n[2],r],e=n[0]}},x=function(t,r){for(var n=b(t,0),a=b(r,0);;){var o=a,s=n;if(s){if(o){var u=i._2(e[0],s[0],o[0]);if(0!==u)return u;a=b(o[1],o[2]),n=b(s[1],s[2]);continue}return 1}return o?-1:0}},w=function(t,r){for(;;){var n=r,a=t;if(a){if(n){var o=n[2],s=n[0],u=a[2],c=a[1],l=a[0],f=i._2(e[0],c,n[1]);if(f){if(f<0){if(w([l,c,0,0],s)){t=u;continue}return 0}if(w([0,c,u,0],o)){t=l;continue}return 0}if(w(l,s)){r=o,t=u;continue}return 0}return 0}return 1}},$=function(e,t){for(;;){var r=t;if(!r)return 0;$(e,r[0]),i._1(e,r[1]),t=r[2]}},E=function(e,t,r){for(;;){var n=r,a=t;if(!a)return n;r=i._2(e,a[1],E(e,a[0],n)),t=a[2]}},M=function(e,t){for(;;){var r=t;if(r){if(i._1(e,r[1])){if(M(e,r[0])){t=r[2];continue}return 0}return 0}return 1}},T=function(e,t){for(;;){var r=t;if(!r)return 0;if(i._1(e,r[1]))return 1;if(T(e,r[0]))return 1;t=r[2]}},S=function(e,t){if(t){var r=t[1],n=S(e,t[0]),a=i._1(e,r),o=S(e,t[2]);return a?f(n,r,o):d(n,o)}return 0},A=function(e,t){if(t){var r=t[1],n=A(e,t[0]),a=n[1],o=n[0],s=i._1(e,r),u=A(e,t[2]),c=u[1],l=u[0];return s?[f(o,r,l),d(a,c)]:[d(o,l),f(a,r,c)]}return[0,0]},z=function(e){return e?(z(e[0])+1|0)+z(e[2])|0:0},R=function(e,t){for(;;){var r=t,n=e;if(!r)return n;t=r[0],e=[r[1],R(n,r[2])]}};return[0,function(e){return e?0:1},function(t,r){for(;;){var n=r;if(n){var a=i._2(e[0],t,n[1]);if(a){r=a<0?n[0]:n[2];continue}return 1}return 0}},s,u,g,v,_,y,x,function(e,t){return+(0===x(e,t))},w,$,E,M,T,S,A,z,function(e){return R(0,e)},p,function(e){for(;;){var t=e;if(t){var r=t[2];if(r){e=r;continue}return t[1]}throw a.not_found}},p,m,function(t,r){for(;;){var n=r;if(n){var o=n[1],s=i._2(e[0],t,o);if(s){r=s<0?n[0]:n[2];continue}return o}throw a.not_found}},function(t){if(t){var i=t[1],o=t[0];if(i){var c=i[1],l=i[0];if(c){var f=c[1],p=c[0];if(f){var h=f[1],d=f[0];if(h){if(h[1]){var m=n.sort_uniq(e[0],t),g=function(e,t){var n=0;if(e>3||e<0)n=1;else switch(e){case 0:return[0,t];case 1:if(t)return[[0,t[0],0,1],t[1]];n=1;break;case 2:if(t){var i=t[1];if(i)return[[[0,t[0],0,1],i[0],0,2],i[1]];n=1}else n=1;break;case 3:if(t){var o=t[1];if(o){var s=o[1];if(s)return[[[0,t[0],0,1],o[0],[0,s[0],0,1],2],s[1]];n=1}else n=1}else n=1}if(1===n){var u=e/2|0,c=g(u,t),l=c[1];if(l){var f=g((e-u|0)-1|0,l[1]);return[r(c[0],l[0],f[0]),f[1]]}throw[a.assert_failure,["set.ml",372,18]]}};return g(n.length(m),m)[0]}return s(h[0],s(d,s(p,s(l,u(o)))))}return s(d,s(p,s(l,u(o))))}return s(p,s(l,u(o)))}return s(l,u(o))}return u(o)}return 0}]}},function(e,t,r){"use strict";(function(e){var n=r(1);t.caml_sys_getenv=function(t){var r=void 0===e?void 0:e;if(void 0!==r){var i=r.env[t];if(void 0!==i)return i;throw n.not_found}throw n.not_found},t.caml_sys_time=function(){var t=void 0===e?void 0:e;return void 0!==t?t.uptime():-1},t.caml_sys_random_seed=function(){return[(4294967295^(0|Date.now()))*Math.random()|0]},t.caml_sys_system_command=function(){return 127},t.caml_sys_getcwd=function(){var t=void 0===e?void 0:e;return void 0!==t?t.cwd():"/"},t.caml_sys_get_argv=function(){var t=void 0===e?void 0:e;return void 0!==t?null==t.argv?["",[""]]:[t.argv[0],t.argv]:["",[""]]},t.caml_sys_exit=function(t){var r=void 0===e?void 0:e;return void 0!==r?r.exit(t):0},t.caml_sys_is_directory=function(){throw[n.failure,"caml_sys_is_directory not implemented"]},t.caml_sys_file_exists=function(){throw[n.failure,"caml_sys_file_exists not implemented"]}}).call(t,r(30))},function(e,t,r){"use strict";var n=r(8),i=r(31),a=r(6),o=r(1),s=[-2147483648,0],u=[2147483647,1],c=[0,1],l=[0,0],f=[-1,4294967295];function p(e){return+(0!=(2147483648&e))}function h(e,t){var r=t[1],n=e[1],i=n+r&4294967295,a=p(n)&&(p(r)||!p(i))||p(r)&&!p(i)?1:0;return[e[0]+t[0]+a&4294967295,i>>>0]}function d(e){return[-1^e[0],(-1^e[1])>>>0]}function m(e,t){return e[0]===t[0]?+(e[1]===t[1]):0}function g(e){return m(e,s)?s:h(d(e),c)}function v(e,t){if(t){var r=e[1];return t>=32?[r<<(t-32|0),0]:[r>>>(32-t|0)|e[0]<<t,r<<t>>>0]}return e}function _(e,t){if(t){var r=e[0];return t<32?[r>>t,(r<<(32-t|0)|e[1]>>>t)>>>0]:[r>=0?0:-1,r>>(t-32|0)>>>0]}return e}function y(e){return 0!==e[0]||0!==e[1]?0:1}function b(e,t){for(;;){var r,n=t,i=e,a=0,o=i[0],u=0,c=0,f=0;if(0!==o)f=4;else{if(0===i[1])return l;f=4}if(4===f)if(0!==n[0])c=3;else{if(0===n[1])return l;c=3}if(3===c&&(-2147483648!==o?u=2:0!==i[1]?u=2:(r=n[1],a=1)),2===u){var p=n[0],h=i[1],d=0;if(-2147483648!==p?d=3:0!==n[1]?d=3:(r=h,a=1),3===d){var m=n[1];if(o<0){if(p<0){t=g(n),e=g(i);continue}return g(b(g(i),n))}if(p<0)return g(b(i,g(n)));var v=65535&o,_=h>>>16,y=65535&h,x=65535&p,w=m>>>16,$=65535&m,E=0,M=0,T=0,S=y*$;return E=(M=(M=(T=(S>>>16)+_*$)>>>16)+((T=(65535&T)+y*w)>>>16)+v*$)>>>16,E+=(M=(65535&M)+_*w)>>>16,E+=(M=(65535&M)+y*x)>>>16,[(M&=65535)|(E=E+((o>>>16)*$+v*w+_*x+y*(p>>>16))&65535)<<16,(65535&S|(65535&T)<<16)>>>0]}}if(1===a)return 0==(1&r)?l:s}}function x(e,t){var r=t[0],n=e[0];return n>r?1:n<r?0:+(e[1]>=t[1])}function w(e,t){return e[0]>t[0]?1:e[0]<t[0]?0:+(e[1]>t[1])}function $(e){return 4294967296*e[0]+e[1]}var E=Math.pow(2,32),M=Math.pow(2,63),T=-Math.pow(2,63);function S(e){return isNaN(e)||!isFinite(e)?l:e<=T?s:e+1>=M?u:e<0?g(S(-e)):[e/E|0,(e%E|0)>>>0]}function A(e,t){for(;;){var r=t,n=e,i=n[0],u=0,p=0;if(0!==r[0])p=2;else{if(0===r[1])throw o.division_by_zero;p=2}if(2===p)if(-2147483648!==i)if(0!==i)u=1;else{if(0===n[1])return l;u=1}else if(0!==n[1])u=1;else{if(m(r,c)||m(r,f))return n;if(m(r,s))return c;var d=r[0],E=v(A(_(n,1),r),1),M=0;if(0!==E[0])M=3;else{if(0===E[1])return d<0?c:g(c);M=3}if(3===M)return h(E,A(h(n,g(b(r,E))),r))}if(1===u){var T=r[0],z=0;if(-2147483648!==T)z=2;else{if(0===r[1])return l;z=2}if(2===z){if(i<0){if(T<0){t=g(r),e=g(n);continue}return g(A(g(n),r))}if(T<0)return g(A(n,g(r)));for(var R=l,C=n;x(C,r);){for(var L=a.caml_float_max(1,Math.floor($(C)/$(r))),P=Math.ceil(Math.log(L)/Math.LN2),U=P<=48?1:Math.pow(2,P-48),I=S(L),O=b(I,r);O[0]<0||w(O,C);)O=b(I=S(L-=U),r);y(I)&&(I=c),R=h(R,I),C=h(C,g(O))}return R}}}}t.min_int=s,t.max_int=u,t.one=c,t.zero=l,t.not=d,t.of_int32=function(e){return[e<0?-1:0,e>>>0]},t.to_int32=function(e){return 0|e[1]},t.add=h,t.neg=g,t.sub=function(e,t){return h(e,g(t))},t.lsl_=v,t.lsr_=function(e,t){if(t){var r=e[0],n=t-32|0;return n?n>0?[0,r>>>n>>>0]:[r>>>t,(r<<(0|-n)|e[1]>>>t)>>>0]:[0,r>>>0]}return e},t.asr_=_,t.is_zero=y,t.mul=b,t.xor=function(e,t){return[e[0]^t[0],(e[1]^t[1])>>>0]},t.or_=function(e,t){return[e[0]|t[0],(e[1]|t[1])>>>0]},t.and_=function(e,t){return[e[0]&t[0],(e[1]&t[1])>>>0]},t.swap=function(e){return[n.caml_int32_bswap(e[1]),n.caml_int32_bswap(e[0])>>>0]},t.ge=x,t.eq=m,t.neq=function(e,t){return 1-m(e,t)},t.lt=function(e,t){return 1-x(e,t)},t.gt=w,t.le=function(e,t){return 1-w(e,t)},t.equal_null=function(e,t){return null!==t?m(e,t):0},t.equal_undefined=function(e,t){return void 0!==t?m(e,t):0},t.equal_nullable=function(e,t){return null==t?0:m(e,t)},t.min=function(e,t){return x(e,t)?t:e},t.max=function(e,t){return w(e,t)?e:t},t.to_float=$,t.of_float=S,t.div=A,t.mod_=function(e,t){return h(e,g(b(A(e,t),t)))},t.div_mod=function(e,t){var r=A(e,t);return[r,h(e,g(b(r,t)))]},t.compare=function(e,t){var r=a.caml_nativeint_compare(e[0],t[0]);return r||a.caml_nativeint_compare(e[1],t[1])},t.to_hex=function(e){var t=function(e){return(e>>>0).toString(16)},r=e[0],n=e[1],a=0;if(0!==r)a=1;else{if(0===n)return"0";a=1}if(1===a){if(0!==n){if(0!==r){var o=t(e[1]),s=8-o.length|0;return s<=0?t(e[0])+o:t(e[0])+(i.repeat(s,"0")+o)}return t(e[1])}return t(e[0])+"00000000"}},t.discard_sign=function(e){return[2147483647&e[0],e[1]]},t.float_of_bits=function(e){var t=new Int32Array([e[1],e[0]]);return new Float64Array(t.buffer)[0]},t.bits_of_float=function(e){var t=new Float64Array([e]),r=new Int32Array(t.buffer);return[r[1],r[0]>>>0]},t.get64=function(e,t){return[e.charCodeAt(t+4|0)<<32|e.charCodeAt(t+5|0)<<40|e.charCodeAt(t+6|0)<<48|e.charCodeAt(t+7|0)<<56,(e.charCodeAt(t)|e.charCodeAt(t+1|0)<<8|e.charCodeAt(t+2|0)<<16|e.charCodeAt(t+3|0)<<24)>>>0]}},function(e,t,r){"use strict";var n=r(7),i=r(20),a=r(0),o=r(36),s=r(16),u=r(23),c=r(12),l=r(10),f=r(9),p=r(6),h=r(2),d=r(50),m=r(1);function g(e,t){var r=[[e,0]],n=t[0];return n?(t[0]=r,n[0][1]=r,0):(t[0]=r,t[1]=r,0)}var v=h.create("Format.Empty_queue");function _(e){var t=e[1];if(t)return t[0][0];throw v}function y(e){var t=e[1];if(t){var r=t[0],n=r[0],i=r[1];return e[1]=i,i||(e[0]=0),n}throw v}function b(e,t){return e[12]=e[12]+t[2]|0,g(t,e[26])}function x(e,t){return a._3(e[16],t,0,t.length)}function w(e,t,r){a._1(e[18],0),e[10]=1;var n=(e[5]-r|0)+t|0,i=p.caml_int_min(e[7],n);return e[9]=i,e[8]=e[5]-e[9]|0,a._1(e[19],e[9])}function $(e,t){return e[8]=e[8]-t|0,a._1(e[19],t)}function E(e,t,r){if("number"==typeof r)switch(r){case 0:var n=e[2];if(n){var i=n[0][0],o=function(e,t){if(t){var r=t[0];return c.caml_lessthan(e,r)?[e,t]:[r,o(e,t[1])]}return[e,0]};return i[0]=o(e[5]-e[8]|0,i[0]),0}return 0;case 1:var s=e[1];return s?(e[1]=s[1],0):0;case 2:var u=e[2];return u?(e[2]=u[1],0):0;case 3:var l=e[1];return l?w(e,0,l[0][1]):a._1(e[18],0);case 4:if(e[9]!==(e[5]-e[8]|0)){var f=e,p=y(f[26]),h=p[0];return f[11]=f[11]-p[2]|0,f[8]=f[8]+h|0,0}return 0;case 5:var d=e[4];return d?(x(e,a._1(e[23],d[0])),e[4]=d[1],0):0}else switch(0|r.tag){case 0:return e[8]=e[8]-t|0,x(e,r[0]),e[10]=0,0;case 1:var g=r[1],v=r[0],_=e[1];if(!_)return 0;var b=_[0],E=b[1];switch(b[0]){case 1:case 2:return w(e,g,E);case 3:return t>e[8]?w(e,g,E):$(e,v);case 4:return e[10]||!(t>e[8]||e[9]>((e[5]-E|0)+g|0))?$(e,v):w(e,g,E);case 0:case 5:return $(e,v)}break;case 2:var M=e[5]-e[8]|0,T=e[2];if(T){var S,A=T[0][0],z=A[0];if(z)try{S=function(e,t){for(;;){var r=t;if(!r)throw m.not_found;var n=r[0];if(c.caml_greaterequal(n,e))return n;t=r[1]}}(M,A[0])}catch(e){if(e!==m.not_found)throw e;S=z[0]}else S=M;var R=S-M|0;return R>=0?$(e,R+r[0]|0):w(e,S+r[1]|0,e[5])}return 0;case 3:var C=r[1];(e[5]-e[8]|0)>e[7]&&function(e){var t=e[1];if(t){var r=t[0],n=r[1];return n>e[8]&&r[0]-1>>>0<=3?w(e,0,n):0}a._1(e[18],0)}(e);var L=e[8]-r[0]|0,P=1!==C?t>e[8]?C:5:1;return e[1]=[[P,L],e[1]],0;case 4:return e[2]=[r[0],e[2]],0;case 5:var U=r[0];return x(e,a._1(e[22],U)),e[4]=[U,e[4]],0}}function M(e){try{for(var t=e;;){var r=_(t[26]),n=r[0];if(n<0&&(t[12]-t[11]|0)<t[8])return 0;y(t[26]),E(t,n<0?1000000010:n,r[1]),t[11]=r[2]+t[11]|0}}catch(e){if(e===v)return 0;throw e}}function T(e,t){return b(e,t),M(e)}function S(e,t,r){return T(e,[t,n.__(0,[r]),t])}var A=[[-1,[-1,n.__(0,[""]),0]],0];function z(e,t){var r=e[0];if(!r)return 0;var n=r[0],i=n[1],a=i[0],o=r[1];if(n[0]<e[11])return e[0]=A,0;var s=0,u=i[1];if("number"==typeof u)return 0;switch(0|u.tag){case 1:case 2:s=1;break;case 3:return t?0:(i[0]=e[12]+a|0,e[0]=o,0);default:return 0}return 1===s?t?(i[0]=e[12]+a|0,e[0]=o,0):0:void 0}function R(e,t,r){return b(e,r),t&&z(e,1),e[0]=[[e[12],r],e[0]],0}function C(e,t,r){if(e[13]=e[13]+1|0,e[13]<e[14])return R(e,0,[0|-e[12],n.__(3,[t,r]),0]);if(e[13]===e[14]){var i=e,a=e[15];return S(i,a.length,a)}return 0}function L(e,t){return e[13]>1?(e[13]<e[14]&&(b(e,[0,1,0]),z(e,1),z(e,0)),e[13]=e[13]-1|0,0):0}function P(e,t){return e[20]&&(e[3]=[t,e[3]],a._1(e[24],t)),e[21]?b(e,[0,n.__(5,[t]),0]):0}function U(e,t){if(e[21]&&b(e,[0,5,0]),e[20]){var r=e[3];return r?(a._1(e[25],r[0]),e[3]=r[1],0):0}return 0}function I(e,t){return e[20]=t,e[21]=t,0}function O(e,t){return[e[22],e[23],e[24],e[25]]}function N(e,t){return e[22]=t[0],e[23]=t[1],e[24]=t[2],e[25]=t[3],0}function k(e){return function(e){e[11]=1,e[12]=1;var t=e[26];t[0]=0,t[1]=0}(e),e[0]=A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[9]=0,e[13]=0,e[8]=e[5],C(e,0,3)}function D(e,t){for(;e[13]>1;)L(e);return e[12]=1000000010,M(e),t&&a._1(e[18],0),k(e)}function F(e,t,r){return e[13]<e[14]?S(e,t,r):0}var B=F;function G(e,t){return B(e,t.length,t)}function V(e,t){return B(e,1,f.bytes_to_string(i.make(1,t)))}function H(e,t){return C(e,0,0)}function j(e,t){return C(e,t,1)}function W(e,t){return C(e,t,2)}function q(e,t){return C(e,t,3)}function X(e,t){return C(e,t,4)}function Y(e,t){return D(e,1),a._1(e[17],0)}function J(e,t){return D(e,0),a._1(e[17],0)}function Z(e,t){return e[13]<e[14]?T(e,[0,3,0]):0}function K(e,t){return e[13]<e[14]?T(e,[0,4,0]):0}function Q(e,t,r){return e[13]<e[14]?R(e,1,[0|-e[12],n.__(1,[t,r]),t]):0}function ee(e,t){return Q(e,0,0)}function te(e,t){return e[13]=e[13]+1|0,e[13]<e[14]?T(e,[0,n.__(4,[[[0]]]),0]):0}function re(e,t){if(e[13]>1){if(e[13]<e[14]){return T(e,[0,2,0]),e[13]=e[13]-1|0,0}return 0}return 0}function ne(e,t,r){return e[13]<e[14]?R(e,1,[0|-e[12],n.__(2,[t,r]),t]):0}function ie(e,t){if(e[13]<e[14]){return T(e,[0,0,0])}return 0}function ae(e,t){return t>1?(e[14]=t,0):0}function oe(e,t){return+(e[13]===e[14])}function se(e){return e<1000000010?e:1000000009}function ue(e,t){var r=e,n=e[5]-t|0;if(n>=1){var i=se(n);return r[6]=i,r[7]=r[5]-r[6]|0,k(r)}return 0}function ce(e,t){if(t>=1){var r=se(t);return e[5]=r,ue(e,e[7]<=e[5]?e[7]:p.caml_int_max(p.caml_int_max(e[5]-e[6]|0,e[5]/2|0),1))}return 0}function le(e,t){return e[16]=t[0],e[17]=t[1],e[18]=t[2],e[19]=t[3],0}function fe(e,t){return[e[16],e[17],e[18],e[19]]}function pe(e,t,r){return e[16]=t,e[17]=r,0}function he(e,t){return[e[16],e[17]]}function de(e,t,r,n,i){return pe(e,t,r),e[18]=n,e[19]=i,0}function me(e,t){return[e[16],e[17],e[18],e[19]]}function ge(e,t){return a._3(e[16],"\n",0,1)}var ve=f.bytes_to_string(i.make(80,32));function _e(e,t){for(;;){var r=t;if(!(r>0))return 0;if(r<=80)return a._3(e[16],ve,0,r);a._3(e[16],ve,0,80),t=r-80|0}}function ye(e,t){return e[16]=function(e,r,n){return l.output_substring(t,e,r,n)},e[17]=function(){return u.caml_ml_flush(t)},e[18]=function(t){return ge(e)},e[19]=function(t){return _e(e,t)},0}function be(e){return"<"+e+">"}function xe(e){return"</"+e+">"}function we(){return 0}function $e(){return 0}function Ee(e,t){var r,i,a,o,s,u,c=(r=e,i=t,a=function(){return 0},o=function(){return 0},s=[0,0],g(u=[-1,n.__(3,[0,3]),0],s),[[[1,u],A],0,0,0,0,78,10,68,78,0,1,1,1,1,l.max_int,".",r,i,a,o,0,0,be,xe,we,$e,s]);return c[18]=function(e){return ge(c)},c[19]=function(e){return _e(c,e)},c}function Me(e){return Ee(function(t,r,n){return l.output_substring(e,t,r,n)},function(){return u.caml_ml_flush(e)})}function Te(e){return Ee(function(t,r,n){return o.add_substring(e,t,r,n)},function(){return 0})}var Se=o.create(512),Ae=Me(l.stdout),ze=Me(l.stderr),Re=Te(Se);function Ce(e,t){D(t,0);var r=o.contents(e);return o.reset(e),r}function Le(e){return J(Ae)}function Pe(e,t){var r=o.create(16),n=Te(r);a._2(e,n,t),J(n);var i=r[1];return i<2?o.contents(r):o.sub(r,1,i-2|0)}function Ue(e,t){if("number"==typeof t)switch(t){case 0:return L(e);case 1:return U(e);case 2:return J(e);case 3:return Z(e);case 4:return Y(e);case 5:return V(e,64);case 6:return V(e,37)}else switch(0|t.tag){case 0:return Q(e,t[1],t[2]);case 1:return 0;case 2:return V(e,64),V(e,t[0])}}function Ie(e,t){var r,n,o,s,u,c,l=0;if("number"==typeof t)return 0;switch(0|t.tag){case 0:return Ie(e,t[0]),Ue(e,t[1]);case 1:var p=t[1];if(Ie(e,t[0]),p.tag){var h=d.open_box_of_string(Pe(Ie,p[0]));return C(e,h[0],h[1])}return P(e,Pe(Ie,p[0]));case 2:var g=t[0],v=0;if("number"==typeof g)v=3;else if(g.tag)v=3;else{var _=g[1];"number"==typeof _?v=3:1===_.tag?(r=g[0],n=_[1],o=t[1],l=1):v=3}if(3===v)return Ie(e,g),G(e,t[1]);break;case 3:var y=t[0],b=0;if("number"==typeof y)b=3;else if(y.tag)b=3;else{var x=y[1];"number"==typeof x?b=3:1===x.tag?(s=y[0],u=x[1],c=t[1],l=2):b=3}if(3===b)return Ie(e,y),V(e,t[1]);break;case 4:var w=t[0],$=0;if("number"==typeof w)$=3;else if(w.tag)$=3;else{var E=w[1];"number"==typeof E?$=3:1===E.tag?(r=w[0],n=E[1],o=t[1],l=1):$=3}if(3===$)return Ie(e,w),G(e,t[1]);break;case 5:var M=t[0],T=0;if("number"==typeof M)T=3;else if(M.tag)T=3;else{var S=M[1];"number"==typeof S?T=3:1===S.tag?(s=M[0],u=S[1],c=t[1],l=2):T=3}if(3===T)return Ie(e,M),V(e,t[1]);break;case 6:return Ie(e,t[0]),a._1(t[1],e);case 7:return Ie(e,t[0]),J(e);case 8:throw Ie(e,t[0]),[m.invalid_argument,t[1]]}switch(l){case 1:return Ie(e,r),F(e,n,o);case 2:return Ie(e,s),F(e,u,f.bytes_to_string(i.make(1,c)))}}function Oe(e,t){var r,n,o,s,u,c,l=0;if("number"==typeof t)return 0;switch(0|t.tag){case 0:return Oe(e,t[0]),Ue(e,t[1]);case 1:var p=t[1];if(Oe(e,t[0]),p.tag){var h=d.open_box_of_string(Pe(Oe,p[0]));return C(e,h[0],h[1])}return P(e,Pe(Oe,p[0]));case 2:var g=t[0],v=0;if("number"==typeof g)v=3;else if(g.tag)v=3;else{var _=g[1];"number"==typeof _?v=3:1===_.tag?(r=g[0],n=_[1],o=t[1],l=1):v=3}if(3===v)return Oe(e,g),G(e,t[1]);break;case 3:var y=t[0],b=0;if("number"==typeof y)b=3;else if(y.tag)b=3;else{var x=y[1];"number"==typeof x?b=3:1===x.tag?(s=y[0],u=x[1],c=t[1],l=2):b=3}if(3===b)return Oe(e,y),V(e,t[1]);break;case 4:var w=t[0],$=0;if("number"==typeof w)$=3;else if(w.tag)$=3;else{var E=w[1];"number"==typeof E?$=3:1===E.tag?(r=w[0],n=E[1],o=t[1],l=1):$=3}if(3===$)return Oe(e,w),G(e,t[1]);break;case 5:var M=t[0],T=0;if("number"==typeof M)T=3;else if(M.tag)T=3;else{var S=M[1];"number"==typeof S?T=3:1===S.tag?(s=M[0],u=S[1],c=t[1],l=2):T=3}if(3===T)return Oe(e,M),V(e,t[1]);break;case 6:var A=t[0],z=0;if("number"==typeof A)z=3;else if(A.tag)z=3;else{var R=A[1];if("number"==typeof R)z=3;else{if(1===R.tag)return Oe(e,A[0]),F(e,R[1],a._1(t[1],0));z=3}}if(3===z)return Oe(e,A),G(e,a._1(t[1],0));break;case 7:return Oe(e,t[0]),J(e);case 8:throw Oe(e,t[0]),[m.invalid_argument,t[1]]}switch(l){case 1:return Oe(e,r),F(e,n,o);case 2:return Oe(e,s),F(e,u,f.bytes_to_string(i.make(1,c)))}}function Ne(e,t,r){return d.make_printf(function(t,r){return Ie(t,r),a._1(e,t)},t,0,r[0])}function ke(e,t,r){return d.make_printf(function(r,n){return a._1(e,t)},t,0,r[0])}function De(e,t){return Ne(function(){return 0},e,t)}function Fe(e,t){var r=o.create(512),n=Te(r);return d.make_printf(function(t,i){return Oe(n,i),a._1(e,Ce(r,n))},0,0,t[0])}l.at_exit(Le);var Be=Fe;t.open_box=function(e){return X(Ae,e)},t.close_box=function(e){return L(Ae)},t.print_string=function(e){return G(Ae,e)},t.print_as=function(e,t){return B(Ae,e,t)},t.print_int=function(e){return G(Ae,""+e)},t.print_float=function(e){return G(Ae,l.string_of_float(e))},t.print_char=function(e){return V(Ae,e)},t.print_bool=function(e){return G(Ae,e?"true":"false")},t.print_space=function(){return Q(Ae,1,0)},t.print_cut=function(){return Q(Ae,0,0)},t.print_break=function(e,t){return Q(Ae,e,t)},t.print_flush=Le,t.print_newline=function(e){return Y(Ae)},t.force_newline=function(e){return Z(Ae)},t.print_if_newline=function(e){return K(Ae)},t.set_margin=function(e){return ce(Ae,e)},t.get_margin=function(){return Ae[5]},t.set_max_indent=function(e){return ue(Ae,e)},t.get_max_indent=function(){return Ae[7]},t.set_max_boxes=function(e){return ae(Ae,e)},t.get_max_boxes=function(){return Ae[14]},t.over_max_boxes=function(e){return oe(Ae)},t.open_hbox=function(e){return H(Ae)},t.open_vbox=function(e){return j(Ae,e)},t.open_hvbox=function(e){return W(Ae,e)},t.open_hovbox=function(e){return q(Ae,e)},t.open_tbox=function(e){return te(Ae)},t.close_tbox=function(e){return re(Ae)},t.print_tbreak=function(e,t){return ne(Ae,e,t)},t.set_tab=function(e){return ie(Ae)},t.print_tab=function(){return ne(Ae,0,0)},t.set_ellipsis_text=function(e){return Ae[15]=e,0},t.get_ellipsis_text=function(){return Ae[15]},t.open_tag=function(e){return P(Ae,e)},t.close_tag=function(e){return U(Ae)},t.set_tags=function(e){return I(Ae,e)},t.set_print_tags=function(e){return Ae[20]=e,0},t.set_mark_tags=function(e){return Ae[21]=e,0},t.get_print_tags=function(){return Ae[20]},t.get_mark_tags=function(){return Ae[21]},t.set_formatter_out_channel=function(e){return ye(Ae,e)},t.set_formatter_output_functions=function(e,t){return pe(Ae,e,t)},t.get_formatter_output_functions=function(e){return he(Ae)},t.set_formatter_out_functions=function(e){return le(Ae,e)},t.get_formatter_out_functions=function(e){return fe(Ae)},t.set_formatter_tag_functions=function(e){return N(Ae,e)},t.get_formatter_tag_functions=function(e){return O(Ae)},t.formatter_of_out_channel=Me,t.std_formatter=Ae,t.err_formatter=ze,t.formatter_of_buffer=Te,t.stdbuf=Se,t.str_formatter=Re,t.flush_str_formatter=function(){D(Re,0);var e=o.contents(Se);return o.reset(Se),e},t.make_formatter=Ee,t.pp_open_hbox=H,t.pp_open_vbox=j,t.pp_open_hvbox=W,t.pp_open_hovbox=q,t.pp_open_box=X,t.pp_close_box=L,t.pp_open_tag=P,t.pp_close_tag=U,t.pp_print_string=G,t.pp_print_as=B,t.pp_print_int=function(e,t){return G(e,""+t)},t.pp_print_float=function(e,t){return G(e,l.string_of_float(t))},t.pp_print_char=V,t.pp_print_bool=function(e,t){return G(e,t?"true":"false")},t.pp_print_break=Q,t.pp_print_cut=ee,t.pp_print_space=function(e,t){return Q(e,1,0)},t.pp_force_newline=Z,t.pp_print_flush=J,t.pp_print_newline=Y,t.pp_print_if_newline=K,t.pp_open_tbox=te,t.pp_close_tbox=re,t.pp_print_tbreak=ne,t.pp_set_tab=ie,t.pp_print_tab=function(e,t){return ne(e,0,0)},t.pp_set_tags=I,t.pp_set_print_tags=function(e,t){return e[20]=t,0},t.pp_set_mark_tags=function(e,t){return e[21]=t,0},t.pp_get_print_tags=function(e,t){return e[20]},t.pp_get_mark_tags=function(e,t){return e[21]},t.pp_set_margin=ce,t.pp_get_margin=function(e,t){return e[5]},t.pp_set_max_indent=ue,t.pp_get_max_indent=function(e,t){return e[7]},t.pp_set_max_boxes=ae,t.pp_get_max_boxes=function(e,t){return e[14]},t.pp_over_max_boxes=oe,t.pp_set_ellipsis_text=function(e,t){return e[15]=t,0},t.pp_get_ellipsis_text=function(e,t){return e[15]},t.pp_set_formatter_out_channel=ye,t.pp_set_formatter_output_functions=pe,t.pp_get_formatter_output_functions=he,t.pp_set_formatter_tag_functions=N,t.pp_get_formatter_tag_functions=O,t.pp_set_formatter_out_functions=le,t.pp_get_formatter_out_functions=fe,t.pp_print_list=function(e,t,r,n){for(;;){var i=n,o=e?e[0]:ee;if(i){var s=i[1],u=i[0];if(s){a._2(t,r,u),a._2(o,r,0),n=s,e=[o];continue}return a._2(t,r,u)}return 0}},t.pp_print_text=function(e,t){for(var r=t.length,n=[0],i=[0],a=function(){return G(e,s.sub(t,n[0],i[0]-n[0]|0)),i[0]=i[0]+1|0,n[0]=i[0],0};i[0]!==r;){var o=f.get(t,i[0]);10!==o?32!==o?i[0]=i[0]+1|0:(a(),Q(e,1,0)):(a(),Z(e))}return n[0]!==r?a():0},t.fprintf=De,t.printf=function(e){return De(Ae,e)},t.eprintf=function(e){return De(ze,e)},t.sprintf=function(e){return Fe(function(e){return e},e)},t.asprintf=function(e){var t=o.create(512),r=Te(t);return d.make_printf(function(e,r){return Ie(e,r),D(e,0),Ce(t,e)},r,0,e[0])},t.ifprintf=function(e,t){return ke(function(){return 0},e,t)},t.kfprintf=Ne,t.ikfprintf=ke,t.ksprintf=Fe,t.bprintf=function(e,t){return d.make_printf(function(e,t){return Ie(e,t),D(e,0)},Te(e),0,t[0])},t.kprintf=Be,t.set_all_formatter_output_functions=function(e,t,r,n){return de(Ae,e,t,r,n)},t.get_all_formatter_output_functions=function(e){return me(Ae)},t.pp_set_all_formatter_output_functions=de,t.pp_get_all_formatter_output_functions=me},function(e,t,r){"use strict";var n=r(33),i=r(7),a=r(20),o=r(0),s=r(36),u=r(35),c=r(16),l=r(23),f=r(12),p=r(51),h=r(52),d=r(8),m=r(10),g=r(24),v=r(9),_=r(6),y=r(2),b=r(1),x=r(32);function w(e,t){var r=t>>>3,n=1<<(7&t);return e[r]=m.char_of_int(p.get(e,r)|n),0}var $=a.to_string;function E(e){for(var t=a.make(32,0),r=0;r<=31;++r)t[r]=m.char_of_int(255^v.get(e,r));return v.bytes_to_string(t)}function M(e,t){var r=t>>>3,n=1<<(7&t);return+(0!=(v.get(e,r)&n))}function T(e){return e?i.__(0,[1,e[0]]):0}function S(e,t){if("number"==typeof e)switch(e){case 0:return[i.__(0,[t])];case 1:return[i.__(1,[t])];case 2:return[i.__(9,[t])];case 3:return[i.__(19,[t])];case 4:return[i.__(22,[t])]}else switch(0|e.tag){case 0:return[i.__(2,[T(e[0]),t])];case 1:return[i.__(3,[T(e[0]),t])];case 2:return[i.__(4,[e[0],T(e[1]),0,t])];case 3:return[i.__(5,[e[0],T(e[1]),0,t])];case 4:return[i.__(6,[e[0],T(e[1]),0,t])];case 5:return[i.__(7,[e[0],T(e[1]),0,t])];case 6:return[i.__(8,[0,T(e[0]),(r=e[1],r?[r[0]]:0),t])];case 7:return[i.__(13,[e[0],e[1],t])];case 8:return[i.__(14,[e[0],e[1],t])];case 9:return[i.__(20,[e[0],e[1],t])];case 10:return[i.__(21,[e[0],t])]}var r}function A(e,t){var r=e[1].length,n=e[0]+t|0;if(n>r){var i=_.caml_int_max(r<<1,n),o=v.caml_create_string(i);return a.blit(e[1],0,o,0,r),e[1]=o,0}return 0}function z(e,t){return A(e,1),e[1][e[0]]=t,e[0]=e[0]+1|0,0}function R(e,t){var r=t.length;return A(e,r),c.blit(t,0,e[1],e[0],r),e[0]=e[0]+r|0,0}function C(e){return a.sub_string(e[1],0,e[0])}function L(e){switch(e){case 0:case 1:case 2:return 100;case 3:case 4:case 5:return 105;case 6:case 7:return 120;case 8:case 9:return 88;case 10:case 11:return 111;case 12:return 117}}function P(e){switch(e){case 0:case 1:case 2:return 102;case 3:case 4:case 5:return 101;case 6:case 7:case 8:return 69;case 9:case 10:case 11:return 103;case 12:case 13:case 14:return 71;case 15:return 70}}function U(e){switch(e){case 0:return 108;case 1:return 110;case 2:return 78}}function I(e,t){var r,i,a=function(e,t){var r=m.char_of_int(t);return 37!==r?64!==r?z(e,r):(z(e,37),z(e,64)):(z(e,37),z(e,37))},o=function(t,r){for(;;){var n=r;if(!(n<256))return 0;if(M(t,m.char_of_int(n))){var i=t,u=n,c=m.char_of_int(u)-45|0;return c>48||c<0?c>=210?a(e,255):s(i,u+1|0):c>47||c<1?o(i,u+1|0):s(i,u+1|0)}r=n+1|0}},s=function(t,r){if(!M(t,m.char_of_int(r)))return a(e,r-1|0),o(t,r+1|0);var n=0,i=m.char_of_int(r)-45|0;if(i>48||i<0){if(i>=210)return a(e,254),a(e,255);n=1}else if(i>47||i<1){if(!M(t,m.char_of_int(r+1|0)))return a(e,r-1|0),o(t,r+1|0);n=1}else n=1;if(1===n){if(!M(t,m.char_of_int(r+1|0)))return a(e,r-1|0),a(e,r),o(t,r+2|0);for(var s=t,u=r-1|0,c=r+2|0;;){var l=c;if(256===l||!M(s,m.char_of_int(l)))return a(e,u),a(e,45),a(e,l-1|0),l<256?o(s,l+1|0):0;c=l+1|0}}};return z(e,91),r=M(t,0)?(z(e,94),E(t)):t,(i=function(e){var t=n.chr(e-1|0),i=n.chr(e+1|0);return M(r,e)?1-(M(r,t)&&M(r,i)):0})(93)&&z(e,93),o(r,1),i(45)&&z(e,45),z(e,93)}function O(e,t){return t?z(e,95):0}function N(e,t){return t?R(e,""+t[0]):0}function k(e,t){return"number"==typeof t?0:(function(e,t){switch(t){case 0:return z(e,45);case 1:return 0;case 2:z(e,48)}}(e,t[0]),t.tag?z(e,42):R(e,""+t[1]))}function D(e,t){return"number"==typeof t?0!==t?R(e,".*"):0:(z(e,46),R(e,""+t[0]))}function F(e,t){switch(t){case 1:case 4:return z(e,43);case 2:case 5:return z(e,32);case 7:case 9:case 11:return z(e,35);case 0:case 3:case 6:case 8:case 10:case 12:return 0}}function B(e,t,r,n,i){return z(e,37),O(e,t),F(e,r),k(e,n),D(e,i),z(e,L(r))}function G(e,t,r,n,i,a){return z(e,37),O(e,t),F(e,r),k(e,n),D(e,i),z(e,a),z(e,L(r))}function V(e,t){switch(t){case 1:case 4:case 7:case 10:case 13:return z(e,43);case 2:case 5:case 8:case 11:case 14:return z(e,32);case 0:case 3:case 6:case 9:case 12:case 15:return 0}}function H(e,t,r,n,i){return z(e,37),O(e,t),V(e,r),k(e,n),D(e,i),z(e,P(r))}function j(e){if("number"==typeof e)switch(e){case 0:return"@]";case 1:return"@}";case 2:return"@?";case 3:return"@\n";case 4:return"@.";case 5:return"@@";case 6:return"@%"}else switch(0|e.tag){case 0:case 1:return e[0];case 2:return"@"+v.bytes_to_string(a.make(1,e[0]))}}function W(e){return e[0][1]}function q(e,t){return 37!==t?z(e,t):R(e,"%%")}function X(e,t){for(var r=0,n=t.length-1|0;r<=n;++r)q(e,v.get(t,r));return 0}function Y(e,t){for(;;){var r=t;if("number"==typeof r)return 0;switch(0|r.tag){case 0:R(e,"%c"),t=r[0];continue;case 1:R(e,"%s"),t=r[0];continue;case 2:R(e,"%i"),t=r[0];continue;case 3:R(e,"%li"),t=r[0];continue;case 4:R(e,"%ni"),t=r[0];continue;case 5:R(e,"%Li"),t=r[0];continue;case 6:R(e,"%f"),t=r[0];continue;case 7:R(e,"%B"),t=r[0];continue;case 8:R(e,"%{"),Y(e,r[0]),R(e,"%}"),t=r[1];continue;case 9:R(e,"%("),Y(e,r[0]),R(e,"%)"),t=r[2];continue;case 10:R(e,"%a"),t=r[0];continue;case 11:R(e,"%t"),t=r[0];continue;case 12:R(e,"%?"),t=r[0];continue;case 13:R(e,"%r"),t=r[0];continue;case 14:R(e,"%_r"),t=r[0];continue}}}function J(e){return e?1+J(e[0])|0:0}function Z(e){if("number"==typeof e)return 0;switch(0|e.tag){case 0:return i.__(0,[Z(e[0])]);case 1:return i.__(1,[Z(e[0])]);case 2:return i.__(2,[Z(e[0])]);case 3:return i.__(3,[Z(e[0])]);case 4:return i.__(4,[Z(e[0])]);case 5:return i.__(5,[Z(e[0])]);case 6:return i.__(6,[Z(e[0])]);case 7:return i.__(7,[Z(e[0])]);case 8:return i.__(8,[e[0],Z(e[1])]);case 9:return i.__(9,[e[1],e[0],Z(e[2])]);case 10:return i.__(10,[Z(e[0])]);case 11:return i.__(11,[Z(e[0])]);case 12:return i.__(12,[Z(e[0])]);case 13:return i.__(13,[Z(e[0])]);case 14:return i.__(14,[Z(e[0])])}}function K(e){if("number"==typeof e)return[function(){return 0},function(){return 0},function(){return 0},function(){return 0}];switch(0|e.tag){case 0:var t=K(e[0]),r=t[1],n=t[0];return[function(){return o._1(n,0),0},function(){return o._1(r,0),0},t[2],t[3]];case 1:var i=K(e[0]),a=i[1],s=i[0];return[function(){return o._1(s,0),0},function(){return o._1(a,0),0},i[2],i[3]];case 2:var u=K(e[0]),c=u[1],l=u[0];return[function(){return o._1(l,0),0},function(){return o._1(c,0),0},u[2],u[3]];case 3:var f=K(e[0]),p=f[1],h=f[0];return[function(){return o._1(h,0),0},function(){return o._1(p,0),0},f[2],f[3]];case 4:var d=K(e[0]),m=d[1],g=d[0];return[function(){return o._1(g,0),0},function(){return o._1(m,0),0},d[2],d[3]];case 5:var v=K(e[0]),_=v[1],y=v[0];return[function(){return o._1(y,0),0},function(){return o._1(_,0),0},v[2],v[3]];case 6:var b=K(e[0]),x=b[1],w=b[0];return[function(){return o._1(w,0),0},function(){return o._1(x,0),0},b[2],b[3]];case 7:var $=K(e[0]),E=$[1],M=$[0];return[function(){return o._1(M,0),0},function(){return o._1(E,0),0},$[2],$[3]];case 8:var T=K(e[1]),S=T[1],A=T[0];return[function(){return o._1(A,0),0},function(){return o._1(S,0),0},T[2],T[3]];case 9:var z=K(e[2]),R=z[3],C=z[2],L=z[1],P=z[0],U=K(Q(Z(e[0]),e[1])),I=U[3],O=U[2],N=U[1],k=U[0];return[function(){return o._1(P,0),o._1(k,0),0},function(){return o._1(N,0),o._1(L,0),0},function(){return o._1(C,0),o._1(O,0),0},function(){return o._1(I,0),o._1(R,0),0}];case 10:var D=K(e[0]),F=D[1],B=D[0];return[function(){return o._1(B,0),0},function(){return o._1(F,0),0},D[2],D[3]];case 11:var G=K(e[0]),V=G[1],H=G[0];return[function(){return o._1(H,0),0},function(){return o._1(V,0),0},G[2],G[3]];case 12:var j=K(e[0]),W=j[1],q=j[0];return[function(){return o._1(q,0),0},function(){return o._1(W,0),0},j[2],j[3]];case 13:var X=K(e[0]),Y=X[3],J=X[2],ee=X[1],te=X[0];return[function(){return o._1(te,0),0},function(){return o._1(ee,0),0},function(){return o._1(J,0),0},function(){return o._1(Y,0),0}];case 14:var re=K(e[0]),ne=re[3],ie=re[2],ae=re[1],oe=re[0];return[function(){return o._1(oe,0),0},function(){return o._1(ae,0),0},function(){return o._1(ie,0),0},function(){return o._1(ne,0),0}]}}function Q(e,t){var r=0;if("number"==typeof e){if("number"==typeof t)return 0;switch(0|t.tag){case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[b.assert_failure,["camlinternalFormat.ml",816,23]]}}else switch(0|e.tag){case 0:if("number"==typeof t)r=8;else switch(0|t.tag){case 0:return i.__(0,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 1:if("number"==typeof t)r=8;else switch(0|t.tag){case 1:return i.__(1,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 2:if("number"==typeof t)r=8;else switch(0|t.tag){case 2:return i.__(2,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 3:if("number"==typeof t)r=8;else switch(0|t.tag){case 3:return i.__(3,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 4:if("number"==typeof t)r=8;else switch(0|t.tag){case 4:return i.__(4,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 5:if("number"==typeof t)r=8;else switch(0|t.tag){case 5:return i.__(5,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 6:if("number"==typeof t)r=8;else switch(0|t.tag){case 6:return i.__(6,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 7:if("number"==typeof t)r=8;else switch(0|t.tag){case 7:return i.__(7,[Q(e[0],t[0])]);case 8:r=6;break;case 9:r=7;break;case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5}break;case 8:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",802,26]];switch(0|t.tag){case 8:return i.__(8,[Q(e[0],t[0]),Q(e[1],t[1])]);case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[b.assert_failure,["camlinternalFormat.ml",802,26]]}break;case 9:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",812,28]];switch(0|t.tag){case 8:r=6;break;case 9:var n=K(Q(Z(e[1]),t[0]));return o._1(n[1],0),o._1(n[3],0),i.__(9,[e[0],t[1],Q(e[2],t[2])]);case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:r=5;break;default:throw[b.assert_failure,["camlinternalFormat.ml",812,28]]}break;case 10:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",780,21]];if(10===t.tag)return i.__(10,[Q(e[0],t[0])]);throw[b.assert_failure,["camlinternalFormat.ml",780,21]];case 11:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",784,21]];switch(0|t.tag){case 10:r=1;break;case 11:return i.__(11,[Q(e[0],t[0])]);default:throw[b.assert_failure,["camlinternalFormat.ml",784,21]]}break;case 12:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",788,19]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:return i.__(12,[Q(e[0],t[0])]);default:throw[b.assert_failure,["camlinternalFormat.ml",788,19]]}break;case 13:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",792,22]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:return i.__(13,[Q(e[0],t[0])]);default:throw[b.assert_failure,["camlinternalFormat.ml",792,22]]}break;case 14:if("number"==typeof t)throw[b.assert_failure,["camlinternalFormat.ml",797,30]];switch(0|t.tag){case 10:r=1;break;case 11:r=2;break;case 12:r=3;break;case 13:r=4;break;case 14:return i.__(14,[Q(e[0],t[0])]);default:throw[b.assert_failure,["camlinternalFormat.ml",797,30]]}}switch(r){case 1:throw[b.assert_failure,["camlinternalFormat.ml",781,21]];case 2:throw[b.assert_failure,["camlinternalFormat.ml",785,21]];case 3:throw[b.assert_failure,["camlinternalFormat.ml",789,19]];case 4:throw[b.assert_failure,["camlinternalFormat.ml",793,22]];case 5:throw[b.assert_failure,["camlinternalFormat.ml",798,30]];case 6:throw[b.assert_failure,["camlinternalFormat.ml",803,26]];case 7:throw[b.assert_failure,["camlinternalFormat.ml",813,28]];case 8:throw[b.assert_failure,["camlinternalFormat.ml",817,23]]}}function ee(e){for(;;){var t=e,r=0;if("number"==typeof t)return 0;switch(0|t.tag){case 2:case 3:r=1;break;case 4:var n=ee(t[3]),a=ne(t[2],i.__(2,[n]));return re(t[1],a);case 5:var o=ee(t[3]),s=ne(t[2],i.__(3,[o]));return re(t[1],s);case 6:var u=ee(t[3]),c=ne(t[2],i.__(4,[u]));return re(t[1],c);case 7:var l=ee(t[3]),f=ne(t[2],i.__(5,[l]));return re(t[1],f);case 8:var p=ee(t[3]),h=ne(t[2],i.__(6,[p]));return re(t[1],h);case 9:return i.__(7,[ee(t[0])]);case 10:e=t[0];continue;case 13:return i.__(8,[t[1],ee(t[2])]);case 14:var d=t[1];return i.__(9,[d,d,ee(t[2])]);case 15:return i.__(10,[ee(t[0])]);case 16:return i.__(11,[ee(t[0])]);case 18:return x.concat_fmtty(ee(t[0][0][0]),ee(t[1]));case 19:return i.__(13,[ee(t[0])]);case 20:return i.__(1,[ee(t[2])]);case 21:return i.__(2,[ee(t[1])]);case 0:case 1:case 22:return i.__(0,[ee(t[0])]);case 23:var m=t[0],g=t[1];return"number"==typeof m?3===m?i.__(14,[ee(g)]):ee(g):8===m.tag?x.concat_fmtty(m[1],ee(g)):ee(g);case 24:return te(t[0],ee(t[2]));default:e=t[1];continue}if(1===r)return re(t[0],i.__(1,[ee(t[1])]))}}function te(e,t){return e?i.__(12,[te(e[0],t)]):t}function re(e,t){return"number"!=typeof e&&e.tag?i.__(2,[t]):t}function ne(e,t){return"number"==typeof e&&0!==e?i.__(2,[t]):t}var ie=y.create("CamlinternalFormat.Type_mismatch");function ae(e,t){if("number"==typeof e)return[0,t];if(e.tag){if("number"==typeof t)throw ie;if(2===t.tag)return[i.__(1,[e[0]]),t[0]];throw ie}return[i.__(0,[e[0],e[1]]),t]}function oe(e,t,r){var n=ae(e,r);if("number"==typeof t){if(0!==t){var i=n[1];if("number"==typeof i)throw ie;if(2===i.tag)return[n[0],1,i[0]];throw ie}return[n[0],0,n[1]]}return[n[0],[t[0]],n[1]]}function se(e,t,r){var n=ue(t,r);return[i.__(23,[e,n[0]]),n[1]]}function ue(e,t){if("number"==typeof e)return[0,t];switch(0|e.tag){case 0:if("number"==typeof t)throw ie;if(t.tag)throw ie;var r=ue(e[0],t[0]);return[i.__(0,[r[0]]),r[1]];case 1:if("number"==typeof t)throw ie;if(t.tag)throw ie;var n=ue(e[0],t[0]);return[i.__(1,[n[0]]),n[1]];case 2:var a=ae(e[0],t),s=a[1];if("number"==typeof s)throw ie;if(1===s.tag){var u=ue(e[1],s[0]);return[i.__(2,[a[0],u[0]]),u[1]]}throw ie;case 3:var c=ae(e[0],t),l=c[1];if("number"==typeof l)throw ie;if(1===l.tag){var p=ue(e[1],l[0]);return[i.__(3,[c[0],p[0]]),p[1]]}throw ie;case 4:var h=oe(e[1],e[2],t),d=h[2];if("number"==typeof d)throw ie;if(2===d.tag){var m=ue(e[3],d[0]);return[i.__(4,[e[0],h[0],h[1],m[0]]),m[1]]}throw ie;case 5:var g=oe(e[1],e[2],t),v=g[2];if("number"==typeof v)throw ie;if(3===v.tag){var _=ue(e[3],v[0]);return[i.__(5,[e[0],g[0],g[1],_[0]]),_[1]]}throw ie;case 6:var y=oe(e[1],e[2],t),b=y[2];if("number"==typeof b)throw ie;if(4===b.tag){var w=ue(e[3],b[0]);return[i.__(6,[e[0],y[0],y[1],w[0]]),w[1]]}throw ie;case 7:var $=oe(e[1],e[2],t),E=$[2];if("number"==typeof E)throw ie;if(5===E.tag){var M=ue(e[3],E[0]);return[i.__(7,[e[0],$[0],$[1],M[0]]),M[1]]}throw ie;case 8:var T=oe(e[1],e[2],t),S=T[2];if("number"==typeof S)throw ie;if(6===S.tag){var A=ue(e[3],S[0]);return[i.__(8,[e[0],T[0],T[1],A[0]]),A[1]]}throw ie;case 9:if("number"==typeof t)throw ie;if(7===t.tag){var z=ue(e[0],t[0]);return[i.__(9,[z[0]]),z[1]]}throw ie;case 10:var R=ue(e[0],t);return[i.__(10,[R[0]]),R[1]];case 11:var C=ue(e[1],t);return[i.__(11,[e[0],C[0]]),C[1]];case 12:var L=ue(e[1],t);return[i.__(12,[e[0],L[0]]),L[1]];case 13:if("number"==typeof t)throw ie;if(8===t.tag){var P=t[0];if(f.caml_notequal([e[1]],[P]))throw ie;var U=ue(e[2],t[1]);return[i.__(13,[e[0],P,U[0]]),U[1]]}throw ie;case 14:if("number"==typeof t)throw ie;if(9===t.tag){var I=t[0];if(f.caml_notequal([x.erase_rel(e[1])],[x.erase_rel(I)]))throw ie;var O=ue(e[2],x.erase_rel(t[2]));return[i.__(14,[e[0],I,O[0]]),O[1]]}throw ie;case 15:if("number"==typeof t)throw ie;if(10===t.tag){var N=ue(e[0],t[0]);return[i.__(15,[N[0]]),N[1]]}throw ie;case 16:if("number"==typeof t)throw ie;if(11===t.tag){var k=ue(e[0],t[0]);return[i.__(16,[k[0]]),k[1]]}throw ie;case 17:var D=ue(e[1],t);return[i.__(17,[e[0],D[0]]),D[1]];case 18:var F=e[0],B=e[1],G=t;if(F.tag){var V=F[0],H=ue(V[0],G),j=ue(B,H[1]);return[i.__(18,[i.__(1,[[H[0],V[1]]]),j[0]]),j[1]]}var W=F[0],q=ue(W[0],G),X=ue(B,q[1]);return[i.__(18,[i.__(0,[[q[0],W[1]]]),X[0]]),X[1]];case 19:if("number"==typeof t)throw ie;if(13===t.tag){var Y=ue(e[0],t[0]);return[i.__(19,[Y[0]]),Y[1]]}throw ie;case 20:if("number"==typeof t)throw ie;if(1===t.tag){var J=ue(e[2],t[0]);return[i.__(20,[e[0],e[1],J[0]]),J[1]]}throw ie;case 21:if("number"==typeof t)throw ie;if(2===t.tag){var ee=ue(e[1],t[0]);return[i.__(21,[e[0],ee[0]]),ee[1]]}throw ie;case 23:var te=e[0],re=e[1],ne=t;if("number"==typeof te){if(3===te){if("number"==typeof ne)throw ie;if(14===ne.tag){var ce=ue(re,ne[0]);return[i.__(23,[3,ce[0]]),ce[1]]}throw ie}return se(te,re,ne)}switch(0|te.tag){case 7:return se(i.__(7,[te[0],te[1]]),re,ne);case 8:var le=function e(t,r,n){if("number"==typeof t)return[0,ue(r,n)];switch(0|t.tag){case 0:if("number"==typeof n)throw ie;if(n.tag)throw ie;var a=e(t[0],r,n[0]);return[i.__(0,[a[0]]),a[1]];case 1:if("number"==typeof n)throw ie;if(1===n.tag){var s=e(t[0],r,n[0]);return[i.__(1,[s[0]]),s[1]]}throw ie;case 2:if("number"==typeof n)throw ie;if(2===n.tag){var u=e(t[0],r,n[0]);return[i.__(2,[u[0]]),u[1]]}throw ie;case 3:if("number"==typeof n)throw ie;if(3===n.tag){var c=e(t[0],r,n[0]);return[i.__(3,[c[0]]),c[1]]}throw ie;case 4:if("number"==typeof n)throw ie;if(4===n.tag){var l=e(t[0],r,n[0]);return[i.__(4,[l[0]]),l[1]]}throw ie;case 5:if("number"==typeof n)throw ie;if(5===n.tag){var p=e(t[0],r,n[0]);return[i.__(5,[p[0]]),p[1]]}throw ie;case 6:if("number"==typeof n)throw ie;if(6===n.tag){var h=e(t[0],r,n[0]);return[i.__(6,[h[0]]),h[1]]}throw ie;case 7:if("number"==typeof n)throw ie;if(7===n.tag){var d=e(t[0],r,n[0]);return[i.__(7,[d[0]]),d[1]]}throw ie;case 8:if("number"==typeof n)throw ie;if(8===n.tag){var m=n[0];if(f.caml_notequal([t[0]],[m]))throw ie;var g=e(t[1],r,n[1]);return[i.__(8,[m,g[0]]),g[1]]}throw ie;case 9:if("number"==typeof n)throw ie;if(9===n.tag){var v=n[1],_=n[0];if(f.caml_notequal([x.erase_rel(t[0])],[x.erase_rel(_)]))throw ie;if(f.caml_notequal([x.erase_rel(t[1])],[x.erase_rel(v)]))throw ie;var y=Q(Z(_),v),b=K(y);o._1(b[1],0),o._1(b[3],0);var w=e(x.erase_rel(t[2]),r,n[2]);return[i.__(9,[_,v,Z(w[0])]),w[1]]}throw ie;case 10:if("number"==typeof n)throw ie;if(10===n.tag){var $=e(t[0],r,n[0]);return[i.__(10,[$[0]]),$[1]]}throw ie;case 11:if("number"==typeof n)throw ie;if(11===n.tag){var E=e(t[0],r,n[0]);return[i.__(11,[E[0]]),E[1]]}throw ie;case 12:throw ie;case 13:if("number"==typeof n)throw ie;if(13===n.tag){var M=e(t[0],r,n[0]);return[i.__(13,[M[0]]),M[1]]}throw ie;case 14:if("number"==typeof n)throw ie;if(14===n.tag){var T=e(t[0],r,n[0]);return[i.__(14,[T[0]]),T[1]]}throw ie}}(te[1],re,ne),fe=le[1];return[i.__(23,[i.__(8,[te[0],le[0]]),fe[0]]),fe[1]];default:return se(te,re,ne)}case 22:case 24:throw ie}}function ce(e,t){var r=ue(e,t);if("number"==typeof r[1])return r[0];throw ie}function le(e,t){return ce(e,x.erase_rel(Z(t)))}function fe(e,t,r){var n=r.length,i=m.abs(t),o=t<0?0:e;if(i<=n)return r;var s=a.make(i,2===o?48:32);switch(o){case 0:c.blit(r,0,s,0,n);break;case 1:c.blit(r,0,s,i-n|0,n);break;case 2:n>0&&(43===v.get(r,0)||45===v.get(r,0)||32===v.get(r,0))?(s[0]=v.get(r,0),c.blit(r,1,s,1+(i-n|0)|0,n-1|0)):n>1&&48===v.get(r,0)&&(120===v.get(r,1)||88===v.get(r,1))?(s[1]=v.get(r,1),c.blit(r,2,s,2+(i-n|0)|0,n-2|0)):c.blit(r,0,s,i-n|0,n)}return v.bytes_to_string(s)}function pe(e,t){var r=m.abs(e),n=t.length,i=v.get(t,0),o=0;if(i>=58)if(i>=71){if(i>102||i<97)return t;o=2}else{if(!(i>=65))return t;o=2}else if(32!==i){if(!(i>=43))return t;switch(i-43|0){case 0:case 2:o=1;break;case 1:case 3:case 4:return t;case 5:if((r+2|0)>n&&n>1&&(120===v.get(t,1)||88===v.get(t,1))){var s=a.make(r+2|0,48);return s[1]=v.get(t,1),c.blit(t,2,s,4+(r-n|0)|0,n-2|0),v.bytes_to_string(s)}o=2;break;case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:o=2}}else o=1;switch(o){case 1:if((r+1|0)>n){var u=a.make(r+1|0,48);return u[0]=i,c.blit(t,1,u,2+(r-n|0)|0,n-1|0),v.bytes_to_string(u)}return t;case 2:if(r>n){var l=a.make(r,48);return c.blit(t,0,l,r-n|0,n),v.bytes_to_string(l)}return t}}function he(e){return c.concat(c.escaped(e),['"',['"',0]])}function de(e,t){var r;switch(e){case 0:r=["%",["d",0]];break;case 1:r=["%+",["d",0]];break;case 2:r=["% ",["d",0]];break;case 3:r=["%",["i",0]];break;case 4:r=["%+",["i",0]];break;case 5:r=["% ",["i",0]];break;case 6:r=["%",["x",0]];break;case 7:r=["%#",["x",0]];break;case 8:r=["%",["X",0]];break;case 9:r=["%#",["X",0]];break;case 10:r=["%",["o",0]];break;case 11:r=["%#",["o",0]];break;case 12:r=["%",["u",0]]}return c.concat(v.bytes_to_string(a.make(1,t)),r)}function me(e,t){return g.caml_format_int(function(e){switch(e){case 0:return"%d";case 1:return"%+d";case 2:return"% d";case 3:return"%i";case 4:return"%+i";case 5:return"% i";case 6:return"%x";case 7:return"%#x";case 8:return"%X";case 9:return"%#X";case 10:return"%o";case 11:return"%#o";case 12:return"%u"}}(e),t)}function ge(e,t){return g.caml_int32_format(de(e,108),t)}function ve(e,t){return g.caml_nativeint_format(de(e,110),t)}function _e(e,t){return g.caml_int64_format(de(e,76),t)}function ye(e,t,r){var n=m.abs(t),i=g.caml_format_float(function(e,t){if(15===e)return"%.12g";var r=m.abs(t),n=P(e),i=[0,new Array(16)];return z(i,37),V(i,e),z(i,46),R(i,""+r),z(i,n),C(i)}(e,n),r);if(15!==e)return i;var a=i.length,o=h.caml_classify_float(r);return 3!==o?o>=4?"nan":function(e){for(;;){var t=e;if(t===a)return 0;var r=v.get(i,t)-46|0;if(r>23||r<0){if(55!==r){e=t+1|0;continue}return 1}if(r>22||r<1)return 1;e=t+1|0}}(0)?i:i+".":r<0?"neg_infinity":"infinity"}function be(e){return c.concat(n.escaped(e),["'",["'",0]])}function xe(e){var t=[0,new Array(16)];return Y(t,e),C(t)}function we(e,t,r,n){for(;;){var a=n,s=r,u=e;if("number"==typeof a)return o._2(u,t,s);switch(0|a.tag){case 0:return function(e,r,n){return function(a){var o=i.__(5,[r,a]);return we(e,t,o,n)}}(u,s,a[0]);case 1:return function(e,r,n){return function(a){var o=be(a),s=i.__(4,[r,o]);return we(e,t,s,n)}}(u,s,a[0]);case 2:return Me(u,t,s,a[1],a[0],function(e){return e});case 3:return Me(u,t,s,a[1],a[0],he);case 4:return Te(u,t,s,a[3],a[1],a[2],me,a[0]);case 5:return Te(u,t,s,a[3],a[1],a[2],ge,a[0]);case 6:return Te(u,t,s,a[3],a[1],a[2],ve,a[0]);case 7:return Te(u,t,s,a[3],a[1],a[2],_e,a[0]);case 8:var c=u,l=t,f=s,p=a[3],h=a[1],d=a[2],m=a[0];if("number"!=typeof h){if(h.tag){var v=h[0];return"number"==typeof d?0!==d?function(e,t,r,n,a,o){return function(s,u,c){var l=fe(o,s,ye(a,u,c));return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,v):function(e,t,r,n,a,o){return function(s,u){var c=ye(a,6,u),l=fe(o,s,c);return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,v):function(e,t,r,n,a,o,s){return function(u,c){var l=fe(o,u,ye(a,s,c));return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,v,d[0])}var _=h[1],y=h[0];return"number"==typeof d?0!==d?function(e,t,r,n,a,o,s){return function(u,c){var l=fe(o,s,ye(a,u,c));return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,y,_):function(e,t,r,n,a,o,s){return function(u){var c=ye(a,6,u),l=fe(o,s,c);return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,y,_):function(e,t,r,n,a,o,s,u){return function(c){var l=fe(o,s,ye(a,u,c));return we(e,t,i.__(4,[r,l]),n)}}(c,l,f,p,m,y,_,d[0])}return"number"==typeof d?0!==d?function(e,t,r,n,a){return function(o,s){var u=ye(a,o,s);return we(e,t,i.__(4,[r,u]),n)}}(c,l,f,p,m):function(e,t,r,n,a){return function(o){var s=ye(a,6,o);return we(e,t,i.__(4,[r,s]),n)}}(c,l,f,p,m):function(e,t,r,n,a,o){return function(s){var u=ye(a,o,s);return we(e,t,i.__(4,[r,u]),n)}}(c,l,f,p,m,d[0]);case 9:return function(e,r,n){return function(a){return we(e,t,i.__(4,[r,a?"true":"false"]),n)}}(u,s,a[0]);case 10:n=a[0],r=i.__(7,[s]);continue;case 11:n=a[1],r=i.__(2,[s,a[0]]);continue;case 12:n=a[1],r=i.__(3,[s,a[0]]);continue;case 13:return function(e,r,n,a){return function(){return we(e,t,i.__(4,[r,a]),n)}}(u,s,a[2],xe(a[1]));case 14:var w=a[2];return function(e,r,n,i){return function(a){return we(e,t,r,x.concat_fmt(le(a[0],n),i))}}(u,s,a[1],w);case 15:return function(e,r,n){return function(a,s){return we(e,t,i.__(6,[r,function(e){return o._2(a,e,s)}]),n)}}(u,s,a[0]);case 16:return function(e,r,n){return function(a){return we(e,t,i.__(6,[r,a]),n)}}(u,s,a[0]);case 17:n=a[1],r=i.__(0,[s,a[0]]);continue;case 18:var $=a[0];if($.tag){var E=function(e,t,r){return function(n,a){return we(e,n,i.__(1,[t,i.__(1,[a])]),r)}}(u,s,a[1]);n=$[0][0],r=0,e=E;continue}var M=function(e,t,r){return function(n,a){return we(e,n,i.__(1,[t,i.__(0,[a])]),r)}}(u,s,a[1]);n=$[0][0],r=0,e=M;continue;case 19:throw[b.assert_failure,["camlinternalFormat.ml",1449,4]];case 20:return function(e,r,n){return function(){return we(e,t,n,r)}}(u,a[2],i.__(8,[s,"Printf: bad conversion %["]));case 21:return function(e,r,n){return function(a){var o=g.caml_format_int("%u",a),s=i.__(4,[r,o]);return we(e,t,s,n)}}(u,s,a[1]);case 22:return function(e,r,n){return function(a){var o=i.__(5,[r,a]);return we(e,t,o,n)}}(u,s,a[0]);case 23:var T=u,S=t,A=s,z=a[0],R=a[1];if("number"==typeof z){if(3===z)throw[b.assert_failure,["camlinternalFormat.ml",1517,39]];return Ee(T,S,A,R)}return 8===z.tag?$e(T,S,A,z[1],R):Ee(T,S,A,R);case 24:return Se(u,t,s,a[2],a[0],o._1(a[1],0))}}}function $e(e,t,r,n,i){if("number"==typeof n)return Ee(e,t,r,i);switch(0|n.tag){case 0:var a=n[0];return function(){return $e(e,t,r,a,i)};case 1:var o=n[0];return function(){return $e(e,t,r,o,i)};case 2:var s=n[0];return function(){return $e(e,t,r,s,i)};case 3:var u=n[0];return function(){return $e(e,t,r,u,i)};case 4:var c=n[0];return function(){return $e(e,t,r,c,i)};case 5:var l=n[0];return function(){return $e(e,t,r,l,i)};case 6:var f=n[0];return function(){return $e(e,t,r,f,i)};case 7:var p=n[0];return function(){return $e(e,t,r,p,i)};case 8:var h=n[1];return function(){return $e(e,t,r,h,i)};case 9:var d=n[2],m=Q(Z(n[0]),n[1]);return function(){return $e(e,t,r,x.concat_fmtty(m,d),i)};case 10:var g=n[0];return function(n,a){return $e(e,t,r,g,i)};case 11:var v=n[0];return function(){return $e(e,t,r,v,i)};case 12:var _=n[0];return function(){return $e(e,t,r,_,i)};case 13:throw[b.assert_failure,["camlinternalFormat.ml",1540,31]];case 14:throw[b.assert_failure,["camlinternalFormat.ml",1541,31]]}}function Ee(e,t,r,n){return we(e,t,i.__(8,[r,"Printf: bad conversion %_"]),n)}function Me(e,t,r,n,a,s){if("number"==typeof a)return function(a){var u=o._1(s,a),c=i.__(4,[r,u]);return we(e,t,c,n)};if(a.tag){var u=a[0];return function(a,c){var l=fe(u,a,o._1(s,c)),f=i.__(4,[r,l]);return we(e,t,f,n)}}var c=a[1],l=a[0];return function(a){var u=fe(l,c,o._1(s,a)),f=i.__(4,[r,u]);return we(e,t,f,n)}}function Te(e,t,r,n,a,s,u,c){if("number"==typeof a){if("number"==typeof s)return 0!==s?function(a,s){var l=pe(a,o._2(u,c,s));return we(e,t,i.__(4,[r,l]),n)}:function(a){var s=o._2(u,c,a);return we(e,t,i.__(4,[r,s]),n)};var l=s[0];return function(a){var s=pe(l,o._2(u,c,a));return we(e,t,i.__(4,[r,s]),n)}}if(a.tag){var f=a[0];if("number"==typeof s)return 0!==s?function(a,s,l){var p=fe(f,a,pe(s,o._2(u,c,l)));return we(e,t,i.__(4,[r,p]),n)}:function(a,s){var l=fe(f,a,o._2(u,c,s));return we(e,t,i.__(4,[r,l]),n)};var p=s[0];return function(a,s){var l=fe(f,a,pe(p,o._2(u,c,s)));return we(e,t,i.__(4,[r,l]),n)}}var h=a[1],d=a[0];if("number"==typeof s)return 0!==s?function(a,s){var l=fe(d,h,pe(a,o._2(u,c,s)));return we(e,t,i.__(4,[r,l]),n)}:function(a){var s=fe(d,h,o._2(u,c,a));return we(e,t,i.__(4,[r,s]),n)};var m=s[0];return function(a){var s=fe(d,h,pe(m,o._2(u,c,a)));return we(e,t,i.__(4,[r,s]),n)}}function Se(e,t,r,n,a,s){if(a){var u=a[0];return function(i){return Se(e,t,r,n,u,o._1(s,i))}}return we(e,t,i.__(4,[r,s]),n)}function Ae(e,t){for(;;){var r=t,n=0;if("number"==typeof r)return 0;switch(0|r.tag){case 0:var i=j(r[1]);return Ae(e,r[0]),s.add_string(e,i);case 1:var a=r[1];if(Ae(e,r[0]),a.tag){s.add_string(e,"@["),t=a[0];continue}s.add_string(e,"@{"),t=a[0];continue;case 2:case 4:n=1;break;case 3:case 5:n=2;break;case 6:return Ae(e,r[0]),s.add_string(e,o._1(r[1],0));case 7:t=r[0];continue;case 8:throw Ae(e,r[0]),[b.invalid_argument,r[1]]}switch(n){case 1:return Ae(e,r[0]),s.add_string(e,r[1]);case 2:return Ae(e,r[0]),s.add_char(e,r[1])}}}function ze(e){var t=s.create(256);return we(function(e,r){Ae(t,r);var n=s.contents(t);throw[b.failure,n]},0,0,e[0])}function Re(e){if(""===e)return[0,4];var t,r,n=e.length,a=function(){return o._1(ze([i.__(11,["invalid box description ",i.__(3,[0,0])]),"invalid box description %S"]),e)},s=function(t){for(;;){var r=t;if(r===n)return r;var i=v.get(e,r);if(9===i)t=r+1|0;else{if(32!==i)return r;t=r+1|0}}},l=s(0),f=function(t,r){for(;;){var i=r;if(i===n)return i;var a=v.get(e,i);if(a>122||a<97)return i;r=i+1|0}}(0,l),p=c.sub(e,l,f-l|0),h=s(f),d=function(t,r){for(;;){var i=r;if(i===n)return i;var a=v.get(e,i);if(a>=48){if(a>=58)return i;r=i+1|0}else{if(45!==a)return i;r=i+1|0}}}(0,h);if(h===d)t=0;else try{t=g.caml_int_of_string(c.sub(e,h,d-h|0))}catch(e){var m=u.internalToOCamlException(e);if(m[0]!==b.failure)throw m;t=a()}switch(s(d)!==n&&a(),p){case"":case"b":r=4;break;case"h":r=0;break;case"hov":r=3;break;case"hv":r=2;break;case"v":r=1;break;default:r=a()}return[t,r]}function Ce(e,t){return"number"==typeof e?[0,t]:e.tag?[i.__(1,[e[0]]),t]:[i.__(0,[e[0],e[1]]),t]}function Le(e,t,r){var n=function(e,t){return"number"==typeof e?0!==e?[1,t]:[0,t]:[[e[0]],t]}(t,r),a=n[1],o=n[0];return"number"==typeof e?[0,o,a]:e.tag?[i.__(1,[e[0]]),o,a]:[i.__(0,[e[0],e[1]]),o,a]}function Pe(e,t){var r=e?e[0]:1,n=function(e,r){return o._3(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", ",i.__(2,[0,0])])])])])]),"invalid format %S: at character number %d, %s"]),t,e,r)},s=function(e,r,n){return o._4(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", '",i.__(0,[i.__(11,["' without ",i.__(2,[0,0])])])])])])])]),"invalid format %S: at character number %d, '%c' without %s"]),t,e,r,n)},l=function(e,r,n){return o._4(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", ",i.__(2,[0,i.__(11,[" expected, read ",i.__(1,[0])])])])])])])]),"invalid format %S: at character number %d, %s expected, read %C"]),t,e,r,n)},p=function(e,t,n,i,a,o){for(;;){var s=a,u=i,c=n,l=0,f=0;if(0!==c)if(0!==u)f=2;else if(0!==s)l=1;else{if(100===o)return 1;if(105===o)return 4;l=1}else if(0!==u)if(0!==s)f=2;else{if(88===o)return 9;if(111===o)return 11;if(120===o)return 7;f=2}else if(0!==s){if(100===o)return 2;if(105===o)return 5;l=1}else{var p=o-88|0;if(p>32||p<0)l=1;else switch(p){case 0:return 8;case 12:return 0;case 17:return 3;case 23:return 10;case 29:return 12;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:l=1;break;case 32:return 6}}if(2===f){var d=0,m=o-88|0;if(m>32||m<0)l=1;else switch(m){case 0:if(r)return 9;l=1;break;case 23:if(r)return 11;l=1;break;case 12:case 17:case 29:d=3;break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:l=1;break;case 32:if(r)return 7;l=1}if(3===d){if(r){i=0;continue}return h(e,t,o,"'#'")}}if(1===l){if(0!==c){if(0!==s){if(r){a=0;continue}return h(e,t,32,"'+'")}if(r){n=0;continue}return h(e,t,o,"'+'")}if(0!==s){if(r){a=0;continue}return h(e,t,o,"' '")}throw[b.assert_failure,["camlinternalFormat.ml",2719,28]]}}},h=function(e,r,n,a){var s=c.sub(t,e,r-e|0);return o._5(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", ",i.__(2,[0,i.__(11,[" is incompatible with '",i.__(0,[i.__(11,["' in sub-format ",i.__(3,[0,0])])])])])])])])])]),"invalid format %S: at character number %d, %s is incompatible with '%c' in sub-format %S"]),t,e,a,n,s)},g=function(e,r,i){for(;;){var a=i,o=e;o===r&&n(r,"unexpected end of format");var s=v.get(t,o);if(s>57||s<48)return[o,a];i=d.imul(a,10)+(s-48|0)|0,e=o+1|0}},_=function(e,r,a,o,s,u,c,l,f,p){r===a&&n(a,"unexpected end of format");var h=function(n){return R(e,r+1|0,a,s,u,c,l,f,p,n,v.get(t,r))};if("number"!=typeof f)return h(f);var d=0;if("number"==typeof p){if(0===p)return h(0);d=1}else d=1;return 1===d?h(0!==o?"number"==typeof p?i.__(1,[0]):i.__(0,[0,p[0]]):"number"==typeof p?i.__(1,[1]):i.__(0,[1,p[0]])):void 0},y=function(e,i,a,o,u,c,l,f,p){i===a&&n(a,"unexpected end of format");var h=v.get(t,i);if(46!==h)return R(e,i+1|0,a,u,c,l,f,p,0,p,h);var d=e,m=i+1|0,y=a,b=o,x=u,w=c,$=l,E=f,M=p;m===y&&n(y,"unexpected end of format");var T=function(e,t){var r=g(t,y,0);return _(d,r[0],y,e,x,w,$,E,M,[r[1]])},S=v.get(t,m),A=0,z=0;if(S>=48){if(!(S>=58))return T(b,m);A=1}else if(S>=42)switch(S-42|0){case 0:return _(d,m+1|0,y,b,x,w,$,E,M,1);case 1:case 3:z=2;break;case 2:case 4:case 5:A=1}else A=1;if(2===z){if(r)return T(b||+(45===S),m+1|0);A=1}return 1===A?r?_(d,m,y,b,x,w,$,E,M,[0]):s(m-1|0,46,"precision"):void 0},x=function(e,r,n){for(;;){var i=r;if(i===n)return T(e,i,0);var a=v.get(t,i);if(37!==a){if(64!==a){r=i+1|0;continue}var o=M(i+1|0,n);return T(e,i,o[0])}var s=$(i,n);return T(e,i,s[0])}},$=function(e,r){var i=e,a=e+1|0,o=r;return a===o&&n(o,"unexpected end of format"),95!==v.get(t,a)?C(i,a,o,0):C(i,a+1|0,o,1)},M=function(e,r){if(e===r)return[i.__(12,[64,0])];var n=v.get(t,e),a=0;if(n>=65)if(n>=94){var o=n-123|0;if(o>2||o<0)a=1;else switch(o){case 0:return I(1,e+1|0,r);case 1:a=1;break;case 2:var s=e+1|0,l=x(s,s,r);return[i.__(17,[1,l[0]])]}}else if(n>=91)switch(n-91|0){case 0:return I(0,e+1|0,r);case 1:a=1;break;case 2:var f=e+1|0,p=x(f,f,r);return[i.__(17,[0,p[0]])]}else a=1;else{if(10===n){var h=e+1|0,d=x(h,h,r);return[i.__(17,[3,d[0]])]}if(n>=32)switch(n-32|0){case 0:var m=e+1|0,g=x(m,m,r);return[i.__(17,[i.__(0,["@ ",1,0]),g[0]])];case 5:if((e+1|0)<r&&37===v.get(t,e+1|0)){var _=e+2|0,y=x(_,_,r);return[i.__(17,[6,y[0]])]}var w=x(e,e,r);return[i.__(12,[64,w[0]])];case 12:var $=e+1|0,E=x($,$,r);return[i.__(17,[i.__(0,["@,",0,0]),E[0]])];case 14:var M=e+1|0,T=x(M,M,r);return[i.__(17,[4,T[0]])];case 27:var z,R=e+1|0,C=r;try{if(R===C||60!==v.get(t,R))throw b.not_found;var L=S(R+1|0,C),P=v.get(t,L),U=0;if(P>=48){if(P>=58)throw b.not_found;U=1}else{if(45!==P)throw b.not_found;U=1}if(1===U){var O=A(L,C),N=O[1],k=S(O[0],C),D=v.get(t,k)-45|0;if(D>12||D<0){if(17!==D)throw b.not_found;var F=c.sub(t,R-2|0,3+(k-R|0)|0);z=[k+1|0,i.__(0,[F,N,0])]}else{if(2===D||1===D)throw b.not_found;var B=A(k,C),G=S(B[0],C);if(62!==v.get(t,G))throw b.not_found;var V=c.sub(t,R-2|0,3+(G-R|0)|0);z=[G+1|0,i.__(0,[V,N,B[1]])]}}}catch(e){var H=u.internalToOCamlException(e);if(H===b.not_found)z=[R,i.__(0,["@;",1,0])];else{if(H[0]!==b.failure)throw H;z=[R,i.__(0,["@;",1,0])]}}var j=z[0],W=x(j,j,C);return[i.__(17,[z[1],W[0]])];case 28:var q,X=e+1|0,Y=r;try{var J=S(X,Y),Z=v.get(t,J),K=0;if(Z>=48?Z>=58?q=0:K=1:45!==Z?q=0:K=1,1===K){var Q=A(J,Y),ee=S(Q[0],Y);if(62!==v.get(t,ee))throw b.not_found;var te=c.sub(t,X-2|0,3+(ee-X|0)|0);q=[[ee+1|0,i.__(1,[te,Q[1]])]]}}catch(e){var re=u.internalToOCamlException(e);if(re===b.not_found)q=0;else{if(re[0]!==b.failure)throw re;q=0}}if(q){var ne=q[0],ie=ne[0],ae=x(ie,ie,Y);return[i.__(17,[ne[1],ae[0]])]}var oe=x(X,X,Y);return[i.__(17,[i.__(2,[60]),oe[0]])];case 1:case 2:case 3:case 4:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 29:case 30:a=1;break;case 31:var se=e+1|0,ue=x(se,se,r);return[i.__(17,[2,ue[0]])];case 32:var ce=e+1|0,le=x(ce,ce,r);return[i.__(17,[5,le[0]])]}else a=1}if(1===a){var fe=e+1|0,pe=x(fe,fe,r);return[i.__(17,[i.__(2,[n]),pe[0]])]}},T=function(e,r,n){var a=r-e|0;return 0!==a?1!==a?[i.__(11,[c.sub(t,e,a),n])]:[i.__(12,[v.get(t,e),n])]:[n]},S=function(e,r){for(;;){var i=e;if(i===r&&n(r,"unexpected end of format"),32!==v.get(t,i))return i;e=i+1|0}},A=function(e,r){e===r&&n(r,"unexpected end of format");var i=v.get(t,e);if(i>=48){if(i>=58)throw[b.assert_failure,["camlinternalFormat.ml",2624,11]];return g(e,r,0)}if(45!==i)throw[b.assert_failure,["camlinternalFormat.ml",2624,11]];(e+1|0)===r&&n(r,"unexpected end of format");var a=v.get(t,e+1|0);if(a>57||a<48)return l(e+1|0,"digit",a);var o=g(e+1|0,r,0);return[o[0],0|-o[1]]},z=function(e,r,a){for(;;){var s=e;if(s===r&&o._3(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[': unclosed sub-format, expected "',i.__(12,[37,i.__(0,[i.__(11,['" at character number ',i.__(4,[0,0,0,0])])])])])])]),'invalid format %S: unclosed sub-format, expected "%%%c" at character number %d']),t,a,r),37===v.get(t,s)){if((s+1|0)===r&&n(r,"unexpected end of format"),v.get(t,s+1|0)===a)return s;var u=v.get(t,s+1|0),c=0;if(u>=95)if(u>=123)if(u>=126)c=1;else switch(u-123|0){case 0:e=z(s+2|0,r,125)+2|0;continue;case 1:c=1;break;case 2:return l(s+1|0,"character ')'",125)}else{if(!(u>=96)){(s+2|0)===r&&n(r,"unexpected end of format");var f=v.get(t,s+2|0);if(40!==f){if(123!==f){e=s+3|0;continue}e=z(s+3|0,r,125)+2|0;continue}e=z(s+3|0,r,41)+2|0;continue}c=1}else{if(40===u){e=z(s+2|0,r,41)+2|0;continue}if(41===u)return l(s+1|0,"character '}'",41);c=1}1!==c||(e=s+2|0)}else e=s+1|0}},R=function(e,a,s,u,c,l,d,m,g,_,y){var w,$=0,E=0,M=0,T=[0],S=0,A=[0],R=function(t,n){return"number"==typeof n?n:n.tag?n[0]>=2?r?i.__(1,[1]):h(e,a,t,"0"):n:n[0]>=2?r?i.__(0,[1,n[1]]):h(e,a,t,"0"):n},C=function(t,n){if("number"==typeof n)return 0;if(n.tag)return h(e,a,t,"'*'");switch(n[0]){case 0:return r?[n[1]]:h(e,a,t,"'-'");case 1:return[n[1]];case 2:return r?[n[1]]:h(e,a,t,"'0'")}},I=0,O=0,N=0;if(y>=124)O=6;else switch(y){case 33:var k=x(a,a,s);w=[i.__(10,[k[0]])];break;case 40:var D=z(a,s,41),F=D+2|0,B=x(F,F,s)[0],G=ee(x(a,a,D)[0]);if(T[0]=1,d){S=1;var V=C(95,m),H=i.__(8,[V,G]);w=[i.__(23,[H,B])]}else S=1,w=[i.__(14,[C(40,m),G,B])];break;case 44:w=x(a,a,s);break;case 37:case 64:O=4;break;case 67:var j=x(a,a,s)[0];T[0]=1,w=d?[i.__(23,[1,j])]:[i.__(1,[j])];break;case 78:var W=x(a,a,s)[0];if(T[0]=1,d){var q=i.__(10,[2]);w=[i.__(23,[q,W])]}else w=[i.__(21,[2,W])];break;case 83:S=1;var X=R(y,_),Y=x(a,a,s)[0];if(T[0]=1,d){S=1;var J=i.__(1,[C(95,_)]);w=[i.__(23,[J,Y])]}else{var Z=Ce(X,Y);w=[i.__(3,[Z[0],Z[1]])]}break;case 91:var K=U(a,s),Q=K[1],te=K[0],re=x(te,te,s)[0];if(T[0]=1,d){S=1;var ne=C(95,m),ie=i.__(9,[ne,Q]);w=[i.__(23,[ie,re])]}else S=1,w=[i.__(20,[C(91,m),Q,re])];break;case 32:case 35:case 43:case 45:case 95:O=5;break;case 97:var ae=x(a,a,s);w=[i.__(15,[ae[0]])];break;case 66:case 98:O=3;break;case 99:var oe=function(e){return T[0]=1,d?[i.__(23,[0,e])]:[i.__(0,[e])]},se=x(a,a,s)[0];S=1;var ue=C(99,m);w=ue?0!==ue[0]?r?oe(se):n(a,"non-zero widths are unsupported for %c conversions"):function(e){return T[0]=1,d?[i.__(23,[4,e])]:[i.__(22,[e])]}(se):oe(se);break;case 69:case 70:case 71:case 101:case 102:case 103:O=2;break;case 76:case 108:case 110:N=8;break;case 114:var ce=x(a,a,s)[0];T[0]=1,w=d?[i.__(23,[3,ce])]:[i.__(19,[ce])];break;case 115:S=1;var le=R(y,_),fe=x(a,a,s)[0];if(T[0]=1,d){S=1;var pe=i.__(0,[C(95,_)]);w=[i.__(23,[pe,fe])]}else{var he=Ce(le,fe);w=[i.__(2,[he[0],he[1]])]}break;case 116:var de=x(a,a,s);w=[i.__(16,[de[0]])];break;case 88:case 100:case 105:case 111:case 117:case 120:N=7;break;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 34:case 36:case 38:case 39:case 41:case 42:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:case 65:case 68:case 72:case 73:case 74:case 75:case 77:case 79:case 80:case 81:case 82:case 84:case 85:case 86:case 87:case 89:case 90:case 92:case 93:case 94:case 96:case 104:case 106:case 107:case 109:case 112:case 113:case 118:case 119:case 121:case 122:O=6;break;case 123:var me=z(a,s,125),ge=x(a,a,me),ve=me+2|0,_e=x(ve,ve,s)[0],ye=ee(ge[0]);if(T[0]=1,d){S=1;var be=C(95,m),xe=i.__(7,[be,ye]);w=[i.__(23,[xe,_e])]}else S=1,w=[i.__(13,[C(123,m),ye,_e])]}switch(N){case 7:$=1,E=1,M=1;var we=p(e,a,u,c,l,y),$e=x(a,a,s)[0];if(T[0]=1,d){S=1;var Ee=C(95,m),Me=i.__(2,[we,Ee]);w=[i.__(23,[Me,$e])]}else{var Te;S=1,A[0]=1;var Se=0;"number"==typeof g&&0===g?Te=m:Se=9,9===Se&&(Te="number"==typeof m?0:m.tag?m[0]>=2?r?i.__(1,[1]):h(e,a,48,"precision"):m:m[0]>=2?r?i.__(0,[1,m[1]]):h(e,a,48,"precision"):m);var Ae=Le(Te,(A[0]=1,g),$e);w=[i.__(4,[we,Ae[0],Ae[1],Ae[2]])]}break;case 8:if(a!==s&&L(v.get(t,a)))O=6;else{var Re=x(a,a,s)[0],Pe=P(y);if(T[0]=1,d){var Ue=i.__(10,[Pe]);w=[i.__(23,[Ue,Re])]}else w=[i.__(21,[Pe,Re])]}}switch(O){case 2:$=1,M=1;var Ie=function(e,t,n,i,a){for(;;){var o=i;if(0!==n){if(0!==o){if(r){i=0;continue}return h(e,t,32,"'+'")}var s=0;if(a>=72){var u=a-101|0;if(u>2||u<0)s=1;else switch(u){case 0:return 4;case 1:return 1;case 2:return 10}}else if(a>=69)switch(a-69|0){case 0:return 7;case 1:s=1;break;case 2:return 13}else s=1;if(1===s){if(r){n=0;continue}return h(e,t,a,"'+'")}}else if(0!==o){var c=0;if(a>=72){var l=a-101|0;if(l>2||l<0)c=1;else switch(l){case 0:return 5;case 1:return 2;case 2:return 11}}else if(a>=69)switch(a-69|0){case 0:return 8;case 1:c=1;break;case 2:return 14}else c=1;if(1===c){if(r){i=0;continue}return h(e,t,a,"' '")}}else if(a>=72){var f=a-101|0;if(f>2||f<0)throw[b.assert_failure,["camlinternalFormat.ml",2747,25]];switch(f){case 0:return 3;case 1:return 0;case 2:return 9}}else{if(!(a>=69))throw[b.assert_failure,["camlinternalFormat.ml",2747,25]];switch(a-69|0){case 0:return 6;case 1:return 15;case 2:return 12}}}}(e,a,u,l,y),Oe=x(a,a,s)[0];if(T[0]=1,d){S=1;var Ne=C(95,m),ke=(A[0]=1,"number"==typeof g?0!==g?h(e,a,95,"'*'"):0:[g[0]]),De=i.__(6,[Ne,ke]);w=[i.__(23,[De,Oe])]}else{S=1;var Fe=Le(m,(A[0]=1,g),Oe);w=[i.__(8,[Ie,Fe[0],Fe[1],Fe[2]])]}break;case 3:var Be=x(a,a,s)[0];T[0]=1,w=d?[i.__(23,[2,Be])]:[i.__(9,[Be])];break;case 4:var Ge=x(a,a,s);w=[i.__(12,[y,Ge[0]])];break;case 5:w=o._3(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", flag ",i.__(1,[i.__(11,[" is only allowed after the '",i.__(12,[37,i.__(11,["', before padding and precision",0])])])])])])])])]),"invalid format %S: at character number %d, flag %C is only allowed after the '%%', before padding and precision"]),t,e,y);break;case 6:if(y>=108)if(y>=111)I=1;else switch(y-108|0){case 0:$=1,E=1,M=1;var Ve=p(e,a+1|0,u,c,l,v.get(t,a)),He=a+1|0,je=x(He,He,s)[0];if(T[0]=1,d){S=1;var We=C(95,m),qe=i.__(3,[Ve,We]);w=[i.__(23,[qe,je])]}else{S=1;var Xe=Le(m,(A[0]=1,g),je);w=[i.__(5,[Ve,Xe[0],Xe[1],Xe[2]])]}break;case 1:I=1;break;case 2:$=1,E=1,M=1;var Ye=p(e,a+1|0,u,c,l,v.get(t,a)),Je=a+1|0,Ze=x(Je,Je,s)[0];if(T[0]=1,d){S=1;var Ke=C(95,m),Qe=i.__(4,[Ye,Ke]);w=[i.__(23,[Qe,Ze])]}else{S=1;var et=Le(m,(A[0]=1,g),Ze);w=[i.__(6,[Ye,et[0],et[1],et[2]])]}}else if(76!==y)I=1;else{$=1,E=1,M=1;var tt=p(e,a+1|0,u,c,l,v.get(t,a)),rt=a+1|0,nt=x(rt,rt,s)[0];if(T[0]=1,d){S=1;var it=C(95,m),at=i.__(5,[tt,it]);w=[i.__(23,[at,nt])]}else{S=1;var ot=Le(m,(A[0]=1,g),nt);w=[i.__(7,[tt,ot[0],ot[1],ot[2]])]}}}if(1===I&&(w=o._3(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[', invalid conversion "',i.__(12,[37,i.__(0,[i.__(12,[34,0])])])])])])])]),'invalid format %S: at character number %d, invalid conversion "%%%c"']),t,a-1|0,y)),r||(!$&&u&&h(e,a,y,"'+'"),!E&&c&&h(e,a,y,"'#'"),!M&&l&&h(e,a,y,"' '"),!S&&f.caml_notequal([m],[0])&&h(e,a,y,"`padding'"),!A[0]&&f.caml_notequal([g],[0])&&h(e,a,d?95:y,"`precision'"),d&&u&&h(e,a,95,"'+'")),!T[0]&&d){var st=0;y>=38?44!==y&&64!==y?st=1:r||(st=1):33!==y?y>=37&&r||(st=1):r||(st=1),1===st&&h(e,a,y,"'_'")}return w},C=function(e,a,u,c){for(var l=[0],f=[0],p=[0],d=[0],m=[0],_=function(e,n){return n[0]&&!r&&o._3(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": at character number ",i.__(4,[0,0,0,i.__(11,[", duplicate flag ",i.__(1,[0])])])])])]),"invalid format %S: at character number %d, duplicate flag %C"]),t,e,v.get(t,e)),n[0]=1,0},b=a;;){var x=b;x===u&&n(u,"unexpected end of format");var w=0,$=v.get(t,x)-32|0;if($>16||$<0)w=1;else switch($){case 0:_(x,d),b=x+1|0;continue;case 3:_(x,m),b=x+1|0;continue;case 11:_(x,p),b=x+1|0;continue;case 13:_(x,f),b=x+1|0;continue;case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 12:case 14:case 15:w=1;break;case 16:_(x,l),b=x+1|0;continue}if(1===w){var E=e,M=x,T=u,S=l[0],A=f[0],z=p[0],R=m[0],C=d[0],L=c;M===T&&n(T,"unexpected end of format");var P=0!==S?0!==A?r?0:h(E,M,45,"0"):2:0!==A?0:1,U=v.get(t,M),I=0;if(U>=48){if(!(U>=58)){var O=g(M,T,0);return y(E,O[0],T,A,z,R,C,L,i.__(0,[P,O[1]]))}I=1}else{if(42===U)return y(E,M+1|0,T,A,z,R,C,L,i.__(1,[P]));I=1}if(1===I)switch(P){case 0:return r||s(M-1|0,45,"padding"),y(E,M,T,A,z,R,C,L,0);case 1:return y(E,M,T,A,z,R,C,L,0);case 2:return y(E,M,T,A,z,R,C,L,i.__(0,[1,0]))}}}},L=function(e){var t=e-88|0;if(t>32||t<0)return 0;switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 18:case 19:case 20:case 21:case 22:case 24:case 25:case 26:case 27:case 28:case 30:case 31:return 0;case 0:case 12:case 17:case 23:case 29:case 32:return 1}},P=function(e){var t=0;if(e>=108)if(e>=111)t=1;else switch(e-108|0){case 0:return 0;case 1:t=1;break;case 2:return 1}else{if(76===e)return 2;t=1}if(1===t)throw[b.assert_failure,["camlinternalFormat.ml",2686,34]]},U=function(e,r){e===r&&n(r,"unexpected end of format");var s=a.make(32,0),u=function(e,t){for(var r=e;r<=t;++r)w(s,m.char_of_int(r));return 0},c=function(e){return o._2(ze([i.__(11,["invalid format ",i.__(3,[0,i.__(11,[": '",i.__(12,[37,i.__(11,["' alone is not accepted in character sets, use ",i.__(12,[37,i.__(12,[37,i.__(11,[" instead at position ",i.__(4,[0,0,0,i.__(12,[46,0])])])])])])])])])]),"invalid format %S: '%%' alone is not accepted in character sets, use %%%% instead at position %d."]),t,e)},l=function(e,r,i){for(;;){var a=i,o=e;o===r&&n(r,"unexpected end of format");var l=v.get(t,o),p=0,h=0;if(l>=46)if(64!==l){if(93===l)return w(s,a),o+1|0;p=1}else h=2;else if(37!==l)if(l>=45){var d=o+1|0,m=r,g=a;d===m&&n(m,"unexpected end of format");var _=v.get(t,d);if(37!==_)return 93!==_?(u(g,_),f(d+1|0,m)):(w(s,g),w(s,45),d+1|0);(d+1|0)===m&&n(m,"unexpected end of format");var y=v.get(t,d+1|0),b=0;if(37!==y){if(64!==y)return c(d);b=1}else b=1;if(1===b)return u(g,y),f(d+2|0,m)}else p=1;else h=2;if(2===h){if(37===a)return w(s,l),f(o+1|0,r);p=1}1!==p||(37===a&&c(o),w(s,a),i=l,e=o+1|0)}},f=function(e,r){for(;;){var i=e;i===r&&n(r,"unexpected end of format");var a=v.get(t,i);if(45!==a)return 93!==a?l(i+1|0,r,a):i+1|0;w(s,45),e=i+1|0}};e===r&&n(r,"unexpected end of format");var p=94!==v.get(t,e)?[e,0]:[e+1|0,1],h=function(e,r){e===r&&n(r,"unexpected end of format");var i=v.get(t,e);return l(e+1|0,r,i)}(p[0],r),d=a.to_string(s);return[h,p[1]?E(d):d]},I=function(e,r,n){try{if(r===n)throw b.not_found;if(60!==v.get(t,r))throw b.not_found;var a=c.index_from(t,r+1|0,62);if(a>=n)throw b.not_found;var o=c.sub(t,r,1+(a-r|0)|0),s=a+1|0,l=x(s,s,n),f=x(r,r,a+1|0)[0],p=[f,o],h=e?i.__(0,[p]):(function(e){if("number"==typeof e)return 0;if(11!==e.tag)return 0;if("number"!=typeof e[1])return 0;try{Re(e[0])}catch(e){var t=u.internalToOCamlException(e);if(t[0]===b.failure)return 0;throw t}}(f),i.__(1,[p]));return[i.__(18,[h,l[0]])]}catch(t){if(t===b.not_found){var d=x(r,r,n),m=[0,""],g=e?i.__(0,[m]):i.__(1,[m]);return[i.__(18,[g,d[0]])]}throw t}};return x(0,0,t.length)}t.is_in_char_set=M,t.rev_char_set=E,t.create_char_set=function(){return a.make(32,0)},t.add_in_char_set=w,t.freeze_char_set=$,t.param_format_of_ignored_format=S,t.make_printf=we,t.output_acc=function e(t,r){for(;;){var n=r,i=0;if("number"==typeof n)return 0;switch(0|n.tag){case 0:var a=j(n[1]);return e(t,n[0]),m.output_string(t,a);case 1:var s=n[1];if(e(t,n[0]),s.tag){m.output_string(t,"@["),r=s[0];continue}m.output_string(t,"@{"),r=s[0];continue;case 2:case 4:i=1;break;case 3:case 5:i=2;break;case 6:return e(t,n[0]),o._1(n[1],t);case 7:return e(t,n[0]),l.caml_ml_flush(t);case 8:throw e(t,n[0]),[b.invalid_argument,n[1]]}switch(i){case 1:return e(t,n[0]),m.output_string(t,n[1]);case 2:return e(t,n[0]),l.caml_ml_output_char(t,n[1])}}},t.bufput_acc=function e(t,r){for(;;){var n=r,i=0;if("number"==typeof n)return 0;switch(0|n.tag){case 0:var a=j(n[1]);return e(t,n[0]),s.add_string(t,a);case 1:var u=n[1];if(e(t,n[0]),u.tag){s.add_string(t,"@["),r=u[0];continue}s.add_string(t,"@{"),r=u[0];continue;case 2:case 4:i=1;break;case 3:case 5:i=2;break;case 6:return e(t,n[0]),o._1(n[1],t);case 7:r=n[0];continue;case 8:throw e(t,n[0]),[b.invalid_argument,n[1]]}switch(i){case 1:return e(t,n[0]),s.add_string(t,n[1]);case 2:return e(t,n[0]),s.add_char(t,n[1])}}},t.strput_acc=Ae,t.type_format=ce,t.fmt_ebb_of_string=Pe,t.format_of_string_fmtty=function(e,t){var r=Pe(0,e);try{return[ce(r[0],t),e]}catch(r){if(r===ie)return o._2(ze([i.__(11,["bad input: format type mismatch between ",i.__(3,[0,i.__(11,[" and ",i.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),e,xe(t));throw r}},t.format_of_string_format=function(e,t){var r=Pe(0,e);try{return[ce(r[0],ee(t[0])),e]}catch(r){if(r===ie)return o._2(ze([i.__(11,["bad input: format type mismatch between ",i.__(3,[0,i.__(11,[" and ",i.__(3,[0,0])])])]),"bad input: format type mismatch between %S and %S"]),e,t[1]);throw r}},t.char_of_iconv=L,t.string_of_formatting_lit=j,t.string_of_formatting_gen=W,t.string_of_fmtty=xe,t.string_of_fmt=function(e){var t=[0,new Array(16)];return function(e,t){for(var r=t,n=0;;){var i=n,a=r;if("number"==typeof a)return 0;switch(0|a.tag){case 0:z(e,37),O(e,i),z(e,99),n=0,r=a[0];continue;case 1:z(e,37),O(e,i),z(e,67),n=0,r=a[0];continue;case 2:z(e,37),O(e,i),k(e,a[0]),z(e,115),n=0,r=a[1];continue;case 3:z(e,37),O(e,i),k(e,a[0]),z(e,83),n=0,r=a[1];continue;case 4:B(e,i,a[0],a[1],a[2]),n=0,r=a[3];continue;case 5:G(e,i,a[0],a[1],a[2],108),n=0,r=a[3];continue;case 6:G(e,i,a[0],a[1],a[2],110),n=0,r=a[3];continue;case 7:G(e,i,a[0],a[1],a[2],76),n=0,r=a[3];continue;case 8:H(e,i,a[0],a[1],a[2]),n=0,r=a[3];continue;case 9:z(e,37),O(e,i),z(e,66),n=0,r=a[0];continue;case 10:R(e,"%!"),r=a[0];continue;case 11:X(e,a[0]),r=a[1];continue;case 12:q(e,a[0]),r=a[1];continue;case 13:z(e,37),O(e,i),N(e,a[0]),z(e,123),Y(e,a[1]),z(e,37),z(e,125),n=0,r=a[2];continue;case 14:z(e,37),O(e,i),N(e,a[0]),z(e,40),Y(e,a[1]),z(e,37),z(e,41),n=0,r=a[2];continue;case 15:z(e,37),O(e,i),z(e,97),n=0,r=a[0];continue;case 16:z(e,37),O(e,i),z(e,116),n=0,r=a[0];continue;case 17:X(e,j(a[0])),r=a[1];continue;case 18:X(e,"@{"),X(e,W(a[0])),r=a[1];continue;case 19:z(e,37),O(e,i),z(e,114),n=0,r=a[0];continue;case 20:z(e,37),O(e,i),N(e,a[0]),I(e,a[1]),n=0,r=a[2];continue;case 21:z(e,37),O(e,i),z(e,U(a[0])),n=0,r=a[1];continue;case 22:z(e,37),O(e,i),X(e,"0c"),n=0,r=a[0];continue;case 23:n=1,r=S(a[0],a[1])[0];continue;case 24:for(var o=1,s=J(a[0]);o<=s;++o)z(e,37),O(e,i),z(e,63);n=0,r=a[2];continue}}}(t,e),C(t)},t.open_box_of_string=Re,t.symm=Z,t.trans=Q,t.recast=le},function(e,t,r){"use strict";var n=r(1);t.get=function(e,t){if(t<0||t>=e.length)throw[n.invalid_argument,"index out of bounds"];return e[t]}},function(e,t,r){"use strict";t.caml_int32_float_of_bits=function(e){var t=new Int32Array([e]);return new Float32Array(t.buffer)[0]},t.caml_int32_bits_of_float=function(e){var t=new Float32Array([e]);return new Int32Array(t.buffer)[0]},t.caml_classify_float=function(e){return isFinite(e)?Math.abs(e)>=2.2250738585072014e-308?0:0!==e?1:2:isNaN(e)?4:3},t.caml_modf_float=function(e){if(isFinite(e)){var t=+(1/e<0),r=Math.abs(e),n=Math.floor(r),i=r-n;return t?[-i,-n]:[i,n]}return isNaN(e)?[NaN,NaN]:[1/e,e]},t.caml_ldexp_float=function(e,t){var r=e,n=t;return n>1023?(n-=1023,r*=Math.pow(2,1023),n>1023&&(n-=1023,r*=Math.pow(2,1023))):n<-1023&&(n+=1023,r*=Math.pow(2,-1023)),r*Math.pow(2,n)},t.caml_frexp_float=function(e){if(0!==e&&isFinite(e)){var t=+(e<0),r=Math.abs(e),n=Math.floor(Math.LOG2E*Math.log(r))+1;return(r*=Math.pow(2,-n))<.5&&(r*=2,n-=1),t&&(r=-r),[r,0|n]}return[e,0]},t.caml_copysign_float=function(e,t){var r=Math.abs(e);return(0===t?1/t:t)<0?-r:r},t.caml_expm1_float=function(e){var t=Math.exp(e),r=t-1;return Math.abs(e)>1?r:0===r?e:e*r/Math.log(t)},t.caml_hypot_float=function(e,t){var r=Math.abs(e),n=Math.abs(t),i=Math.max(r,n),a=Math.min(r,n)/(0!==i?i:1);return i*Math.sqrt(1+a*a)},t.caml_log10_float=function(e){return Math.LOG10E*Math.log(e)}},function(e,t,r){"use strict";var n=r(2).create("Interface-Rts.Unexpected_ranks");t.Unexpected_ranks=n},function(e,t,r){"use strict";var n=r(34),i=n.scalar(1),a=n.vec2(1,1),o=n.vec3(1,1,1),s=n.vec4(1,1,1,1),u=n.mat2(a,a),c=n.mat3(o,o,o),l=n.mat4(s,s,s,s);function f(e){return n.get(e,n.x)}function p(e){return n.get(e,n.y)}function h(e){return n.get(e,n.z)}function d(e){return n.get(e,n.w)}var m=[i,0,d],g=[a,1,d],v=[o,2,d],_=[s,3,d],y=[s,4,d],b=[s,5,d],x=[s,6,d],w=[o,7,d],$=[s,8,d],E=[s,9,d],M=[s,10,d],T=[s,11,d],S=[o,12,d],A=[s,13,d],z=[s,14,d],R=[s,15,d],C=[s,16,d],L=[o,17,d],P=[s,18,d],U=[s,19,d],I=[s,20,d],O=[s,21,d],N=[a,22,d],k=[o,23,d],D=[s,24,d],F=[s,25,d],B=[s,26,d],G=[s,27,d],V=[o,28,d],H=[s,29,d],j=[s,30,d],W=[s,31,d],q=[s,32,d],X=[o,33,d],Y=[s,34,d],J=[s,35,d],Z=[s,36,d],K=[s,37,d],Q=[o,38,d],ee=[s,39,d],te=[s,40,d],re=[s,41,d],ne=[s,42,d],ie=[a,43,d],ae=[o,44,d],oe=[s,45,d],se=[s,46,d],ue=[s,47,d],ce=[s,48,d],le=[o,49,d],fe=[s,50,d],pe=[s,51,d],he=[s,52,d],de=[s,53,d],me=[o,54,d],ge=[s,55,d],ve=[s,56,d],_e=[s,57,d],ye=[s,58,d],be=[o,59,d],xe=[s,60,d],we=[s,61,d],$e=[s,62,d],Ee=[s,63,d],Me=[a,64,d],Te=[o,65,d],Se=[s,66,d],Ae=[s,67,d],ze=[s,68,d],Re=[s,69,d],Ce=[o,70,d],Le=[s,71,d],Pe=[s,72,d],Ue=[s,73,d],Ie=[s,74,d],Oe=[o,75,d],Ne=[s,76,d],ke=[s,77,d],De=[s,78,d],Fe=[s,79,d],Be=[o,80,d],Ge=[s,81,d],Ve=[s,82,d],He=[s,83,d],je=[s,84,d],We=[i,85,h],qe=[a,86,d],Xe=[o,87,d],Ye=[s,88,d],Je=[s,89,d],Ze=[s,90,d],Ke=[s,91,d],Qe=[o,92,d],et=[s,93,d],tt=[s,94,d],rt=[s,95,d],nt=[s,96,d],it=[o,97,d],at=[s,98,d],ot=[s,99,d],st=[s,100,d],ut=[s,101,d],ct=[o,102,d],lt=[s,103,d],ft=[s,104,d],pt=[s,105,d],ht=[s,106,d],dt=[a,107,h],mt=[o,108,d],gt=[s,109,d],vt=[s,110,d],_t=[s,111,d],yt=[s,112,d],bt=[o,113,h],xt=[s,114,d],wt=[s,115,h],$t=[s,116,h],Et=[s,117,h],Mt=[o,118,h],Tt=[s,119,d],St=[s,120,h],At=[s,121,h],zt=[s,122,h],Rt=[o,123,h],Ct=[s,124,d],Lt=[s,125,h],Pt=[s,126,h],Ut=[s,127,h],It=[a,128,h],Ot=[o,129,d],Nt=[s,130,d],kt=[s,131,d],Dt=[s,132,d],Ft=[s,133,d],Bt=[o,134,h],Gt=[s,135,d],Vt=[s,136,h],Ht=[s,137,h],jt=[s,138,h],Wt=[o,139,h],qt=[s,140,d],Xt=[s,141,h],Yt=[s,142,h],Jt=[s,143,h],Zt=[o,144,h],Kt=[s,145,d],Qt=[s,146,h],er=[s,147,h],tr=[s,148,h],rr=[a,149,h],nr=[o,150,d],ir=[s,151,d],ar=[s,152,d],or=[s,153,d],sr=[s,154,d],ur=[o,155,h],cr=[s,156,d],lr=[s,157,h],fr=[s,158,h],pr=[s,159,h],hr=[o,160,h],dr=[s,161,d],mr=[s,162,h],gr=[s,163,h],vr=[s,164,h],_r=[o,165,h],yr=[s,166,d],br=[s,167,h],xr=[s,168,h],wr=[s,169,h],$r=[i,170,f],Er=[a,171,d],Mr=[o,172,d],Tr=[s,173,d],Sr=[s,174,d],Ar=[s,175,d],zr=[s,176,d],Rr=[o,177,d],Cr=[s,178,d],Lr=[s,179,d],Pr=[s,180,d],Ur=[s,181,d],Ir=[o,182,d],Or=[s,183,d],Nr=[s,184,d],kr=[s,185,d],Dr=[s,186,d],Fr=[o,187,d],Br=[s,188,d],Gr=[s,189,d],Vr=[s,190,d],Hr=[s,191,d],jr=[a,192,h],Wr=[o,193,d],qr=[s,194,d],Xr=[s,195,d],Yr=[s,196,d],Jr=[s,197,d],Zr=[o,198,h],Kr=[s,199,d],Qr=[s,200,h],en=[s,201,h],tn=[s,202,h],rn=[o,203,h],nn=[s,204,d],an=[s,205,h],on=[s,206,h],sn=[s,207,h],un=[o,208,h],cn=[s,209,d],ln=[s,210,h],fn=[s,211,h],pn=[s,212,h],hn=[a,213,f],dn=[o,214,d],mn=[s,215,d],gn=[s,216,d],vn=[s,217,d],_n=[s,218,d],yn=[o,219,h],bn=[s,220,d],xn=[s,221,h],wn=[s,222,h],$n=[s,223,h],En=[o,224,f],Mn=[s,225,d],Tn=[s,226,h],Sn=[s,227,f],An=[s,228,f],zn=[o,229,f],Rn=[s,230,d],Cn=[s,231,h],Ln=[s,232,f],Pn=[s,233,f],Un=[a,234,f],In=[o,235,d],On=[s,236,d],Nn=[s,237,d],kn=[s,238,d],Dn=[s,239,d],Fn=[o,240,h],Bn=[s,241,d],Gn=[s,242,h],Vn=[s,243,h],Hn=[s,244,h],jn=[o,245,f],Wn=[s,246,d],qn=[s,247,h],Xn=[s,248,f],Yn=[s,249,f],Jn=[o,250,f],Zn=[s,251,d],Kn=[s,252,h],Qn=[s,253,f],ei=[s,254,f],ti=[i,255,f],ri=[a,256,d],ni=[o,257,d],ii=[s,258,d],ai=[s,259,d],oi=[s,260,d],si=[s,261,d],ui=[o,262,d],ci=[s,263,d],li=[s,264,d],fi=[s,265,d],pi=[s,266,d],hi=[o,267,d],di=[s,268,d],mi=[s,269,d],gi=[s,270,d],vi=[s,271,d],_i=[o,272,d],yi=[s,273,d],bi=[s,274,d],xi=[s,275,d],wi=[s,276,d],$i=[a,277,h],Ei=[o,278,d],Mi=[s,279,d],Ti=[s,280,d],Si=[s,281,d],Ai=[s,282,d],zi=[o,283,h],Ri=[s,284,d],Ci=[s,285,h],Li=[s,286,h],Pi=[s,287,h],Ui=[o,288,h],Ii=[s,289,d],Oi=[s,290,h],Ni=[s,291,h],ki=[s,292,h],Di=[o,293,h],Fi=[s,294,d],Bi=[s,295,h],Gi=[s,296,h],Vi=[s,297,h],Hi=[a,298,f],ji=[o,299,d],Wi=[s,300,d],qi=[s,301,d],Xi=[s,302,d],Yi=[s,303,d],Ji=[o,304,h],Zi=[s,305,d],Ki=[s,306,h],Qi=[s,307,h],ea=[s,308,h],ta=[o,309,f],ra=[s,310,d],na=[s,311,h],ia=[s,312,f],aa=[s,313,f],oa=[o,314,f],sa=[s,315,d],ua=[s,316,h],ca=[s,317,f],la=[s,318,f],fa=[a,319,f],pa=[o,320,d],ha=[s,321,d],da=[s,322,d],ma=[s,323,d],ga=[s,324,d],va=[o,325,h],_a=[s,326,d],ya=[s,327,h],ba=[s,328,h],xa=[s,329,h],wa=[o,330,f],$a=[s,331,d],Ea=[s,332,h],Ma=[s,333,f],Ta=[s,334,f],Sa=[o,335,f],Aa=[s,336,d],za=[s,337,h],Ra=[s,338,f],Ca=[s,339,f],La=[i,340,d],Pa=[a,341,d],Ua=[o,342,d],Ia=[s,343,d],Oa=[s,344,d],Na=[s,345,d],ka=[s,346,d],Da=[o,347,d],Fa=[s,348,d],Ba=[s,349,d],Ga=[s,350,d],Va=[s,351,d],Ha=[o,352,d],ja=[s,353,d],Wa=[s,354,d],qa=[s,355,d],Xa=[s,356,d],Ya=[o,357,d],Ja=[s,358,d],Za=[s,359,d],Ka=[s,360,d],Qa=[s,361,d],eo=[a,362,d],to=[o,363,d],ro=[s,364,d],no=[s,365,d],io=[s,366,d],ao=[s,367,d],oo=[o,368,d],so=[s,369,d],uo=[s,370,d],co=[s,371,d],lo=[s,372,d],fo=[o,373,d],po=[s,374,d],ho=[s,375,d],mo=[s,376,d],go=[s,377,d],vo=[o,378,d],_o=[s,379,d],yo=[s,380,d],bo=[s,381,d],xo=[s,382,d],wo=[a,383,d],$o=[o,384,d],Eo=[s,385,d],Mo=[s,386,d],To=[s,387,d],So=[s,388,d],Ao=[o,389,d],zo=[s,390,d],Ro=[s,391,d],Co=[s,392,d],Lo=[s,393,d],Po=[o,394,d],Uo=[s,395,d],Io=[s,396,d],Oo=[s,397,d],No=[s,398,d],ko=[o,399,d],Do=[s,400,d],Fo=[s,401,d],Bo=[s,402,d],Go=[s,403,d],Vo=[a,404,d],Ho=[o,405,d],jo=[s,406,d],Wo=[s,407,d],qo=[s,408,d],Xo=[s,409,d],Yo=[o,410,d],Jo=[s,411,d],Zo=[s,412,d],Ko=[s,413,d],Qo=[s,414,d],es=[o,415,d],ts=[s,416,d],rs=[s,417,d],ns=[s,418,d],is=[s,419,d],as=[o,420,d],os=[s,421,d],ss=[s,422,d],us=[s,423,d],cs=[s,424,d],ls=[i,425,f],fs=[a,426,d],ps=[o,427,d],hs=[s,428,d],ds=[s,429,d],ms=[s,430,d],gs=[s,431,d],vs=[o,432,d],_s=[s,433,d],ys=[s,434,d],bs=[s,435,d],xs=[s,436,d],ws=[o,437,d],$s=[s,438,d],Es=[s,439,d],Ms=[s,440,d],Ts=[s,441,d],Ss=[o,442,d],As=[s,443,d],zs=[s,444,d],Rs=[s,445,d],Cs=[s,446,d],Ls=[a,447,f],Ps=[o,448,d],Us=[s,449,d],Is=[s,450,d],Os=[s,451,d],Ns=[s,452,d],ks=[o,453,f],Ds=[s,454,d],Fs=[s,455,f],Bs=[s,456,p],Gs=[s,457,h],Vs=[o,458,p],Hs=[s,459,d],js=[s,460,p],Ws=[s,461,p],qs=[s,462,h],Xs=[o,463,h],Ys=[s,464,d],Js=[s,465,h],Zs=[s,466,h],Ks=[s,467,h],Qs=[a,468,p],eu=[o,469,d],tu=[s,470,d],ru=[s,471,d],nu=[s,472,d],iu=[s,473,d],au=[o,474,p],ou=[s,475,d],su=[s,476,p],uu=[s,477,p],cu=[s,478,h],lu=[o,479,p],fu=[s,480,d],pu=[s,481,p],hu=[s,482,p],du=[s,483,h],mu=[o,484,h],gu=[s,485,d],vu=[s,486,h],_u=[s,487,h],yu=[s,488,h],bu=[a,489,h],xu=[o,490,d],wu=[s,491,d],$u=[s,492,d],Eu=[s,493,d],Mu=[s,494,d],Tu=[o,495,h],Su=[s,496,d],Au=[s,497,h],zu=[s,498,h],Ru=[s,499,h],Cu=[o,500,h],Lu=[s,501,d],Pu=[s,502,h],Uu=[s,503,h],Iu=[s,504,h],Ou=[o,505,h],Nu=[s,506,d],ku=[s,507,h],Du=[s,508,h],Fu=[s,509,h],Bu=[i,510,p],Gu=[a,511,d],Vu=[o,512,d],Hu=[s,513,d],ju=[s,514,d],Wu=[s,515,d],qu=[s,516,d],Xu=[o,517,d],Yu=[s,518,d],Ju=[s,519,d],Zu=[s,520,d],Ku=[s,521,d],Qu=[o,522,d],ec=[s,523,d],tc=[s,524,d],rc=[s,525,d],nc=[s,526,d],ic=[o,527,d],ac=[s,528,d],oc=[s,529,d],sc=[s,530,d],uc=[s,531,d],cc=[a,532,p],lc=[o,533,d],fc=[s,534,d],pc=[s,535,d],hc=[s,536,d],dc=[s,537,d],mc=[o,538,p],gc=[s,539,d],vc=[s,540,p],_c=[s,541,p],yc=[s,542,h],bc=[o,543,p],xc=[s,544,d],wc=[s,545,p],$c=[s,546,p],Ec=[s,547,h],Mc=[o,548,h],Tc=[s,549,d],Sc=[s,550,h],Ac=[s,551,h],zc=[s,552,h],Rc=[a,553,p],Cc=[o,554,d],Lc=[s,555,d],Pc=[s,556,d],Uc=[s,557,d],Ic=[s,558,d],Oc=[o,559,p],Nc=[s,560,d],kc=[s,561,p],Dc=[s,562,p],Fc=[s,563,h],Bc=[o,564,p],Gc=[s,565,d],Vc=[s,566,p],Hc=[s,567,p],jc=[s,568,h],Wc=[o,569,h],qc=[s,570,d],Xc=[s,571,h],Yc=[s,572,h],Jc=[s,573,h],Zc=[a,574,h],Kc=[o,575,d],Qc=[s,576,d],el=[s,577,d],tl=[s,578,d],rl=[s,579,d],nl=[o,580,h],il=[s,581,d],al=[s,582,h],ol=[s,583,h],sl=[s,584,h],ul=[o,585,h],cl=[s,586,d],ll=[s,587,h],fl=[s,588,h],pl=[s,589,h],hl=[o,590,h],dl=[s,591,d],ml=[s,592,h],gl=[s,593,h],vl=[s,594,h],_l=[i,595,h],yl=[a,596,d],bl=[o,597,d],xl=[s,598,d],wl=[s,599,d],$l=[s,600,d],El=[s,601,d],Ml=[o,602,d],Tl=[s,603,d],Sl=[s,604,d],Al=[s,605,d],zl=[s,606,d],Rl=[o,607,d],Cl=[s,608,d],Ll=[s,609,d],Pl=[s,610,d],Ul=[s,611,d],Il=[o,612,d],Ol=[s,613,d],Nl=[s,614,d],kl=[s,615,d],Dl=[s,616,d],Fl=[a,617,h],Bl=[o,618,d],Gl=[s,619,d],Vl=[s,620,d],Hl=[s,621,d],jl=[s,622,d],Wl=[o,623,h],ql=[s,624,d],Xl=[s,625,h],Yl=[s,626,h],Jl=[s,627,h],Zl=[o,628,h],Kl=[s,629,d],Ql=[s,630,h],ef=[s,631,h],tf=[s,632,h],rf=[o,633,h],nf=[s,634,d],af=[s,635,h],of=[s,636,h],sf=[s,637,h],uf=[a,638,h],cf=[o,639,d],lf=[s,640,d],ff=[s,641,d],pf=[s,642,d],hf=[s,643,d],df=[o,644,h],mf=[s,645,d],gf=[s,646,h],vf=[s,647,h],_f=[s,648,h],yf=[o,649,h],bf=[s,650,d],xf=[s,651,h],wf=[s,652,h],$f=[s,653,h],Ef=[o,654,h],Mf=[s,655,d],Tf=[s,656,h],Sf=[s,657,h],Af=[s,658,h],zf=[a,659,h],Rf=[o,660,d],Cf=[s,661,d],Lf=[s,662,d],Pf=[s,663,d],Uf=[s,664,d],If=[o,665,h],Of=[s,666,d],Nf=[s,667,h],kf=[s,668,h],Df=[s,669,h],Ff=[o,670,h],Bf=[s,671,d],Gf=[s,672,h],Vf=[s,673,h],Hf=[s,674,h],jf=[o,675,h],Wf=[s,676,d],qf=[s,677,h],Xf=[s,678,h],Yf=[s,679,h],Jf=i;t.PhantomAlgebra=0,t.protoScalar=i,t.protoFloat=Jf,t.protoVec2=a,t.protoVec3=o,t.protoVec4=s,t.protoMat2=u,t.protoMat3=c,t.protoMat4=l,t.fmtSwizzle=function(e){switch(e){case 0:return"a";case 1:return"aa";case 2:return"aaa";case 3:return"aaaa";case 4:return"aaab";case 5:return"aaag";case 6:return"aaar";case 7:return"aab";case 8:return"aaba";case 9:return"aabb";case 10:return"aabg";case 11:return"aabr";case 12:return"aag";case 13:return"aaga";case 14:return"aagb";case 15:return"aagg";case 16:return"aagr";case 17:return"aar";case 18:return"aara";case 19:return"aarb";case 20:return"aarg";case 21:return"aarr";case 22:return"ab";case 23:return"aba";case 24:return"abaa";case 25:return"abab";case 26:return"abag";case 27:return"abar";case 28:return"abb";case 29:return"abba";case 30:return"abbb";case 31:return"abbg";case 32:return"abbr";case 33:return"abg";case 34:return"abga";case 35:return"abgb";case 36:return"abgg";case 37:return"abgr";case 38:return"abr";case 39:return"abra";case 40:return"abrb";case 41:return"abrg";case 42:return"abrr";case 43:return"ag";case 44:return"aga";case 45:return"agaa";case 46:return"agab";case 47:return"agag";case 48:return"agar";case 49:return"agb";case 50:return"agba";case 51:return"agbb";case 52:return"agbg";case 53:return"agbr";case 54:return"agg";case 55:return"agga";case 56:return"aggb";case 57:return"aggg";case 58:return"aggr";case 59:return"agr";case 60:return"agra";case 61:return"agrb";case 62:return"agrg";case 63:return"agrr";case 64:return"ar";case 65:return"ara";case 66:return"araa";case 67:return"arab";case 68:return"arag";case 69:return"arar";case 70:return"arb";case 71:return"arba";case 72:return"arbb";case 73:return"arbg";case 74:return"arbr";case 75:return"arg";case 76:return"arga";case 77:return"argb";case 78:return"argg";case 79:return"argr";case 80:return"arr";case 81:return"arra";case 82:return"arrb";case 83:return"arrg";case 84:return"arrr";case 85:return"b";case 86:return"ba";case 87:return"baa";case 88:return"baaa";case 89:return"baab";case 90:return"baag";case 91:return"baar";case 92:return"bab";case 93:return"baba";case 94:return"babb";case 95:return"babg";case 96:return"babr";case 97:return"bag";case 98:return"baga";case 99:return"bagb";case 100:return"bagg";case 101:return"bagr";case 102:return"bar";case 103:return"bara";case 104:return"barb";case 105:return"barg";case 106:return"barr";case 107:return"bb";case 108:return"bba";case 109:return"bbaa";case 110:return"bbab";case 111:return"bbag";case 112:return"bbar";case 113:return"bbb";case 114:return"bbba";case 115:return"bbbb";case 116:return"bbbg";case 117:return"bbbr";case 118:return"bbg";case 119:return"bbga";case 120:return"bbgb";case 121:return"bbgg";case 122:return"bbgr";case 123:return"bbr";case 124:return"bbra";case 125:return"bbrb";case 126:return"bbrg";case 127:return"bbrr";case 128:return"bg";case 129:return"bga";case 130:return"bgaa";case 131:return"bgab";case 132:return"bgag";case 133:return"bgar";case 134:return"bgb";case 135:return"bgba";case 136:return"bgbb";case 137:return"bgbg";case 138:return"bgbr";case 139:return"bgg";case 140:return"bgga";case 141:return"bggb";case 142:return"bggg";case 143:return"bggr";case 144:return"bgr";case 145:return"bgra";case 146:return"bgrb";case 147:return"bgrg";case 148:return"bgrr";case 149:return"br";case 150:return"bra";case 151:return"braa";case 152:return"brab";case 153:return"brag";case 154:return"brar";case 155:return"brb";case 156:return"brba";case 157:return"brbb";case 158:return"brbg";case 159:return"brbr";case 160:return"brg";case 161:return"brga";case 162:return"brgb";case 163:return"brgg";case 164:return"brgr";case 165:return"brr";case 166:return"brra";case 167:return"brrb";case 168:return"brrg";case 169:return"brrr";case 170:return"g";case 171:return"ga";case 172:return"gaa";case 173:return"gaaa";case 174:return"gaab";case 175:return"gaag";case 176:return"gaar";case 177:return"gab";case 178:return"gaba";case 179:return"gabb";case 180:return"gabg";case 181:return"gabr";case 182:return"gag";case 183:return"gaga";case 184:return"gagb";case 185:return"gagg";case 186:return"gagr";case 187:return"gar";case 188:return"gara";case 189:return"garb";case 190:return"garg";case 191:return"garr";case 192:return"gb";case 193:return"gba";case 194:return"gbaa";case 195:return"gbab";case 196:return"gbag";case 197:return"gbar";case 198:return"gbb";case 199:return"gbba";case 200:return"gbbb";case 201:return"gbbg";case 202:return"gbbr";case 203:return"gbg";case 204:return"gbga";case 205:return"gbgb";case 206:return"gbgg";case 207:return"gbgr";case 208:return"gbr";case 209:return"gbra";case 210:return"gbrb";case 211:return"gbrg";case 212:return"gbrr";case 213:return"gg";case 214:return"gga";case 215:return"ggaa";case 216:return"ggab";case 217:return"ggag";case 218:return"ggar";case 219:return"ggb";case 220:return"ggba";case 221:return"ggbb";case 222:return"ggbg";case 223:return"ggbr";case 224:return"ggg";case 225:return"ggga";case 226:return"gggb";case 227:return"gggg";case 228:return"gggr";case 229:return"ggr";case 230:return"ggra";case 231:return"ggrb";case 232:return"ggrg";case 233:return"ggrr";case 234:return"gr";case 235:return"gra";case 236:return"graa";case 237:return"grab";case 238:return"grag";case 239:return"grar";case 240:return"grb";case 241:return"grba";case 242:return"grbb";case 243:return"grbg";case 244:return"grbr";case 245:return"grg";case 246:return"grga";case 247:return"grgb";case 248:return"grgg";case 249:return"grgr";case 250:return"grr";case 251:return"grra";case 252:return"grrb";case 253:return"grrg";case 254:return"grrr";case 255:return"r";case 256:return"ra";case 257:return"raa";case 258:return"raaa";case 259:return"raab";case 260:return"raag";case 261:return"raar";case 262:return"rab";case 263:return"raba";case 264:return"rabb";case 265:return"rabg";case 266:return"rabr";case 267:return"rag";case 268:return"raga";case 269:return"ragb";case 270:return"ragg";case 271:return"ragr";case 272:return"rar";case 273:return"rara";case 274:return"rarb";case 275:return"rarg";case 276:return"rarr";case 277:return"rb";case 278:return"rba";case 279:return"rbaa";case 280:return"rbab";case 281:return"rbag";case 282:return"rbar";case 283:return"rbb";case 284:return"rbba";case 285:return"rbbb";case 286:return"rbbg";case 287:return"rbbr";case 288:return"rbg";case 289:return"rbga";case 290:return"rbgb";case 291:return"rbgg";case 292:return"rbgr";case 293:return"rbr";case 294:return"rbra";case 295:return"rbrb";case 296:return"rbrg";case 297:return"rbrr";case 298:return"rg";case 299:return"rga";case 300:return"rgaa";case 301:return"rgab";case 302:return"rgag";case 303:return"rgar";case 304:return"rgb";case 305:return"rgba";case 306:return"rgbb";case 307:return"rgbg";case 308:return"rgbr";case 309:return"rgg";case 310:return"rgga";case 311:return"rggb";case 312:return"rggg";case 313:return"rggr";case 314:return"rgr";case 315:return"rgra";case 316:return"rgrb";case 317:return"rgrg";case 318:return"rgrr";case 319:return"rr";case 320:return"rra";case 321:return"rraa";case 322:return"rrab";case 323:return"rrag";case 324:return"rrar";case 325:return"rrb";case 326:return"rrba";case 327:return"rrbb";case 328:return"rrbg";case 329:return"rrbr";case 330:return"rrg";case 331:return"rrga";case 332:return"rrgb";case 333:return"rrgg";case 334:return"rrgr";case 335:return"rrr";case 336:return"rrra";case 337:return"rrrb";case 338:return"rrrg";case 339:return"rrrr";case 340:return"w";case 341:return"ww";case 342:return"www";case 343:return"wwww";case 344:return"wwwx";case 345:return"wwwy";case 346:return"wwwz";case 347:return"wwx";case 348:return"wwxw";case 349:return"wwxx";case 350:return"wwxy";case 351:return"wwxz";case 352:return"wwy";case 353:return"wwyw";case 354:return"wwyx";case 355:return"wwyy";case 356:return"wwyz";case 357:return"wwz";case 358:return"wwzw";case 359:return"wwzx";case 360:return"wwzy";case 361:return"wwzz";case 362:return"wx";case 363:return"wxw";case 364:return"wxww";case 365:return"wxwx";case 366:return"wxwy";case 367:return"wxwz";case 368:return"wxx";case 369:return"wxxw";case 370:return"wxxx";case 371:return"wxxy";case 372:return"wxxz";case 373:return"wxy";case 374:return"wxyw";case 375:return"wxyx";case 376:return"wxyy";case 377:return"wxyz";case 378:return"wxz";case 379:return"wxzw";case 380:return"wxzx";case 381:return"wxzy";case 382:return"wxzz";case 383:return"wy";case 384:return"wyw";case 385:return"wyww";case 386:return"wywx";case 387:return"wywy";case 388:return"wywz";case 389:return"wyx";case 390:return"wyxw";case 391:return"wyxx";case 392:return"wyxy";case 393:return"wyxz";case 394:return"wyy";case 395:return"wyyw";case 396:return"wyyx";case 397:return"wyyy";case 398:return"wyyz";case 399:return"wyz";case 400:return"wyzw";case 401:return"wyzx";case 402:return"wyzy";case 403:return"wyzz";case 404:return"wz";case 405:return"wzw";case 406:return"wzww";case 407:return"wzwx";case 408:return"wzwy";case 409:return"wzwz";case 410:return"wzx";case 411:return"wzxw";case 412:return"wzxx";case 413:return"wzxy";case 414:return"wzxz";case 415:return"wzy";case 416:return"wzyw";case 417:return"wzyx";case 418:return"wzyy";case 419:return"wzyz";case 420:return"wzz";case 421:return"wzzw";case 422:return"wzzx";case 423:return"wzzy";case 424:return"wzzz";case 425:return"x";case 426:return"xw";case 427:return"xww";case 428:return"xwww";case 429:return"xwwx";case 430:return"xwwy";case 431:return"xwwz";case 432:return"xwx";case 433:return"xwxw";case 434:return"xwxx";case 435:return"xwxy";case 436:return"xwxz";case 437:return"xwy";case 438:return"xwyw";case 439:return"xwyx";case 440:return"xwyy";case 441:return"xwyz";case 442:return"xwz";case 443:return"xwzw";case 444:return"xwzx";case 445:return"xwzy";case 446:return"xwzz";case 447:return"xx";case 448:return"xxw";case 449:return"xxww";case 450:return"xxwx";case 451:return"xxwy";case 452:return"xxwz";case 453:return"xxx";case 454:return"xxxw";case 455:return"xxxx";case 456:return"xxxy";case 457:return"xxxz";case 458:return"xxy";case 459:return"xxyw";case 460:return"xxyx";case 461:return"xxyy";case 462:return"xxyz";case 463:return"xxz";case 464:return"xxzw";case 465:return"xxzx";case 466:return"xxzy";case 467:return"xxzz";case 468:return"xy";case 469:return"xyw";case 470:return"xyww";case 471:return"xywx";case 472:return"xywy";case 473:return"xywz";case 474:return"xyx";case 475:return"xyxw";case 476:return"xyxx";case 477:return"xyxy";case 478:return"xyxz";case 479:return"xyy";case 480:return"xyyw";case 481:return"xyyx";case 482:return"xyyy";case 483:return"xyyz";case 484:return"xyz";case 485:return"xyzw";case 486:return"xyzx";case 487:return"xyzy";case 488:return"xyzz";case 489:return"xz";case 490:return"xzw";case 491:return"xzww";case 492:return"xzwx";case 493:return"xzwy";case 494:return"xzwz";case 495:return"xzx";case 496:return"xzxw";case 497:return"xzxx";case 498:return"xzxy";case 499:return"xzxz";case 500:return"xzy";case 501:return"xzyw";case 502:return"xzyx";case 503:return"xzyy";case 504:return"xzyz";case 505:return"xzz";case 506:return"xzzw";case 507:return"xzzx";case 508:return"xzzy";case 509:return"xzzz";case 510:return"y";case 511:return"yw";case 512:return"yww";case 513:return"ywww";case 514:return"ywwx";case 515:return"ywwy";case 516:return"ywwz";case 517:return"ywx";case 518:return"ywxw";case 519:return"ywxx";case 520:return"ywxy";case 521:return"ywxz";case 522:return"ywy";case 523:return"ywyw";case 524:return"ywyx";case 525:return"ywyy";case 526:return"ywyz";case 527:return"ywz";case 528:return"ywzw";case 529:return"ywzx";case 530:return"ywzy";case 531:return"ywzz";case 532:return"yx";case 533:return"yxw";case 534:return"yxww";case 535:return"yxwx";case 536:return"yxwy";case 537:return"yxwz";case 538:return"yxx";case 539:return"yxxw";case 540:return"yxxx";case 541:return"yxxy";case 542:return"yxxz";case 543:return"yxy";case 544:return"yxyw";case 545:return"yxyx";case 546:return"yxyy";case 547:return"yxyz";case 548:return"yxz";case 549:return"yxzw";case 550:return"yxzx";case 551:return"yxzy";case 552:return"yxzz";case 553:return"yy";case 554:return"yyw";case 555:return"yyww";case 556:return"yywx";case 557:return"yywy";case 558:return"yywz";case 559:return"yyx";case 560:return"yyxw";case 561:return"yyxx";case 562:return"yyxy";case 563:return"yyxz";case 564:return"yyy";case 565:return"yyyw";case 566:return"yyyx";case 567:return"yyyy";case 568:return"yyyz";case 569:return"yyz";case 570:return"yyzw";case 571:return"yyzx";case 572:return"yyzy";case 573:return"yyzz";case 574:return"yz";case 575:return"yzw";case 576:return"yzww";case 577:return"yzwx";case 578:return"yzwy";case 579:return"yzwz";case 580:return"yzx";case 581:return"yzxw";case 582:return"yzxx";case 583:return"yzxy";case 584:return"yzxz";case 585:return"yzy";case 586:return"yzyw";case 587:return"yzyx";case 588:return"yzyy";case 589:return"yzyz";case 590:return"yzz";case 591:return"yzzw";case 592:return"yzzx";case 593:return"yzzy";case 594:return"yzzz";case 595:return"z";case 596:return"zw";case 597:return"zww";case 598:return"zwww";case 599:return"zwwx";case 600:return"zwwy";case 601:return"zwwz";case 602:return"zwx";case 603:return"zwxw";case 604:return"zwxx";case 605:return"zwxy";case 606:return"zwxz";case 607:return"zwy";case 608:return"zwyw";case 609:return"zwyx";case 610:return"zwyy";case 611:return"zwyz";case 612:return"zwz";case 613:return"zwzw";case 614:return"zwzx";case 615:return"zwzy";case 616:return"zwzz";case 617:return"zx";case 618:return"zxw";case 619:return"zxww";case 620:return"zxwx";case 621:return"zxwy";case 622:return"zxwz";case 623:return"zxx";case 624:return"zxxw";case 625:return"zxxx";case 626:return"zxxy";case 627:return"zxxz";case 628:return"zxy";case 629:return"zxyw";case 630:return"zxyx";case 631:return"zxyy";case 632:return"zxyz";case 633:return"zxz";case 634:return"zxzw";case 635:return"zxzx";case 636:return"zxzy";case 637:return"zxzz";case 638:return"zy";case 639:return"zyw";case 640:return"zyww";case 641:return"zywx";case 642:return"zywy";case 643:return"zywz";case 644:return"zyx";case 645:return"zyxw";case 646:return"zyxx";case 647:return"zyxy";case 648:return"zyxz";case 649:return"zyy";case 650:return"zyyw";case 651:return"zyyx";case 652:return"zyyy";case 653:return"zyyz";case 654:return"zyz";case 655:return"zyzw";case 656:return"zyzx";case 657:return"zyzy";case 658:return"zyzz";case 659:return"zz";case 660:return"zzw";case 661:return"zzww";case 662:return"zzwx";case 663:return"zzwy";case 664:return"zzwz";case 665:return"zzx";case 666:return"zzxw";case 667:return"zzxx";case 668:return"zzxy";case 669:return"zzxz";case 670:return"zzy";case 671:return"zzyw";case 672:return"zzyx";case 673:return"zzyy";case 674:return"zzyz";case 675:return"zzz";case 676:return"zzzw";case 677:return"zzzx";case 678:return"zzzy";case 679:return"zzzz"}},t.accept1=f,t.accept2=p,t.accept3=h,t.accept4=d,t.a$prime=m,t.aa$prime=g,t.aaa$prime=v,t.aaaa$prime=_,t.aaab$prime=y,t.aaag$prime=b,t.aaar$prime=x,t.aab$prime=w,t.aaba$prime=$,t.aabb$prime=E,t.aabg$prime=M,t.aabr$prime=T,t.aag$prime=S,t.aaga$prime=A,t.aagb$prime=z,t.aagg$prime=R,t.aagr$prime=C,t.aar$prime=L,t.aara$prime=P,t.aarb$prime=U,t.aarg$prime=I,t.aarr$prime=O,t.ab$prime=N,t.aba$prime=k,t.abaa$prime=D,t.abab$prime=F,t.abag$prime=B,t.abar$prime=G,t.abb$prime=V,t.abba$prime=H,t.abbb$prime=j,t.abbg$prime=W,t.abbr$prime=q,t.abg$prime=X,t.abga$prime=Y,t.abgb$prime=J,t.abgg$prime=Z,t.abgr$prime=K,t.abr$prime=Q,t.abra$prime=ee,t.abrb$prime=te,t.abrg$prime=re,t.abrr$prime=ne,t.ag$prime=ie,t.aga$prime=ae,t.agaa$prime=oe,t.agab$prime=se,t.agag$prime=ue,t.agar$prime=ce,t.agb$prime=le,t.agba$prime=fe,t.agbb$prime=pe,t.agbg$prime=he,t.agbr$prime=de,t.agg$prime=me,t.agga$prime=ge,t.aggb$prime=ve,t.aggg$prime=_e,t.aggr$prime=ye,t.agr$prime=be,t.agra$prime=xe,t.agrb$prime=we,t.agrg$prime=$e,t.agrr$prime=Ee,t.ar$prime=Me,t.ara$prime=Te,t.araa$prime=Se,t.arab$prime=Ae,t.arag$prime=ze,t.arar$prime=Re,t.arb$prime=Ce,t.arba$prime=Le,t.arbb$prime=Pe,t.arbg$prime=Ue,t.arbr$prime=Ie,t.arg$prime=Oe,t.arga$prime=Ne,t.argb$prime=ke,t.argg$prime=De,t.argr$prime=Fe,t.arr$prime=Be,t.arra$prime=Ge,t.arrb$prime=Ve,t.arrg$prime=He,t.arrr$prime=je,t.b$prime=We,t.ba$prime=qe,t.baa$prime=Xe,t.baaa$prime=Ye,t.baab$prime=Je,t.baag$prime=Ze,t.baar$prime=Ke,t.bab$prime=Qe,t.baba$prime=et,t.babb$prime=tt,t.babg$prime=rt,t.babr$prime=nt,t.bag$prime=it,t.baga$prime=at,t.bagb$prime=ot,t.bagg$prime=st,t.bagr$prime=ut,t.bar$prime=ct,t.bara$prime=lt,t.barb$prime=ft,t.barg$prime=pt,t.barr$prime=ht,t.bb$prime=dt,t.bba$prime=mt,t.bbaa$prime=gt,t.bbab$prime=vt,t.bbag$prime=_t,t.bbar$prime=yt,t.bbb$prime=bt,t.bbba$prime=xt,t.bbbb$prime=wt,t.bbbg$prime=$t,t.bbbr$prime=Et,t.bbg$prime=Mt,t.bbga$prime=Tt,t.bbgb$prime=St,t.bbgg$prime=At,t.bbgr$prime=zt,t.bbr$prime=Rt,t.bbra$prime=Ct,t.bbrb$prime=Lt,t.bbrg$prime=Pt,t.bbrr$prime=Ut,t.bg$prime=It,t.bga$prime=Ot,t.bgaa$prime=Nt,t.bgab$prime=kt,t.bgag$prime=Dt,t.bgar$prime=Ft,t.bgb$prime=Bt,t.bgba$prime=Gt,t.bgbb$prime=Vt,t.bgbg$prime=Ht,t.bgbr$prime=jt,t.bgg$prime=Wt,t.bgga$prime=qt,t.bggb$prime=Xt,t.bggg$prime=Yt,t.bggr$prime=Jt,t.bgr$prime=Zt,t.bgra$prime=Kt,t.bgrb$prime=Qt,t.bgrg$prime=er,t.bgrr$prime=tr,t.br$prime=rr,t.bra$prime=nr,t.braa$prime=ir,t.brab$prime=ar,t.brag$prime=or,t.brar$prime=sr,t.brb$prime=ur,t.brba$prime=cr,t.brbb$prime=lr,t.brbg$prime=fr,t.brbr$prime=pr,t.brg$prime=hr,t.brga$prime=dr,t.brgb$prime=mr,t.brgg$prime=gr,t.brgr$prime=vr,t.brr$prime=_r,t.brra$prime=yr,t.brrb$prime=br,t.brrg$prime=xr,t.brrr$prime=wr,t.g$prime=$r,t.ga$prime=Er,t.gaa$prime=Mr,t.gaaa$prime=Tr,t.gaab$prime=Sr,t.gaag$prime=Ar,t.gaar$prime=zr,t.gab$prime=Rr,t.gaba$prime=Cr,t.gabb$prime=Lr,t.gabg$prime=Pr,t.gabr$prime=Ur,t.gag$prime=Ir,t.gaga$prime=Or,t.gagb$prime=Nr,t.gagg$prime=kr,t.gagr$prime=Dr,t.gar$prime=Fr,t.gara$prime=Br,t.garb$prime=Gr,t.garg$prime=Vr,t.garr$prime=Hr,t.gb$prime=jr,t.gba$prime=Wr,t.gbaa$prime=qr,t.gbab$prime=Xr,t.gbag$prime=Yr,t.gbar$prime=Jr,t.gbb$prime=Zr,t.gbba$prime=Kr,t.gbbb$prime=Qr,t.gbbg$prime=en,t.gbbr$prime=tn,t.gbg$prime=rn,t.gbga$prime=nn,t.gbgb$prime=an,t.gbgg$prime=on,t.gbgr$prime=sn,t.gbr$prime=un,t.gbra$prime=cn,t.gbrb$prime=ln,t.gbrg$prime=fn,t.gbrr$prime=pn,t.gg$prime=hn,t.gga$prime=dn,t.ggaa$prime=mn,t.ggab$prime=gn,t.ggag$prime=vn,t.ggar$prime=_n,t.ggb$prime=yn,t.ggba$prime=bn,t.ggbb$prime=xn,t.ggbg$prime=wn,t.ggbr$prime=$n,t.ggg$prime=En,t.ggga$prime=Mn,t.gggb$prime=Tn,t.gggg$prime=Sn,t.gggr$prime=An,t.ggr$prime=zn,t.ggra$prime=Rn,t.ggrb$prime=Cn,t.ggrg$prime=Ln,t.ggrr$prime=Pn,t.gr$prime=Un,t.gra$prime=In,t.graa$prime=On,t.grab$prime=Nn,t.grag$prime=kn,t.grar$prime=Dn,t.grb$prime=Fn,t.grba$prime=Bn,t.grbb$prime=Gn,t.grbg$prime=Vn,t.grbr$prime=Hn,t.grg$prime=jn,t.grga$prime=Wn,t.grgb$prime=qn,t.grgg$prime=Xn,t.grgr$prime=Yn,t.grr$prime=Jn,t.grra$prime=Zn,t.grrb$prime=Kn,t.grrg$prime=Qn,t.grrr$prime=ei,t.r$prime=ti,t.ra$prime=ri,t.raa$prime=ni,t.raaa$prime=ii,t.raab$prime=ai,t.raag$prime=oi,t.raar$prime=si,t.rab$prime=ui,t.raba$prime=ci,t.rabb$prime=li,t.rabg$prime=fi,t.rabr$prime=pi,t.rag$prime=hi,t.raga$prime=di,t.ragb$prime=mi,t.ragg$prime=gi,t.ragr$prime=vi,t.rar$prime=_i,t.rara$prime=yi,t.rarb$prime=bi,t.rarg$prime=xi,t.rarr$prime=wi,t.rb$prime=$i,t.rba$prime=Ei,t.rbaa$prime=Mi,t.rbab$prime=Ti,t.rbag$prime=Si,t.rbar$prime=Ai,t.rbb$prime=zi,t.rbba$prime=Ri,t.rbbb$prime=Ci,t.rbbg$prime=Li,t.rbbr$prime=Pi,t.rbg$prime=Ui,t.rbga$prime=Ii,t.rbgb$prime=Oi,t.rbgg$prime=Ni,t.rbgr$prime=ki,t.rbr$prime=Di,t.rbra$prime=Fi,t.rbrb$prime=Bi,t.rbrg$prime=Gi,t.rbrr$prime=Vi,t.rg$prime=Hi,t.rga$prime=ji,t.rgaa$prime=Wi,t.rgab$prime=qi,t.rgag$prime=Xi,t.rgar$prime=Yi,t.rgb$prime=Ji,t.rgba$prime=Zi,t.rgbb$prime=Ki,t.rgbg$prime=Qi,t.rgbr$prime=ea,t.rgg$prime=ta,t.rgga$prime=ra,t.rggb$prime=na,t.rggg$prime=ia,t.rggr$prime=aa,t.rgr$prime=oa,t.rgra$prime=sa,t.rgrb$prime=ua,t.rgrg$prime=ca,t.rgrr$prime=la,t.rr$prime=fa,t.rra$prime=pa,t.rraa$prime=ha,t.rrab$prime=da,t.rrag$prime=ma,t.rrar$prime=ga,t.rrb$prime=va,t.rrba$prime=_a,t.rrbb$prime=ya,t.rrbg$prime=ba,t.rrbr$prime=xa,t.rrg$prime=wa,t.rrga$prime=$a,t.rrgb$prime=Ea,t.rrgg$prime=Ma,t.rrgr$prime=Ta,t.rrr$prime=Sa,t.rrra$prime=Aa,t.rrrb$prime=za,t.rrrg$prime=Ra,t.rrrr$prime=Ca,t.w$prime=La,t.ww$prime=Pa,t.www$prime=Ua,t.wwww$prime=Ia,t.wwwx$prime=Oa,t.wwwy$prime=Na,t.wwwz$prime=ka,t.wwx$prime=Da,t.wwxw$prime=Fa,t.wwxx$prime=Ba,t.wwxy$prime=Ga,t.wwxz$prime=Va,t.wwy$prime=Ha,t.wwyw$prime=ja,t.wwyx$prime=Wa,t.wwyy$prime=qa,t.wwyz$prime=Xa,t.wwz$prime=Ya,t.wwzw$prime=Ja,t.wwzx$prime=Za,t.wwzy$prime=Ka,t.wwzz$prime=Qa,t.wx$prime=eo,t.wxw$prime=to,t.wxww$prime=ro,t.wxwx$prime=no,t.wxwy$prime=io,t.wxwz$prime=ao,t.wxx$prime=oo,t.wxxw$prime=so,t.wxxx$prime=uo,t.wxxy$prime=co,t.wxxz$prime=lo,t.wxy$prime=fo,t.wxyw$prime=po,t.wxyx$prime=ho,t.wxyy$prime=mo,t.wxyz$prime=go,t.wxz$prime=vo,t.wxzw$prime=_o,t.wxzx$prime=yo,t.wxzy$prime=bo,t.wxzz$prime=xo,t.wy$prime=wo,t.wyw$prime=$o,t.wyww$prime=Eo,t.wywx$prime=Mo,t.wywy$prime=To,t.wywz$prime=So,t.wyx$prime=Ao,t.wyxw$prime=zo,t.wyxx$prime=Ro,t.wyxy$prime=Co,t.wyxz$prime=Lo,t.wyy$prime=Po,t.wyyw$prime=Uo,t.wyyx$prime=Io,t.wyyy$prime=Oo,t.wyyz$prime=No,t.wyz$prime=ko,t.wyzw$prime=Do,t.wyzx$prime=Fo,t.wyzy$prime=Bo,t.wyzz$prime=Go,t.wz$prime=Vo,t.wzw$prime=Ho,t.wzww$prime=jo,t.wzwx$prime=Wo,t.wzwy$prime=qo,t.wzwz$prime=Xo,t.wzx$prime=Yo,t.wzxw$prime=Jo,t.wzxx$prime=Zo,t.wzxy$prime=Ko,t.wzxz$prime=Qo,t.wzy$prime=es,t.wzyw$prime=ts,t.wzyx$prime=rs,t.wzyy$prime=ns,t.wzyz$prime=is,t.wzz$prime=as,t.wzzw$prime=os,t.wzzx$prime=ss,t.wzzy$prime=us,t.wzzz$prime=cs,t.x$prime=ls,t.xw$prime=fs,t.xww$prime=ps,t.xwww$prime=hs,t.xwwx$prime=ds,t.xwwy$prime=ms,t.xwwz$prime=gs,t.xwx$prime=vs,t.xwxw$prime=_s,t.xwxx$prime=ys,t.xwxy$prime=bs,t.xwxz$prime=xs,t.xwy$prime=ws,t.xwyw$prime=$s,t.xwyx$prime=Es,t.xwyy$prime=Ms,t.xwyz$prime=Ts,t.xwz$prime=Ss,t.xwzw$prime=As,t.xwzx$prime=zs,t.xwzy$prime=Rs,t.xwzz$prime=Cs,t.xx$prime=Ls,t.xxw$prime=Ps,t.xxww$prime=Us,t.xxwx$prime=Is,t.xxwy$prime=Os,t.xxwz$prime=Ns,t.xxx$prime=ks,t.xxxw$prime=Ds,t.xxxx$prime=Fs,t.xxxy$prime=Bs,t.xxxz$prime=Gs,t.xxy$prime=Vs,t.xxyw$prime=Hs,t.xxyx$prime=js,t.xxyy$prime=Ws,t.xxyz$prime=qs,t.xxz$prime=Xs,t.xxzw$prime=Ys,t.xxzx$prime=Js,t.xxzy$prime=Zs,t.xxzz$prime=Ks,t.xy$prime=Qs,t.xyw$prime=eu,t.xyww$prime=tu,t.xywx$prime=ru,t.xywy$prime=nu,t.xywz$prime=iu,t.xyx$prime=au,t.xyxw$prime=ou,t.xyxx$prime=su,t.xyxy$prime=uu,t.xyxz$prime=cu,t.xyy$prime=lu,t.xyyw$prime=fu,t.xyyx$prime=pu,t.xyyy$prime=hu,t.xyyz$prime=du,t.xyz$prime=mu,t.xyzw$prime=gu,t.xyzx$prime=vu,t.xyzy$prime=_u,t.xyzz$prime=yu,t.xz$prime=bu,t.xzw$prime=xu,t.xzww$prime=wu,t.xzwx$prime=$u,t.xzwy$prime=Eu,t.xzwz$prime=Mu,t.xzx$prime=Tu,t.xzxw$prime=Su,t.xzxx$prime=Au,t.xzxy$prime=zu,t.xzxz$prime=Ru,t.xzy$prime=Cu,t.xzyw$prime=Lu,t.xzyx$prime=Pu,t.xzyy$prime=Uu,t.xzyz$prime=Iu,t.xzz$prime=Ou,t.xzzw$prime=Nu,t.xzzx$prime=ku,t.xzzy$prime=Du,t.xzzz$prime=Fu,t.y$prime=Bu,t.yw$prime=Gu,t.yww$prime=Vu,t.ywww$prime=Hu,t.ywwx$prime=ju,t.ywwy$prime=Wu,t.ywwz$prime=qu,t.ywx$prime=Xu,t.ywxw$prime=Yu,t.ywxx$prime=Ju,t.ywxy$prime=Zu,t.ywxz$prime=Ku,t.ywy$prime=Qu,t.ywyw$prime=ec,t.ywyx$prime=tc,t.ywyy$prime=rc,t.ywyz$prime=nc,t.ywz$prime=ic,t.ywzw$prime=ac,t.ywzx$prime=oc,t.ywzy$prime=sc,t.ywzz$prime=uc,t.yx$prime=cc,t.yxw$prime=lc,t.yxww$prime=fc,t.yxwx$prime=pc,t.yxwy$prime=hc,t.yxwz$prime=dc,t.yxx$prime=mc,t.yxxw$prime=gc,t.yxxx$prime=vc,t.yxxy$prime=_c,t.yxxz$prime=yc,t.yxy$prime=bc,t.yxyw$prime=xc,t.yxyx$prime=wc,t.yxyy$prime=$c,t.yxyz$prime=Ec,t.yxz$prime=Mc,t.yxzw$prime=Tc,t.yxzx$prime=Sc,t.yxzy$prime=Ac,t.yxzz$prime=zc,t.yy$prime=Rc,t.yyw$prime=Cc,t.yyww$prime=Lc,t.yywx$prime=Pc,t.yywy$prime=Uc,t.yywz$prime=Ic,t.yyx$prime=Oc,t.yyxw$prime=Nc,t.yyxx$prime=kc,t.yyxy$prime=Dc,t.yyxz$prime=Fc,t.yyy$prime=Bc,t.yyyw$prime=Gc,t.yyyx$prime=Vc,t.yyyy$prime=Hc,t.yyyz$prime=jc,t.yyz$prime=Wc,t.yyzw$prime=qc,t.yyzx$prime=Xc,t.yyzy$prime=Yc,t.yyzz$prime=Jc,t.yz$prime=Zc,t.yzw$prime=Kc,t.yzww$prime=Qc,t.yzwx$prime=el,t.yzwy$prime=tl,t.yzwz$prime=rl,t.yzx$prime=nl,t.yzxw$prime=il,t.yzxx$prime=al,t.yzxy$prime=ol,t.yzxz$prime=sl,t.yzy$prime=ul,t.yzyw$prime=cl,t.yzyx$prime=ll,t.yzyy$prime=fl,t.yzyz$prime=pl,t.yzz$prime=hl,t.yzzw$prime=dl,t.yzzx$prime=ml,t.yzzy$prime=gl,t.yzzz$prime=vl,t.z$prime=_l,t.zw$prime=yl,t.zww$prime=bl,t.zwww$prime=xl,t.zwwx$prime=wl,t.zwwy$prime=$l,t.zwwz$prime=El,t.zwx$prime=Ml,t.zwxw$prime=Tl,t.zwxx$prime=Sl,t.zwxy$prime=Al,t.zwxz$prime=zl,t.zwy$prime=Rl,t.zwyw$prime=Cl,t.zwyx$prime=Ll,t.zwyy$prime=Pl,t.zwyz$prime=Ul,t.zwz$prime=Il,t.zwzw$prime=Ol,t.zwzx$prime=Nl,t.zwzy$prime=kl,t.zwzz$prime=Dl,t.zx$prime=Fl,t.zxw$prime=Bl,t.zxww$prime=Gl,t.zxwx$prime=Vl,t.zxwy$prime=Hl,t.zxwz$prime=jl,t.zxx$prime=Wl,t.zxxw$prime=ql,t.zxxx$prime=Xl,t.zxxy$prime=Yl,t.zxxz$prime=Jl,t.zxy$prime=Zl,t.zxyw$prime=Kl,t.zxyx$prime=Ql,t.zxyy$prime=ef,t.zxyz$prime=tf,t.zxz$prime=rf,t.zxzw$prime=nf,t.zxzx$prime=af,t.zxzy$prime=of,t.zxzz$prime=sf,t.zy$prime=uf,t.zyw$prime=cf,t.zyww$prime=lf,t.zywx$prime=ff,t.zywy$prime=pf,t.zywz$prime=hf,t.zyx$prime=df,t.zyxw$prime=mf,t.zyxx$prime=gf,t.zyxy$prime=vf,t.zyxz$prime=_f,t.zyy$prime=yf,t.zyyw$prime=bf,t.zyyx$prime=xf,t.zyyy$prime=wf,t.zyyz$prime=$f,t.zyz$prime=Ef,t.zyzw$prime=Mf,t.zyzx$prime=Tf,t.zyzy$prime=Sf,t.zyzz$prime=Af,t.zz$prime=zf,t.zzw$prime=Rf,t.zzww$prime=Cf,t.zzwx$prime=Lf,t.zzwy$prime=Pf,t.zzwz$prime=Uf,t.zzx$prime=If,t.zzxw$prime=Of,t.zzxx$prime=Nf,t.zzxy$prime=kf,t.zzxz$prime=Df,t.zzy$prime=Ff,t.zzyw$prime=Bf,t.zzyx$prime=Gf,t.zzyy$prime=Vf,t.zzyz$prime=Hf,t.zzz$prime=jf,t.zzzw$prime=Wf,t.zzzx$prime=qf,t.zzzy$prime=Xf,t.zzzz$prime=Yf},function(e,t,r){"use strict";var n=Math.PI;t.pi=n,t.getRandomInt=function(e){return 0|Math.floor(Math.random()*Math.floor(e))}},function(e,t,r){"use strict";var n=r(57);t.createStats=function(){return new n}},function(e,t,r){var n;n=function(){var e=function(){function t(e){return i.appendChild(e.dom),e}function r(e){for(var t=0;t<i.children.length;t++)i.children[t].style.display=t===e?"block":"none";n=e}var n=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(e){e.preventDefault(),r(++n%i.children.length)},!1);var a=(performance||Date).now(),o=a,s=0,u=t(new e.Panel("FPS","#0ff","#002")),c=t(new e.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new e.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:i,addPanel:t,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){s++;var e=(performance||Date).now();if(c.update(e-a,200),e>o+1e3&&(u.update(1e3*s/(e-o),100),o=e,s=0,l)){var t=performance.memory;l.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:i,setMode:r}};return e.Panel=function(e,t,r){var n=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,u=48*o,c=3*o,l=2*o,f=3*o,p=15*o,h=74*o,d=30*o,m=document.createElement("canvas");m.width=s,m.height=u,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=r,g.fillRect(0,0,s,u),g.fillStyle=t,g.fillText(e,c,l),g.fillRect(f,p,h,d),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(f,p,h,d),{dom:m,update:function(u,v){n=Math.min(n,u),i=Math.max(i,u),g.fillStyle=r,g.globalAlpha=1,g.fillRect(0,0,s,p),g.fillStyle=t,g.fillText(a(u)+" "+e+" ("+a(n)+"-"+a(i)+")",c,l),g.drawImage(m,f+o,p,h-o,d,f,p,h-o,d),g.fillRect(f+h-o,p,o,d),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(f+h-o,p,o,a((1-u/v)*d))}}},e},e.exports=n()},function(e,t,r){"use strict";var n=r(59),i=r(8),a=r(17),o=new n.BoxBufferGeometry(1,1,1,1,1,1),s=new n.MeshBasicMaterial,u=new n.Mesh(o,s),c=new n.SphereBufferGeometry(1,256,256),l=new n.PlaneBufferGeometry(a.getWidth(0),a.getHeight(0),128,128),f=new n.PlaneBufferGeometry(a.getWidth(0),a.getHeight(0),a.getTileWidth(0)<<7,a.getTileHeight(0)<<7),p=new n.PlaneBufferGeometry(1,1,1,1);function h(e){for(var t=e.length,r=new Int32Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e[n];return r}var d=window.partialMemoize4(function(e,t,r,i){var a=e/t,o=new n.PerspectiveCamera(45,a,.1,1e4);return o.position.set(r[0],r[1],r[2]),o.rotation.set(i[0],i[1],i[2]),o});t.protoBox=o,t.protoBoxMaterial=s,t.protoMesh=u,t.protoSphere=c,t.protoPlane=l,t.protoBigPlane=f,t.protoQuad=p,t.reInt32=h,t.createSphereGeometry=function(){return[c.attributes.position.array,c.attributes.uv.array,h(c.index.array)]},t.createBoxGeometry=function(){return[o.attributes.position.array,o.attributes.uv.array,h(o.index.array)]},t.createPlaneGeometry=function(){return[l.attributes.position.array,l.attributes.uv.array,h(l.index.array)]},t.createBigPlaneGeometry=function(){return[f.attributes.position.array,f.attributes.uv.array,h(f.index.array)]},t.createQuadGeometry=function(){return[p.attributes.position.array,p.attributes.uv.array,h(p.index.array)]},t.createTreesGeometry=function(){var e=i.div(2e4,a.getTileWidth(0)),t=function(t){for(var r=t.length,n=new Float32Array(i.imul(r,e)),a=0,o=e-1|0;a<=o;++a)for(var s=0,u=r-1|0;s<=u;++s){var c=t[s];n[i.imul(a,r)+s|0]=c}return n},r=p.attributes.position.array;return[t(r),t(p.attributes.uv.array),function(t,r){for(var n=t.length,a=new Int32Array(i.imul(n,e)),o=0,s=e-1|0;o<=s;++o)for(var u=0,c=n-1|0;u<=c;++u){var l=t[u]+i.imul(o,r)|0;a[i.imul(o,n)+u|0]=l}return a}(h(p.index.array),r.length/3|0)]},t.getObjectMatrix=function(e,t,r){return u.position.set(e[0],e[1],e[2]),u.scale.set(t[0],t[1],t[2]),u.rotation.set(r[0],r[1],r[2]),[(u.updateMatrixWorld(),u.matrixWorld)]},t.getCamera=d,t.getViewMatrices=function(e,t,r){e.updateMatrixWorld();var n=t.clone(),i=e.matrixWorldInverse.clone();i.multiply(n);var a=e.projectionMatrix,o=i.clone();return a.clone(),o.elements=[-.9366722106933594,0,-.3502073884010315,0,-.14800404012203217,.9063078165054321,.39585480093955994,.45315390825271606,.3173956871032715,.4226182699203491,-.8489133715629578,-3.7886908054351807,0,0,0,1],o.transpose(),o.multiply(n),[(r?o:i).elements,a.elements]}},function(e,t,r){"use strict";function n(){}Object.defineProperty(t,"__esModule",{value:!0}),r.d(t,"WebGLRenderTargetCube",function(){return Ft}),r.d(t,"WebGLRenderTarget",function(){return Dt}),r.d(t,"WebGLRenderer",function(){return yi}),r.d(t,"ShaderLib",function(){return Pr}),r.d(t,"UniformsLib",function(){return Rr}),r.d(t,"UniformsUtils",function(){return Cr}),r.d(t,"ShaderChunk",function(){return Lr}),r.d(t,"FogExp2",function(){return bi}),r.d(t,"Fog",function(){return xi}),r.d(t,"Scene",function(){return wi}),r.d(t,"LensFlare",function(){return $i}),r.d(t,"Sprite",function(){return Mi}),r.d(t,"LOD",function(){return Ti}),r.d(t,"SkinnedMesh",function(){return zi}),r.d(t,"Skeleton",function(){return Si}),r.d(t,"Bone",function(){return Ai}),r.d(t,"Mesh",function(){return Wn}),r.d(t,"LineSegments",function(){return Li}),r.d(t,"LineLoop",function(){return Pi}),r.d(t,"Line",function(){return Ci}),r.d(t,"Points",function(){return Ii}),r.d(t,"Group",function(){return Oi}),r.d(t,"VideoTexture",function(){return Ni}),r.d(t,"DataTexture",function(){return Bt}),r.d(t,"CompressedTexture",function(){return ki}),r.d(t,"CubeTexture",function(){return Gt}),r.d(t,"CanvasTexture",function(){return Or}),r.d(t,"DepthTexture",function(){return Di}),r.d(t,"Texture",function(){return Nt}),r.d(t,"CompressedTextureLoader",function(){return lo}),r.d(t,"DataTextureLoader",function(){return fo}),r.d(t,"CubeTextureLoader",function(){return ho}),r.d(t,"TextureLoader",function(){return mo}),r.d(t,"ObjectLoader",function(){return ys}),r.d(t,"MaterialLoader",function(){return cs}),r.d(t,"BufferGeometryLoader",function(){return ls}),r.d(t,"DefaultLoadingManager",function(){return so}),r.d(t,"LoadingManager",function(){return oo}),r.d(t,"JSONLoader",function(){return _s}),r.d(t,"ImageLoader",function(){return po}),r.d(t,"ImageBitmapLoader",function(){return Es}),r.d(t,"FontLoader",function(){return Ss}),r.d(t,"FileLoader",function(){return co}),r.d(t,"Loader",function(){return gs}),r.d(t,"LoaderUtils",function(){return vs}),r.d(t,"Cache",function(){return ao}),r.d(t,"AudioLoader",function(){return js}),r.d(t,"SpotLightShadow",function(){return Go}),r.d(t,"SpotLight",function(){return Vo}),r.d(t,"PointLight",function(){return Ho}),r.d(t,"RectAreaLight",function(){return Xo}),r.d(t,"HemisphereLight",function(){return Fo}),r.d(t,"DirectionalLightShadow",function(){return jo}),r.d(t,"DirectionalLight",function(){return Wo}),r.d(t,"AmbientLight",function(){return qo}),r.d(t,"LightShadow",function(){return Bo}),r.d(t,"Light",function(){return Do}),r.d(t,"StereoCamera",function(){return Ws}),r.d(t,"PerspectiveCamera",function(){return mi}),r.d(t,"OrthographicCamera",function(){return fn}),r.d(t,"CubeCamera",function(){return qs}),r.d(t,"ArrayCamera",function(){return gi}),r.d(t,"Camera",function(){return ln}),r.d(t,"AudioListener",function(){return Xs}),r.d(t,"PositionalAudio",function(){return Js}),r.d(t,"AudioContext",function(){return Hs}),r.d(t,"AudioAnalyser",function(){return Zs}),r.d(t,"Audio",function(){return Ys}),r.d(t,"VectorKeyframeTrack",function(){return ss}),r.d(t,"StringKeyframeTrack",function(){return Yo}),r.d(t,"QuaternionKeyframeTrack",function(){return Qo}),r.d(t,"NumberKeyframeTrack",function(){return ts}),r.d(t,"ColorKeyframeTrack",function(){return es}),r.d(t,"BooleanKeyframeTrack",function(){return Jo}),r.d(t,"PropertyMixer",function(){return Ks}),r.d(t,"PropertyBinding",function(){return eu}),r.d(t,"KeyframeTrack",function(){return os}),r.d(t,"AnimationUtils",function(){return as}),r.d(t,"AnimationObjectGroup",function(){return tu}),r.d(t,"AnimationMixer",function(){return nu}),r.d(t,"AnimationClip",function(){return us}),r.d(t,"Uniform",function(){return iu}),r.d(t,"InstancedBufferGeometry",function(){return au}),r.d(t,"BufferGeometry",function(){return On}),r.d(t,"Geometry",function(){return mn}),r.d(t,"InterleavedBufferAttribute",function(){return ou}),r.d(t,"InstancedInterleavedBuffer",function(){return uu}),r.d(t,"InterleavedBuffer",function(){return su}),r.d(t,"InstancedBufferAttribute",function(){return cu}),r.d(t,"Face3",function(){return pn}),r.d(t,"Object3D",function(){return cn}),r.d(t,"Raycaster",function(){return lu}),r.d(t,"Layers",function(){return rn}),r.d(t,"EventDispatcher",function(){return n}),r.d(t,"Clock",function(){return hu}),r.d(t,"QuaternionLinearInterpolant",function(){return Ko}),r.d(t,"LinearInterpolant",function(){return ns}),r.d(t,"DiscreteInterpolant",function(){return is}),r.d(t,"CubicInterpolant",function(){return rs}),r.d(t,"Interpolant",function(){return Zo}),r.d(t,"Triangle",function(){return jn}),r.d(t,"Math",function(){return Rt}),r.d(t,"Spherical",function(){return du}),r.d(t,"Cylindrical",function(){return mu}),r.d(t,"Plane",function(){return Zr}),r.d(t,"Frustum",function(){return Kr}),r.d(t,"Sphere",function(){return Jr}),r.d(t,"Ray",function(){return Vn}),r.d(t,"Matrix4",function(){return Lt}),r.d(t,"Matrix3",function(){return It}),r.d(t,"Box3",function(){return Yr}),r.d(t,"Box2",function(){return Ur}),r.d(t,"Line3",function(){return Hn}),r.d(t,"Euler",function(){return tn}),r.d(t,"Vector4",function(){return kt}),r.d(t,"Vector3",function(){return Ut}),r.d(t,"Vector2",function(){return Ct}),r.d(t,"Quaternion",function(){return Pt}),r.d(t,"Color",function(){return zr}),r.d(t,"ImmediateRenderObject",function(){return gu}),r.d(t,"VertexNormalsHelper",function(){return vu}),r.d(t,"SpotLightHelper",function(){return _u}),r.d(t,"SkeletonHelper",function(){return yu}),r.d(t,"PointLightHelper",function(){return bu}),r.d(t,"RectAreaLightHelper",function(){return xu}),r.d(t,"HemisphereLightHelper",function(){return wu}),r.d(t,"GridHelper",function(){return $u}),r.d(t,"PolarGridHelper",function(){return Eu}),r.d(t,"FaceNormalsHelper",function(){return Mu}),r.d(t,"DirectionalLightHelper",function(){return Tu}),r.d(t,"CameraHelper",function(){return Su}),r.d(t,"BoxHelper",function(){return Au}),r.d(t,"Box3Helper",function(){return zu}),r.d(t,"PlaneHelper",function(){return Ru}),r.d(t,"ArrowHelper",function(){return Cu}),r.d(t,"AxesHelper",function(){return Lu}),r.d(t,"Shape",function(){return ko}),r.d(t,"Path",function(){return No}),r.d(t,"ShapePath",function(){return Ms}),r.d(t,"Font",function(){return Ts}),r.d(t,"CurvePath",function(){return Oo}),r.d(t,"Curve",function(){return go}),r.d(t,"ShapeUtils",function(){return Sa}),r.d(t,"SceneUtils",function(){return Pu}),r.d(t,"WebGLUtils",function(){return _i}),r.d(t,"WireframeGeometry",function(){return Fi}),r.d(t,"ParametricGeometry",function(){return Bi}),r.d(t,"ParametricBufferGeometry",function(){return Gi}),r.d(t,"TetrahedronGeometry",function(){return ji}),r.d(t,"TetrahedronBufferGeometry",function(){return Wi}),r.d(t,"OctahedronGeometry",function(){return qi}),r.d(t,"OctahedronBufferGeometry",function(){return Xi}),r.d(t,"IcosahedronGeometry",function(){return Yi}),r.d(t,"IcosahedronBufferGeometry",function(){return Ji}),r.d(t,"DodecahedronGeometry",function(){return Zi}),r.d(t,"DodecahedronBufferGeometry",function(){return Ki}),r.d(t,"PolyhedronGeometry",function(){return Vi}),r.d(t,"PolyhedronBufferGeometry",function(){return Hi}),r.d(t,"TubeGeometry",function(){return Qi}),r.d(t,"TubeBufferGeometry",function(){return ea}),r.d(t,"TorusKnotGeometry",function(){return ta}),r.d(t,"TorusKnotBufferGeometry",function(){return ra}),r.d(t,"TorusGeometry",function(){return na}),r.d(t,"TorusBufferGeometry",function(){return ia}),r.d(t,"TextGeometry",function(){return Ra}),r.d(t,"TextBufferGeometry",function(){return Ca}),r.d(t,"SphereGeometry",function(){return La}),r.d(t,"SphereBufferGeometry",function(){return Pa}),r.d(t,"RingGeometry",function(){return Ua}),r.d(t,"RingBufferGeometry",function(){return Ia}),r.d(t,"PlaneGeometry",function(){return Dn}),r.d(t,"PlaneBufferGeometry",function(){return Fn}),r.d(t,"LatheGeometry",function(){return Oa}),r.d(t,"LatheBufferGeometry",function(){return Na}),r.d(t,"ShapeGeometry",function(){return ka}),r.d(t,"ShapeBufferGeometry",function(){return Da}),r.d(t,"ExtrudeGeometry",function(){return Aa}),r.d(t,"ExtrudeBufferGeometry",function(){return za}),r.d(t,"EdgesGeometry",function(){return Ba}),r.d(t,"ConeGeometry",function(){return Ha}),r.d(t,"ConeBufferGeometry",function(){return ja}),r.d(t,"CylinderGeometry",function(){return Ga}),r.d(t,"CylinderBufferGeometry",function(){return Va}),r.d(t,"CircleGeometry",function(){return Wa}),r.d(t,"CircleBufferGeometry",function(){return qa}),r.d(t,"BoxGeometry",function(){return Nn}),r.d(t,"BoxBufferGeometry",function(){return kn}),r.d(t,"ShadowMaterial",function(){return Ya}),r.d(t,"SpriteMaterial",function(){return Ei}),r.d(t,"RawShaderMaterial",function(){return Ja}),r.d(t,"ShaderMaterial",function(){return Gn}),r.d(t,"PointsMaterial",function(){return Ui}),r.d(t,"MeshPhysicalMaterial",function(){return Ka}),r.d(t,"MeshStandardMaterial",function(){return Za}),r.d(t,"MeshPhongMaterial",function(){return Qa}),r.d(t,"MeshToonMaterial",function(){return eo}),r.d(t,"MeshNormalMaterial",function(){return to}),r.d(t,"MeshLambertMaterial",function(){return ro}),r.d(t,"MeshDepthMaterial",function(){return qr}),r.d(t,"MeshDistanceMaterial",function(){return Xr}),r.d(t,"MeshBasicMaterial",function(){return Bn}),r.d(t,"LineDashedMaterial",function(){return no}),r.d(t,"LineBasicMaterial",function(){return Ri}),r.d(t,"Material",function(){return Wr}),r.d(t,"Float64BufferAttribute",function(){return Mn}),r.d(t,"Float32BufferAttribute",function(){return En}),r.d(t,"Uint32BufferAttribute",function(){return $n}),r.d(t,"Int32BufferAttribute",function(){return wn}),r.d(t,"Uint16BufferAttribute",function(){return xn}),r.d(t,"Int16BufferAttribute",function(){return bn}),r.d(t,"Uint8ClampedBufferAttribute",function(){return yn}),r.d(t,"Uint8BufferAttribute",function(){return _n}),r.d(t,"Int8BufferAttribute",function(){return vn}),r.d(t,"BufferAttribute",function(){return gn}),r.d(t,"ArcCurve",function(){return _o}),r.d(t,"CatmullRomCurve3",function(){return Eo}),r.d(t,"CubicBezierCurve",function(){return Ao}),r.d(t,"CubicBezierCurve3",function(){return zo}),r.d(t,"EllipseCurve",function(){return vo}),r.d(t,"LineCurve",function(){return Ro}),r.d(t,"LineCurve3",function(){return Co}),r.d(t,"QuadraticBezierCurve",function(){return Lo}),r.d(t,"QuadraticBezierCurve3",function(){return Po}),r.d(t,"SplineCurve",function(){return Uo}),r.d(t,"REVISION",function(){return h}),r.d(t,"MOUSE",function(){return d}),r.d(t,"CullFaceNone",function(){return m}),r.d(t,"CullFaceBack",function(){return g}),r.d(t,"CullFaceFront",function(){return v}),r.d(t,"CullFaceFrontBack",function(){return _}),r.d(t,"FrontFaceDirectionCW",function(){return y}),r.d(t,"FrontFaceDirectionCCW",function(){return b}),r.d(t,"BasicShadowMap",function(){return x}),r.d(t,"PCFShadowMap",function(){return w}),r.d(t,"PCFSoftShadowMap",function(){return $}),r.d(t,"FrontSide",function(){return E}),r.d(t,"BackSide",function(){return M}),r.d(t,"DoubleSide",function(){return T}),r.d(t,"FlatShading",function(){return S}),r.d(t,"SmoothShading",function(){return A}),r.d(t,"NoColors",function(){return z}),r.d(t,"FaceColors",function(){return R}),r.d(t,"VertexColors",function(){return C}),r.d(t,"NoBlending",function(){return L}),r.d(t,"NormalBlending",function(){return P}),r.d(t,"AdditiveBlending",function(){return U}),r.d(t,"SubtractiveBlending",function(){return I}),r.d(t,"MultiplyBlending",function(){return O}),r.d(t,"CustomBlending",function(){return N}),r.d(t,"AddEquation",function(){return k}),r.d(t,"SubtractEquation",function(){return D}),r.d(t,"ReverseSubtractEquation",function(){return F}),r.d(t,"MinEquation",function(){return B}),r.d(t,"MaxEquation",function(){return G}),r.d(t,"ZeroFactor",function(){return V}),r.d(t,"OneFactor",function(){return H}),r.d(t,"SrcColorFactor",function(){return j}),r.d(t,"OneMinusSrcColorFactor",function(){return W}),r.d(t,"SrcAlphaFactor",function(){return q}),r.d(t,"OneMinusSrcAlphaFactor",function(){return X}),r.d(t,"DstAlphaFactor",function(){return Y}),r.d(t,"OneMinusDstAlphaFactor",function(){return J}),r.d(t,"DstColorFactor",function(){return Z}),r.d(t,"OneMinusDstColorFactor",function(){return K}),r.d(t,"SrcAlphaSaturateFactor",function(){return Q}),r.d(t,"NeverDepth",function(){return ee}),r.d(t,"AlwaysDepth",function(){return te}),r.d(t,"LessDepth",function(){return re}),r.d(t,"LessEqualDepth",function(){return ne}),r.d(t,"EqualDepth",function(){return ie}),r.d(t,"GreaterEqualDepth",function(){return ae}),r.d(t,"GreaterDepth",function(){return oe}),r.d(t,"NotEqualDepth",function(){return se}),r.d(t,"MultiplyOperation",function(){return ue}),r.d(t,"MixOperation",function(){return ce}),r.d(t,"AddOperation",function(){return le}),r.d(t,"NoToneMapping",function(){return fe}),r.d(t,"LinearToneMapping",function(){return pe}),r.d(t,"ReinhardToneMapping",function(){return he}),r.d(t,"Uncharted2ToneMapping",function(){return de}),r.d(t,"CineonToneMapping",function(){return me}),r.d(t,"UVMapping",function(){return ge}),r.d(t,"CubeReflectionMapping",function(){return ve}),r.d(t,"CubeRefractionMapping",function(){return _e}),r.d(t,"EquirectangularReflectionMapping",function(){return ye}),r.d(t,"EquirectangularRefractionMapping",function(){return be}),r.d(t,"SphericalReflectionMapping",function(){return xe}),r.d(t,"CubeUVReflectionMapping",function(){return we}),r.d(t,"CubeUVRefractionMapping",function(){return $e}),r.d(t,"RepeatWrapping",function(){return Ee}),r.d(t,"ClampToEdgeWrapping",function(){return Me}),r.d(t,"MirroredRepeatWrapping",function(){return Te}),r.d(t,"NearestFilter",function(){return Se}),r.d(t,"NearestMipMapNearestFilter",function(){return Ae}),r.d(t,"NearestMipMapLinearFilter",function(){return ze}),r.d(t,"LinearFilter",function(){return Re}),r.d(t,"LinearMipMapNearestFilter",function(){return Ce}),r.d(t,"LinearMipMapLinearFilter",function(){return Le}),r.d(t,"UnsignedByteType",function(){return Pe}),r.d(t,"ByteType",function(){return Ue}),r.d(t,"ShortType",function(){return Ie}),r.d(t,"UnsignedShortType",function(){return Oe}),r.d(t,"IntType",function(){return Ne}),r.d(t,"UnsignedIntType",function(){return ke}),r.d(t,"FloatType",function(){return De}),r.d(t,"HalfFloatType",function(){return Fe}),r.d(t,"UnsignedShort4444Type",function(){return Be}),r.d(t,"UnsignedShort5551Type",function(){return Ge}),r.d(t,"UnsignedShort565Type",function(){return Ve}),r.d(t,"UnsignedInt248Type",function(){return He}),r.d(t,"AlphaFormat",function(){return je}),r.d(t,"RGBFormat",function(){return We}),r.d(t,"RGBAFormat",function(){return qe}),r.d(t,"LuminanceFormat",function(){return Xe}),r.d(t,"LuminanceAlphaFormat",function(){return Ye}),r.d(t,"RGBEFormat",function(){return Je}),r.d(t,"DepthFormat",function(){return Ze}),r.d(t,"DepthStencilFormat",function(){return Ke}),r.d(t,"RGB_S3TC_DXT1_Format",function(){return Qe}),r.d(t,"RGBA_S3TC_DXT1_Format",function(){return et}),r.d(t,"RGBA_S3TC_DXT3_Format",function(){return tt}),r.d(t,"RGBA_S3TC_DXT5_Format",function(){return rt}),r.d(t,"RGB_PVRTC_4BPPV1_Format",function(){return nt}),r.d(t,"RGB_PVRTC_2BPPV1_Format",function(){return it}),r.d(t,"RGBA_PVRTC_4BPPV1_Format",function(){return at}),r.d(t,"RGBA_PVRTC_2BPPV1_Format",function(){return ot}),r.d(t,"RGB_ETC1_Format",function(){return st}),r.d(t,"LoopOnce",function(){return ut}),r.d(t,"LoopRepeat",function(){return ct}),r.d(t,"LoopPingPong",function(){return lt}),r.d(t,"InterpolateDiscrete",function(){return ft}),r.d(t,"InterpolateLinear",function(){return pt}),r.d(t,"InterpolateSmooth",function(){return ht}),r.d(t,"ZeroCurvatureEnding",function(){return dt}),r.d(t,"ZeroSlopeEnding",function(){return mt}),r.d(t,"WrapAroundEnding",function(){return gt}),r.d(t,"TrianglesDrawMode",function(){return vt}),r.d(t,"TriangleStripDrawMode",function(){return _t}),r.d(t,"TriangleFanDrawMode",function(){return yt}),r.d(t,"LinearEncoding",function(){return bt}),r.d(t,"sRGBEncoding",function(){return xt}),r.d(t,"GammaEncoding",function(){return wt}),r.d(t,"RGBEEncoding",function(){return $t}),r.d(t,"LogLuvEncoding",function(){return Et}),r.d(t,"RGBM7Encoding",function(){return Mt}),r.d(t,"RGBM16Encoding",function(){return Tt}),r.d(t,"RGBDEncoding",function(){return St}),r.d(t,"BasicDepthPacking",function(){return At}),r.d(t,"RGBADepthPacking",function(){return zt}),r.d(t,"CubeGeometry",function(){return Nn}),r.d(t,"Face4",function(){return Uu}),r.d(t,"LineStrip",function(){return Iu}),r.d(t,"LinePieces",function(){return Ou}),r.d(t,"MeshFaceMaterial",function(){return Nu}),r.d(t,"MultiMaterial",function(){return ku}),r.d(t,"PointCloud",function(){return Du}),r.d(t,"Particle",function(){return Fu}),r.d(t,"ParticleSystem",function(){return Bu}),r.d(t,"PointCloudMaterial",function(){return Gu}),r.d(t,"ParticleBasicMaterial",function(){return Vu}),r.d(t,"ParticleSystemMaterial",function(){return Hu}),r.d(t,"Vertex",function(){return ju}),r.d(t,"DynamicBufferAttribute",function(){return Wu}),r.d(t,"Int8Attribute",function(){return qu}),r.d(t,"Uint8Attribute",function(){return Xu}),r.d(t,"Uint8ClampedAttribute",function(){return Yu}),r.d(t,"Int16Attribute",function(){return Ju}),r.d(t,"Uint16Attribute",function(){return Zu}),r.d(t,"Int32Attribute",function(){return Ku}),r.d(t,"Uint32Attribute",function(){return Qu}),r.d(t,"Float32Attribute",function(){return ec}),r.d(t,"Float64Attribute",function(){return tc}),r.d(t,"ClosedSplineCurve3",function(){return rc}),r.d(t,"SplineCurve3",function(){return nc}),r.d(t,"Spline",function(){return ic}),r.d(t,"AxisHelper",function(){return ac}),r.d(t,"BoundingBoxHelper",function(){return oc}),r.d(t,"EdgesHelper",function(){return sc}),r.d(t,"WireframeHelper",function(){return uc}),r.d(t,"XHRLoader",function(){return cc}),r.d(t,"BinaryTextureLoader",function(){return lc}),r.d(t,"GeometryUtils",function(){return fc}),r.d(t,"ImageUtils",function(){return pc}),r.d(t,"Projector",function(){return hc}),r.d(t,"CanvasRenderer",function(){return dc}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),void 0===Math.sign&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype==!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),Object.assign(n.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var r=this._listeners[e];if(void 0!==r){var n=r.indexOf(t);-1!==n&&r.splice(n,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var r=t.slice(0),n=0,i=r.length;n<i;n++)r[n].call(this,e)}}}});var i,a,o,s,u,c,l,f,p,h="89",d={LEFT:0,MIDDLE:1,RIGHT:2},m=0,g=1,v=2,_=3,y=0,b=1,x=0,w=1,$=2,E=0,M=1,T=2,S=1,A=2,z=0,R=1,C=2,L=0,P=1,U=2,I=3,O=4,N=5,k=100,D=101,F=102,B=103,G=104,V=200,H=201,j=202,W=203,q=204,X=205,Y=206,J=207,Z=208,K=209,Q=210,ee=0,te=1,re=2,ne=3,ie=4,ae=5,oe=6,se=7,ue=0,ce=1,le=2,fe=0,pe=1,he=2,de=3,me=4,ge=300,ve=301,_e=302,ye=303,be=304,xe=305,we=306,$e=307,Ee=1e3,Me=1001,Te=1002,Se=1003,Ae=1004,ze=1005,Re=1006,Ce=1007,Le=1008,Pe=1009,Ue=1010,Ie=1011,Oe=1012,Ne=1013,ke=1014,De=1015,Fe=1016,Be=1017,Ge=1018,Ve=1019,He=1020,je=1021,We=1022,qe=1023,Xe=1024,Ye=1025,Je=qe,Ze=1026,Ke=1027,Qe=2001,et=2002,tt=2003,rt=2004,nt=2100,it=2101,at=2102,ot=2103,st=2151,ut=2200,ct=2201,lt=2202,ft=2300,pt=2301,ht=2302,dt=2400,mt=2401,gt=2402,vt=0,_t=1,yt=2,bt=3e3,xt=3001,wt=3007,$t=3002,Et=3003,Mt=3004,Tt=3005,St=3006,At=3200,zt=3201,Rt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var e=[],t=0;t<256;t++)e[t]=(t<16?"0":"")+t.toString(16).toUpperCase();return function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return e[255&t]+e[t>>8&255]+e[t>>16&255]+e[t>>24&255]+"-"+e[255&r]+e[r>>8&255]+"-"+e[r>>16&15|64]+e[r>>24&255]+"-"+e[63&n|128]+e[n>>8&255]+"-"+e[n>>16&255]+e[n>>24&255]+e[255&i]+e[i>>8&255]+e[i>>16&255]+e[i>>24&255]}}(),clamp:function(e,t,r){return Math.max(t,Math.min(r,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,r,n,i){return n+(e-t)*(i-n)/(r-t)},lerp:function(e,t,r){return(1-r)*e+r*t},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Rt.DEG2RAD},radToDeg:function(e){return e*Rt.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}};function Ct(e,t){this.x=e||0,this.y=t||0}function Lt(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Pt(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._w=void 0!==n?n:1}function Ut(e,t,r){this.x=e||0,this.y=t||0,this.z=r||0}function It(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ct.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Ct.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:(i=new Ct,a=new Ct,function(e,t){return i.set(e,e),a.set(t,t),this.clamp(i,a)}),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=this.x-e.x,a=this.y-e.y;return this.x=i*r-a*n+e.x,this.y=i*n+a*r+e.y,this}}),Object.assign(Lt.prototype,{isMatrix4:!0,set:function(e,t,r,n,i,a,o,s,u,c,l,f,p,h,d,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=n,g[1]=i,g[5]=a,g[9]=o,g[13]=s,g[2]=u,g[6]=c,g[10]=l,g[14]=f,g[3]=p,g[7]=h,g[11]=d,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Lt).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this},copyPosition:function(e){var t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this},extractBasis:function(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this},extractRotation:(f=new Ut,function(e){var t=this.elements,r=e.elements,n=1/f.setFromMatrixColumn(e,0).length(),i=1/f.setFromMatrixColumn(e,1).length(),a=1/f.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,this}),makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,r=e.x,n=e.y,i=e.z,a=Math.cos(r),o=Math.sin(r),s=Math.cos(n),u=Math.sin(n),c=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var f=a*c,p=a*l,h=o*c,d=o*l;t[0]=s*c,t[4]=-s*l,t[8]=u,t[1]=p+h*u,t[5]=f-d*u,t[9]=-o*s,t[2]=d-f*u,t[6]=h+p*u,t[10]=a*s}else if("YXZ"===e.order){var m=s*c,g=s*l,v=u*c,_=u*l;t[0]=m+_*o,t[4]=v*o-g,t[8]=a*u,t[1]=a*l,t[5]=a*c,t[9]=-o,t[2]=g*o-v,t[6]=_+m*o,t[10]=a*s}else if("ZXY"===e.order){m=s*c,g=s*l,v=u*c,_=u*l;t[0]=m-_*o,t[4]=-a*l,t[8]=v+g*o,t[1]=g+v*o,t[5]=a*c,t[9]=_-m*o,t[2]=-a*u,t[6]=o,t[10]=a*s}else if("ZYX"===e.order){f=a*c,p=a*l,h=o*c,d=o*l;t[0]=s*c,t[4]=h*u-p,t[8]=f*u+d,t[1]=s*l,t[5]=d*u+f,t[9]=p*u-h,t[2]=-u,t[6]=o*s,t[10]=a*s}else if("YZX"===e.order){var y=a*s,b=a*u,x=o*s,w=o*u;t[0]=s*c,t[4]=w-y*l,t[8]=x*l+b,t[1]=l,t[5]=a*c,t[9]=-o*c,t[2]=-u*c,t[6]=b*l+x,t[10]=y-w*l}else if("XZY"===e.order){y=a*s,b=a*u,x=o*s,w=o*u;t[0]=s*c,t[4]=-l,t[8]=u*c,t[1]=y*l+w,t[5]=a*c,t[9]=b*l-x,t[2]=x*l-b,t[6]=o*c,t[10]=w*l+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){var t=this.elements,r=e._x,n=e._y,i=e._z,a=e._w,o=r+r,s=n+n,u=i+i,c=r*o,l=r*s,f=r*u,p=n*s,h=n*u,d=i*u,m=a*o,g=a*s,v=a*u;return t[0]=1-(p+d),t[4]=l-v,t[8]=f+g,t[1]=l+v,t[5]=1-(c+d),t[9]=h-m,t[2]=f-g,t[6]=h+m,t[10]=1-(c+p),t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},lookAt:(u=new Ut,c=new Ut,l=new Ut,function(e,t,r){var n=this.elements;return l.subVectors(e,t),0===l.lengthSq()&&(l.z=1),l.normalize(),u.crossVectors(r,l),0===u.lengthSq()&&(1===Math.abs(r.z)?l.x+=1e-4:l.z+=1e-4,l.normalize(),u.crossVectors(r,l)),u.normalize(),c.crossVectors(l,u),n[0]=u.x,n[4]=c.x,n[8]=l.x,n[1]=u.y,n[5]=c.y,n[9]=l.y,n[2]=u.z,n[6]=c.z,n[10]=l.z,this}),multiply:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[4],s=r[8],u=r[12],c=r[1],l=r[5],f=r[9],p=r[13],h=r[2],d=r[6],m=r[10],g=r[14],v=r[3],_=r[7],y=r[11],b=r[15],x=n[0],w=n[4],$=n[8],E=n[12],M=n[1],T=n[5],S=n[9],A=n[13],z=n[2],R=n[6],C=n[10],L=n[14],P=n[3],U=n[7],I=n[11],O=n[15];return i[0]=a*x+o*M+s*z+u*P,i[4]=a*w+o*T+s*R+u*U,i[8]=a*$+o*S+s*C+u*I,i[12]=a*E+o*A+s*L+u*O,i[1]=c*x+l*M+f*z+p*P,i[5]=c*w+l*T+f*R+p*U,i[9]=c*$+l*S+f*C+p*I,i[13]=c*E+l*A+f*L+p*O,i[2]=h*x+d*M+m*z+g*P,i[6]=h*w+d*T+m*R+g*U,i[10]=h*$+d*S+m*C+g*I,i[14]=h*E+d*A+m*L+g*O,i[3]=v*x+_*M+y*z+b*P,i[7]=v*w+_*T+y*R+b*U,i[11]=v*$+_*S+y*C+b*I,i[15]=v*E+_*A+y*L+b*O,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},applyToBufferAttribute:function(){var e=new Ut;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix4(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),determinant:function(){var e=this.elements,t=e[0],r=e[4],n=e[8],i=e[12],a=e[1],o=e[5],s=e[9],u=e[13],c=e[2],l=e[6],f=e[10],p=e[14];return e[3]*(+i*s*l-n*u*l-i*o*f+r*u*f+n*o*p-r*s*p)+e[7]*(+t*s*p-t*u*f+i*a*f-n*a*p+n*u*c-i*s*c)+e[11]*(+t*u*l-t*o*p-i*a*l+r*a*p+i*o*c-r*u*c)+e[15]*(-n*o*c-t*s*l+t*o*f+n*a*l-r*a*f+r*s*c)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e){var t=this.elements;return t[12]=e.x,t[13]=e.y,t[14]=e.z,this},getInverse:function(e,t){var r=this.elements,n=e.elements,i=n[0],a=n[1],o=n[2],s=n[3],u=n[4],c=n[5],l=n[6],f=n[7],p=n[8],h=n[9],d=n[10],m=n[11],g=n[12],v=n[13],_=n[14],y=n[15],b=h*_*f-v*d*f+v*l*m-c*_*m-h*l*y+c*d*y,x=g*d*f-p*_*f-g*l*m+u*_*m+p*l*y-u*d*y,w=p*v*f-g*h*f+g*c*m-u*v*m-p*c*y+u*h*y,$=g*h*l-p*v*l-g*c*d+u*v*d+p*c*_-u*h*_,E=i*b+a*x+o*w+s*$;if(0===E){var M="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(M);return console.warn(M),this.identity()}var T=1/E;return r[0]=b*T,r[1]=(v*d*s-h*_*s-v*o*m+a*_*m+h*o*y-a*d*y)*T,r[2]=(c*_*s-v*l*s+v*o*f-a*_*f-c*o*y+a*l*y)*T,r[3]=(h*l*s-c*d*s-h*o*f+a*d*f+c*o*m-a*l*m)*T,r[4]=x*T,r[5]=(p*_*s-g*d*s+g*o*m-i*_*m-p*o*y+i*d*y)*T,r[6]=(g*l*s-u*_*s-g*o*f+i*_*f+u*o*y-i*l*y)*T,r[7]=(u*d*s-p*l*s+p*o*f-i*d*f-u*o*m+i*l*m)*T,r[8]=w*T,r[9]=(g*h*s-p*v*s-g*a*m+i*v*m+p*a*y-i*h*y)*T,r[10]=(u*v*s-g*c*s+g*a*f-i*v*f-u*a*y+i*c*y)*T,r[11]=(p*c*s-u*h*s-p*a*f+i*h*f+u*a*m-i*c*m)*T,r[12]=$*T,r[13]=(p*v*o-g*h*o+g*a*d-i*v*d-p*a*_+i*h*_)*T,r[14]=(g*c*o-u*v*o-g*a*l+i*v*l+u*a*_-i*c*_)*T,r[15]=(u*h*o-p*c*o+p*a*l-i*h*l-u*a*d+i*c*d)*T,this},scale:function(e){var t=this.elements,r=e.x,n=e.y,i=e.z;return t[0]*=r,t[4]*=n,t[8]*=i,t[1]*=r,t[5]*=n,t[9]*=i,t[2]*=r,t[6]*=n,t[10]*=i,t[3]*=r,t[7]*=n,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))},makeTranslation:function(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var r=Math.cos(t),n=Math.sin(t),i=1-r,a=e.x,o=e.y,s=e.z,u=i*a,c=i*o;return this.set(u*a+r,u*o-n*s,u*s+n*o,0,u*o+n*s,c*o+r,c*s-n*a,0,u*s-n*o,c*s+n*a,i*s*s+r,0,0,0,0,1),this},makeScale:function(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(e,t,r){return this.set(1,t,r,0,e,1,r,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,r){return this.makeRotationFromQuaternion(t),this.scale(r),this.setPosition(e),this},decompose:(o=new Ut,s=new Lt,function(e,t,r){var n=this.elements,i=o.set(n[0],n[1],n[2]).length(),a=o.set(n[4],n[5],n[6]).length(),u=o.set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),e.x=n[12],e.y=n[13],e.z=n[14],s.copy(this);var c=1/i,l=1/a,f=1/u;return s.elements[0]*=c,s.elements[1]*=c,s.elements[2]*=c,s.elements[4]*=l,s.elements[5]*=l,s.elements[6]*=l,s.elements[8]*=f,s.elements[9]*=f,s.elements[10]*=f,t.setFromRotationMatrix(s),r.x=i,r.y=a,r.z=u,this}),makePerspective:function(e,t,r,n,i,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*i/(t-e),u=2*i/(r-n),c=(t+e)/(t-e),l=(r+n)/(r-n),f=-(a+i)/(a-i),p=-2*a*i/(a-i);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=u,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=f,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,r,n,i,a){var o=this.elements,s=1/(t-e),u=1/(r-n),c=1/(a-i),l=(t+e)*s,f=(r+n)*u,p=(a+i)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*u,o[9]=0,o[13]=-f,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<16;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}),Object.assign(Pt,{slerp:function(e,t,r,n){return r.copy(e).slerp(t,n)},slerpFlat:function(e,t,r,n,i,a,o){var s=r[n+0],u=r[n+1],c=r[n+2],l=r[n+3],f=i[a+0],p=i[a+1],h=i[a+2],d=i[a+3];if(l!==d||s!==f||u!==p||c!==h){var m=1-o,g=s*f+u*p+c*h+l*d,v=g>=0?1:-1,_=1-g*g;if(_>Number.EPSILON){var y=Math.sqrt(_),b=Math.atan2(y,g*v);m=Math.sin(m*b)/y,o=Math.sin(o*b)/y}var x=o*v;if(s=s*m+f*x,u=u*m+p*x,c=c*m+h*x,l=l*m+d*x,m===1-o){var w=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=w,u*=w,c*=w,l*=w}}e[t]=s,e[t+1]=u,e[t+2]=c,e[t+3]=l}}),Object.defineProperties(Pt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this.onChangeCallback()}}}),Object.assign(Pt.prototype,{set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this.onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=e._x,n=e._y,i=e._z,a=e.order,o=Math.cos,s=Math.sin,u=o(r/2),c=o(n/2),l=o(i/2),f=s(r/2),p=s(n/2),h=s(i/2);return"XYZ"===a?(this._x=f*c*l+u*p*h,this._y=u*p*l-f*c*h,this._z=u*c*h+f*p*l,this._w=u*c*l-f*p*h):"YXZ"===a?(this._x=f*c*l+u*p*h,this._y=u*p*l-f*c*h,this._z=u*c*h-f*p*l,this._w=u*c*l+f*p*h):"ZXY"===a?(this._x=f*c*l-u*p*h,this._y=u*p*l+f*c*h,this._z=u*c*h+f*p*l,this._w=u*c*l-f*p*h):"ZYX"===a?(this._x=f*c*l-u*p*h,this._y=u*p*l+f*c*h,this._z=u*c*h-f*p*l,this._w=u*c*l+f*p*h):"YZX"===a?(this._x=f*c*l+u*p*h,this._y=u*p*l+f*c*h,this._z=u*c*h-f*p*l,this._w=u*c*l-f*p*h):"XZY"===a&&(this._x=f*c*l-u*p*h,this._y=u*p*l-f*c*h,this._z=u*c*h+f*p*l,this._w=u*c*l+f*p*h),!1!==t&&this.onChangeCallback(),this},setFromAxisAngle:function(e,t){var r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(e){var t,r=e.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],u=r[9],c=r[2],l=r[6],f=r[10],p=n+s+f;return p>0?(t=.5/Math.sqrt(p+1),this._w=.25/t,this._x=(l-u)*t,this._y=(a-c)*t,this._z=(o-i)*t):n>s&&n>f?(t=2*Math.sqrt(1+n-s-f),this._w=(l-u)/t,this._x=.25*t,this._y=(i+o)/t,this._z=(a+c)/t):s>f?(t=2*Math.sqrt(1+s-n-f),this._w=(a-c)/t,this._x=(i+o)/t,this._y=.25*t,this._z=(u+l)/t):(t=2*Math.sqrt(1+f-n-s),this._w=(o-i)/t,this._x=(a+c)/t,this._y=(u+l)/t,this._z=.25*t),this.onChangeCallback(),this},setFromUnitVectors:function(){var e,t=new Ut;return function(r,n){return void 0===t&&(t=new Ut),(e=r.dot(n)+1)<1e-6?(e=0,Math.abs(r.x)>Math.abs(r.z)?t.set(-r.y,r.x,0):t.set(0,-r.z,r.y)):t.crossVectors(r,n),this._x=t.x,this._y=t.y,this._z=t.z,this._w=e,this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this.onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var r=e._x,n=e._y,i=e._z,a=e._w,o=t._x,s=t._y,u=t._z,c=t._w;return this._x=r*c+a*o+n*u-i*s,this._y=n*c+a*s+i*o-r*u,this._z=i*c+a*u+r*s-n*o,this._w=a*c-r*o-n*s-i*u,this.onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var r=this._x,n=this._y,i=this._z,a=this._w,o=a*e._w+r*e._x+n*e._y+i*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=n,this._z=i,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var u=Math.atan2(s,o),c=Math.sin((1-t)*u)/s,l=Math.sin(t*u)/s;return this._w=a*c+this._w*l,this._x=r*c+this._x*l,this._y=n*c+this._y*l,this._z=i*c+this._z*l,this.onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(Ut.prototype,{isVector3:!0,set:function(e,t,r){return this.x=e,this.y=t,this.z=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:(p=new Pt,function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(p.setFromEuler(e))}),applyAxisAngle:function(){var e=new Pt;return function(t,r){return this.applyQuaternion(e.setFromAxisAngle(t,r))}}(),applyMatrix3:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6]*n,this.y=i[1]*t+i[4]*r+i[7]*n,this.z=i[2]*t+i[5]*r+i[8]*n,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements,a=1/(i[3]*t+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*t+i[4]*r+i[8]*n+i[12])*a,this.y=(i[1]*t+i[5]*r+i[9]*n+i[13])*a,this.z=(i[2]*t+i[6]*r+i[10]*n+i[14])*a,this},applyQuaternion:function(e){var t=this.x,r=this.y,n=this.z,i=e.x,a=e.y,o=e.z,s=e.w,u=s*t+a*n-o*r,c=s*r+o*t-i*n,l=s*n+i*r-a*t,f=-i*t-a*r-o*n;return this.x=u*s+f*-i+c*-o-l*-a,this.y=c*s+f*-a+l*-i-u*-o,this.z=l*s+f*-o+u*-a-c*-i,this},project:function(){var e=new Lt;return function(t){return e.multiplyMatrices(t.projectionMatrix,e.getInverse(t.matrixWorld)),this.applyMatrix4(e)}}(),unproject:function(){var e=new Lt;return function(t){return e.multiplyMatrices(t.matrixWorld,e.getInverse(t.projectionMatrix)),this.applyMatrix4(e)}}(),transformDirection:function(e){var t=this.x,r=this.y,n=this.z,i=e.elements;return this.x=i[0]*t+i[4]*r+i[8]*n,this.y=i[1]*t+i[5]*r+i[9]*n,this.z=i[2]*t+i[6]*r+i[10]*n,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(){var e=new Ut,t=new Ut;return function(r,n){return e.set(r,r,r),t.set(n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},cross:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var r=e.x,n=e.y,i=e.z,a=t.x,o=t.y,s=t.z;return this.x=n*s-i*o,this.y=i*a-r*s,this.z=r*o-n*a,this},projectOnVector:function(e){var t=e.dot(this)/e.lengthSq();return this.copy(e).multiplyScalar(t)},projectOnPlane:function(){var e=new Ut;return function(t){return e.copy(this).projectOnVector(t),this.sub(e)}}(),reflect:function(){var e=new Ut;return function(t){return this.sub(e.copy(t).multiplyScalar(2*this.dot(t)))}}(),angleTo:function(e){var t=this.dot(e)/Math.sqrt(this.lengthSq()*e.lengthSq());return Math.acos(Rt.clamp(t,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){var t=Math.sin(e.phi)*e.radius;return this.x=t*Math.sin(e.theta),this.y=Math.cos(e.phi)*e.radius,this.z=t*Math.cos(e.theta),this},setFromCylindrical:function(e){return this.x=e.radius*Math.sin(e.theta),this.y=e.y,this.z=e.radius*Math.cos(e.theta),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}}),Object.assign(It.prototype,{isMatrix3:!0,set:function(e,t,r,n,i,a,o,s,u){var c=this.elements;return c[0]=e,c[1]=n,c[2]=o,c[3]=t,c[4]=i,c[5]=s,c[6]=r,c[7]=a,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var e=new Ut;return function(t){for(var r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.applyMatrix3(this),t.setXYZ(r,e.x,e.y,e.z);return t}}(),multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var r=e.elements,n=t.elements,i=this.elements,a=r[0],o=r[3],s=r[6],u=r[1],c=r[4],l=r[7],f=r[2],p=r[5],h=r[8],d=n[0],m=n[3],g=n[6],v=n[1],_=n[4],y=n[7],b=n[2],x=n[5],w=n[8];return i[0]=a*d+o*v+s*b,i[3]=a*m+o*_+s*x,i[6]=a*g+o*y+s*w,i[1]=u*d+c*v+l*b,i[4]=u*m+c*_+l*x,i[7]=u*g+c*y+l*w,i[2]=f*d+p*v+h*b,i[5]=f*m+p*_+h*x,i[8]=f*g+p*y+h*w,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],u=e[7],c=e[8];return t*a*c-t*o*u-r*i*c+r*o*s+n*i*u-n*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=e.elements,n=this.elements,i=r[0],a=r[1],o=r[2],s=r[3],u=r[4],c=r[5],l=r[6],f=r[7],p=r[8],h=p*u-c*f,d=c*l-p*s,m=f*s-u*l,g=i*h+a*d+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(v);return console.warn(v),this.identity()}var _=1/g;return n[0]=h*_,n[1]=(o*f-p*a)*_,n[2]=(c*a-o*u)*_,n[3]=d*_,n[4]=(p*i-o*l)*_,n[5]=(o*s-c*i)*_,n[6]=m*_,n[7]=(a*l-f*i)*_,n[8]=(u*i-a*s)*_,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,r,n,i,a,o){var s=Math.cos(i),u=Math.sin(i);this.set(r*s,r*u,-r*(s*a+u*o)+a+e,-n*u,n*s,-n*(-u*a+s*o)+o+t,0,0,1)},scale:function(e,t){var r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this},rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=this.elements,i=n[0],a=n[3],o=n[6],s=n[1],u=n[4],c=n[7];return n[0]=t*i+r*s,n[3]=t*a+r*u,n[6]=t*o+r*c,n[1]=-r*i+t*s,n[4]=-r*a+t*u,n[7]=-r*o+t*c,this},translate:function(e,t){var r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this},equals:function(e){for(var t=this.elements,r=e.elements,n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var r=0;r<9;r++)this.elements[r]=e[r+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}});var Ot=0;function Nt(e,t,r,n,i,a,o,s,u,c){Object.defineProperty(this,"id",{value:Ot++}),this.uuid=Rt.generateUUID(),this.name="",this.image=void 0!==e?e:Nt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Nt.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:Me,this.wrapT=void 0!==n?n:Me,this.magFilter=void 0!==i?i:Re,this.minFilter=void 0!==a?a:Le,this.anisotropy=void 0!==u?u:1,this.format=void 0!==o?o:qe,this.type=void 0!==s?s:Pe,this.offset=new Ct(0,0),this.repeat=new Ct(1,1),this.center=new Ct(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new It,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==c?c:bt,this.version=0,this.onUpdate=null}function kt(e,t,r,n){this.x=e||0,this.y=t||0,this.z=r||0,this.w=void 0!==n?n:1}function Dt(e,t,r){this.uuid=Rt.generateUUID(),this.width=e,this.height=t,this.scissor=new kt(0,0,e,t),this.scissorTest=!1,this.viewport=new kt(0,0,e,t),void 0===(r=r||{}).minFilter&&(r.minFilter=Re),this.texture=new Nt(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function Ft(e,t,r){Dt.call(this,e,t,r),this.activeCubeFace=0,this.activeMipMapLevel=0}function Bt(e,t,r,n,i,a,o,s,u,c,l,f){Nt.call(this,null,a,o,s,u,c,n,i,l,f),this.image={data:e,width:t,height:r},this.magFilter=void 0!==u?u:Se,this.minFilter=void 0!==c?c:Se,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Gt(e,t,r,n,i,a,o,s,u,c){e=void 0!==e?e:[],t=void 0!==t?t:ve,Nt.call(this,e,t,r,n,i,a,o,s,u,c),this.flipY=!1}Nt.DEFAULT_IMAGE=void 0,Nt.DEFAULT_MAPPING=ge,Nt.prototype=Object.assign(Object.create(n.prototype),{constructor:Nt,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Rt.generateUUID()),t||void 0!==e.images[n.uuid]||(e.images[n.uuid]={uuid:n.uuid,url:function(e){var t;if(e instanceof HTMLCanvasElement)t=e;else{(t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=e.width,t.height=e.height;var r=t.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height)}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(n)}),r.image=n.uuid}return t||(e.textures[this.uuid]=r),r},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping===ge){if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ee:e.x=e.x-Math.floor(e.x);break;case Me:e.x=e.x<0?0:1;break;case Te:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Ee:e.y=e.y-Math.floor(e.y);break;case Me:e.y=e.y<0?0:1;break;case Te:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}this.flipY&&(e.y=1-e.y)}}}),Object.defineProperty(Nt.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(kt.prototype,{isVector4:!0,set:function(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,r=this.y,n=this.z,i=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n+a[12]*i,this.y=a[1]*t+a[5]*r+a[9]*n+a[13]*i,this.z=a[2]*t+a[6]*r+a[10]*n+a[14]*i,this.w=a[3]*t+a[7]*r+a[11]*n+a[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,r,n,i,a=e.elements,o=a[0],s=a[4],u=a[8],c=a[1],l=a[5],f=a[9],p=a[2],h=a[6],d=a[10];if(Math.abs(s-c)<.01&&Math.abs(u-p)<.01&&Math.abs(f-h)<.01){if(Math.abs(s+c)<.1&&Math.abs(u+p)<.1&&Math.abs(f+h)<.1&&Math.abs(o+l+d-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,g=(l+1)/2,v=(d+1)/2,_=(s+c)/4,y=(u+p)/4,b=(f+h)/4;return m>g&&m>v?m<.01?(r=0,n=.707106781,i=.707106781):(n=_/(r=Math.sqrt(m)),i=y/r):g>v?g<.01?(r=.707106781,n=0,i=.707106781):(r=_/(n=Math.sqrt(g)),i=b/n):v<.01?(r=.707106781,n=.707106781,i=0):(r=y/(i=Math.sqrt(v)),n=b/i),this.set(r,n,i,t),this}var x=Math.sqrt((h-f)*(h-f)+(u-p)*(u-p)+(c-s)*(c-s));return Math.abs(x)<.001&&(x=1),this.x=(h-f)/x,this.y=(u-p)/x,this.z=(c-s)/x,this.w=Math.acos((o+l+d-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(){var e,t;return function(r,n){return void 0===e&&(e=new kt,t=new kt),e.set(r,r,r,r),t.set(n,n,n,n),this.clamp(e,t)}}(),clampLength:function(e,t){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,r){return this.subVectors(t,e).multiplyScalar(r).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Dt.prototype=Object.assign(Object.create(n.prototype),{constructor:Dt,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ft.prototype=Object.create(Dt.prototype),Ft.prototype.constructor=Ft,Ft.prototype.isWebGLRenderTargetCube=!0,Bt.prototype=Object.create(Nt.prototype),Bt.prototype.constructor=Bt,Bt.prototype.isDataTexture=!0,Gt.prototype=Object.create(Nt.prototype),Gt.prototype.constructor=Gt,Gt.prototype.isCubeTexture=!0,Object.defineProperty(Gt.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var Vt=new Nt,Ht=new Gt;function jt(){this.seq=[],this.map={}}var Wt=[],qt=[],Xt=new Float32Array(16),Yt=new Float32Array(9);function Jt(e,t,r){var n=e[0];if(n<=0||n>0)return e;var i=t*r,a=Wt[i];if(void 0===a&&(a=new Float32Array(i),Wt[i]=a),0!==t){n.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=r,e[o].toArray(a,s)}return a}function Zt(e,t){var r=qt[t];void 0===r&&(r=new Int32Array(t),qt[t]=r);for(var n=0;n!==t;++n)r[n]=e.allocTextureUnit();return r}function Kt(e,t){e.uniform1f(this.addr,t)}function Qt(e,t){e.uniform1i(this.addr,t)}function er(e,t){void 0===t.x?e.uniform2fv(this.addr,t):e.uniform2f(this.addr,t.x,t.y)}function tr(e,t){void 0!==t.x?e.uniform3f(this.addr,t.x,t.y,t.z):void 0!==t.r?e.uniform3f(this.addr,t.r,t.g,t.b):e.uniform3fv(this.addr,t)}function rr(e,t){void 0===t.x?e.uniform4fv(this.addr,t):e.uniform4f(this.addr,t.x,t.y,t.z,t.w)}function nr(e,t){e.uniformMatrix2fv(this.addr,!1,t.elements||t)}function ir(e,t){void 0===t.elements?e.uniformMatrix3fv(this.addr,!1,t):(Yt.set(t.elements),e.uniformMatrix3fv(this.addr,!1,Yt))}function ar(e,t){void 0===t.elements?e.uniformMatrix4fv(this.addr,!1,t):(Xt.set(t.elements),e.uniformMatrix4fv(this.addr,!1,Xt))}function or(e,t,r){var n=r.allocTextureUnit();e.uniform1i(this.addr,n),r.setTexture2D(t||Vt,n)}function sr(e,t,r){var n=r.allocTextureUnit();e.uniform1i(this.addr,n),r.setTextureCube(t||Ht,n)}function ur(e,t){e.uniform2iv(this.addr,t)}function cr(e,t){e.uniform3iv(this.addr,t)}function lr(e,t){e.uniform4iv(this.addr,t)}function fr(e,t){e.uniform1fv(this.addr,t)}function pr(e,t){e.uniform1iv(this.addr,t)}function hr(e,t){e.uniform2fv(this.addr,Jt(t,this.size,2))}function dr(e,t){e.uniform3fv(this.addr,Jt(t,this.size,3))}function mr(e,t){e.uniform4fv(this.addr,Jt(t,this.size,4))}function gr(e,t){e.uniformMatrix2fv(this.addr,!1,Jt(t,this.size,4))}function vr(e,t){e.uniformMatrix3fv(this.addr,!1,Jt(t,this.size,9))}function _r(e,t){e.uniformMatrix4fv(this.addr,!1,Jt(t,this.size,16))}function yr(e,t,r){var n=t.length,i=Zt(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.setTexture2D(t[a]||Vt,i[a])}function br(e,t,r){var n=t.length,i=Zt(r,n);e.uniform1iv(this.addr,i);for(var a=0;a!==n;++a)r.setTextureCube(t[a]||Ht,i[a])}function xr(e,t,r){this.id=e,this.addr=r,this.setValue=function(e){switch(e){case 5126:return Kt;case 35664:return er;case 35665:return tr;case 35666:return rr;case 35674:return nr;case 35675:return ir;case 35676:return ar;case 35678:case 36198:return or;case 35680:return sr;case 5124:case 35670:return Qt;case 35667:case 35671:return ur;case 35668:case 35672:return cr;case 35669:case 35673:return lr}}(t.type)}function wr(e,t,r){this.id=e,this.addr=r,this.size=t.size,this.setValue=function(e){switch(e){case 5126:return fr;case 35664:return hr;case 35665:return dr;case 35666:return mr;case 35674:return gr;case 35675:return vr;case 35676:return _r;case 35678:return yr;case 35680:return br;case 5124:case 35670:return pr;case 35667:case 35671:return ur;case 35668:case 35672:return cr;case 35669:case 35673:return lr}}(t.type)}function $r(e){this.id=e,jt.call(this)}$r.prototype.setValue=function(e,t){for(var r=this.seq,n=0,i=r.length;n!==i;++n){var a=r[n];a.setValue(e,t[a.id])}};var Er=/([\w\d_]+)(\])?(\[|\.)?/g;function Mr(e,t){e.seq.push(t),e.map[t.id]=t}function Tr(e,t,r){var n=e.name,i=n.length;for(Er.lastIndex=0;;){var a=Er.exec(n),o=Er.lastIndex,s=a[1],u="]"===a[2],c=a[3];if(u&&(s|=0),void 0===c||"["===c&&o+2===i){Mr(r,void 0===c?new xr(s,e,t):new wr(s,e,t));break}var l=r.map[s];void 0===l&&Mr(r,l=new $r(s)),r=l}}function Sr(e,t,r){jt.call(this),this.renderer=r;for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),i=0;i<n;++i){var a=e.getActiveUniform(t,i),o=a.name;Tr(a,e.getUniformLocation(t,o),this)}}Sr.prototype.setValue=function(e,t,r){var n=this.map[t];void 0!==n&&n.setValue(e,r,this.renderer)},Sr.prototype.setOptional=function(e,t,r){var n=t[r];void 0!==n&&this.setValue(e,r,n)},Sr.upload=function(e,t,r,n){for(var i=0,a=t.length;i!==a;++i){var o=t[i],s=r[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,n)}},Sr.seqWithValue=function(e,t){for(var r=[],n=0,i=e.length;n!==i;++n){var a=e[n];a.id in t&&r.push(a)}return r};var Ar={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function zr(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}Object.assign(zr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,r){return this.r=e,this.g=t,this.b=r,this},setHSL:function(){function e(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}return function(t,r,n){if(t=Rt.euclideanModulo(t,1),r=Rt.clamp(r,0,1),n=Rt.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,a=2*n-i;this.r=e(a,i,t+1/3),this.g=e(a,i,t),this.b=e(a,i,t-1/3)}return this}}(),setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n,i=r[1],a=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,t(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,t(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,u=parseInt(n[3],10)/100;return t(n[5]),this.setHSL(o,s,u)}}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c,l=(c=r[1]).length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}e&&e.length>0&&(void 0!==(c=Ar[e])?this.setHex(c):console.warn("THREE.Color: Unknown color "+e));return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var r=t>0?1/t:1;return this.r=Math.pow(e.r,r),this.g=Math.pow(e.g,r),this.b=Math.pow(e.b,r),this},convertGammaToLinear:function(){var e=this.r,t=this.g,r=this.b;return this.r=e*e,this.g=t*t,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){var t,r,n=e||{h:0,s:0,l:0},i=this.r,a=this.g,o=this.b,s=Math.max(i,a,o),u=Math.min(i,a,o),c=(u+s)/2;if(u===s)t=0,r=0;else{var l=s-u;switch(r=c<=.5?l/(s+u):l/(2-s-u),s){case i:t=(a-o)/l+(a<o?6:0);break;case a:t=(o-i)/l+2;break;case o:t=(i-a)/l+4}t/=6}return n.h=t,n.s=r,n.l=c,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,r){var n=this.getHSL();return n.h+=e,n.s+=t,n.l+=r,this.setHSL(n.h,n.s,n.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});var Rr={common:{diffuse:{value:new zr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new It},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ct(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new zr(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new zr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new It}}},Cr={merge:function(e){for(var t={},r=0;r<e.length;r++){var n=this.clone(e[r]);for(var i in n)t[i]=n[i]}return t},clone:function(e){var t={};for(var r in e)for(var n in t[r]={},e[r]){var i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}return t}},Lr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Pr={basic:{uniforms:Cr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.fog]),vertexShader:Lr.meshbasic_vert,fragmentShader:Lr.meshbasic_frag},lambert:{uniforms:Cr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.fog,Rr.lights,{emissive:{value:new zr(0)}}]),vertexShader:Lr.meshlambert_vert,fragmentShader:Lr.meshlambert_frag},phong:{uniforms:Cr.merge([Rr.common,Rr.specularmap,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.gradientmap,Rr.fog,Rr.lights,{emissive:{value:new zr(0)},specular:{value:new zr(1118481)},shininess:{value:30}}]),vertexShader:Lr.meshphong_vert,fragmentShader:Lr.meshphong_frag},standard:{uniforms:Cr.merge([Rr.common,Rr.envmap,Rr.aomap,Rr.lightmap,Rr.emissivemap,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,Rr.roughnessmap,Rr.metalnessmap,Rr.fog,Rr.lights,{emissive:{value:new zr(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Lr.meshphysical_vert,fragmentShader:Lr.meshphysical_frag},points:{uniforms:Cr.merge([Rr.points,Rr.fog]),vertexShader:Lr.points_vert,fragmentShader:Lr.points_frag},dashed:{uniforms:Cr.merge([Rr.common,Rr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Lr.linedashed_vert,fragmentShader:Lr.linedashed_frag},depth:{uniforms:Cr.merge([Rr.common,Rr.displacementmap]),vertexShader:Lr.depth_vert,fragmentShader:Lr.depth_frag},normal:{uniforms:Cr.merge([Rr.common,Rr.bumpmap,Rr.normalmap,Rr.displacementmap,{opacity:{value:1}}]),vertexShader:Lr.normal_vert,fragmentShader:Lr.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Lr.cube_vert,fragmentShader:Lr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Lr.equirect_vert,fragmentShader:Lr.equirect_frag},distanceRGBA:{uniforms:Cr.merge([Rr.common,Rr.displacementmap,{referencePosition:{value:new Ut},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Lr.distanceRGBA_vert,fragmentShader:Lr.distanceRGBA_frag},shadow:{uniforms:Cr.merge([Rr.lights,Rr.fog,{color:{value:new zr(0)},opacity:{value:1}}]),vertexShader:Lr.shadow_vert,fragmentShader:Lr.shadow_frag}};function Ur(e,t){this.min=void 0!==e?e:new Ct(1/0,1/0),this.max=void 0!==t?t:new Ct(-1/0,-1/0)}function Ir(e,t,r,n,i){var a,o,s,u,c,l,f,p;function h(){var e=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),n=new Uint16Array([0,1,2,0,2,3]);a=t.createBuffer(),o=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o),t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW),f=t.createTexture(),p=t.createTexture(),r.bindTexture(t.TEXTURE_2D,f),t.texImage2D(t.TEXTURE_2D,0,t.RGB,16,16,0,t.RGB,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),r.bindTexture(t.TEXTURE_2D,p),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,16,16,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),s={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position;","\tif ( renderType == 2 ) {","\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\t\tvVisibility =        visibility.r / 9.0;","\t\tvVisibility *= 1.0 - visibility.g / 9.0;","\t\tvVisibility *=       visibility.b / 9.0;","\t\tvVisibility *= 1.0 - visibility.a / 9.0;","\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","\t}","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tif ( renderType == 0 ) {","\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","\t} else if ( renderType == 1 ) {","\t\tgl_FragColor = texture2D( map, vUV );","\t} else {","\t\tvec4 texture = texture2D( map, vUV );","\t\ttexture.a *= opacity * vVisibility;","\t\tgl_FragColor = texture;","\t\tgl_FragColor.rgb *= color;","\t}","}"].join("\n")},u=function(e){var r=t.createProgram(),n=t.createShader(t.FRAGMENT_SHADER),a=t.createShader(t.VERTEX_SHADER),o="precision "+i.precision+" float;\n";return t.shaderSource(n,o+e.fragmentShader),t.shaderSource(a,o+e.vertexShader),t.compileShader(n),t.compileShader(a),t.attachShader(r,n),t.attachShader(r,a),t.linkProgram(r),r}(s),c={vertex:t.getAttribLocation(u,"position"),uv:t.getAttribLocation(u,"uv")},l={renderType:t.getUniformLocation(u,"renderType"),map:t.getUniformLocation(u,"map"),occlusionMap:t.getUniformLocation(u,"occlusionMap"),opacity:t.getUniformLocation(u,"opacity"),color:t.getUniformLocation(u,"color"),scale:t.getUniformLocation(u,"scale"),rotation:t.getUniformLocation(u,"rotation"),screenPosition:t.getUniformLocation(u,"screenPosition")}}this.render=function(e,i,s,d){if(0!==e.length){var m=new Ut,g=d.w/d.z,v=.5*d.z,_=.5*d.w,y=16/d.w,b=new Ct(y*g,y),x=new Ut(1,1,0),w=new Ct(1,1),$=new Ur;$.min.set(d.x,d.y),$.max.set(d.x+(d.z-16),d.y+(d.w-16)),void 0===u&&h(),r.useProgram(u),r.initAttributes(),r.enableAttribute(c.vertex),r.enableAttribute(c.uv),r.disableUnusedAttributes(),t.uniform1i(l.occlusionMap,0),t.uniform1i(l.map,1),t.bindBuffer(t.ARRAY_BUFFER,a),t.vertexAttribPointer(c.vertex,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(c.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o),r.disable(t.CULL_FACE),r.buffers.depth.setMask(!1);for(var E=0,M=e.length;E<M;E++){y=16/d.w,b.set(y*g,y);var T=e[E];if(m.set(T.matrixWorld.elements[12],T.matrixWorld.elements[13],T.matrixWorld.elements[14]),m.applyMatrix4(s.matrixWorldInverse),m.applyMatrix4(s.projectionMatrix),x.copy(m),w.x=d.x+x.x*v+v-8,w.y=d.y+x.y*_+_-8,!0===$.containsPoint(w)){r.activeTexture(t.TEXTURE0),r.bindTexture(t.TEXTURE_2D,null),r.activeTexture(t.TEXTURE1),r.bindTexture(t.TEXTURE_2D,f),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGB,w.x,w.y,16,16,0),t.uniform1i(l.renderType,0),t.uniform2f(l.scale,b.x,b.y),t.uniform3f(l.screenPosition,x.x,x.y,x.z),r.disable(t.BLEND),r.enable(t.DEPTH_TEST),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),r.activeTexture(t.TEXTURE0),r.bindTexture(t.TEXTURE_2D,p),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,w.x,w.y,16,16,0),t.uniform1i(l.renderType,1),r.disable(t.DEPTH_TEST),r.activeTexture(t.TEXTURE1),r.bindTexture(t.TEXTURE_2D,f),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),T.positionScreen.copy(x),T.customUpdateCallback?T.customUpdateCallback(T):T.updateLensFlares(),t.uniform1i(l.renderType,2),r.enable(t.BLEND);for(var S=0,A=T.lensFlares.length;S<A;S++){var z=T.lensFlares[S];z.opacity>.001&&z.scale>.001&&(x.x=z.x,x.y=z.y,x.z=z.z,y=z.size*z.scale/d.w,b.x=y*g,b.y=y,t.uniform3f(l.screenPosition,x.x,x.y,x.z),t.uniform2f(l.scale,b.x,b.y),t.uniform1f(l.rotation,z.rotation),t.uniform1f(l.opacity,z.opacity),t.uniform3f(l.color,z.color.r,z.color.g,z.color.b),r.setBlending(z.blending,z.blendEquation,z.blendSrc,z.blendDst),n.setTexture2D(z.texture,1),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}}}r.enable(t.CULL_FACE),r.enable(t.DEPTH_TEST),r.buffers.depth.setMask(!0),r.reset()}}}function Or(e,t,r,n,i,a,o,s,u){Nt.call(this,e,t,r,n,i,a,o,s,u),this.needsUpdate=!0}function Nr(e,t,r,n,i){var a,o,s,u,c,l,f=new Ut,p=new Pt,h=new Ut;function d(){var e=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);a=t.createBuffer(),o=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o),t.bufferData(t.ELEMENT_ARRAY_BUFFER,r,t.STATIC_DRAW),s=function(){var e=t.createProgram(),r=t.createShader(t.VERTEX_SHADER),n=t.createShader(t.FRAGMENT_SHADER);return t.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = position * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),t.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),t.compileShader(r),t.compileShader(n),t.attachShader(e,r),t.attachShader(e,n),t.linkProgram(e),e}(),u={position:t.getAttribLocation(s,"position"),uv:t.getAttribLocation(s,"uv")},c={uvOffset:t.getUniformLocation(s,"uvOffset"),uvScale:t.getUniformLocation(s,"uvScale"),rotation:t.getUniformLocation(s,"rotation"),scale:t.getUniformLocation(s,"scale"),color:t.getUniformLocation(s,"color"),map:t.getUniformLocation(s,"map"),opacity:t.getUniformLocation(s,"opacity"),modelViewMatrix:t.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:t.getUniformLocation(s,"projectionMatrix"),fogType:t.getUniformLocation(s,"fogType"),fogDensity:t.getUniformLocation(s,"fogDensity"),fogNear:t.getUniformLocation(s,"fogNear"),fogFar:t.getUniformLocation(s,"fogFar"),fogColor:t.getUniformLocation(s,"fogColor"),fogDepth:t.getUniformLocation(s,"fogDepth"),alphaTest:t.getUniformLocation(s,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var f=n.getContext("2d");f.fillStyle="white",f.fillRect(0,0,8,8),l=new Or(n)}function m(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:t.id-e.id}this.render=function(i,g,v){if(0!==i.length){void 0===s&&d(),r.useProgram(s),r.initAttributes(),r.enableAttribute(u.position),r.enableAttribute(u.uv),r.disableUnusedAttributes(),r.disable(t.CULL_FACE),r.enable(t.BLEND),t.bindBuffer(t.ARRAY_BUFFER,a),t.vertexAttribPointer(u.position,2,t.FLOAT,!1,16,0),t.vertexAttribPointer(u.uv,2,t.FLOAT,!1,16,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,o),t.uniformMatrix4fv(c.projectionMatrix,!1,v.projectionMatrix.elements),r.activeTexture(t.TEXTURE0),t.uniform1i(c.map,0);var _=0,y=0,b=g.fog;b?(t.uniform3f(c.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(t.uniform1f(c.fogNear,b.near),t.uniform1f(c.fogFar,b.far),t.uniform1i(c.fogType,1),_=1,y=1):b.isFogExp2&&(t.uniform1f(c.fogDensity,b.density),t.uniform1i(c.fogType,2),_=2,y=2)):(t.uniform1i(c.fogType,0),_=0,y=0);for(var x=0,w=i.length;x<w;x++){(E=i[x]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,E.matrixWorld),E.z=-E.modelViewMatrix.elements[14]}i.sort(m);var $=[];for(x=0,w=i.length;x<w;x++){var E,M=(E=i[x]).material;if(!1!==M.visible){E.onBeforeRender(e,g,v,void 0,M,void 0),t.uniform1f(c.alphaTest,M.alphaTest),t.uniformMatrix4fv(c.modelViewMatrix,!1,E.modelViewMatrix.elements),E.matrixWorld.decompose(f,p,h),$[0]=h.x,$[1]=h.y;var T=0;g.fog&&M.fog&&(T=y),_!==T&&(t.uniform1i(c.fogType,T),_=T),null!==M.map?(t.uniform2f(c.uvOffset,M.map.offset.x,M.map.offset.y),t.uniform2f(c.uvScale,M.map.repeat.x,M.map.repeat.y)):(t.uniform2f(c.uvOffset,0,0),t.uniform2f(c.uvScale,1,1)),t.uniform1f(c.opacity,M.opacity),t.uniform3f(c.color,M.color.r,M.color.g,M.color.b),t.uniform1f(c.rotation,M.rotation),t.uniform2fv(c.scale,$),r.setBlending(M.blending,M.blendEquation,M.blendSrc,M.blendDst,M.blendEquationAlpha,M.blendSrcAlpha,M.blendDstAlpha,M.premultipliedAlpha),r.buffers.depth.setTest(M.depthTest),r.buffers.depth.setMask(M.depthWrite),r.buffers.color.setMask(M.colorWrite),n.setTexture2D(M.map||l,0),t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0),E.onAfterRender(e,g,v,void 0,M,void 0)}}r.enable(t.CULL_FACE),r.reset()}}}Pr.physical={uniforms:Cr.merge([Pr.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Lr.meshphysical_vert,fragmentShader:Lr.meshphysical_frag},Object.assign(Ur.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Ct;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){var t=e||new Ct;return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new Ct;return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return(t||new Ct).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return(t||new Ct).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Ct;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Or.prototype=Object.create(Nt.prototype),Or.prototype.constructor=Or;var kr,Dr,Fr,Br,Gr,Vr,Hr,jr=0;function Wr(){Object.defineProperty(this,"id",{value:jr++}),this.uuid=Rt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=P,this.side=E,this.flatShading=!1,this.vertexColors=z,this.opacity=1,this.transparent=!1,this.blendSrc=q,this.blendDst=X,this.blendEquation=k,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ne,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function qr(e){Wr.call(this),this.type="MeshDepthMaterial",this.depthPacking=At,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(e)}function Xr(e){Wr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Ut,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Yr(e,t){this.min=void 0!==e?e:new Ut(1/0,1/0,1/0),this.max=void 0!==t?t:new Ut(-1/0,-1/0,-1/0)}function Jr(e,t){this.center=void 0!==e?e:new Ut,this.radius=void 0!==t?t:0}function Zr(e,t){this.normal=void 0!==e?e:new Ut(1,0,0),this.constant=void 0!==t?t:0}function Kr(e,t,r,n,i,a){this.planes=[void 0!==e?e:new Zr,void 0!==t?t:new Zr,void 0!==r?r:new Zr,void 0!==n?n:new Zr,void 0!==i?i:new Zr,void 0!==a?a:new Zr]}function Qr(e,t,r){for(var n=new Kr,i=new Lt,a=new Ct,o=new Ct(r,r),s=new Ut,u=new Ut,c=1,l=2,f=1+(c|l),p=new Array(f),h=new Array(f),d={},m=[new Ut(1,0,0),new Ut(-1,0,0),new Ut(0,0,1),new Ut(0,0,-1),new Ut(0,1,0),new Ut(0,-1,0)],g=[new Ut(0,1,0),new Ut(0,1,0),new Ut(0,1,0),new Ut(0,1,0),new Ut(0,0,1),new Ut(0,0,-1)],v=[new kt,new kt,new kt,new kt,new kt,new kt],_=0;_!==f;++_){var y=0!=(_&c),b=0!=(_&l),x=new qr({depthPacking:zt,morphTargets:y,skinning:b});p[_]=x;var $=new Xr({morphTargets:y,skinning:b});h[_]=$}var S=this;function A(t,r,n,i,a,o){var s=t.geometry,u=null,f=p,m=t.customDepthMaterial;if(n&&(f=h,m=t.customDistanceMaterial),m)u=m;else{var g=!1;r.morphTargets&&(s&&s.isBufferGeometry?g=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(g=s.morphTargets&&s.morphTargets.length>0)),t.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t);var v=t.isSkinnedMesh&&r.skinning,_=0;g&&(_|=c),v&&(_|=l),u=f[_]}if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var y=u.uuid,b=r.uuid,x=d[y];void 0===x&&(x={},d[y]=x);var w=x[b];void 0===w&&(w=u.clone(),x[b]=w),u=w}u.visible=r.visible,u.wireframe=r.wireframe;var $=r.side;return S.renderSingleSided&&$==T&&($=E),S.renderReverseSided&&($===E?$=M:$===M&&($=E)),u.side=$,u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,n&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=a,u.farDistance=o),u}function z(r,i,a,o){if(!1!==r.visible){if(r.layers.test(i.layers)&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,r.matrixWorld);var s=t.update(r),c=r.material;if(Array.isArray(c))for(var l=s.groups,f=0,p=l.length;f<p;f++){var h=l[f],d=c[h.materialIndex];if(d&&d.visible){var m=A(r,d,o,u,a.near,a.far);e.renderBufferDirect(a,null,s,m,r,h)}}else if(c.visible){m=A(r,c,o,u,a.near,a.far);e.renderBufferDirect(a,null,s,m,r,null)}}for(var g=r.children,v=0,_=g.length;v<_;v++)z(g[v],i,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=w,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(t,r,c){if(!1!==S.enabled&&(!1!==S.autoUpdate||!1!==S.needsUpdate)&&0!==t.length){var l,f=e.context,p=e.state;p.disable(f.BLEND),p.buffers.color.setClear(1,1,1,1),p.buffers.depth.setTest(!0),p.setScissorTest(!1);for(var h=0,d=t.length;h<d;h++){var _=t[h],y=_.shadow,b=_&&_.isPointLight;if(void 0!==y){var x=y.camera;if(a.copy(y.mapSize),a.min(o),b){var w=a.x,$=a.y;v[0].set(2*w,$,w,$),v[1].set(0,$,w,$),v[2].set(3*w,$,w,$),v[3].set(w,$,w,$),v[4].set(3*w,0,w,$),v[5].set(w,0,w,$),a.x*=4,a.y*=2}if(null===y.map){var E={minFilter:Se,magFilter:Se,format:qe};y.map=new Dt(a.x,a.y,E),y.map.texture.name=_.name+".shadowMap",x.updateProjectionMatrix()}y.isSpotLightShadow&&y.update(_);var M=y.map,T=y.matrix;u.setFromMatrixPosition(_.matrixWorld),x.position.copy(u),b?(l=6,T.makeTranslation(-u.x,-u.y,-u.z)):(l=1,s.setFromMatrixPosition(_.target.matrixWorld),x.lookAt(s),x.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(x.projectionMatrix),T.multiply(x.matrixWorldInverse)),e.setRenderTarget(M),e.clear();for(var A=0;A<l;A++){if(b){s.copy(x.position),s.add(m[A]),x.up.copy(g[A]),x.lookAt(s),x.updateMatrixWorld();var R=v[A];p.viewport(R)}i.multiplyMatrices(x.projectionMatrix,x.matrixWorldInverse),n.setFromMatrix(i),z(r,c,x,b)}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}S.needsUpdate=!1}}}function en(e){var t={};return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),t[e.uuid]},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=t[r.uuid];n&&(e.deleteBuffer(n.buffer),delete t[r.uuid])},update:function(r,n){r.isInterleavedBufferAttribute&&(r=r.data);var i=t[r.uuid];void 0===i?t[r.uuid]=function(t,r){var n=t.array,i=t.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW,a=e.createBuffer();e.bindBuffer(r,a),e.bufferData(r,n,i),t.onUploadCallback();var o=e.FLOAT;return n instanceof Float32Array?o=e.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=e.UNSIGNED_SHORT:n instanceof Int16Array?o=e.SHORT:n instanceof Uint32Array?o=e.UNSIGNED_INT:n instanceof Int32Array?o=e.INT:n instanceof Int8Array?o=e.BYTE:n instanceof Uint8Array&&(o=e.UNSIGNED_BYTE),{buffer:a,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(r,n):i.version<r.version&&(function(t,r,n){var i=r.array,a=r.updateRange;e.bindBuffer(n,t),!1===r.dynamic?e.bufferData(n,i,e.STATIC_DRAW):-1===a.count?e.bufferSubData(n,0,i):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(e.bufferSubData(n,a.offset*i.BYTES_PER_ELEMENT,i.subarray(a.offset,a.offset+a.count)),a.count=-1)}(i.buffer,r,n),i.version=r.version)}}}function tn(e,t,r,n){this._x=e||0,this._y=t||0,this._z=r||0,this._order=n||tn.DefaultOrder}function rn(){this.mask=1}Wr.prototype=Object.assign(Object.create(n.prototype),{constructor:Wr,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var r=e[t];if(void 0!==r)if("shading"!==t){var n=this[t];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]="overdraw"===t?Number(r):r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===S;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==P&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==E&&(r.side=this.side),this.vertexColors!==z&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){var i=n(e.textures),a=n(e.images);i.length>0&&(r.textures=i),a.length>0&&(r.images=a)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.lights=e.lights,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.overdraw=e.overdraw,this.visible=e.visible,this.userData=JSON.parse(JSON.stringify(e.userData)),this.clipShadows=e.clipShadows,this.clipIntersection=e.clipIntersection;var t=e.clippingPlanes,r=null;if(null!==t){var n=t.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),qr.prototype=Object.create(Wr.prototype),qr.prototype.constructor=qr,qr.prototype.isMeshDepthMaterial=!0,qr.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},Xr.prototype=Object.create(Wr.prototype),Xr.prototype.constructor=Xr,Xr.prototype.isMeshDistanceMaterial=!0,Xr.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},Object.assign(Yr.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.length;s<u;s+=3){var c=e[s],l=e[s+1],f=e[s+2];c<t&&(t=c),l<r&&(r=l),f<n&&(n=f),c>i&&(i=c),l>a&&(a=l),f>o&&(o=f)}return this.min.set(t,r,n),this.max.set(i,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,r=1/0,n=1/0,i=-1/0,a=-1/0,o=-1/0,s=0,u=e.count;s<u;s++){var c=e.getX(s),l=e.getY(s),f=e.getZ(s);c<t&&(t=c),l<r&&(r=l),f<n&&(n=f),c>i&&(i=c),l>a&&(a=l),f>o&&(o=f)}return this.min.set(t,r,n),this.max.set(i,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(){var e=new Ut;return function(t,r){var n=e.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}}(),setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){var t=e||new Ut;return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){var t=e||new Ut;return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(){var e,t,r,n=new Ut;function i(i){var a=i.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(t=0,r=o.length;t<r;t++)n.copy(o[t]),n.applyMatrix4(i.matrixWorld),e.expandByPoint(n)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(t=0,r=s.count;t<r;t++)n.fromBufferAttribute(s,t).applyMatrix4(i.matrixWorld),e.expandByPoint(n)}}return function(t){return e=this,t.updateMatrixWorld(!0),t.traverse(i),this}}(),containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return(t||new Ut).set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:(Dr=new Ut,function(e){return this.clampPoint(e.center,Dr),Dr.distanceToSquared(e.center)<=e.radius*e.radius}),intersectsPlane:function(e){var t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=e.constant&&r>=e.constant},clampPoint:function(e,t){return(t||new Ut).copy(e).clamp(this.min,this.max)},distanceToPoint:function(){var e=new Ut;return function(t){return e.copy(t).clamp(this.min,this.max).sub(t).length()}}(),getBoundingSphere:function(){var e=new Ut;return function(t){var r=t||new Jr;return this.getCenter(r.center),r.radius=.5*this.getSize(e).length(),r}}(),intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:(kr=[new Ut,new Ut,new Ut,new Ut,new Ut,new Ut,new Ut,new Ut],function(e){return this.isEmpty()?this:(kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kr),this)}),translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(Jr.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:(Fr=new Yr,function(e,t){var r=this.center;void 0!==t?r.copy(t):Fr.setFromPoints(e).getCenter(r);for(var n=0,i=0,a=e.length;i<a;i++)n=Math.max(n,r.distanceToSquared(e[i]));return this.radius=Math.sqrt(n),this}),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var r=this.center.distanceToSquared(e),n=t||new Ut;return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(e){var t=e||new Yr;return t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(Zr.prototype,{set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(){var e=new Ut,t=new Ut;return function(r,n,i){var a=e.subVectors(i,n).cross(t.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return(t||new Ut).copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(){var e=new Ut;return function(t,r){var n=r||new Ut,i=t.delta(e),a=this.normal.dot(i);if(0===a)return 0===this.distanceToPoint(t.start)?n.copy(t.start):void 0;var o=-(t.start.dot(this.normal)+this.constant)/a;return o<0||o>1?void 0:n.copy(i).multiplyScalar(o).add(t.start)}}(),intersectsLine:function(e){var t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return(e||new Ut).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var e=new Ut,t=new It;return function(r,n){var i=n||t.getNormalMatrix(r),a=this.coplanarPoint(e).applyMatrix4(r),o=this.normal.applyMatrix3(i).normalize();return this.constant=-a.dot(o),this}}(),translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}}),Object.assign(Kr.prototype,{set:function(e,t,r,n,i,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(n),o[4].copy(i),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,r=0;r<6;r++)t[r].copy(e.planes[r]);return this},setFromMatrix:function(e){var t=this.planes,r=e.elements,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],u=r[5],c=r[6],l=r[7],f=r[8],p=r[9],h=r[10],d=r[11],m=r[12],g=r[13],v=r[14],_=r[15];return t[0].setComponents(o-n,l-s,d-f,_-m).normalize(),t[1].setComponents(o+n,l+s,d+f,_+m).normalize(),t[2].setComponents(o+i,l+u,d+p,_+g).normalize(),t[3].setComponents(o-i,l-u,d-p,_-g).normalize(),t[4].setComponents(o-a,l-c,d-h,_-v).normalize(),t[5].setComponents(o+a,l+c,d+h,_+v).normalize(),this},intersectsObject:(Vr=new Jr,function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Vr.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Vr)}),intersectsSprite:function(){var e=new Jr;return function(t){return e.center.set(0,0,0),e.radius=.7071067811865476,e.applyMatrix4(t.matrixWorld),this.intersectsSphere(e)}}(),intersectsSphere:function(e){for(var t=this.planes,r=e.center,n=-e.radius,i=0;i<6;i++){if(t[i].distanceToPoint(r)<n)return!1}return!0},intersectsBox:(Br=new Ut,Gr=new Ut,function(e){for(var t=this.planes,r=0;r<6;r++){var n=t[r];Br.x=n.normal.x>0?e.min.x:e.max.x,Gr.x=n.normal.x>0?e.max.x:e.min.x,Br.y=n.normal.y>0?e.min.y:e.max.y,Gr.y=n.normal.y>0?e.max.y:e.min.y,Br.z=n.normal.z>0?e.min.z:e.max.z,Gr.z=n.normal.z>0?e.max.z:e.min.z;var i=n.distanceToPoint(Br),a=n.distanceToPoint(Gr);if(i<0&&a<0)return!1}return!0}),containsPoint:function(e){for(var t=this.planes,r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}}),tn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],tn.DefaultOrder="XYZ",Object.defineProperties(tn.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this.onChangeCallback()}}}),Object.assign(tn.prototype,{isEuler:!0,set:function(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this.onChangeCallback(),this},setFromRotationMatrix:function(e,t,r){var n=Rt.clamp,i=e.elements,a=i[0],o=i[4],s=i[8],u=i[1],c=i[5],l=i[9],f=i[2],p=i[6],h=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,h),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(p,c),this._z=0)):"YXZ"===t?(this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,h),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-f,a),this._z=0)):"ZXY"===t?(this._x=Math.asin(n(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-f,h),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(u,a))):"ZYX"===t?(this._y=Math.asin(-n(f,-1,1)),Math.abs(f)<.99999?(this._x=Math.atan2(p,h),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,c))):"YZX"===t?(this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(s,h))):"XZY"===t?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(p,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-l,h),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var e=new Lt;return function(t,r,n){return e.makeRotationFromQuaternion(t),this.setFromRotationMatrix(e,r,n)}}(),setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:(Hr=new Pt,function(e){return Hr.setFromEuler(this),this.setFromQuaternion(Hr,e)}),equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this.onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Ut(this._x,this._y,this._z)},onChange:function(e){return this.onChangeCallback=e,this},onChangeCallback:function(){}}),Object.assign(rn.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},test:function(e){return 0!=(this.mask&e.mask)}});var nn,an,on,sn,un=0;function cn(){Object.defineProperty(this,"id",{value:un++}),this.uuid=Rt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=cn.DefaultUp.clone();var e=new Ut,t=new tn,r=new Pt,n=new Ut(1,1,1);t.onChange(function(){r.setFromEuler(t,!1)}),r.onChange(function(){t.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:e},rotation:{enumerable:!0,value:t},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new Lt},normalMatrix:{value:new It}}),this.matrix=new Lt,this.matrixWorld=new Lt,this.matrixAutoUpdate=cn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new rn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ln(){cn.call(this),this.type="Camera",this.matrixWorldInverse=new Lt,this.projectionMatrix=new Lt}function fn(e,t,r,n,i,a){ln.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function pn(e,t,r,n,i,a){this.a=e,this.b=t,this.c=r,this.normal=n&&n.isVector3?n:new Ut,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new zr,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==a?a:0}cn.DefaultUp=new Ut(0,1,0),cn.DefaultMatrixAutoUpdate=!0,cn.prototype=Object.assign(Object.create(n.prototype),{constructor:cn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(e){this.matrix.multiplyMatrices(e,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:(sn=new Pt,function(e,t){return sn.setFromAxisAngle(e,t),this.quaternion.multiply(sn),this}),rotateOnWorldAxis:function(){var e=new Pt;return function(t,r){return e.setFromAxisAngle(t,r),this.quaternion.premultiply(e),this}}(),rotateX:function(){var e=new Ut(1,0,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateY:function(){var e=new Ut(0,1,0);return function(t){return this.rotateOnAxis(e,t)}}(),rotateZ:function(){var e=new Ut(0,0,1);return function(t){return this.rotateOnAxis(e,t)}}(),translateOnAxis:function(){var e=new Ut;return function(t,r){return e.copy(t).applyQuaternion(this.quaternion),this.position.add(e.multiplyScalar(r)),this}}(),translateX:function(){var e=new Ut(1,0,0);return function(t){return this.translateOnAxis(e,t)}}(),translateY:function(){var e=new Ut(0,1,0);return function(t){return this.translateOnAxis(e,t)}}(),translateZ:function(){var e=new Ut(0,0,1);return function(t){return this.translateOnAxis(e,t)}}(),localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:(on=new Lt,function(e){return e.applyMatrix4(on.getInverse(this.matrixWorld))}),lookAt:function(){var e=new Lt,t=new Ut;return function(r,n,i){r.isVector3?t.copy(r):t.set(r,n,i),this.isCamera?e.lookAt(this.position,t,this.up):e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}}(),add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,e.dispatchEvent({type:"added"}),this.children.push(e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var r=this.children.indexOf(e);return-1!==r&&(e.parent=null,e.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){var t=e||new Ut;return this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:(nn=new Ut,an=new Ut,function(e){var t=e||new Pt;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(nn,t,an),t}),getWorldRotation:function(){var e=new Pt;return function(t){var r=t||new tn;return this.getWorldQuaternion(e),r.setFromQuaternion(e,this.rotation.order,!1)}}(),getWorldScale:function(){var e=new Ut,t=new Pt;return function(r){var n=r||new Ut;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(e,t,n),n}}(),getWorldDirection:function(){var e=new Pt;return function(t){var r=t||new Ut;return this.getWorldQuaternion(e),r.set(0,0,1).applyQuaternion(e)}}(),raycast:function(){},traverse:function(e){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,r=0,n=t.length;r<n;r++)t[r].updateMatrixWorld(e)},toJSON:function(e){var t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.matrix=this.matrix.toArray(),void 0!==this.geometry){n.geometry=i(e.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,u=o.length;s<u;s++){var c=o[s];i(e.shapes,c)}else i(e.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,u=this.material.length;s<u;s++)l.push(i(e.materials,this.material[s]));n.material=l}else n.material=i(e.materials,this.material);if(this.children.length>0){n.children=[];for(s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(t){var f=m(e.geometries),p=m(e.materials),h=m(e.textures),d=m(e.images);o=m(e.shapes);f.length>0&&(r.geometries=f),p.length>0&&(r.materials=p),h.length>0&&(r.textures=h),d.length>0&&(r.images=d),o.length>0&&(r.shapes=o)}return r.object=n,r;function m(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}}),ln.prototype=Object.assign(Object.create(cn.prototype),{constructor:ln,isCamera:!0,copy:function(e,t){return cn.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this},getWorldDirection:function(){var e=new Pt;return function(t){var r=t||new Ut;return this.getWorldQuaternion(e),r.set(0,0,-1).applyQuaternion(e)}}(),updateMatrixWorld:function(e){cn.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),fn.prototype=Object.assign(Object.create(ln.prototype),{constructor:fn,isOrthographicCamera:!0,copy:function(e,t){return ln.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,r,n,i,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-e,a=r+e,o=n+t,s=n-t;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,f=(this.top-this.bottom)/this.view.height;a=(i+=l*(this.view.offsetX/u))+l*(this.view.width/u),s=(o-=f*(this.view.offsetY/c))-f*(this.view.height/c)}this.projectionMatrix.makeOrthographic(i,a,o,s,this.near,this.far)},toJSON:function(e){var t=cn.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}),Object.assign(pn.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var hn,dn=0;function mn(){Object.defineProperty(this,"id",{value:dn+=2}),this.uuid=Rt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function gn(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Rt.generateUUID(),this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function vn(e,t,r){gn.call(this,new Int8Array(e),t,r)}function _n(e,t,r){gn.call(this,new Uint8Array(e),t,r)}function yn(e,t,r){gn.call(this,new Uint8ClampedArray(e),t,r)}function bn(e,t,r){gn.call(this,new Int16Array(e),t,r)}function xn(e,t,r){gn.call(this,new Uint16Array(e),t,r)}function wn(e,t,r){gn.call(this,new Int32Array(e),t,r)}function $n(e,t,r){gn.call(this,new Uint32Array(e),t,r)}function En(e,t,r){gn.call(this,new Float32Array(e),t,r)}function Mn(e,t,r){gn.call(this,new Float64Array(e),t,r)}function Tn(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Sn(e){if(0===e.length)return-1/0;for(var t=e[0],r=1,n=e.length;r<n;++r)e[r]>t&&(t=e[r]);return t}mn.prototype=Object.assign(Object.create(n.prototype),{constructor:mn,isGeometry:!0,applyMatrix:function(e){for(var t=(new It).getNormalMatrix(e),r=0,n=this.vertices.length;r<n;r++){this.vertices[r].applyMatrix4(e)}for(r=0,n=this.faces.length;r<n;r++){var i=this.faces[r];i.normal.applyMatrix3(t).normalize();for(var a=0,o=i.vertexNormals.length;a<o;a++)i.vertexNormals[a].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var e=new Lt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Lt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Lt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Lt;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Lt;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:(hn=new cn,function(e){hn.lookAt(e),hn.updateMatrix(),this.applyMatrix(hn.matrix)}),fromBufferGeometry:function(e){var t=this,r=null!==e.index?e.index.array:void 0,n=e.attributes,i=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,o=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var c=[],l=[],f=[],p=0,h=0;p<i.length;p+=3,h+=2)t.vertices.push(new Ut(i[p],i[p+1],i[p+2])),void 0!==a&&c.push(new Ut(a[p],a[p+1],a[p+2])),void 0!==o&&t.colors.push(new zr(o[p],o[p+1],o[p+2])),void 0!==s&&l.push(new Ct(s[h],s[h+1])),void 0!==u&&f.push(new Ct(u[h],u[h+1]));function d(e,r,n,i){var p=new pn(e,r,n,void 0!==a?[c[e].clone(),c[r].clone(),c[n].clone()]:[],void 0!==o?[t.colors[e].clone(),t.colors[r].clone(),t.colors[n].clone()]:[],i);t.faces.push(p),void 0!==s&&t.faceVertexUvs[0].push([l[e].clone(),l[r].clone(),l[n].clone()]),void 0!==u&&t.faceVertexUvs[1].push([f[e].clone(),f[r].clone(),f[n].clone()])}var m=e.groups;if(m.length>0)for(p=0;p<m.length;p++)for(var g=m[p],v=g.start,_=(h=v,v+g.count);h<_;h+=3)void 0!==r?d(r[h],r[h+1],r[h+2],g.materialIndex):d(h,h+1,h+2,g.materialIndex);else if(void 0!==r)for(p=0;p<r.length;p+=3)d(r[p],r[p+1],r[p+2]);else for(p=0;p<i.length/3;p+=3)d(p,p+1,p+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,r=0===t?1:1/t,n=new Lt;return n.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var e=new Ut,t=new Ut,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],a=this.vertices[i.a],o=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,r,n,i,a,o;for(void 0===e&&(e=!0),o=new Array(this.vertices.length),t=0,r=this.vertices.length;t<r;t++)o[t]=new Ut;if(e){var s,u,c,l=new Ut,f=new Ut;for(n=0,i=this.faces.length;n<i;n++)a=this.faces[n],s=this.vertices[a.a],u=this.vertices[a.b],c=this.vertices[a.c],l.subVectors(c,u),f.subVectors(s,u),l.cross(f),o[a.a].add(l),o[a.b].add(l),o[a.c].add(l)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)o[(a=this.faces[n]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,r=this.vertices.length;t<r;t++)o[t].normalize();for(n=0,i=this.faces.length;n<i;n++){var p=(a=this.faces[n]).vertexNormals;3===p.length?(p[0].copy(o[a.a]),p[1].copy(o[a.b]),p[2].copy(o[a.c])):(p[0]=o[a.a].clone(),p[1]=o[a.b].clone(),p[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,r;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var n=(r=this.faces[e]).vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for((i=this.faces[r]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var a=new mn;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)u=new Ut,c={a:new Ut,b:new Ut,c:new Ut},o.push(u),s.push(c)}var u,c,l=this.morphNormals[e];for(a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],u=l.faceNormals[r],c=l.vertexNormals[r],u.copy(i.normal),c.a.copy(i.vertexNormals[0]),c.b.copy(i.vertexNormals[1]),c.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)(i=this.faces[r]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeLineDistances:function(){for(var e=0,t=this.vertices,r=0,n=t.length;r<n;r++)r>0&&(e+=t[r].distanceTo(t[r-1])),this.lineDistances[r]=e},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yr),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Jr),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,r){if(e&&e.isGeometry){var n,i=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,u=e.faces,c=this.faceVertexUvs[0],l=e.faceVertexUvs[0],f=this.colors,p=e.colors;void 0===r&&(r=0),void 0!==t&&(n=(new It).getNormalMatrix(t));for(var h=0,d=o.length;h<d;h++){var m=o[h].clone();void 0!==t&&m.applyMatrix4(t),a.push(m)}for(h=0,d=p.length;h<d;h++)f.push(p[h].clone());for(h=0,d=u.length;h<d;h++){var g,v,_,y=u[h],b=y.vertexNormals,x=y.vertexColors;(g=new pn(y.a+i,y.b+i,y.c+i)).normal.copy(y.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var w=0,$=b.length;w<$;w++)v=b[w].clone(),void 0!==n&&v.applyMatrix3(n).normalize(),g.vertexNormals.push(v);g.color.copy(y.color);for(w=0,$=x.length;w<$;w++)_=x[w],g.vertexColors.push(_.clone());g.materialIndex=y.materialIndex+r,s.push(g)}for(h=0,d=l.length;h<d;h++){var E=l[h],M=[];if(void 0!==E){for(w=0,$=E.length;w<$;w++)M.push(E[w].clone());c.push(M)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e,t,r,n,i,a,o,s,u={},c=[],l=[],f=Math.pow(10,4);for(r=0,n=this.vertices.length;r<n;r++)e=this.vertices[r],void 0===u[t=Math.round(e.x*f)+"_"+Math.round(e.y*f)+"_"+Math.round(e.z*f)]?(u[t]=r,c.push(this.vertices[r]),l[r]=c.length-1):l[r]=l[u[t]];var p=[];for(r=0,n=this.faces.length;r<n;r++){(i=this.faces[r]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],a=[i.a,i.b,i.c];for(var h=0;h<3;h++)if(a[h]===a[(h+1)%3]){p.push(r);break}}for(r=p.length-1;r>=0;r--){var d=p[r];for(this.faces.splice(d,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(d,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(e){this.vertices=[];for(var t=0,r=e.length;t<r;t++){var n=e[t];this.vertices.push(new Ut(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort(function(e,t){return e.materialIndex-t.materialIndex});var n,i,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];a&&a.length===t&&(n=[]),o&&o.length===t&&(i=[]);for(r=0;r<t;r++){var s=e[r]._id;n&&n.push(a[s]),i&&i.push(o[s])}n&&(this.faceVertexUvs[0]=n),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],i=0;i<this.vertices.length;i++){var a=this.vertices[i];n.push(a.x,a.y,a.z)}var o=[],s=[],u={},c=[],l={},f=[],p={};for(i=0;i<this.faces.length;i++){var h=this.faces[i],d=void 0!==this.faceVertexUvs[0][i],m=h.normal.length()>0,g=h.vertexNormals.length>0,v=1!==h.color.r||1!==h.color.g||1!==h.color.b,_=h.vertexColors.length>0,y=0;if(y=$(y=$(y=$(y=$(y=$(y=$(y=$(y=$(y,0,0),1,!0),2,!1),3,d),4,m),5,g),6,v),7,_),o.push(y),o.push(h.a,h.b,h.c),o.push(h.materialIndex),d){var b=this.faceVertexUvs[0][i];o.push(T(b[0]),T(b[1]),T(b[2]))}if(m&&o.push(E(h.normal)),g){var x=h.vertexNormals;o.push(E(x[0]),E(x[1]),E(x[2]))}if(v&&o.push(M(h.color)),_){var w=h.vertexColors;o.push(M(w[0]),M(w[1]),M(w[2]))}}function $(e,t,r){return r?e|1<<t:e&~(1<<t)}function E(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==u[t]?u[t]:(u[t]=s.length/3,s.push(e.x,e.y,e.z),u[t])}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==l[t]?l[t]:(l[t]=c.length,c.push(e.getHex()),l[t])}function T(e){var t=e.x.toString()+e.y.toString();return void 0!==p[t]?p[t]:(p[t]=f.length/2,f.push(e.x,e.y),p[t])}return e.data={},e.data.vertices=n,e.data.normals=s,c.length>0&&(e.data.colors=c),f.length>0&&(e.data.uvs=[f]),e.data.faces=o,e},clone:function(){return(new mn).copy(this)},copy:function(e){var t,r,n,i,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,r=s.length;t<r;t++)this.vertices.push(s[t].clone());var u=e.colors;for(t=0,r=u.length;t<r;t++)this.colors.push(u[t].clone());var c=e.faces;for(t=0,r=c.length;t<r;t++)this.faces.push(c[t].clone());for(t=0,r=e.faceVertexUvs.length;t<r;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),n=0,i=l.length;n<i;n++){var f=l[n],p=[];for(a=0,o=f.length;a<o;a++){var h=f[a];p.push(h.clone())}this.faceVertexUvs[t].push(p)}}var d=e.morphTargets;for(t=0,r=d.length;t<r;t++){var m={};if(m.name=d[t].name,void 0!==d[t].vertices)for(m.vertices=[],n=0,i=d[t].vertices.length;n<i;n++)m.vertices.push(d[t].vertices[n].clone());if(void 0!==d[t].normals)for(m.normals=[],n=0,i=d[t].normals.length;n<i;n++)m.normals.push(d[t].normals[n].clone());this.morphTargets.push(m)}var g=e.morphNormals;for(t=0,r=g.length;t<r;t++){var v={};if(void 0!==g[t].vertexNormals)for(v.vertexNormals=[],n=0,i=g[t].vertexNormals.length;n<i;n++){var _=g[t].vertexNormals[n],y={};y.a=_.a.clone(),y.b=_.b.clone(),y.c=_.c.clone(),v.vertexNormals.push(y)}if(void 0!==g[t].faceNormals)for(v.faceNormals=[],n=0,i=g[t].faceNormals.length;n<i;n++)v.faceNormals.push(g[t].faceNormals[n].clone());this.morphNormals.push(v)}var b=e.skinWeights;for(t=0,r=b.length;t<r;t++)this.skinWeights.push(b[t].clone());var x=e.skinIndices;for(t=0,r=x.length;t<r;t++)this.skinIndices.push(x[t].clone());var w=e.lineDistances;for(t=0,r=w.length;t<r;t++)this.lineDistances.push(w[t]);var $=e.boundingBox;null!==$&&(this.boundingBox=$.clone());var E=e.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(gn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(gn.prototype,{isBufferAttribute:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.itemSize:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.itemSize,r*=t.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[e+n]=t.array[r+n];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new zr),t[r++]=a.r,t[r++]=a.g,t[r++]=a.b}return this},copyIndicesArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var a=e[n];t[r++]=a.a,t[r++]=a.b,t[r++]=a.c}return this},copyVector2sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new Ct),t[r++]=a.x,t[r++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new Ut),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,r=0,n=0,i=e.length;n<i;n++){var a=e[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new kt),t[r++]=a.x,t[r++]=a.y,t[r++]=a.z,t[r++]=a.w}return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),vn.prototype=Object.create(gn.prototype),vn.prototype.constructor=vn,_n.prototype=Object.create(gn.prototype),_n.prototype.constructor=_n,yn.prototype=Object.create(gn.prototype),yn.prototype.constructor=yn,bn.prototype=Object.create(gn.prototype),bn.prototype.constructor=bn,xn.prototype=Object.create(gn.prototype),xn.prototype.constructor=xn,wn.prototype=Object.create(gn.prototype),wn.prototype.constructor=wn,$n.prototype=Object.create(gn.prototype),$n.prototype.constructor=$n,En.prototype=Object.create(gn.prototype),En.prototype.constructor=En,Mn.prototype=Object.create(gn.prototype),Mn.prototype.constructor=Mn,Object.assign(Tn.prototype,{computeGroups:function(e){for(var t,r=[],n=void 0,i=e.faces,a=0;a<i.length;a++){var o=i[a];o.materialIndex!==n&&(n=o.materialIndex,void 0!==t&&(t.count=3*a-t.start,r.push(t)),t={start:3*a,materialIndex:n})}void 0!==t&&(t.count=3*a-t.start,r.push(t)),this.groups=r},fromGeometry:function(e){var t,r=e.faces,n=e.vertices,i=e.faceVertexUvs,a=i[0]&&i[0].length>0,o=i[1]&&i[1].length>0,s=e.morphTargets,u=s.length;if(u>0){t=[];for(var c=0;c<u;c++)t[c]=[];this.morphTargets.position=t}var l,f=e.morphNormals,p=f.length;if(p>0){l=[];for(c=0;c<p;c++)l[c]=[];this.morphTargets.normal=l}var h=e.skinIndices,d=e.skinWeights,m=h.length===n.length,g=d.length===n.length;for(c=0;c<r.length;c++){var v=r[c];this.vertices.push(n[v.a],n[v.b],n[v.c]);var _=v.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var y=v.normal;this.normals.push(y,y,y)}var b,x=v.vertexColors;if(3===x.length)this.colors.push(x[0],x[1],x[2]);else{var w=v.color;this.colors.push(w,w,w)}if(!0===a)void 0!==(b=i[0][c])?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new Ct,new Ct,new Ct));if(!0===o)void 0!==(b=i[1][c])?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new Ct,new Ct,new Ct));for(var $=0;$<u;$++){var E=s[$].vertices;t[$].push(E[v.a],E[v.b],E[v.c])}for($=0;$<p;$++){var M=f[$].vertexNormals[c];l[$].push(M.a,M.b,M.c)}m&&this.skinIndices.push(h[v.a],h[v.b],h[v.c]),g&&this.skinWeights.push(d[v.a],d[v.b],d[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}});var An,zn,Rn,Cn,Ln,Pn,Un,In=1;function On(){Object.defineProperty(this,"id",{value:In+=2}),this.uuid=Rt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Nn(e,t,r,n,i,a){mn.call(this),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a},this.fromBufferGeometry(new kn(e,t,r,n,i,a)),this.mergeVertices()}function kn(e,t,r,n,i,a){On.call(this),this.type="BoxBufferGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:i,depthSegments:a};var o=this;e=e||1,t=t||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1;var s=[],u=[],c=[],l=[],f=0,p=0;function h(e,t,r,n,i,a,h,d,m,g,v){var _,y,b=a/m,x=h/g,w=a/2,$=h/2,E=d/2,M=m+1,T=g+1,S=0,A=0,z=new Ut;for(y=0;y<T;y++){var R=y*x-$;for(_=0;_<M;_++){var C=_*b-w;z[e]=C*n,z[t]=R*i,z[r]=E,u.push(z.x,z.y,z.z),z[e]=0,z[t]=0,z[r]=d>0?1:-1,c.push(z.x,z.y,z.z),l.push(_/m),l.push(1-y/g),S+=1}}for(y=0;y<g;y++)for(_=0;_<m;_++){var L=f+_+M*y,P=f+_+M*(y+1),U=f+(_+1)+M*(y+1),I=f+(_+1)+M*y;s.push(L,P,I),s.push(P,U,I),A+=6}o.addGroup(p,A,v),p+=A,f+=S}h("z","y","x",-1,-1,r,t,e,a=Math.floor(a)||1,i,0),h("z","y","x",1,-1,r,t,-e,a,i,1),h("x","z","y",1,1,e,r,t,n,a,2),h("x","z","y",1,-1,e,r,-t,n,a,3),h("x","y","z",1,-1,e,t,r,n,i,4),h("x","y","z",-1,-1,e,t,-r,n,i,5),this.setIndex(s),this.addAttribute("position",new En(u,3)),this.addAttribute("normal",new En(c,3)),this.addAttribute("uv",new En(l,2))}function Dn(e,t,r,n){mn.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Fn(e,t,r,n)),this.mergeVertices()}function Fn(e,t,r,n){On.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};var i,a,o=(e=e||1)/2,s=(t=t||1)/2,u=Math.floor(r)||1,c=Math.floor(n)||1,l=u+1,f=c+1,p=e/u,h=t/c,d=[],m=[],g=[],v=[];for(a=0;a<f;a++){var _=a*h-s;for(i=0;i<l;i++){var y=i*p-o;m.push(y,-_,0),g.push(0,0,1),v.push(i/u),v.push(1-a/c)}}for(a=0;a<c;a++)for(i=0;i<u;i++){var b=i+l*a,x=i+l*(a+1),w=i+1+l*(a+1),$=i+1+l*a;d.push(b,x,$),d.push(x,w,$)}this.setIndex(d),this.addAttribute("position",new En(m,3)),this.addAttribute("normal",new En(g,3)),this.addAttribute("uv",new En(v,2))}function Bn(e){Wr.call(this),this.type="MeshBasicMaterial",this.color=new zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(e)}function Gn(e){Wr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Vn(e,t){this.origin=void 0!==e?e:new Ut,this.direction=void 0!==t?t:new Ut}function Hn(e,t){this.start=void 0!==e?e:new Ut,this.end=void 0!==t?t:new Ut}function jn(e,t,r){this.a=void 0!==e?e:new Ut,this.b=void 0!==t?t:new Ut,this.c=void 0!==r?r:new Ut}function Wn(e,t){cn.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new On,this.material=void 0!==t?t:new Bn({color:16777215*Math.random()}),this.drawMode=vt,this.updateMorphTargets()}function qn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program&&t.program&&e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Xn(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Yn(){var e={};return{get:function(t,r){var n=t.id+","+r.id,i=e[n];return void 0===i&&(i=new function(){var e=[],t=0,r=[],n=[];return{opaque:r,transparent:n,init:function(){t=0,r.length=0,n.length=0},push:function(i,a,o,s,u){var c=e[t];void 0===c?(c={id:i.id,object:i,geometry:a,material:o,program:o.program,renderOrder:i.renderOrder,z:s,group:u},e[t]=c):(c.id=i.id,c.object=i,c.geometry=a,c.material=o,c.program=o.program,c.renderOrder=i.renderOrder,c.z=s,c.group=u),(!0===o.transparent?n:r).push(c),t++},sort:function(){r.length>1&&r.sort(qn),n.length>1&&n.sort(Xn)}}},e[n]=i),i},dispose:function(){e={}}}}function Jn(e,t){return Math.abs(t[1])-Math.abs(e[1])}function Zn(){var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var r;switch(t.type){case"DirectionalLight":r={direction:new Ut,color:new zr,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct};break;case"SpotLight":r={position:new Ut,direction:new Ut,color:new zr,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct};break;case"PointLight":r={position:new Ut,color:new zr,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ct,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new Ut,skyColor:new zr,groundColor:new zr};break;case"RectAreaLight":r={color:new zr,position:new Ut,halfWidth:new Ut,halfHeight:new Ut}}return e[t.id]=r,r}}},t={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new Ut,n=new Lt,i=new Lt;return{setup:function(a,o,s){for(var u=0,c=0,l=0,f=0,p=0,h=0,d=0,m=0,g=s.matrixWorldInverse,v=0,_=a.length;v<_;v++){var y=a[v],b=y.color,x=y.intensity,w=y.distance,$=y.shadow&&y.shadow.map?y.shadow.map.texture:null;if(y.isAmbientLight)u+=b.r*x,c+=b.g*x,l+=b.b*x;else if(y.isDirectionalLight){if((M=e.get(y)).color.copy(y.color).multiplyScalar(y.intensity),M.direction.setFromMatrixPosition(y.matrixWorld),r.setFromMatrixPosition(y.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(g),M.shadow=y.castShadow,y.castShadow){var E=y.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize}t.directionalShadowMap[f]=$,t.directionalShadowMatrix[f]=y.shadow.matrix,t.directional[f]=M,f++}else if(y.isSpotLight)(M=e.get(y)).position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(g),M.color.copy(b).multiplyScalar(x),M.distance=w,M.direction.setFromMatrixPosition(y.matrixWorld),r.setFromMatrixPosition(y.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(g),M.coneCos=Math.cos(y.angle),M.penumbraCos=Math.cos(y.angle*(1-y.penumbra)),M.decay=0===y.distance?0:y.decay,M.shadow=y.castShadow,y.castShadow&&(E=y.shadow,M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize),t.spotShadowMap[h]=$,t.spotShadowMatrix[h]=y.shadow.matrix,t.spot[h]=M,h++;else if(y.isRectAreaLight)(M=e.get(y)).color.copy(b).multiplyScalar(x/(y.width*y.height)),M.position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(g),i.identity(),n.copy(y.matrixWorld),n.premultiply(g),i.extractRotation(n),M.halfWidth.set(.5*y.width,0,0),M.halfHeight.set(0,.5*y.height,0),M.halfWidth.applyMatrix4(i),M.halfHeight.applyMatrix4(i),t.rectArea[d]=M,d++;else if(y.isPointLight)(M=e.get(y)).position.setFromMatrixPosition(y.matrixWorld),M.position.applyMatrix4(g),M.color.copy(y.color).multiplyScalar(y.intensity),M.distance=y.distance,M.decay=0===y.distance?0:y.decay,M.shadow=y.castShadow,y.castShadow&&(E=y.shadow,M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize,M.shadowCameraNear=E.camera.near,M.shadowCameraFar=E.camera.far),t.pointShadowMap[p]=$,t.pointShadowMatrix[p]=y.shadow.matrix,t.point[p]=M,p++;else if(y.isHemisphereLight){var M;(M=e.get(y)).direction.setFromMatrixPosition(y.matrixWorld),M.direction.transformDirection(g),M.direction.normalize(),M.skyColor.copy(y.color).multiplyScalar(x),M.groundColor.copy(y.groundColor).multiplyScalar(x),t.hemi[m]=M,m++}}t.ambient[0]=u,t.ambient[1]=c,t.ambient[2]=l,t.directional.length=f,t.spot.length=h,t.rectArea.length=d,t.point.length=p,t.hemi.length=m,t.hash=f+","+p+","+h+","+d+","+m+","+o.length},state:t}}function Kn(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),!1===e.getShaderParameter(n,e.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==e.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",t===e.VERTEX_SHADER?"vertex":"fragment",e.getShaderInfoLog(n),function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")}(r)),n}On.prototype=Object.assign(Object.create(n.prototype),{constructor:On,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Sn(e)>65535?$n:xn)(e,1):this.index=e},addAttribute:function(e,t){return t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(t)):(this.attributes[e]=t,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(e,new gn(arguments[1],arguments[2])))},getAttribute:function(e){return this.attributes[e]},removeAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,r){this.groups.push({start:e,count:t,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix:function(e){var t=this.attributes.position;void 0!==t&&(e.applyToBufferAttribute(t),t.needsUpdate=!0);var r=this.attributes.normal;void 0!==r&&((new It).getNormalMatrix(e).applyToBufferAttribute(r),r.needsUpdate=!0);return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var e=new Lt;return function(t){return e.makeRotationX(t),this.applyMatrix(e),this}}(),rotateY:function(){var e=new Lt;return function(t){return e.makeRotationY(t),this.applyMatrix(e),this}}(),rotateZ:function(){var e=new Lt;return function(t){return e.makeRotationZ(t),this.applyMatrix(e),this}}(),translate:function(){var e=new Lt;return function(t,r,n){return e.makeTranslation(t,r,n),this.applyMatrix(e),this}}(),scale:function(){var e=new Lt;return function(t,r,n){return e.makeScale(t,r,n),this.applyMatrix(e),this}}(),lookAt:function(){var e=new cn;return function(t){e.lookAt(t),e.updateMatrix(),this.applyMatrix(e.matrix)}}(),center:function(){this.computeBoundingBox();var e=this.boundingBox.getCenter().negate();return this.translate(e.x,e.y,e.z),e},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var r=new En(3*t.vertices.length,3),n=new En(3*t.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(t.vertices)),this.addAttribute("color",n.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new En(t.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r];t.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new En(t,3)),this},updateFromObject:function(e){var t,r=e.geometry;if(e.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(r.vertices),t.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(r.normals),t.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(r.colors),t.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(r.uvs),t.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(r.lineDistances),t.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(e.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Tn).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.addAttribute("position",new gn(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var r=new Float32Array(3*e.normals.length);this.addAttribute("normal",new gn(r,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var n=new Float32Array(3*e.colors.length);this.addAttribute("color",new gn(n,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.addAttribute("uv",new gn(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(2*e.uvs2.length);this.addAttribute("uv2",new gn(a,2).copyVector2sArray(e.uvs2))}if(e.indices.length>0){var o=new(Sn(e.indices)>65535?Uint32Array:Uint16Array)(3*e.indices.length);this.setIndex(new gn(o,1).copyIndicesArray(e.indices))}for(var s in this.groups=e.groups,e.morphTargets){for(var u=[],c=e.morphTargets[s],l=0,f=c.length;l<f;l++){var p=c[l],h=new En(3*p.length,3);u.push(h.copyVector3sArray(p))}this.morphAttributes[s]=u}if(e.skinIndices.length>0){var d=new En(4*e.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var m=new En(4*e.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Yr);var e=this.attributes.position;void 0!==e?this.boundingBox.setFromBufferAttribute(e):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var e=new Yr,t=new Ut;return function(){null===this.boundingSphere&&(this.boundingSphere=new Jr);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;e.setFromBufferAttribute(r),e.getCenter(n);for(var i=0,a=0,o=r.count;a<o;a++)t.x=r.getX(a),t.y=r.getY(a),t.z=r.getZ(a),i=Math.max(i,n.distanceToSquared(t));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes,r=this.groups;if(t.position){var n=t.position.array;if(void 0===t.normal)this.addAttribute("normal",new gn(new Float32Array(n.length),3));else for(var i=t.normal.array,a=0,o=i.length;a<o;a++)i[a]=0;var s,u,c,l=t.normal.array,f=new Ut,p=new Ut,h=new Ut,d=new Ut,m=new Ut;if(e){var g=e.array;0===r.length&&this.addGroup(0,g.length);for(var v=0,_=r.length;v<_;++v){var y=r[v],b=y.start;for(a=b,o=b+y.count;a<o;a+=3)s=3*g[a+0],u=3*g[a+1],c=3*g[a+2],f.fromArray(n,s),p.fromArray(n,u),h.fromArray(n,c),d.subVectors(h,p),m.subVectors(f,p),d.cross(m),l[s]+=d.x,l[s+1]+=d.y,l[s+2]+=d.z,l[u]+=d.x,l[u+1]+=d.y,l[u+2]+=d.z,l[c]+=d.x,l[c+1]+=d.y,l[c+2]+=d.z}}else for(a=0,o=n.length;a<o;a+=9)f.fromArray(n,a),p.fromArray(n,a+3),h.fromArray(n,a+6),d.subVectors(h,p),m.subVectors(f,p),d.cross(m),l[a]=d.x,l[a+1]=d.y,l[a+2]=d.z,l[a+3]=d.x,l[a+4]=d.y,l[a+5]=d.z,l[a+6]=d.x,l[a+7]=d.y,l[a+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0);var r=this.attributes;for(var n in r)if(void 0!==e.attributes[n])for(var i=r[n].array,a=e.attributes[n],o=a.array,s=0,u=a.itemSize*t;s<o.length;s++,u++)i[u]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){var e=new Ut;return function(){for(var t=this.attributes.normal,r=0,n=t.count;r<n;r++)e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.normalize(),t.setXYZ(r,e.x,e.y,e.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var e=new On,t=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],a=i.array,o=i.itemSize,s=new a.constructor(t.length*o),u=0,c=0,l=0,f=t.length;l<f;l++){u=t[l]*o;for(var p=0;p<o;p++)s[c++]=a[u++]}e.addAttribute(n,new gn(s,o))}return e},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);e.data.index={type:n.array.constructor.name,array:i}}var a=this.attributes;for(var r in a){var o=a[r];i=Array.prototype.slice.call(o.array);e.data.attributes[r]={itemSize:o.itemSize,type:o.array.constructor.name,array:i,normalized:o.normalized}}var s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;return null!==u&&(e.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),e},clone:function(){return(new On).copy(this)},copy:function(e){var t,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var a=e.attributes;for(t in a){var o=a[t];this.addAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var u=[],c=s[t];for(r=0,n=c.length;r<n;r++)u.push(c[r].clone());this.morphAttributes[t]=u}var l=e.groups;for(r=0,n=l.length;r<n;r++){var f=l[r];this.addGroup(f.start,f.count,f.materialIndex)}var p=e.boundingBox;null!==p&&(this.boundingBox=p.clone());var h=e.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Nn.prototype=Object.create(mn.prototype),Nn.prototype.constructor=Nn,kn.prototype=Object.create(On.prototype),kn.prototype.constructor=kn,Dn.prototype=Object.create(mn.prototype),Dn.prototype.constructor=Dn,Fn.prototype=Object.create(On.prototype),Fn.prototype.constructor=Fn,Bn.prototype=Object.create(Wr.prototype),Bn.prototype.constructor=Bn,Bn.prototype.isMeshBasicMaterial=!0,Bn.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this},Gn.prototype=Object.create(Wr.prototype),Gn.prototype.constructor=Gn,Gn.prototype.isShaderMaterial=!0,Gn.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cr.clone(e.uniforms),this.defines=e.defines,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Gn.prototype.toJSON=function(e){var t=Wr.prototype.toJSON.call(this,e);return t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t},Object.assign(Vn.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return(t||new Ut).copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(){var e=new Ut;return function(t){return this.origin.copy(this.at(t,e)),this}}(),closestPointToPoint:function(e,t){var r=t||new Ut;r.subVectors(e,this.origin);var n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(){var e=new Ut;return function(t){var r=e.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(e.copy(this.direction).multiplyScalar(r).add(this.origin),e.distanceToSquared(t))}}(),distanceSqToSegment:(zn=new Ut,Rn=new Ut,Cn=new Ut,function(e,t,r,n){zn.copy(e).add(t).multiplyScalar(.5),Rn.copy(t).sub(e).normalize(),Cn.copy(this.origin).sub(zn);var i,a,o,s,u=.5*e.distanceTo(t),c=-this.direction.dot(Rn),l=Cn.dot(this.direction),f=-Cn.dot(Rn),p=Cn.lengthSq(),h=Math.abs(1-c*c);if(h>0)if(a=c*l-f,s=u*h,(i=c*f-l)>=0)if(a>=-s)if(a<=s){var d=1/h;o=(i*=d)*(i+c*(a*=d)+2*l)+a*(c*i+a+2*f)+p}else a=u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*f)+p;else a=-u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*f)+p;else a<=-s?o=-(i=Math.max(0,-(-c*u+l)))*i+(a=i>0?-u:Math.min(Math.max(-u,-f),u))*(a+2*f)+p:a<=s?(i=0,o=(a=Math.min(Math.max(-u,-f),u))*(a+2*f)+p):o=-(i=Math.max(0,-(c*u+l)))*i+(a=i>0?u:Math.min(Math.max(-u,-f),u))*(a+2*f)+p;else a=c>0?-u:u,o=-(i=Math.max(0,-(c*a+l)))*i+a*(a+2*f)+p;return r&&r.copy(this.direction).multiplyScalar(i).add(this.origin),n&&n.copy(Rn).multiplyScalar(a).add(zn),o}),intersectSphere:function(){var e=new Ut;return function(t,r){e.subVectors(t.center,this.origin);var n=e.dot(this.direction),i=e.dot(e)-n*n,a=t.radius*t.radius;if(i>a)return null;var o=Math.sqrt(a-i),s=n-o,u=n+o;return s<0&&u<0?null:s<0?this.at(u,r):this.at(s,r)}}(),intersectsSphere:function(e){return this.distanceToPoint(e.center)<=e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null},intersectPlane:function(e,t){var r=this.distanceToPlane(e);return null===r?null:this.at(r,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var r,n,i,a,o,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,f=this.origin;return u>=0?(r=(e.min.x-f.x)*u,n=(e.max.x-f.x)*u):(r=(e.max.x-f.x)*u,n=(e.min.x-f.x)*u),c>=0?(i=(e.min.y-f.y)*c,a=(e.max.y-f.y)*c):(i=(e.max.y-f.y)*c,a=(e.min.y-f.y)*c),r>a||i>n?null:((i>r||r!=r)&&(r=i),(a<n||n!=n)&&(n=a),l>=0?(o=(e.min.z-f.z)*l,s=(e.max.z-f.z)*l):(o=(e.max.z-f.z)*l,s=(e.min.z-f.z)*l),r>s||o>n?null:((o>r||r!=r)&&(r=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(r>=0?r:n,t)))},intersectsBox:(An=new Ut,function(e){return null!==this.intersectBox(e,An)}),intersectTriangle:function(){var e=new Ut,t=new Ut,r=new Ut,n=new Ut;return function(i,a,o,s,u){t.subVectors(a,i),r.subVectors(o,i),n.crossVectors(t,r);var c,l=this.direction.dot(n);if(l>0){if(s)return null;c=1}else{if(!(l<0))return null;c=-1,l=-l}e.subVectors(this.origin,i);var f=c*this.direction.dot(r.crossVectors(e,r));if(f<0)return null;var p=c*this.direction.dot(t.cross(e));if(p<0)return null;if(f+p>l)return null;var h=-c*e.dot(n);return h<0?null:this.at(h/l,u)}}(),applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}}),Object.assign(Hn.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return(e||new Ut).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return(e||new Ut).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){var r=t||new Ut;return this.delta(r).multiplyScalar(e).add(this.start)},closestPointToPointParameter:(Ln=new Ut,Pn=new Ut,function(e,t){Ln.subVectors(e,this.start),Pn.subVectors(this.end,this.start);var r=Pn.dot(Pn),n=Pn.dot(Ln)/r;return t&&(n=Rt.clamp(n,0,1)),n}),closestPointToPoint:function(e,t,r){var n=this.closestPointToPointParameter(e,t),i=r||new Ut;return this.delta(i).multiplyScalar(n).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Object.assign(jn,{normal:(Un=new Ut,function(e,t,r,n){var i=n||new Ut;i.subVectors(r,t),Un.subVectors(e,t),i.cross(Un);var a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}),barycoordFromPoint:function(){var e=new Ut,t=new Ut,r=new Ut;return function(n,i,a,o,s){e.subVectors(o,i),t.subVectors(a,i),r.subVectors(n,i);var u=e.dot(e),c=e.dot(t),l=e.dot(r),f=t.dot(t),p=t.dot(r),h=u*f-c*c,d=s||new Ut;if(0===h)return d.set(-2,-1,-1);var m=1/h,g=(f*l-c*p)*m,v=(u*p-c*l)*m;return d.set(1-g-v,v,g)}}(),containsPoint:function(){var e=new Ut;return function(t,r,n,i){var a=jn.barycoordFromPoint(t,r,n,i,e);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}()}),Object.assign(jn.prototype,{set:function(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this},setFromPointsAndIndices:function(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},area:function(){var e=new Ut,t=new Ut;return function(){return e.subVectors(this.c,this.b),t.subVectors(this.a,this.b),.5*e.cross(t).length()}}(),midpoint:function(e){return(e||new Ut).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(e){return jn.normal(this.a,this.b,this.c,e)},plane:function(e){return(e||new Zr).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(e,t){return jn.barycoordFromPoint(e,this.a,this.b,this.c,t)},containsPoint:function(e){return jn.containsPoint(e,this.a,this.b,this.c)},closestPointToPoint:function(){var e=new Zr,t=[new Hn,new Hn,new Hn],r=new Ut,n=new Ut;return function(i,a){var o=a||new Ut,s=1/0;if(e.setFromCoplanarPoints(this.a,this.b,this.c),e.projectPoint(i,r),!0===this.containsPoint(r))o.copy(r);else{t[0].set(this.a,this.b),t[1].set(this.b,this.c),t[2].set(this.c,this.a);for(var u=0;u<t.length;u++){t[u].closestPointToPoint(r,!0,n);var c=r.distanceToSquared(n);c<s&&(s=c,o.copy(n))}}return o}}(),equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Wn.prototype=Object.assign(Object.create(cn.prototype),{constructor:Wn,isMesh:!0,setDrawMode:function(e){this.drawMode=e},copy:function(e){return cn.prototype.copy.call(this,e),this.drawMode=e.drawMode,void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,a=Object.keys(i);if(a.length>0){var o=i[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=o.length;e<t;e++)r=o[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=s.length;e<t;e++)r=s[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=e}},raycast:function(){var e=new Lt,t=new Vn,r=new Jr,n=new Ut,i=new Ut,a=new Ut,o=new Ut,s=new Ut,u=new Ut,c=new Ct,l=new Ct,f=new Ct,p=new Ut,h=new Ut,d=new Ut;function m(e,t,r,n,i,a,o){return jn.barycoordFromPoint(e,t,r,n,p),i.multiplyScalar(p.x),a.multiplyScalar(p.y),o.multiplyScalar(p.z),i.add(a).add(o),i.clone()}function g(e,t,r,n,i,a,o,s){if(null===(t.side===M?n.intersectTriangle(o,a,i,!0,s):n.intersectTriangle(i,a,o,t.side!==T,s)))return null;d.copy(s),d.applyMatrix4(e.matrixWorld);var u=r.ray.origin.distanceTo(d);return u<r.near||u>r.far?null:{distance:u,point:d.clone(),object:e}}function v(e,t,r,o,s,u,p,d){n.fromBufferAttribute(o,u),i.fromBufferAttribute(o,p),a.fromBufferAttribute(o,d);var v=g(e,e.material,t,r,n,i,a,h);return v&&(s&&(c.fromBufferAttribute(s,u),l.fromBufferAttribute(s,p),f.fromBufferAttribute(s,d),v.uv=m(h,n,i,a,c,l,f)),v.face=new pn(u,p,d,jn.normal(n,i,a)),v.faceIndex=u),v}return function(p,d){var _,y=this.geometry,b=this.material,x=this.matrixWorld;if(void 0!==b&&(null===y.boundingSphere&&y.computeBoundingSphere(),r.copy(y.boundingSphere),r.applyMatrix4(x),!1!==p.ray.intersectsSphere(r)&&(e.getInverse(x),t.copy(p.ray).applyMatrix4(e),null===y.boundingBox||!1!==t.intersectsBox(y.boundingBox))))if(y.isBufferGeometry){var w,$,E,M,T,S=y.index,A=y.attributes.position,z=y.attributes.uv;if(null!==S)for(M=0,T=S.count;M<T;M+=3)w=S.getX(M),$=S.getX(M+1),E=S.getX(M+2),(_=v(this,p,t,A,z,w,$,E))&&(_.faceIndex=Math.floor(M/3),d.push(_));else if(void 0!==A)for(M=0,T=A.count;M<T;M+=3)(_=v(this,p,t,A,z,w=M,$=M+1,E=M+2))&&(_.index=w,d.push(_))}else if(y.isGeometry){var R,C,L,P,U=Array.isArray(b),I=y.vertices,O=y.faces,N=y.faceVertexUvs[0];N.length>0&&(P=N);for(var k=0,D=O.length;k<D;k++){var F=O[k],B=U?b[F.materialIndex]:b;if(void 0!==B){if(R=I[F.a],C=I[F.b],L=I[F.c],!0===B.morphTargets){var G=y.morphTargets,V=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),a.set(0,0,0);for(var H=0,j=G.length;H<j;H++){var W=V[H];if(0!==W){var q=G[H].vertices;n.addScaledVector(o.subVectors(q[F.a],R),W),i.addScaledVector(s.subVectors(q[F.b],C),W),a.addScaledVector(u.subVectors(q[F.c],L),W)}}n.add(R),i.add(C),a.add(L),R=n,C=i,L=a}if(_=g(this,B,p,t,R,C,L,h)){if(P&&P[k]){var X=P[k];c.copy(X[0]),l.copy(X[1]),f.copy(X[2]),_.uv=m(h,R,C,L,c,l,f)}_.face=F,_.faceIndex=k,d.push(_)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Qn,ei,ti,ri,ni,ii,ai=0;function oi(e){switch(e){case bt:return["Linear","( value )"];case xt:return["sRGB","( value )"];case $t:return["RGBE","( value )"];case Mt:return["RGBM","( value, 7.0 )"];case Tt:return["RGBM","( value, 16.0 )"];case St:return["RGBD","( value, 256.0 )"];case wt:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+e)}}function si(e,t){var r=oi(t);return"vec4 "+e+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function ui(e){return""!==e}function ci(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights)}function li(e){return e.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(e,t){var r=Lr[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return li(r)})}function fi(e){return e.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(e,t,r,n){for(var i="",a=parseInt(t);a<parseInt(r);a++)i+=n.replace(/\[ i \]/g,"[ "+a+" ]");return i})}function pi(e,t,r,n,i,a){var o=e.context,s=n.defines,u=i.vertexShader,c=i.fragmentShader,l="SHADOWMAP_TYPE_BASIC";a.shadowMapType===w?l="SHADOWMAP_TYPE_PCF":a.shadowMapType===$&&(l="SHADOWMAP_TYPE_PCF_SOFT");var f="ENVMAP_TYPE_CUBE",p="ENVMAP_MODE_REFLECTION",h="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(n.envMap.mapping){case ve:case _e:f="ENVMAP_TYPE_CUBE";break;case we:case $e:f="ENVMAP_TYPE_CUBE_UV";break;case ye:case be:f="ENVMAP_TYPE_EQUIREC";break;case xe:f="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case _e:case be:p="ENVMAP_MODE_REFRACTION"}switch(n.combine){case ue:h="ENVMAP_BLENDING_MULTIPLY";break;case ce:h="ENVMAP_BLENDING_MIX";break;case le:h="ENVMAP_BLENDING_ADD"}}var d,m,g,v,_,y=e.gammaFactor>0?e.gammaFactor:1,b=function(e,t,r){return[(e=e||{}).derivatives||t.envMapCubeUV||t.bumpMap||t.normalMap||t.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(e.fragDepth||t.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",e.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(e.shaderTextureLOD||t.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ui).join("\n")}(n.extensions,a,t),x=function(e){var t=[];for(var r in e){var n=e[r];!1!==n&&t.push("#define "+r+" "+n)}return t.join("\n")}(s),E=o.createProgram();n.isRawShaderMaterial?((d=[x].filter(ui).join("\n")).length>0&&(d+="\n"),(m=[b,x].filter(ui).join("\n")).length>0&&(m+="\n")):(d=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,x,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+p:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+a.numClippingPlanes,a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(ui).join("\n"),m=[b,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+i.name,x,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"","#define GAMMA_FACTOR "+y,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+f:"",a.envMap?"#define "+p:"",a.envMap?"#define "+h:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+a.numClippingPlanes,"#define UNION_CLIPPING_PLANES "+(a.numClippingPlanes-a.numClipIntersection),a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&t.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&t.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==fe?"#define TONE_MAPPING":"",a.toneMapping!==fe?Lr.tonemapping_pars_fragment:"",a.toneMapping!==fe?function(e,t){var r;switch(t){case pe:r="Linear";break;case he:r="Reinhard";break;case de:r="Uncharted2";break;case me:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.envMapEncoding||a.emissiveMapEncoding?Lr.encodings_pars_fragment:"",a.mapEncoding?si("mapTexelToLinear",a.mapEncoding):"",a.envMapEncoding?si("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?si("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?(g="linearToOutputTexel",v=a.outputEncoding,_=oi(v),"vec4 "+g+"( vec4 value ) { return LinearTo"+_[0]+_[1]+"; }"):"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(ui).join("\n")),u=ci(u=li(u),a),c=ci(c=li(c),a),n.isShaderMaterial||(u=fi(u),c=fi(c));var M=d+u,T=m+c,S=Kn(o,o.VERTEX_SHADER,M),A=Kn(o,o.FRAGMENT_SHADER,T);o.attachShader(E,S),o.attachShader(E,A),void 0!==n.index0AttributeName?o.bindAttribLocation(E,0,n.index0AttributeName):!0===a.morphTargets&&o.bindAttribLocation(E,0,"position"),o.linkProgram(E);var z,R,C=o.getProgramInfoLog(E),L=o.getShaderInfoLog(S),P=o.getShaderInfoLog(A),U=!0,I=!0;return!1===o.getProgramParameter(E,o.LINK_STATUS)?(U=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(E,o.VALIDATE_STATUS),"gl.getProgramInfoLog",C,L,P)):""!==C?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",C):""!==L&&""!==P||(I=!1),I&&(this.diagnostics={runnable:U,material:n,programLog:C,vertexShader:{log:L,prefix:d},fragmentShader:{log:P,prefix:m}}),o.deleteShader(S),o.deleteShader(A),this.getUniforms=function(){return void 0===z&&(z=new Sr(o,E,e)),z},this.getAttributes=function(){return void 0===R&&(R=function(e,t){for(var r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var a=e.getActiveAttrib(t,i).name;r[a]=e.getAttribLocation(t,a)}return r}(o,E)),R},this.destroy=function(){o.deleteProgram(E),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=ai++,this.code=r,this.usedTimes=1,this.program=E,this.vertexShader=S,this.fragmentShader=A,this}function hi(e,t,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(e,t){var r;return e?e.isTexture?r=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=e.texture.encoding):r=bt,r===bt&&t&&(r=wt),r}this.getParameters=function(t,n,a,s,u,c,l){var f=i[t.type],p=l.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(r.floatVertexTextures)return 1024;var n=r.maxVertexUniforms,i=Math.floor((n-20)/4),a=Math.min(i,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(l):0,h=r.precision;null!==t.precision&&(h=r.getMaxPrecision(t.precision))!==t.precision&&console.warn("THREE.WebGLProgram.getParameters:",t.precision,"not supported, using",h,"instead.");var d=e.getRenderTarget();return{shaderID:f,precision:h,supportsVertexTextures:r.vertexTextures,outputEncoding:o(d?d.texture:null,e.gammaOutput),map:!!t.map,mapEncoding:o(t.map,e.gammaInput),envMap:!!t.envMap,envMapMode:t.envMap&&t.envMap.mapping,envMapEncoding:o(t.envMap,e.gammaInput),envMapCubeUV:!!t.envMap&&(t.envMap.mapping===we||t.envMap.mapping===$e),lightMap:!!t.lightMap,aoMap:!!t.aoMap,emissiveMap:!!t.emissiveMap,emissiveMapEncoding:o(t.emissiveMap,e.gammaInput),bumpMap:!!t.bumpMap,normalMap:!!t.normalMap,displacementMap:!!t.displacementMap,roughnessMap:!!t.roughnessMap,metalnessMap:!!t.metalnessMap,specularMap:!!t.specularMap,alphaMap:!!t.alphaMap,gradientMap:!!t.gradientMap,combine:t.combine,vertexColors:t.vertexColors,fog:!!s,useFog:t.fog,fogExp:s&&s.isFogExp2,flatShading:t.flatShading,sizeAttenuation:t.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:t.skinning&&p>0,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:t.morphTargets,morphNormals:t.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:u,numClipIntersection:c,dithering:t.dithering,shadowMapEnabled:e.shadowMap.enabled&&l.receiveShadow&&a.length>0,shadowMapType:e.shadowMap.type,toneMapping:e.toneMapping,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:t.premultipliedAlpha,alphaTest:t.alphaTest,doubleSided:t.side===T,flipSided:t.side===M,depthPacking:void 0!==t.depthPacking&&t.depthPacking}},this.getProgramCode=function(t,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var i in t.defines)n.push(i),n.push(t.defines[i]);for(var o=0;o<a.length;o++)n.push(r[a[o]]);return n.push(t.onBeforeCompile.toString()),n.push(e.gammaOutput),n.join()},this.acquireProgram=function(r,i,a,o){for(var s,u=0,c=n.length;u<c;u++){var l=n[u];if(l.code===o){++(s=l).usedTimes;break}}return void 0===s&&(s=new pi(e,t,o,r,i,a),n.push(s)),s},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=n.indexOf(e);n[t]=n[n.length-1],n.pop(),e.destroy()}},this.programs=n}function di(e,t,r,n,i,a,o){var s="undefined"!=typeof WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext,u={};function c(e,t){if(e.width>t||e.height>t){var r=t/Math.max(e.width,e.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(e.width*r),n.height=Math.floor(e.height*r),n.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+e.width+"x"+e.height+"). Resized to "+n.width+"x"+n.height,e),n}return e}function l(e){return Rt.isPowerOfTwo(e.width)&&Rt.isPowerOfTwo(e.height)}function f(e,t){return e.generateMipmaps&&t&&e.minFilter!==Se&&e.minFilter!==Re}function p(t){return t===Se||t===Ae||t===ze?e.NEAREST:e.LINEAR}function h(t){var r=t.target;r.removeEventListener("dispose",h),function(t){var r=n.get(t);if(t.image&&r.__image__webglTextureCube)e.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;e.deleteTexture(r.__webglTexture)}n.remove(t)}(r),r.isVideoTexture&&delete u[r.id],o.textures--}function d(t){var r=t.target;r.removeEventListener("dispose",d),function(t){var r=n.get(t),i=n.get(t.texture);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLRenderTargetCube)for(var a=0;a<6;a++)e.deleteFramebuffer(r.__webglFramebuffer[a]),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer[a]);else e.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&e.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(t.texture),n.remove(t)}(r),o.textures--}function m(t,p){var d=n.get(t);if(t.version>0&&d.__version!==t.version){var m=t.image;if(void 0===m)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",t);else{if(!1!==m.complete)return void function(t,n,p){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",h),t.__webglTexture=e.createTexture(),n.isVideoTexture&&(u[n.id]=n),o.textures++);r.activeTexture(e.TEXTURE0+p),r.bindTexture(e.TEXTURE_2D,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment);var d=c(n.image,i.maxTextureSize);(function(e){return e.wrapS!==Me||e.wrapT!==Me||e.minFilter!==Se&&e.minFilter!==Re})(n)&&!1===l(d)&&(d=function(e){if(e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof ImageBitmap){var t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.width=Rt.floorPowerOfTwo(e.width),t.height=Rt.floorPowerOfTwo(e.height),t.getContext("2d").drawImage(e,0,0,t.width,t.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+e.width+"x"+e.height+"). Resized to "+t.width+"x"+t.height,e),t}return e}(d));var m=l(d),v=a.convert(n.format),_=a.convert(n.type);g(e.TEXTURE_2D,n,m);var y,b=n.mipmaps;if(n.isDepthTexture){var x=e.DEPTH_COMPONENT;if(n.type===De){if(!s)throw new Error("Float Depth Texture only supported in WebGL2.0");x=e.DEPTH_COMPONENT32F}else s&&(x=e.DEPTH_COMPONENT16);n.format===Ze&&x===e.DEPTH_COMPONENT&&n.type!==Oe&&n.type!==ke&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Oe,_=a.convert(n.type)),n.format===Ke&&(x=e.DEPTH_STENCIL,n.type!==He&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=He,_=a.convert(n.type))),r.texImage2D(e.TEXTURE_2D,0,x,d.width,d.height,0,v,_,null)}else if(n.isDataTexture)if(b.length>0&&m){for(var w=0,$=b.length;w<$;w++)y=b[w],r.texImage2D(e.TEXTURE_2D,w,v,y.width,y.height,0,v,_,y.data);n.generateMipmaps=!1}else r.texImage2D(e.TEXTURE_2D,0,v,d.width,d.height,0,v,_,d.data);else if(n.isCompressedTexture)for(var w=0,$=b.length;w<$;w++)y=b[w],n.format!==qe&&n.format!==We?r.getCompressedTextureFormats().indexOf(v)>-1?r.compressedTexImage2D(e.TEXTURE_2D,w,v,y.width,y.height,0,y.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(e.TEXTURE_2D,w,v,y.width,y.height,0,v,_,y.data);else if(b.length>0&&m){for(var w=0,$=b.length;w<$;w++)y=b[w],r.texImage2D(e.TEXTURE_2D,w,v,v,_,y);n.generateMipmaps=!1}else r.texImage2D(e.TEXTURE_2D,0,v,v,_,d);f(n,m)&&e.generateMipmap(e.TEXTURE_2D);t.__version=n.version,n.onUpdate&&n.onUpdate(n)}(d,t,p);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",t)}}r.activeTexture(e.TEXTURE0+p),r.bindTexture(e.TEXTURE_2D,d.__webglTexture)}function g(r,o,s){var u;if(s?(e.texParameteri(r,e.TEXTURE_WRAP_S,a.convert(o.wrapS)),e.texParameteri(r,e.TEXTURE_WRAP_T,a.convert(o.wrapT)),e.texParameteri(r,e.TEXTURE_MAG_FILTER,a.convert(o.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,a.convert(o.minFilter))):(e.texParameteri(r,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(r,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),o.wrapS===Me&&o.wrapT===Me||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),e.texParameteri(r,e.TEXTURE_MAG_FILTER,p(o.magFilter)),e.texParameteri(r,e.TEXTURE_MIN_FILTER,p(o.minFilter)),o.minFilter!==Se&&o.minFilter!==Re&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),u=t.get("EXT_texture_filter_anisotropic")){if(o.type===De&&null===t.get("OES_texture_float_linear"))return;if(o.type===Fe&&null===t.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(e.texParameterf(r,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function v(t,i,o,s){var u=a.convert(i.texture.format),c=a.convert(i.texture.type);r.texImage2D(s,0,u,i.width,i.height,0,u,c,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,o,s,n.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function _(t,r){e.bindRenderbuffer(e.RENDERBUFFER,t),r.depthBuffer&&!r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)):r.depthBuffer&&r.stencilBuffer?(e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,r.width,r.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)):e.renderbufferStorage(e.RENDERBUFFER,e.RGBA4,r.width,r.height),e.bindRenderbuffer(e.RENDERBUFFER,null)}function y(t){var r=n.get(t),i=!0===t.isWebGLRenderTargetCube;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,r){if(r&&r.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),m(r.depthTexture,0);var i=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===Ze)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(r.depthTexture.format!==Ke)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(r.__webglFramebuffer,t)}else if(i){r.__webglDepthbuffer=[];for(var a=0;a<6;a++)e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer[a]),r.__webglDepthbuffer[a]=e.createRenderbuffer(),_(r.__webglDepthbuffer[a],t)}else e.bindFramebuffer(e.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=e.createRenderbuffer(),_(r.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}this.setTexture2D=m,this.setTextureCube=function(t,s){var u=n.get(t);if(6===t.image.length)if(t.version>0&&u.__version!==t.version){u.__image__webglTextureCube||(t.addEventListener("dispose",h),u.__image__webglTextureCube=e.createTexture(),o.textures++),r.activeTexture(e.TEXTURE0+s),r.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var p=t&&t.isCompressedTexture,d=t.image[0]&&t.image[0].isDataTexture,m=[],v=0;v<6;v++)m[v]=p||d?d?t.image[v].image:t.image[v]:c(t.image[v],i.maxCubemapSize);var _=l(m[0]),y=a.convert(t.format),b=a.convert(t.type);for(g(e.TEXTURE_CUBE_MAP,t,_),v=0;v<6;v++)if(p)for(var x,w=m[v].mipmaps,$=0,E=w.length;$<E;$++)x=w[$],t.format!==qe&&t.format!==We?r.getCompressedTextureFormats().indexOf(y)>-1?r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,$,y,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,$,y,x.width,x.height,0,y,b,x.data);else d?r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,y,m[v].width,m[v].height,0,y,b,m[v].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,y,y,b,m[v]);f(t,_)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),u.__version=t.version,t.onUpdate&&t.onUpdate(t)}else r.activeTexture(e.TEXTURE0+s),r.bindTexture(e.TEXTURE_CUBE_MAP,u.__image__webglTextureCube)},this.setTextureCubeDynamic=function(t,i){r.activeTexture(e.TEXTURE0+i),r.bindTexture(e.TEXTURE_CUBE_MAP,n.get(t).__webglTexture)},this.setupRenderTarget=function(t){var i=n.get(t),a=n.get(t.texture);t.addEventListener("dispose",d),a.__webglTexture=e.createTexture(),o.textures++;var s=!0===t.isWebGLRenderTargetCube,u=l(t);if(s){i.__webglFramebuffer=[];for(var c=0;c<6;c++)i.__webglFramebuffer[c]=e.createFramebuffer()}else i.__webglFramebuffer=e.createFramebuffer();if(s){for(r.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture),g(e.TEXTURE_CUBE_MAP,t.texture,u),c=0;c<6;c++)v(i.__webglFramebuffer[c],t,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+c);f(t.texture,u)&&e.generateMipmap(e.TEXTURE_CUBE_MAP),r.bindTexture(e.TEXTURE_CUBE_MAP,null)}else r.bindTexture(e.TEXTURE_2D,a.__webglTexture),g(e.TEXTURE_2D,t.texture,u),v(i.__webglFramebuffer,t,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),f(t.texture,u)&&e.generateMipmap(e.TEXTURE_2D),r.bindTexture(e.TEXTURE_2D,null);t.depthBuffer&&y(t)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(f(i,l(t))){var a=t.isWebGLRenderTargetCube?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,o=n.get(i).__webglTexture;r.bindTexture(a,o),e.generateMipmap(a),r.bindTexture(a,null)}},this.updateVideoTextures=function(){for(var e in u)u[e].update()}}function mi(e,t,r,n){ln.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function gi(e){mi.call(this),this.cameras=e||[]}function vi(e){var t=this,r=null,n=null,i=null;"undefined"!=typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData);var a=new Lt,o=new mi;o.bounds=new kt(0,0,.5,1),o.layers.enable(1);var s=new mi;s.bounds=new kt(.5,0,.5,1),s.layers.enable(2);var u,c,l=new gi([o,s]);function f(){if(null!==r&&r.isPresenting){var n=r.getEyeParameters("left"),i=n.renderWidth,a=n.renderHeight;c=e.getPixelRatio(),u=e.getSize(),e.setDrawingBufferSize(2*i,a,1)}else t.enabled&&e.setDrawingBufferSize(u.width,u.height,c)}l.layers.enable(1),l.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",f,!1),this.enabled=!1,this.getDevice=function(){return r},this.setDevice=function(e){void 0!==e&&(r=e)},this.setPoseTarget=function(e){void 0!==e&&(i=e)},this.getCamera=function(e){if(null===r)return e;r.depthNear=e.near,r.depthFar=e.far,r.getFrameData(n);var t=n.pose,u=null!==i?i:e;if(null!==t.position?u.position.fromArray(t.position):u.position.set(0,0,0),null!==t.orientation&&u.quaternion.fromArray(t.orientation),u.updateMatrixWorld(),!1===r.isPresenting)return e;o.near=e.near,s.near=e.near,o.far=e.far,s.far=e.far,l.matrixWorld.copy(e.matrixWorld),l.matrixWorldInverse.copy(e.matrixWorldInverse),o.matrixWorldInverse.fromArray(n.leftViewMatrix),s.matrixWorldInverse.fromArray(n.rightViewMatrix);var c=u.parent;null!==c&&(a.getInverse(c.matrixWorld),o.matrixWorldInverse.multiply(a),s.matrixWorldInverse.multiply(a)),o.matrixWorld.getInverse(o.matrixWorldInverse),s.matrixWorld.getInverse(s.matrixWorldInverse),o.projectionMatrix.fromArray(n.leftProjectionMatrix),s.projectionMatrix.fromArray(n.rightProjectionMatrix),l.projectionMatrix.copy(o.projectionMatrix);var f=r.getLayers();if(f.length){var p=f[0];null!==p.leftBounds&&4===p.leftBounds.length&&o.bounds.fromArray(p.leftBounds),null!==p.rightBounds&&4===p.rightBounds.length&&s.bounds.fromArray(p.rightBounds)}return l},this.submitFrame=function(){r&&r.isPresenting&&r.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",f)}}function _i(e,t){return{convert:function(r){var n;if(r===Ee)return e.REPEAT;if(r===Me)return e.CLAMP_TO_EDGE;if(r===Te)return e.MIRRORED_REPEAT;if(r===Se)return e.NEAREST;if(r===Ae)return e.NEAREST_MIPMAP_NEAREST;if(r===ze)return e.NEAREST_MIPMAP_LINEAR;if(r===Re)return e.LINEAR;if(r===Ce)return e.LINEAR_MIPMAP_NEAREST;if(r===Le)return e.LINEAR_MIPMAP_LINEAR;if(r===Pe)return e.UNSIGNED_BYTE;if(r===Be)return e.UNSIGNED_SHORT_4_4_4_4;if(r===Ge)return e.UNSIGNED_SHORT_5_5_5_1;if(r===Ve)return e.UNSIGNED_SHORT_5_6_5;if(r===Ue)return e.BYTE;if(r===Ie)return e.SHORT;if(r===Oe)return e.UNSIGNED_SHORT;if(r===Ne)return e.INT;if(r===ke)return e.UNSIGNED_INT;if(r===De)return e.FLOAT;if(r===Fe&&null!==(n=t.get("OES_texture_half_float")))return n.HALF_FLOAT_OES;if(r===je)return e.ALPHA;if(r===We)return e.RGB;if(r===qe)return e.RGBA;if(r===Xe)return e.LUMINANCE;if(r===Ye)return e.LUMINANCE_ALPHA;if(r===Ze)return e.DEPTH_COMPONENT;if(r===Ke)return e.DEPTH_STENCIL;if(r===k)return e.FUNC_ADD;if(r===D)return e.FUNC_SUBTRACT;if(r===F)return e.FUNC_REVERSE_SUBTRACT;if(r===V)return e.ZERO;if(r===H)return e.ONE;if(r===j)return e.SRC_COLOR;if(r===W)return e.ONE_MINUS_SRC_COLOR;if(r===q)return e.SRC_ALPHA;if(r===X)return e.ONE_MINUS_SRC_ALPHA;if(r===Y)return e.DST_ALPHA;if(r===J)return e.ONE_MINUS_DST_ALPHA;if(r===Z)return e.DST_COLOR;if(r===K)return e.ONE_MINUS_DST_COLOR;if(r===Q)return e.SRC_ALPHA_SATURATE;if((r===Qe||r===et||r===tt||r===rt)&&null!==(n=t.get("WEBGL_compressed_texture_s3tc"))){if(r===Qe)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===et)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===tt)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===rt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===nt||r===it||r===at||r===ot)&&null!==(n=t.get("WEBGL_compressed_texture_pvrtc"))){if(r===nt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===it)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===at)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===ot)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===st&&null!==(n=t.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((r===B||r===G)&&null!==(n=t.get("EXT_blend_minmax"))){if(r===B)return n.MIN_EXT;if(r===G)return n.MAX_EXT}return r===He&&null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:0}}}function yi(e){console.log("THREE.WebGLRenderer",h);var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==e.context?e.context:null,n=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,a=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,u=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",l=[],f=[],p=null,d=[],_=[];this.domElement=t,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=pe,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var b,x,w,$,E,S,A,R,C,k,D,F,B,G,V,H,j,W,q,X=this,Y=!1,J=null,Z=null,K=-1,Q="",ue=null,ce=null,le=new kt,fe=new kt,he=null,de=0,me=t.width,ge=t.height,ve=1,_e=new kt(0,0,me,ge),ye=new kt(0,0,me,ge),be=!1,xe=new Kr,we=new function(){var e=this,t=null,r=0,n=!1,i=!1,a=new Zr,o=new It,s={value:null,needsUpdate:!1};function u(){s.value!==t&&(s.value=t,s.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function c(t,r,n,i){var u=null!==t?t.length:0,c=null;if(0!==u){if(c=s.value,!0!==i||null===c){var l=n+4*u,f=r.matrixWorldInverse;o.getNormalMatrix(f),(null===c||c.length<l)&&(c=new Float32Array(l));for(var p=0,h=n;p!==u;++p,h+=4)a.copy(t[p]).applyMatrix4(f,o),a.normal.toArray(c,h),c[h+3]=a.constant}s.value=c,s.needsUpdate=!0}return e.numPlanes=u,c}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,a){var o=0!==e.length||i||0!==r||n;return n=i,t=c(e,a,0),r=e.length,o},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1,u()},this.setState=function(e,a,o,l,f,p){if(!n||null===e||0===e.length||i&&!o)i?c(null):u();else{var h=i?0:r,d=4*h,m=f.clippingState||null;s.value=m,m=c(e,l,d,p);for(var g=0;g!==d;++g)m[g]=t[g];f.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=h}}},$e=!1,Ee=!1,Me=new Lt,Te=new Ut,Se={geometries:0,textures:0},Ae={frame:0,calls:0,vertices:0,faces:0,points:0};function ze(){return null===J?ve:1}this.info={render:Ae,memory:Se,programs:null};try{var Re={alpha:n,depth:i,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:u,powerPreference:c};if(t.addEventListener("webglcontextlost",Ie,!1),t.addEventListener("webglcontextrestored",Oe,!1),null===(b=r||t.getContext("webgl",Re)||t.getContext("experimental-webgl",Re)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===b.getShaderPrecisionFormat&&(b.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){console.error("THREE.WebGLRenderer: "+e.message)}function Ce(){(x=new function(e){var t={};return{get:function(r){if(void 0!==t[r])return t[r];var n;switch(r){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=e.getExtension("WEBGL_compressed_texture_etc1");break;default:n=e.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),t[r]=n,n}}}(b)).get("WEBGL_depth_texture"),x.get("OES_texture_float"),x.get("OES_texture_float_linear"),x.get("OES_texture_half_float"),x.get("OES_texture_half_float_linear"),x.get("OES_standard_derivatives"),x.get("OES_element_index_uint"),x.get("ANGLE_instanced_arrays"),q=new _i(b,x),w=new function(e,t,r){var n;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a=void 0!==r.precision?r.precision:"highp",o=i(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);var s=!0===r.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),c=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),h=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),d=e.getParameter(e.MAX_VARYING_VECTORS),m=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=c>0,v=!!t.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var r=t.get("EXT_texture_filter_anisotropic");return n=null!==r?e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:s,maxTextures:u,maxVertexTextures:c,maxTextureSize:l,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:h,maxVaryings:d,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}(b,x,e),($=new function(e,t,r){var n=new function(){var t=!1,r=new kt,n=null,i=new kt(0,0,0,0);return{setMask:function(r){n===r||t||(e.colorMask(r,r,r,r),n=r)},setLocked:function(e){t=e},setClear:function(t,n,a,o,s){!0===s&&(t*=o,n*=o,a*=o),r.set(t,n,a,o),!1===i.equals(r)&&(e.clearColor(t,n,a,o),i.copy(r))},reset:function(){t=!1,n=null,i.set(-1,0,0,0)}}},i=new function(){var t=!1,r=null,n=null,i=null;return{setTest:function(t){t?W(e.DEPTH_TEST):q(e.DEPTH_TEST)},setMask:function(n){r===n||t||(e.depthMask(n),r=n)},setFunc:function(t){if(n!==t){if(t)switch(t){case ee:e.depthFunc(e.NEVER);break;case te:e.depthFunc(e.ALWAYS);break;case re:e.depthFunc(e.LESS);break;case ne:e.depthFunc(e.LEQUAL);break;case ie:e.depthFunc(e.EQUAL);break;case ae:e.depthFunc(e.GEQUAL);break;case oe:e.depthFunc(e.GREATER);break;case se:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);n=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,r=null,n=null,i=null}}},a=new function(){var t=!1,r=null,n=null,i=null,a=null,o=null,s=null,u=null,c=null;return{setTest:function(t){t?W(e.STENCIL_TEST):q(e.STENCIL_TEST)},setMask:function(n){r===n||t||(e.stencilMask(n),r=n)},setFunc:function(t,r,o){n===t&&i===r&&a===o||(e.stencilFunc(t,r,o),n=t,i=r,a=o)},setOp:function(t,r,n){o===t&&s===r&&u===n||(e.stencilOp(t,r,n),o=t,s=r,u=n)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,n=null,i=null,a=null,o=null,s=null,u=null,c=null}}},o=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=new Uint8Array(o),u=new Uint8Array(o),c=new Uint8Array(o),l={},f=null,p=null,h=null,d=null,_=null,y=null,b=null,x=null,w=null,$=!1,E=null,S=null,A=null,z=null,R=null,C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),k=parseFloat(/^WebGL\ ([0-9])/.exec(e.getParameter(e.VERSION))[1]),D=parseFloat(k)>=1,F=null,B={},G=new kt,V=new kt;function H(t,r,n){var i=new Uint8Array(4),a=e.createTexture();e.bindTexture(t,a),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var o=0;o<n;o++)e.texImage2D(r+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return a}var j={};function W(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function q(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}function X(t,n,i,a,o,s,u,c){if(t!==L?W(e.BLEND):q(e.BLEND),t!==N){if(t!==h||c!==$)switch(t){case U:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE));break;case I:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR));break;case O:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA)):(e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.SRC_COLOR));break;default:c?(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA)):(e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA))}d=null,_=null,y=null,b=null,x=null,w=null}else o=o||n,s=s||i,u=u||a,n===d&&o===b||(e.blendEquationSeparate(r.convert(n),r.convert(o)),d=n,b=o),i===_&&a===y&&s===x&&u===w||(e.blendFuncSeparate(r.convert(i),r.convert(a),r.convert(s),r.convert(u)),_=i,y=a,x=s,w=u);h=t,$=c}function Y(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function J(t){t!==m?(W(e.CULL_FACE),t!==S&&(t===g?e.cullFace(e.BACK):t===v?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):q(e.CULL_FACE),S=t}function Z(t,r,n){t?(W(e.POLYGON_OFFSET_FILL),z===r&&R===n||(e.polygonOffset(r,n),z=r,R=n)):q(e.POLYGON_OFFSET_FILL)}function K(t){void 0===t&&(t=e.TEXTURE0+C-1),F!==t&&(e.activeTexture(t),F=t)}return j[e.TEXTURE_2D]=H(e.TEXTURE_2D,e.TEXTURE_2D,1),j[e.TEXTURE_CUBE_MAP]=H(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),n.setClear(0,0,0,1),i.setClear(1),a.setClear(0),W(e.DEPTH_TEST),i.setFunc(ne),Y(!1),J(g),W(e.CULL_FACE),W(e.BLEND),X(P),{buffers:{color:n,depth:i,stencil:a},initAttributes:function(){for(var e=0,t=s.length;e<t;e++)s[e]=0},enableAttribute:function(r){s[r]=1,0===u[r]&&(e.enableVertexAttribArray(r),u[r]=1),0!==c[r]&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,0),c[r]=0)},enableAttributeAndDivisor:function(r,n){s[r]=1,0===u[r]&&(e.enableVertexAttribArray(r),u[r]=1),c[r]!==n&&(t.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(r,n),c[r]=n)},disableUnusedAttributes:function(){for(var t=0,r=u.length;t!==r;++t)u[t]!==s[t]&&(e.disableVertexAttribArray(t),u[t]=0)},enable:W,disable:q,getCompressedTextureFormats:function(){if(null===f&&(f=[],t.get("WEBGL_compressed_texture_pvrtc")||t.get("WEBGL_compressed_texture_s3tc")||t.get("WEBGL_compressed_texture_etc1")))for(var r=e.getParameter(e.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)f.push(r[n]);return f},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:X,setMaterial:function(t,r){t.side===T?q(e.CULL_FACE):W(e.CULL_FACE);var a=t.side===M;r&&(a=!a),Y(a),!0===t.transparent?X(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha):X(L),i.setFunc(t.depthFunc),i.setTest(t.depthTest),i.setMask(t.depthWrite),n.setMask(t.colorWrite),Z(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:Y,setCullFace:J,setLineWidth:function(t){t!==A&&(D&&e.lineWidth(t),A=t)},setPolygonOffset:Z,setScissorTest:function(t){t?W(e.SCISSOR_TEST):q(e.SCISSOR_TEST)},activeTexture:K,bindTexture:function(t,r){null===F&&K();var n=B[F];void 0===n&&(n={type:void 0,texture:void 0},B[F]=n),n.type===t&&n.texture===r||(e.bindTexture(t,r||j[t]),n.type=t,n.texture=r)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===G.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),G.copy(t))},viewport:function(t){!1===V.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),V.copy(t))},reset:function(){for(var t=0;t<u.length;t++)1===u[t]&&(e.disableVertexAttribArray(t),u[t]=0);l={},f=null,F=null,B={},p=null,h=null,E=null,S=null,n.reset(),i.reset(),a.reset()}}}(b,x,q)).scissor(fe.copy(ye).multiplyScalar(ve)),$.viewport(le.copy(_e).multiplyScalar(ve)),E=new function(){var e={};return{get:function(t){var r=t.uuid,n=e[r];return void 0===n&&(n={},e[r]=n),n},remove:function(t){delete e[t.uuid]},clear:function(){e={}}}},S=new di(b,x,$,E,w,q,Se),A=new en(b),R=new function(e,t,r){var n={},i={};function a(e){var o=e.target,s=n[o.id];for(var u in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[u]);o.removeEventListener("dispose",a),delete n[o.id];var c=i[o.id];c&&(t.remove(c),delete i[o.id]),(c=i[s.id])&&(t.remove(c),delete i[s.id]),r.geometries--}return{get:function(e,t){var i=n[t.id];return i||(t.addEventListener("dispose",a),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new On).setFromObject(e)),i=t._bufferGeometry),n[t.id]=i,r.geometries++,i)},update:function(r){var n=r.index,i=r.attributes;for(var a in null!==n&&t.update(n,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[a],e.ARRAY_BUFFER);var o=r.morphAttributes;for(var a in o)for(var s=o[a],u=0,c=s.length;u<c;u++)t.update(s[u],e.ARRAY_BUFFER)},getWireframeAttribute:function(r){var n=i[r.id];if(n)return n;var a,o=[],s=r.index,u=r.attributes;if(null!==s)for(var c=0,l=(a=s.array).length;c<l;c+=3){var f=a[c+0],p=a[c+1],h=a[c+2];o.push(f,p,p,h,h,f)}else for(c=0,l=(a=u.position.array).length/3-1;c<l;c+=3)f=c+0,p=c+1,h=c+2,o.push(f,p,p,h,h,f);return n=new(Sn(o)>65535?$n:xn)(o,1),t.update(n,e.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}}}(b,A,Se),C=new function(e,t){var r={};return{update:function(n){var i=t.frame,a=n.geometry,o=e.get(n,a);return r[o.id]!==i&&(a.isGeometry&&o.updateFromObject(n),e.update(o),r[o.id]=i),o},clear:function(){r={}}}}(R,Ae),G=new function(e){var t={},r=new Float32Array(8);return{update:function(n,i,a,o){var s=n.morphTargetInfluences,u=s.length,c=t[i.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];t[i.id]=c}var f=a.morphTargets&&i.morphAttributes.position,p=a.morphNormals&&i.morphAttributes.normal;for(l=0;l<u;l++)0!==(h=c[l])[1]&&(f&&i.removeAttribute("morphTarget"+l),p&&i.removeAttribute("morphNormal"+l));for(l=0;l<u;l++)(h=c[l])[0]=l,h[1]=s[l];for(c.sort(Jn),l=0;l<8;l++){var h;if(h=c[l]){var d=h[0],m=h[1];if(m){f&&i.addAttribute("morphTarget"+l,f[d]),p&&i.addAttribute("morphNormal"+l,p[d]),r[l]=m;continue}}r[l]=0}o.getUniforms().setValue(e,"morphTargetInfluences",r)}}}(b),D=new hi(X,x,w),k=new Zn,F=new Yn,B=new function(e,t,r,n){var i,a,o,s=new zr(0),u=0;function c(e,r){t.buffers.color.setClear(e.r,e.g,e.b,r,n)}return{getClearColor:function(){return s},setClearColor:function(e,t){s.set(e),c(s,u=void 0!==t?t:1)},getClearAlpha:function(){return u},setClearAlpha:function(e){c(s,u=e)},render:function(t,n,l,f){var p=n.background;null===p?c(s,u):p&&p.isColor&&(c(p,1),f=!0),(e.autoClear||f)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&p.isCubeTexture?(void 0===o&&((o=new Wn(new kn(1,1,1),new Gn({uniforms:Pr.cube.uniforms,vertexShader:Pr.cube.vertexShader,fragmentShader:Pr.cube.fragmentShader,side:M,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},r.update(o.geometry)),o.material.uniforms.tCube.value=p,t.push(o,o.geometry,o.material,0,null)):p&&p.isTexture&&(void 0===i&&(i=new fn(-1,1,1,-1,0,1),a=new Wn(new Fn(2,2),new Bn({depthTest:!1,depthWrite:!1,fog:!1})),r.update(a.geometry)),a.material.map=p,e.renderBufferDirect(i,null,a.geometry,a.material,a,null))}}}(X,$,R,s),V=new function(e,t,r){var n;this.setMode=function(e){n=e},this.render=function(t,i){e.drawArrays(n,t,i),r.calls++,r.vertices+=i,n===e.TRIANGLES?r.faces+=i/3:n===e.POINTS&&(r.points+=i)},this.renderInstances=function(i,a,o){var s=t.get("ANGLE_instanced_arrays");if(null!==s){var u=i.attributes.position;u.isInterleavedBufferAttribute?(o=u.data.count,s.drawArraysInstancedANGLE(n,0,o,i.maxInstancedCount)):s.drawArraysInstancedANGLE(n,a,o,i.maxInstancedCount),r.calls++,r.vertices+=o*i.maxInstancedCount,n===e.TRIANGLES?r.faces+=i.maxInstancedCount*o/3:n===e.POINTS&&(r.points+=i.maxInstancedCount*o)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(b,x,Ae),H=new function(e,t,r){var n,i,a;this.setMode=function(e){n=e},this.setIndex=function(e){i=e.type,a=e.bytesPerElement},this.render=function(t,o){e.drawElements(n,o,i,t*a),r.calls++,r.vertices+=o,n===e.TRIANGLES?r.faces+=o/3:n===e.POINTS&&(r.points+=o)},this.renderInstances=function(o,s,u){var c=t.get("ANGLE_instanced_arrays");null!==c?(c.drawElementsInstancedANGLE(n,u,i,s*a,o.maxInstancedCount),r.calls++,r.vertices+=u*o.maxInstancedCount,n===e.TRIANGLES?r.faces+=o.maxInstancedCount*u/3:n===e.POINTS&&(r.points+=o.maxInstancedCount*u)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(b,x,Ae),j=new Ir(X,b,$,S,w),W=new Nr(X,b,$,S,w),X.info.programs=D.programs,X.context=b,X.capabilities=w,X.extensions=x,X.properties=E,X.renderLists=F,X.state=$}Ce();var Le=new vi(X);this.vr=Le;var Ue=new Qr(X,C,w.maxTextureSize);function Ie(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Y=!0}function Oe(){console.log("THREE.WebGLRenderer: Context Restored."),Y=!1,Ce()}function Ne(e){var t=e.target;t.removeEventListener("dispose",Ne),function(e){ke(e),E.remove(e)}(t)}function ke(e){var t=E.get(e).program;e.program=void 0,void 0!==t&&D.releaseProgram(t)}this.shadowMap=Ue,this.getContext=function(){return b},this.getContextAttributes=function(){return b.getContextAttributes()},this.forceContextLoss=function(){var e=x.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=x.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return ve},this.setPixelRatio=function(e){void 0!==e&&(ve=e,this.setSize(me,ge,!1))},this.getSize=function(){return{width:me,height:ge}},this.setSize=function(e,r,n){var i=Le.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(me=e,ge=r,t.width=e*ve,t.height=r*ve,!1!==n&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(){return{width:me*ve,height:ge*ve}},this.setDrawingBufferSize=function(e,r,n){me=e,ge=r,ve=n,t.width=e*n,t.height=r*n,this.setViewport(0,0,e,r)},this.setViewport=function(e,t,r,n){_e.set(e,ge-t-n,r,n),$.viewport(le.copy(_e).multiplyScalar(ve))},this.setScissor=function(e,t,r,n){ye.set(e,ge-t-n,r,n),$.scissor(fe.copy(ye).multiplyScalar(ve))},this.setScissorTest=function(e){$.setScissorTest(be=e)},this.getClearColor=function(){return B.getClearColor()},this.setClearColor=function(){B.setClearColor.apply(B,arguments)},this.getClearAlpha=function(){return B.getClearAlpha()},this.setClearAlpha=function(){B.setClearAlpha.apply(B,arguments)},this.clear=function(e,t,r){var n=0;(void 0===e||e)&&(n|=b.COLOR_BUFFER_BIT),(void 0===t||t)&&(n|=b.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=b.STENCIL_BUFFER_BIT),b.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(e,t,r,n){this.setRenderTarget(e),this.clear(t,r,n)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ie,!1),t.removeEventListener("webglcontextrestored",Oe,!1),F.dispose(),Le.dispose()},this.renderBufferImmediate=function(e,t,r){$.initAttributes();var n=E.get(e);e.hasPositions&&!n.position&&(n.position=b.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=b.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=b.createBuffer()),e.hasColors&&!n.color&&(n.color=b.createBuffer());var i=t.getAttributes();if(e.hasPositions&&(b.bindBuffer(b.ARRAY_BUFFER,n.position),b.bufferData(b.ARRAY_BUFFER,e.positionArray,b.DYNAMIC_DRAW),$.enableAttribute(i.position),b.vertexAttribPointer(i.position,3,b.FLOAT,!1,0,0)),e.hasNormals){if(b.bindBuffer(b.ARRAY_BUFFER,n.normal),!r.isMeshPhongMaterial&&!r.isMeshStandardMaterial&&!r.isMeshNormalMaterial&&!0===r.flatShading)for(var a=0,o=3*e.count;a<o;a+=9){var s=e.normalArray,u=(s[a+0]+s[a+3]+s[a+6])/3,c=(s[a+1]+s[a+4]+s[a+7])/3,l=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=u,s[a+1]=c,s[a+2]=l,s[a+3]=u,s[a+4]=c,s[a+5]=l,s[a+6]=u,s[a+7]=c,s[a+8]=l}b.bufferData(b.ARRAY_BUFFER,e.normalArray,b.DYNAMIC_DRAW),$.enableAttribute(i.normal),b.vertexAttribPointer(i.normal,3,b.FLOAT,!1,0,0)}e.hasUvs&&r.map&&(b.bindBuffer(b.ARRAY_BUFFER,n.uv),b.bufferData(b.ARRAY_BUFFER,e.uvArray,b.DYNAMIC_DRAW),$.enableAttribute(i.uv),b.vertexAttribPointer(i.uv,2,b.FLOAT,!1,0,0)),e.hasColors&&r.vertexColors!==z&&(b.bindBuffer(b.ARRAY_BUFFER,n.color),b.bufferData(b.ARRAY_BUFFER,e.colorArray,b.DYNAMIC_DRAW),$.enableAttribute(i.color),b.vertexAttribPointer(i.color,3,b.FLOAT,!1,0,0)),$.disableUnusedAttributes(),b.drawArrays(b.TRIANGLES,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,r,n,i,a){var o=i.isMesh&&i.matrixWorld.determinant()<0;$.setMaterial(n,o);var s=Ye(e,t,n,i),u=r.id+"_"+s.id+"_"+(!0===n.wireframe),c=!1;u!==Q&&(Q=u,c=!0),i.morphTargetInfluences&&(G.update(i,r,n,s),c=!0);var l,f=r.index,p=r.attributes.position,h=1;!0===n.wireframe&&(f=R.getWireframeAttribute(r),h=2);var d=V;null!==f&&(l=A.get(f),(d=H).setIndex(l)),c&&(!function(e,t,r,n){if(r&&r.isInstancedBufferGeometry&&null===x.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");void 0===n&&(n=0);$.initAttributes();var i=r.attributes,a=t.getAttributes(),o=e.defaultAttributeValues;for(var s in a){var u=a[s];if(u>=0){var c=i[s];if(void 0!==c){var l=c.normalized,f=c.itemSize,p=A.get(c);if(void 0===p)continue;var h=p.buffer,d=p.type,m=p.bytesPerElement;if(c.isInterleavedBufferAttribute){var g=c.data,v=g.stride,_=c.offset;g&&g.isInstancedInterleavedBuffer?($.enableAttributeAndDivisor(u,g.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=g.meshPerAttribute*g.count)):$.enableAttribute(u),b.bindBuffer(b.ARRAY_BUFFER,h),b.vertexAttribPointer(u,f,d,l,v*m,(n*v+_)*m)}else c.isInstancedBufferAttribute?($.enableAttributeAndDivisor(u,c.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=c.meshPerAttribute*c.count)):$.enableAttribute(u),b.bindBuffer(b.ARRAY_BUFFER,h),b.vertexAttribPointer(u,f,d,l,0,n*f*m)}else if(void 0!==o){var y=o[s];if(void 0!==y)switch(y.length){case 2:b.vertexAttrib2fv(u,y);break;case 3:b.vertexAttrib3fv(u,y);break;case 4:b.vertexAttrib4fv(u,y);break;default:b.vertexAttrib1fv(u,y)}}}}$.disableUnusedAttributes()}(n,s,r),null!==f&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,l.buffer));var m=0;null!==f?m=f.count:void 0!==p&&(m=p.count);var g=r.drawRange.start*h,v=r.drawRange.count*h,_=null!==a?a.start*h:0,y=null!==a?a.count*h:1/0,w=Math.max(g,_),E=Math.min(m,g+v,_+y)-1,M=Math.max(0,E-w+1);if(0!==M){if(i.isMesh)if(!0===n.wireframe)$.setLineWidth(n.wireframeLinewidth*ze()),d.setMode(b.LINES);else switch(i.drawMode){case vt:d.setMode(b.TRIANGLES);break;case _t:d.setMode(b.TRIANGLE_STRIP);break;case yt:d.setMode(b.TRIANGLE_FAN)}else if(i.isLine){var T=n.linewidth;void 0===T&&(T=1),$.setLineWidth(T*ze()),i.isLineSegments?d.setMode(b.LINES):i.isLineLoop?d.setMode(b.LINE_LOOP):d.setMode(b.LINE_STRIP)}else i.isPoints&&d.setMode(b.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&d.renderInstances(r,w,M):d.render(w,M)}},this.compile=function(e,t){l.length=0,f.length=0,e.traverse(function(e){e.isLight&&(l.push(e),e.castShadow&&f.push(e))}),k.setup(l,f,t),e.traverse(function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)Xe(t.material[r],e.fog,t);else Xe(t.material,e.fog,t)})};var Be,Ge=!1,Ve=null;function He(e){null!==Ve&&Ve(e);var t=Le.getDevice();t&&t.isPresenting?t.requestAnimationFrame(He):window.requestAnimationFrame(He)}function je(e,t,r,n){for(var i=0,a=e.length;i<a;i++){var o=e[i],s=o.object,u=o.geometry,c=void 0===n?o.material:n,l=o.group;if(r.isArrayCamera){ce=r;for(var f=r.cameras,p=0,h=f.length;p<h;p++){var d=f[p];if(s.layers.test(d.layers)){var m=d.bounds,g=m.x*me,v=m.y*ge,_=m.z*me,y=m.w*ge;$.viewport(le.set(g,v,_,y).multiplyScalar(ve)),We(s,t,d,u,c,l)}}}else ce=null,We(s,t,r,u,c,l)}}function We(e,t,r,n,i,a){if(e.onBeforeRender(X,t,r,n,i,a),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=e.isMesh&&e.matrixWorld.determinant()<0;$.setMaterial(i,o);var s=Ye(r,t.fog,i,e);Q="",function(e,t,r){e.render(function(e){X.renderBufferImmediate(e,t,r)})}(e,s,i)}else X.renderBufferDirect(r,t.fog,n,i,e,a);e.onAfterRender(X,t,r,n,i,a)}function Xe(e,t,r){var n=E.get(e),i=D.getParameters(e,k.state,f,t,we.numPlanes,we.numIntersection,r),a=D.getProgramCode(e,i),o=n.program,s=!0;if(void 0===o)e.addEventListener("dispose",Ne);else if(o.code!==a)ke(e);else{if(void 0!==i.shaderID)return;s=!1}if(s){if(i.shaderID){var u=Pr[i.shaderID];n.shader={name:e.type,uniforms:Cr.clone(u.uniforms),vertexShader:u.vertexShader,fragmentShader:u.fragmentShader}}else n.shader={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};e.onBeforeCompile(n.shader),o=D.acquireProgram(e,n.shader,i,a),n.program=o,e.program=o}var c=o.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var l=0;l<X.maxMorphTargets;l++)c["morphTarget"+l]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals){e.numSupportedMorphNormals=0;for(l=0;l<X.maxMorphNormals;l++)c["morphNormal"+l]>=0&&e.numSupportedMorphNormals++}var p=n.shader.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(n.numClippingPlanes=we.numPlanes,n.numIntersection=we.numIntersection,p.clippingPlanes=we.uniform),n.fog=t,n.lightsHash=k.state.hash,e.lights&&(p.ambientLightColor.value=k.state.ambient,p.directionalLights.value=k.state.directional,p.spotLights.value=k.state.spot,p.rectAreaLights.value=k.state.rectArea,p.pointLights.value=k.state.point,p.hemisphereLights.value=k.state.hemi,p.directionalShadowMap.value=k.state.directionalShadowMap,p.directionalShadowMatrix.value=k.state.directionalShadowMatrix,p.spotShadowMap.value=k.state.spotShadowMap,p.spotShadowMatrix.value=k.state.spotShadowMatrix,p.pointShadowMap.value=k.state.pointShadowMap,p.pointShadowMatrix.value=k.state.pointShadowMatrix);var h=n.program.getUniforms(),d=Sr.seqWithValue(h.seq,p);n.uniformsList=d}function Ye(e,t,r,n){de=0;var i=E.get(r);if($e&&(Ee||e!==ue)){var a=e===ue&&r.id===K;we.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,e,i,a)}!1===r.needsUpdate&&(void 0===i.program?r.needsUpdate=!0:r.fog&&i.fog!==t?r.needsUpdate=!0:r.lights&&i.lightsHash!==k.state.hash?r.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===we.numPlanes&&i.numIntersection===we.numIntersection||(r.needsUpdate=!0)),r.needsUpdate&&(Xe(r,t,n),r.needsUpdate=!1);var o,s,u=!1,c=!1,l=!1,f=i.program,p=f.getUniforms(),h=i.shader.uniforms;if($.useProgram(f.program)&&(u=!0,c=!0,l=!0),r.id!==K&&(K=r.id,c=!0),u||e!==ue){if(p.setValue(b,"projectionMatrix",e.projectionMatrix),w.logarithmicDepthBuffer&&p.setValue(b,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),ue!==(ce||e)&&(ue=ce||e,c=!0,l=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var d=p.map.cameraPosition;void 0!==d&&d.setValue(b,Te.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&p.setValue(b,"viewMatrix",e.matrixWorldInverse)}if(r.skinning){p.setOptional(b,n,"bindMatrix"),p.setOptional(b,n,"bindMatrixInverse");var m=n.skeleton;if(m){var g=m.bones;if(w.floatVertexTextures){if(void 0===m.boneTexture){var v=Math.sqrt(4*g.length);v=Rt.ceilPowerOfTwo(v),v=Math.max(v,4);var _=new Float32Array(v*v*4);_.set(m.boneMatrices);var y=new Bt(_,v,v,qe,De);m.boneMatrices=_,m.boneTexture=y,m.boneTextureSize=v}p.setValue(b,"boneTexture",m.boneTexture),p.setValue(b,"boneTextureSize",m.boneTextureSize)}else p.setOptional(b,m,"boneMatrices")}}return c&&(p.setValue(b,"toneMappingExposure",X.toneMappingExposure),p.setValue(b,"toneMappingWhitePoint",X.toneMappingWhitePoint),r.lights&&(s=l,(o=h).ambientLightColor.needsUpdate=s,o.directionalLights.needsUpdate=s,o.pointLights.needsUpdate=s,o.spotLights.needsUpdate=s,o.rectAreaLights.needsUpdate=s,o.hemisphereLights.needsUpdate=s),t&&r.fog&&function(e,t){e.fogColor.value=t.color,t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(h,t),r.isMeshBasicMaterial?Je(h,r):r.isMeshLambertMaterial?(Je(h,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(h,r)):r.isMeshPhongMaterial?(Je(h,r),r.isMeshToonMaterial?function(e,t){Ze(e,t),t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(h,r):Ze(h,r)):r.isMeshStandardMaterial?(Je(h,r),r.isMeshPhysicalMaterial?function(e,t){e.clearCoat.value=t.clearCoat,e.clearCoatRoughness.value=t.clearCoatRoughness,Ke(e,t)}(h,r):Ke(h,r)):r.isMeshDepthMaterial?(Je(h,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(h,r)):r.isMeshDistanceMaterial?(Je(h,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(h,r)):r.isMeshNormalMaterial?(Je(h,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale);t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale));t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(h,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value=t.color,e.opacity.value=t.opacity}(h,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(h,r)):r.isPointsMaterial?function(e,t){if(e.diffuse.value=t.color,e.opacity.value=t.opacity,e.size.value=t.size*ve,e.scale.value=.5*ge,e.map.value=t.map,null!==t.map){if(!0===t.map.matrixAutoUpdate){var r=t.map.offset,n=t.map.repeat,i=t.map.rotation,a=t.map.center;t.map.matrix.setUvTransform(r.x,r.y,n.x,n.y,i,a.x,a.y)}e.uvTransform.value.copy(t.map.matrix)}}(h,r):r.isShadowMaterial&&(h.color.value=r.color,h.opacity.value=r.opacity),void 0!==h.ltcMat&&(h.ltcMat.value=Rr.LTC_MAT_TEXTURE),void 0!==h.ltcMag&&(h.ltcMag.value=Rr.LTC_MAG_TEXTURE),Sr.upload(b,i.uniformsList,h,X)),p.setValue(b,"modelViewMatrix",n.modelViewMatrix),p.setValue(b,"normalMatrix",n.normalMatrix),p.setValue(b,"modelMatrix",n.matrixWorld),f}function Je(e,t){var r;if(e.opacity.value=t.opacity,t.color&&(e.diffuse.value=t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap),t.envMap&&(e.envMap.value=t.envMap,e.flipEnvMap.value=t.envMap&&t.envMap.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r){if(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate){var n=r.offset,i=r.repeat,a=r.rotation,o=r.center;r.matrix.setUvTransform(n.x,n.y,i.x,i.y,a,o.x,o.y)}e.uvTransform.value.copy(r.matrix)}}function Ze(e,t){e.specular.value=t.specular,e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}function Ke(e,t){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale)),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),t.envMap&&(e.envMapIntensity.value=t.envMapIntensity)}this.animate=function(e){Ve=e,function(){if(!Ge){var e=Le.getDevice();e&&e.isPresenting?e.requestAnimationFrame(He):window.requestAnimationFrame(He),Ge=!0}}()},this.render=function(e,t,r,n){if(t&&t.isCamera){if(!Y){Q="",K=-1,ue=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),Le.enabled&&(t=Le.getCamera(t)),Me.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),xe.setFromMatrix(Me),l.length=0,f.length=0,d.length=0,_.length=0,Ee=this.localClippingEnabled,$e=we.init(this.clippingPlanes,Ee,t),(p=F.get(e,t)).init(),function e(t,r,n){if(!1===t.visible)return;var i=t.layers.test(r.layers);if(i)if(t.isLight)l.push(t),t.castShadow&&f.push(t);else if(t.isSprite)t.frustumCulled&&!xe.intersectsSprite(t)||d.push(t);else if(t.isLensFlare)_.push(t);else if(t.isImmediateRenderObject)n&&Te.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Me),p.push(t,null,t.material,Te.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||xe.intersectsObject(t))){n&&Te.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Me);var a=C.update(t),o=t.material;if(Array.isArray(o))for(var s=a.groups,u=0,c=s.length;u<c;u++){var h=s[u],m=o[h.materialIndex];m&&m.visible&&p.push(t,a,m,Te.z,h)}else o.visible&&p.push(t,a,o,Te.z,null)}var g=t.children;for(var u=0,c=g.length;u<c;u++)e(g[u],r,n)}(e,t,X.sortObjects),!0===X.sortObjects&&p.sort(),S.updateVideoTextures(),$e&&we.beginShadows(),Ue.render(f,e,t),k.setup(l,f,t),$e&&we.endShadows(),Ae.frame++,Ae.calls=0,Ae.vertices=0,Ae.faces=0,Ae.points=0,void 0===r&&(r=null),this.setRenderTarget(r),B.render(p,e,t,n);var i=p.opaque,a=p.transparent;if(e.overrideMaterial){var o=e.overrideMaterial;i.length&&je(i,e,t,o),a.length&&je(a,e,t,o)}else i.length&&je(i,e,t),a.length&&je(a,e,t);W.render(d,e,t),j.render(_,e,t,le),r&&S.updateRenderTargetMipmap(r),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1),Le.enabled&&Le.submitFrame()}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFaceCulling=function(e,t){$.setCullFace(e),$.setFlipSided(t===y)},this.allocTextureUnit=function(){var e=de;return e>=w.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+e+" texture units while this GPU supports only "+w.maxTextures),de+=1,e},this.setTexture2D=(Be=!1,function(e,t){e&&e.isWebGLRenderTarget&&(Be||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),Be=!0),e=e.texture),S.setTexture2D(e,t)}),this.setTexture=function(){var e=!1;return function(t,r){e||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),e=!0),S.setTexture2D(t,r)}}(),this.setTextureCube=function(){var e=!1;return function(t,r){t&&t.isWebGLRenderTargetCube&&(e||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),e=!0),t=t.texture),t&&t.isCubeTexture||Array.isArray(t.image)&&6===t.image.length?S.setTextureCube(t,r):S.setTextureCubeDynamic(t,r)}}(),this.getRenderTarget=function(){return J},this.setRenderTarget=function(e){J=e,e&&void 0===E.get(e).__webglFramebuffer&&S.setupRenderTarget(e);var t=null,r=!1;if(e){var n=E.get(e).__webglFramebuffer;e.isWebGLRenderTargetCube?(t=n[e.activeCubeFace],r=!0):t=n,le.copy(e.viewport),fe.copy(e.scissor),he=e.scissorTest}else le.copy(_e).multiplyScalar(ve),fe.copy(ye).multiplyScalar(ve),he=be;if(Z!==t&&(b.bindFramebuffer(b.FRAMEBUFFER,t),Z=t),$.viewport(le),$.scissor(fe),$.setScissorTest(he),r){var i=E.get(e.texture);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+e.activeCubeFace,i.__webglTexture,e.activeMipMapLevel)}},this.readRenderTargetPixels=function(e,t,r,n,i,a){if(e&&e.isWebGLRenderTarget){var o=E.get(e).__webglFramebuffer;if(o){var s=!1;o!==Z&&(b.bindFramebuffer(b.FRAMEBUFFER,o),s=!0);try{var u=e.texture,c=u.format,l=u.type;if(c!==qe&&q.convert(c)!==b.getParameter(b.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===Pe||q.convert(l)===b.getParameter(b.IMPLEMENTATION_COLOR_READ_TYPE)||l===De&&(x.get("OES_texture_float")||x.get("WEBGL_color_buffer_float"))||l===Fe&&x.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");b.checkFramebufferStatus(b.FRAMEBUFFER)===b.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-n&&r>=0&&r<=e.height-i&&b.readPixels(t,r,n,i,q.convert(c),q.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&b.bindFramebuffer(b.FRAMEBUFFER,Z)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")}}function bi(e,t){this.name="",this.color=new zr(e),this.density=void 0!==t?t:25e-5}function xi(e,t,r){this.name="",this.color=new zr(e),this.near=void 0!==t?t:1,this.far=void 0!==r?r:1e3}function wi(){cn.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function $i(e,t,r,n,i){cn.call(this),this.lensFlares=[],this.positionScreen=new Ut,this.customUpdateCallback=void 0,void 0!==e&&this.add(e,t,r,n,i)}function Ei(e){Wr.call(this),this.type="SpriteMaterial",this.color=new zr(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(e)}function Mi(e){cn.call(this),this.type="Sprite",this.material=void 0!==e?e:new Ei}function Ti(){cn.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Si(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===t)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Lt)}}function Ai(){cn.call(this),this.type="Bone"}function zi(e,t){Wn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Lt,this.bindMatrixInverse=new Lt;var r=new Si(this.initBones());this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function Ri(e){Wr.call(this),this.type="LineBasicMaterial",this.color=new zr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(e)}function Ci(e,t,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Li(e,t);cn.call(this),this.type="Line",this.geometry=void 0!==e?e:new On,this.material=void 0!==t?t:new Ri({color:16777215*Math.random()})}function Li(e,t){Ci.call(this,e,t),this.type="LineSegments"}function Pi(e,t){Ci.call(this,e,t),this.type="LineLoop"}function Ui(e){Wr.call(this),this.type="PointsMaterial",this.color=new zr(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(e)}function Ii(e,t){cn.call(this),this.type="Points",this.geometry=void 0!==e?e:new On,this.material=void 0!==t?t:new Ui({color:16777215*Math.random()})}function Oi(){cn.call(this),this.type="Group"}function Ni(e,t,r,n,i,a,o,s,u){Nt.call(this,e,t,r,n,i,a,o,s,u),this.generateMipmaps=!1;var c=this;e.addEventListener("loadeddata",function t(){e.removeEventListener("loadeddata",t,!1),c.needsUpdate=!0},!1)}function ki(e,t,r,n,i,a,o,s,u,c,l,f){Nt.call(this,null,a,o,s,u,c,n,i,l,f),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}function Di(e,t,r,n,i,a,o,s,u,c){if((c=void 0!==c?c:Ze)!==Ze&&c!==Ke)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Ze&&(r=Oe),void 0===r&&c===Ke&&(r=He),Nt.call(this,null,n,i,a,o,s,c,r,u),this.image={width:e,height:t},this.magFilter=void 0!==o?o:Se,this.minFilter=void 0!==s?s:Se,this.flipY=!1,this.generateMipmaps=!1}function Fi(e){On.call(this),this.type="WireframeGeometry";var t,r,n,i,a,o,s,u,c,l,f=[],p=[0,0],h={},d=["a","b","c"];if(e&&e.isGeometry){var m=e.faces;for(t=0,n=m.length;t<n;t++){var g=m[t];for(r=0;r<3;r++)s=g[d[r]],u=g[d[(r+1)%3]],p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===h[c=p[0]+","+p[1]]&&(h[c]={index1:p[0],index2:p[1]})}for(c in h)o=h[c],l=e.vertices[o.index1],f.push(l.x,l.y,l.z),l=e.vertices[o.index2],f.push(l.x,l.y,l.z)}else if(e&&e.isBufferGeometry){var v,_,y,b,x,w,$;if(l=new Ut,null!==e.index){for(v=e.attributes.position,_=e.index,0===(y=e.groups).length&&(y=[{start:0,count:_.count,materialIndex:0}]),i=0,a=y.length;i<a;++i)for(t=x=(b=y[i]).start,n=x+b.count;t<n;t+=3)for(r=0;r<3;r++)s=_.getX(t+r),u=_.getX(t+(r+1)%3),p[0]=Math.min(s,u),p[1]=Math.max(s,u),void 0===h[c=p[0]+","+p[1]]&&(h[c]={index1:p[0],index2:p[1]});for(c in h)o=h[c],l.fromBufferAttribute(v,o.index1),f.push(l.x,l.y,l.z),l.fromBufferAttribute(v,o.index2),f.push(l.x,l.y,l.z)}else for(t=0,n=(v=e.attributes.position).count/3;t<n;t++)for(r=0;r<3;r++)w=3*t+r,l.fromBufferAttribute(v,w),f.push(l.x,l.y,l.z),$=3*t+(r+1)%3,l.fromBufferAttribute(v,$),f.push(l.x,l.y,l.z)}this.addAttribute("position",new En(f,3))}function Bi(e,t,r){mn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:r},this.fromBufferGeometry(new Gi(e,t,r)),this.mergeVertices()}function Gi(e,t,r){On.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:r};var n,i,a=[],o=[],s=[],u=[],c=new Ut,l=new Ut,f=new Ut,p=new Ut,h=new Ut,d=t+1;for(n=0;n<=r;n++){var m=n/r;for(i=0;i<=t;i++){var g=i/t;l=e(g,m,l),o.push(l.x,l.y,l.z),g-1e-5>=0?(f=e(g-1e-5,m,f),p.subVectors(l,f)):(f=e(g+1e-5,m,f),p.subVectors(f,l)),m-1e-5>=0?(f=e(g,m-1e-5,f),h.subVectors(l,f)):(f=e(g,m+1e-5,f),h.subVectors(f,l)),c.crossVectors(p,h).normalize(),s.push(c.x,c.y,c.z),u.push(g,m)}}for(n=0;n<r;n++)for(i=0;i<t;i++){var v=n*d+i,_=n*d+i+1,y=(n+1)*d+i+1,b=(n+1)*d+i;a.push(v,_,b),a.push(_,y,b)}this.setIndex(a),this.addAttribute("position",new En(o,3)),this.addAttribute("normal",new En(s,3)),this.addAttribute("uv",new En(u,2))}function Vi(e,t,r,n){mn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},this.fromBufferGeometry(new Hi(e,t,r,n)),this.mergeVertices()}function Hi(e,t,r,n){On.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:n},r=r||1;var i=[],a=[];function o(e,t,r,n){var i,a,o=Math.pow(2,n),u=[];for(i=0;i<=o;i++){u[i]=[];var c=e.clone().lerp(r,i/o),l=t.clone().lerp(r,i/o),f=o-i;for(a=0;a<=f;a++)u[i][a]=0===a&&i===o?c:c.clone().lerp(l,a/f)}for(i=0;i<o;i++)for(a=0;a<2*(o-i)-1;a++){var p=Math.floor(a/2);a%2==0?(s(u[i][p+1]),s(u[i+1][p]),s(u[i][p])):(s(u[i][p+1]),s(u[i+1][p+1]),s(u[i+1][p]))}}function s(e){i.push(e.x,e.y,e.z)}function u(t,r){var n=3*t;r.x=e[n+0],r.y=e[n+1],r.z=e[n+2]}function c(e,t,r,n){n<0&&1===e.x&&(a[t]=e.x-1),0===r.x&&0===r.z&&(a[t]=n/2/Math.PI+.5)}function l(e){return Math.atan2(e.z,-e.x)}!function(e){for(var r=new Ut,n=new Ut,i=new Ut,a=0;a<t.length;a+=3)u(t[a+0],r),u(t[a+1],n),u(t[a+2],i),o(r,n,i,e)}(n=n||0),function(e){for(var t=new Ut,r=0;r<i.length;r+=3)t.x=i[r+0],t.y=i[r+1],t.z=i[r+2],t.normalize().multiplyScalar(e),i[r+0]=t.x,i[r+1]=t.y,i[r+2]=t.z}(r),function(){for(var e=new Ut,t=0;t<i.length;t+=3){e.x=i[t+0],e.y=i[t+1],e.z=i[t+2];var r=l(e)/2/Math.PI+.5,n=(o=e,Math.atan2(-o.y,Math.sqrt(o.x*o.x+o.z*o.z))/Math.PI+.5);a.push(r,1-n)}var o;(function(){for(var e=new Ut,t=new Ut,r=new Ut,n=new Ut,o=new Ct,s=new Ct,u=new Ct,f=0,p=0;f<i.length;f+=9,p+=6){e.set(i[f+0],i[f+1],i[f+2]),t.set(i[f+3],i[f+4],i[f+5]),r.set(i[f+6],i[f+7],i[f+8]),o.set(a[p+0],a[p+1]),s.set(a[p+2],a[p+3]),u.set(a[p+4],a[p+5]),n.copy(e).add(t).add(r).divideScalar(3);var h=l(n);c(o,p+0,e,h),c(s,p+2,t,h),c(u,p+4,r,h)}})(),function(){for(var e=0;e<a.length;e+=6){var t=a[e+0],r=a[e+2],n=a[e+4],i=Math.max(t,r,n),o=Math.min(t,r,n);i>.9&&o<.1&&(t<.2&&(a[e+0]+=1),r<.2&&(a[e+2]+=1),n<.2&&(a[e+4]+=1))}}()}(),this.addAttribute("position",new En(i,3)),this.addAttribute("normal",new En(i.slice(),3)),this.addAttribute("uv",new En(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function ji(e,t){mn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Wi(e,t)),this.mergeVertices()}function Wi(e,t){Hi.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}function qi(e,t){mn.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Xi(e,t)),this.mergeVertices()}function Xi(e,t){Hi.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Yi(e,t){mn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ji(e,t)),this.mergeVertices()}function Ji(e,t){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1];Hi.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Zi(e,t){mn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Ki(e,t)),this.mergeVertices()}function Ki(e,t){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n];Hi.call(this,i,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}function Qi(e,t,r,n,i,a){mn.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new ea(e,t,r,n,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function ea(e,t,r,n,i){On.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:i},t=t||64,r=r||1,n=n||8,i=i||!1;var a=e.computeFrenetFrames(t,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,u=new Ut,c=new Ut,l=new Ct,f=new Ut,p=[],h=[],d=[],m=[];function g(i){f=e.getPointAt(i/t,f);var o=a.normals[i],l=a.binormals[i];for(s=0;s<=n;s++){var d=s/n*Math.PI*2,m=Math.sin(d),g=-Math.cos(d);c.x=g*o.x+m*l.x,c.y=g*o.y+m*l.y,c.z=g*o.z+m*l.z,c.normalize(),h.push(c.x,c.y,c.z),u.x=f.x+r*c.x,u.y=f.y+r*c.y,u.z=f.z+r*c.z,p.push(u.x,u.y,u.z)}}!function(){for(o=0;o<t;o++)g(o);g(!1===i?t:0),function(){for(o=0;o<=t;o++)for(s=0;s<=n;s++)l.x=o/t,l.y=s/n,d.push(l.x,l.y)}(),function(){for(s=1;s<=t;s++)for(o=1;o<=n;o++){var e=(n+1)*(s-1)+(o-1),r=(n+1)*s+(o-1),i=(n+1)*s+o,a=(n+1)*(s-1)+o;m.push(e,r,a),m.push(r,i,a)}}()}(),this.setIndex(m),this.addAttribute("position",new En(p,3)),this.addAttribute("normal",new En(h,3)),this.addAttribute("uv",new En(d,2))}function ta(e,t,r,n,i,a,o){mn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new ra(e,t,r,n,i,a)),this.mergeVertices()}function ra(e,t,r,n,i,a){On.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:n,p:i,q:a},e=e||1,t=t||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,a=a||3;var o,s,u=[],c=[],l=[],f=[],p=new Ut,h=new Ut,d=new Ut,m=new Ut,g=new Ut,v=new Ut,_=new Ut;for(o=0;o<=r;++o){var y=o/r*i*Math.PI*2;for(S(y,i,a,e,d),S(y+.01,i,a,e,m),v.subVectors(m,d),_.addVectors(m,d),g.crossVectors(v,_),_.crossVectors(g,v),g.normalize(),_.normalize(),s=0;s<=n;++s){var b=s/n*Math.PI*2,x=-t*Math.cos(b),w=t*Math.sin(b);p.x=d.x+(x*_.x+w*g.x),p.y=d.y+(x*_.y+w*g.y),p.z=d.z+(x*_.z+w*g.z),c.push(p.x,p.y,p.z),h.subVectors(p,d).normalize(),l.push(h.x,h.y,h.z),f.push(o/r),f.push(s/n)}}for(s=1;s<=r;s++)for(o=1;o<=n;o++){var $=(n+1)*(s-1)+(o-1),E=(n+1)*s+(o-1),M=(n+1)*s+o,T=(n+1)*(s-1)+o;u.push($,E,T),u.push(E,M,T)}function S(e,t,r,n,i){var a=Math.cos(e),o=Math.sin(e),s=r/t*e,u=Math.cos(s);i.x=n*(2+u)*.5*a,i.y=n*(2+u)*o*.5,i.z=n*Math.sin(s)*.5}this.setIndex(u),this.addAttribute("position",new En(c,3)),this.addAttribute("normal",new En(l,3)),this.addAttribute("uv",new En(f,2))}function na(e,t,r,n,i){mn.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new ia(e,t,r,n,i)),this.mergeVertices()}function ia(e,t,r,n,i){On.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:n,arc:i},e=e||1,t=t||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var a,o,s=[],u=[],c=[],l=[],f=new Ut,p=new Ut,h=new Ut;for(a=0;a<=r;a++)for(o=0;o<=n;o++){var d=o/n*i,m=a/r*Math.PI*2;p.x=(e+t*Math.cos(m))*Math.cos(d),p.y=(e+t*Math.cos(m))*Math.sin(d),p.z=t*Math.sin(m),u.push(p.x,p.y,p.z),f.x=e*Math.cos(d),f.y=e*Math.sin(d),h.subVectors(p,f).normalize(),c.push(h.x,h.y,h.z),l.push(o/n),l.push(a/r)}for(a=1;a<=r;a++)for(o=1;o<=n;o++){var g=(n+1)*a+o-1,v=(n+1)*(a-1)+o-1,_=(n+1)*(a-1)+o,y=(n+1)*a+o;s.push(g,v,y),s.push(v,_,y)}this.setIndex(s),this.addAttribute("position",new En(u,3)),this.addAttribute("normal",new En(c,3)),this.addAttribute("uv",new En(l,2))}mi.prototype=Object.assign(Object.create(ln.prototype),{constructor:mi,isPerspectiveCamera:!0,copy:function(e,t){return ln.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Rt.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Rt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Rt.RAD2DEG*Math.atan(Math.tan(.5*Rt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,r,n,i,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Rt.DEG2RAD*this.fov)/this.zoom,r=2*t,n=this.aspect*r,i=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;i+=a.offsetX*n/o,t-=a.offsetY*r/s,n*=a.width/o,r*=a.height/s}var u=this.filmOffset;0!==u&&(i+=e*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,t,t-r,e,this.far)},toJSON:function(e){var t=cn.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),gi.prototype=Object.assign(Object.create(mi.prototype),{constructor:gi,isArrayCamera:!0}),bi.prototype.isFogExp2=!0,bi.prototype.clone=function(){return new bi(this.color.getHex(),this.density)},bi.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},xi.prototype.isFog=!0,xi.prototype.clone=function(){return new xi(this.color.getHex(),this.near,this.far)},xi.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},wi.prototype=Object.assign(Object.create(cn.prototype),{constructor:wi,copy:function(e,t){return cn.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=cn.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}),$i.prototype=Object.assign(Object.create(cn.prototype),{constructor:$i,isLensFlare:!0,copy:function(e){cn.prototype.copy.call(this,e),this.positionScreen.copy(e.positionScreen),this.customUpdateCallback=e.customUpdateCallback;for(var t=0,r=e.lensFlares.length;t<r;t++)this.lensFlares.push(e.lensFlares[t]);return this},add:function(e,t,r,n,i,a){void 0===t&&(t=-1),void 0===r&&(r=0),void 0===a&&(a=1),void 0===i&&(i=new zr(16777215)),void 0===n&&(n=P),r=Math.min(r,Math.max(0,r)),this.lensFlares.push({texture:e,size:t,distance:r,x:0,y:0,z:0,scale:1,rotation:0,opacity:a,color:i,blending:n})},updateLensFlares:function(){var e,t,r=this.lensFlares.length,n=2*-this.positionScreen.x,i=2*-this.positionScreen.y;for(e=0;e<r;e++)(t=this.lensFlares[e]).x=this.positionScreen.x+n*t.distance,t.y=this.positionScreen.y+i*t.distance,t.wantedRotation=t.x*Math.PI*.25,t.rotation+=.25*(t.wantedRotation-t.rotation)}}),Ei.prototype=Object.create(Wr.prototype),Ei.prototype.constructor=Ei,Ei.prototype.isSpriteMaterial=!0,Ei.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.rotation=e.rotation,this},Mi.prototype=Object.assign(Object.create(cn.prototype),{constructor:Mi,isSprite:!0,raycast:(Qn=new Ut,ei=new Ut,ti=new Ut,function(e,t){ei.setFromMatrixPosition(this.matrixWorld),e.ray.closestPointToPoint(ei,Qn),ti.setFromMatrixScale(this.matrixWorld);var r=ti.x*ti.y/4;if(!(ei.distanceToSquared(Qn)>r)){var n=e.ray.origin.distanceTo(Qn);n<e.near||n>e.far||t.push({distance:n,point:Qn.clone(),face:null,object:this})}}),clone:function(){return new this.constructor(this.material).copy(this)}}),Ti.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ti,copy:function(e){cn.prototype.copy.call(this,e,!1);for(var t=e.levels,r=0,n=t.length;r<n;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(e,t){void 0===t&&(t=0),t=Math.abs(t);for(var r=this.levels,n=0;n<r.length&&!(t<r[n].distance);n++);r.splice(n,0,{distance:t,object:e}),this.add(e)},getObjectForDistance:function(e){for(var t=this.levels,r=1,n=t.length;r<n&&!(e<t[r].distance);r++);return t[r-1].object},raycast:(ri=new Ut,function(e,t){ri.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(ri);this.getObjectForDistance(r).raycast(e,t)}),update:function(){var e=new Ut,t=new Ut;return function(r){var n=this.levels;if(n.length>1){e.setFromMatrixPosition(r.matrixWorld),t.setFromMatrixPosition(this.matrixWorld);var i=e.distanceTo(t);n[0].object.visible=!0;for(var a=1,o=n.length;a<o&&i>=n[a].distance;a++)n[a-1].object.visible=!1,n[a].object.visible=!0;for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(e){var t=cn.prototype.toJSON.call(this,e);t.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var a=r[n];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}}),Object.assign(Si.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var r=new Lt;this.bones[e]&&r.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(r)}},pose:function(){var e,t,r;for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,r=this.bones.length;t<r;t++)(e=this.bones[t])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:(ni=new Lt,ii=new Lt,function(){for(var e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture,i=0,a=e.length;i<a;i++){var o=e[i]?e[i].matrixWorld:ii;ni.multiplyMatrices(o,t[i]),ni.toArray(r,16*i)}void 0!==n&&(n.needsUpdate=!0)}),clone:function(){return new Si(this.bones,this.boneInverses)}}),Ai.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ai,isBone:!0}),zi.prototype=Object.assign(Object.create(Wn.prototype),{constructor:zi,isSkinnedMesh:!0,initBones:function(){var e,t,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)t=this.geometry.bones[r],e=new Ai,i.push(e),e.name=t.name,e.position.fromArray(t.pos),e.quaternion.fromArray(t.rotq),void 0!==t.scl&&e.scale.fromArray(t.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)-1!==(t=this.geometry.bones[r]).parent&&null!==t.parent&&void 0!==i[t.parent]?i[t.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var e,t;if(this.geometry&&this.geometry.isGeometry)for(t=0;t<this.geometry.skinWeights.length;t++){var r=this.geometry.skinWeights[t];(e=1/r.manhattanLength())!==1/0?r.multiplyScalar(e):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new kt,i=this.geometry.attributes.skinWeight;for(t=0;t<i.count;t++)n.x=i.getX(t),n.y=i.getY(t),n.z=i.getZ(t),n.w=i.getW(t),(e=1/n.manhattanLength())!==1/0?n.multiplyScalar(e):n.set(1,0,0,0),i.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(e){Wn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ri.prototype=Object.create(Wr.prototype),Ri.prototype.constructor=Ri,Ri.prototype.isLineBasicMaterial=!0,Ri.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this},Ci.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ci,isLine:!0,raycast:function(){var e=new Lt,t=new Vn,r=new Jr;return function(n,i){var a=n.linePrecision,o=a*a,s=this.geometry,u=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(u),!1!==n.ray.intersectsSphere(r)){e.getInverse(u),t.copy(n.ray).applyMatrix4(e);var c=new Ut,l=new Ut,f=new Ut,p=new Ut,h=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var d=s.index,m=s.attributes.position.array;if(null!==d)for(var g=d.array,v=0,_=g.length-1;v<_;v+=h){var y=g[v],b=g[v+1];if(c.fromArray(m,3*y),l.fromArray(m,3*b),!(t.distanceSqToSegment(c,l,p,f)>o))p.applyMatrix4(this.matrixWorld),($=n.ray.origin.distanceTo(p))<n.near||$>n.far||i.push({distance:$,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}else for(v=0,_=m.length/3-1;v<_;v+=h){if(c.fromArray(m,3*v),l.fromArray(m,3*v+3),!(t.distanceSqToSegment(c,l,p,f)>o))p.applyMatrix4(this.matrixWorld),($=n.ray.origin.distanceTo(p))<n.near||$>n.far||i.push({distance:$,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else if(s.isGeometry){var x=s.vertices,w=x.length;for(v=0;v<w-1;v+=h){var $;if(!(t.distanceSqToSegment(x[v],x[v+1],p,f)>o))p.applyMatrix4(this.matrixWorld),($=n.ray.origin.distanceTo(p))<n.near||$>n.far||i.push({distance:$,point:f.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Li.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Li,isLineSegments:!0}),Pi.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Pi,isLineLoop:!0}),Ui.prototype=Object.create(Wr.prototype),Ui.prototype.constructor=Ui,Ui.prototype.isPointsMaterial=!0,Ui.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this},Ii.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ii,isPoints:!0,raycast:function(){var e=new Lt,t=new Vn,r=new Jr;return function(n,i){var a=this,o=this.geometry,s=this.matrixWorld,u=n.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),r.copy(o.boundingSphere),r.applyMatrix4(s),r.radius+=u,!1!==n.ray.intersectsSphere(r)){e.getInverse(s),t.copy(n.ray).applyMatrix4(e);var c=u/((this.scale.x+this.scale.y+this.scale.z)/3),l=c*c,f=new Ut;if(o.isBufferGeometry){var p=o.index,h=o.attributes.position.array;if(null!==p)for(var d=p.array,m=0,g=d.length;m<g;m++){var v=d[m];f.fromArray(h,3*v),b(f,v)}else{m=0;for(var _=h.length/3;m<_;m++)f.fromArray(h,3*m),b(f,m)}}else{var y=o.vertices;for(m=0,_=y.length;m<_;m++)b(y[m],m)}}function b(e,r){var o=t.distanceSqToPoint(e);if(o<l){var u=t.closestPointToPoint(e);u.applyMatrix4(s);var c=n.ray.origin.distanceTo(u);if(c<n.near||c>n.far)return;i.push({distance:c,distanceToRay:Math.sqrt(o),point:u.clone(),index:r,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Oi.prototype=Object.assign(Object.create(cn.prototype),{constructor:Oi,isGroup:!0}),Ni.prototype=Object.assign(Object.create(Nt.prototype),{constructor:Ni,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),ki.prototype=Object.create(Nt.prototype),ki.prototype.constructor=ki,ki.prototype.isCompressedTexture=!0,Di.prototype=Object.create(Nt.prototype),Di.prototype.constructor=Di,Di.prototype.isDepthTexture=!0,Fi.prototype=Object.create(On.prototype),Fi.prototype.constructor=Fi,Bi.prototype=Object.create(mn.prototype),Bi.prototype.constructor=Bi,Gi.prototype=Object.create(On.prototype),Gi.prototype.constructor=Gi,Vi.prototype=Object.create(mn.prototype),Vi.prototype.constructor=Vi,Hi.prototype=Object.create(On.prototype),Hi.prototype.constructor=Hi,ji.prototype=Object.create(mn.prototype),ji.prototype.constructor=ji,Wi.prototype=Object.create(Hi.prototype),Wi.prototype.constructor=Wi,qi.prototype=Object.create(mn.prototype),qi.prototype.constructor=qi,Xi.prototype=Object.create(Hi.prototype),Xi.prototype.constructor=Xi,Yi.prototype=Object.create(mn.prototype),Yi.prototype.constructor=Yi,Ji.prototype=Object.create(Hi.prototype),Ji.prototype.constructor=Ji,Zi.prototype=Object.create(mn.prototype),Zi.prototype.constructor=Zi,Ki.prototype=Object.create(Hi.prototype),Ki.prototype.constructor=Ki,Qi.prototype=Object.create(mn.prototype),Qi.prototype.constructor=Qi,ea.prototype=Object.create(On.prototype),ea.prototype.constructor=ea,ta.prototype=Object.create(mn.prototype),ta.prototype.constructor=ta,ra.prototype=Object.create(On.prototype),ra.prototype.constructor=ra,na.prototype=Object.create(mn.prototype),na.prototype.constructor=na,ia.prototype=Object.create(On.prototype),ia.prototype.constructor=ia;var aa=function(e,t,r){r=r||2;var n,i,a,o,s,u,c,l=t&&t.length,f=l?t[0]*r:e.length,p=oa(e,0,f,r,!0),h=[];if(!p)return h;if(l&&(p=function(e,t,r,n){var i,a,o,s,u,c=[];for(i=0,a=t.length;i<a;i++)o=t[i]*n,s=i<a-1?t[i+1]*n:e.length,(u=oa(e,o,s,n,!1))===u.next&&(u.steiner=!0),c.push(ga(u));for(c.sort(ha),i=0;i<c.length;i++)da(c[i],r),r=sa(r,r.next);return r}(e,t,p,r)),e.length>80*r){n=a=e[0],i=o=e[1];for(var d=r;d<f;d+=r)s=e[d],u=e[d+1],s<n&&(n=s),u<i&&(i=u),s>a&&(a=s),u>o&&(o=u);c=0!==(c=Math.max(a-n,o-i))?1/c:0}return ua(p,h,r,n,i,c),h};function oa(e,t,r,n,i){var a,o;if(i===function(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,r,n)>0)for(a=t;a<r;a+=n)o=Ea(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=Ea(a,e[a],e[a+1],o);return o&&ba(o,o.next)&&(Ma(o),o=o.next),o}function sa(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!ba(n,n.next)&&0!==ya(n.prev,n,n.next))n=n.next;else{if(Ma(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function ua(e,t,r,n,i,a,o){if(e){!o&&a&&function(e,t,r,n){var i=e;do{null===i.z&&(i.z=ma(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,a,o,s,u,c=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(u=c;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,c*=2}while(o>1)}(i)}(e,n,i,a);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,a?la(e,n,i,a):ca(e))t.push(s.i/r),t.push(e.i/r),t.push(u.i/r),Ma(e),e=u.next,c=u.next;else if((e=u)===c){o?1===o?ua(e=fa(e,t,r),t,r,n,i,a,2):2===o&&pa(e,t,r,n,i,a):ua(sa(e),t,r,n,i,a,1);break}}}function ca(e){var t=e.prev,r=e,n=e.next;if(ya(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(va(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&ya(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function la(e,t,r,n){var i=e.prev,a=e,o=e.next;if(ya(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,u=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,c=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,l=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=ma(s,u,t,r,n),p=ma(c,l,t,r,n),h=e.nextZ;h&&h.z<=p;){if(h!==e.prev&&h!==e.next&&va(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&ya(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(h=e.prevZ;h&&h.z>=f;){if(h!==e.prev&&h!==e.next&&va(i.x,i.y,a.x,a.y,o.x,o.y,h.x,h.y)&&ya(h.prev,h,h.next)>=0)return!1;h=h.prevZ}return!0}function fa(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!ba(i,a)&&xa(i,n,n.next,a)&&wa(i,a)&&wa(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),Ma(n),Ma(n.next),n=e=a),n=n.next}while(n!==e);return n}function pa(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&_a(o,s)){var u=$a(o,s);return o=sa(o,o.next),u=sa(u,u.next),ua(o,t,r,n,i,a),void ua(u,t,r,n,i,a)}s=s.next}o=o.next}while(o!==e)}function ha(e,t){return e.x-t.x}function da(e,t){if(t=function(e,t){var r,n=t,i=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>o){if(o=s,s===i){if(a===n.y)return n;if(a===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!r)return null;if(i===o)return r.prev;var u,c=r,l=r.x,f=r.y,p=1/0;n=r.next;for(;n!==c;)i>=n.x&&n.x>=l&&i!==n.x&&va(a<f?i:o,a,l,f,a<f?o:i,a,n.x,n.y)&&((u=Math.abs(a-n.y)/(i-n.x))<p||u===p&&n.x>r.x)&&wa(n,e)&&(r=n,p=u),n=n.next;return r}(e,t)){var r=$a(t,e);sa(r,r.next)}}function ma(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function ga(e){var t=e,r=e;do{t.x<r.x&&(r=t),t=t.next}while(t!==e);return r}function va(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function _a(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&xa(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&wa(e,t)&&wa(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)}function ya(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function ba(e,t){return e.x===t.x&&e.y===t.y}function xa(e,t,r,n){return!!(ba(e,t)&&ba(r,n)||ba(e,n)&&ba(r,t))||ya(e,t,r)>0!=ya(e,t,n)>0&&ya(r,n,e)>0!=ya(r,n,t)>0}function wa(e,t){return ya(e.prev,e,e.next)<0?ya(e,t,e.next)>=0&&ya(e,e.prev,t)>=0:ya(e,t,e.prev)<0||ya(e,e.next,t)<0}function $a(e,t){var r=new Ta(e.i,e.x,e.y),n=new Ta(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function Ea(e,t,r,n){var i=new Ta(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Ma(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ta(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Sa={area:function(e){for(var t=e.length,r=0,n=t-1,i=0;i<t;n=i++)r+=e[n].x*e[i].y-e[i].x*e[n].y;return.5*r},isClockWise:function(e){return Sa.area(e)<0},triangulateShape:function(e,t){function r(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function n(e,t){for(var r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var i=[],a=[],o=[];r(e),n(i,e);var s=e.length;for(t.forEach(r),c=0;c<t.length;c++)a.push(s),s+=t[c].length,n(i,t[c]);for(var u=aa(i,a),c=0;c<u.length;c+=3)o.push(u.slice(c,c+3));return o}};function Aa(e,t){mn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new za(e,t)),this.mergeVertices()}function za(e,t){void 0!==e&&(On.call(this),this.type="ExtrudeBufferGeometry",e=Array.isArray(e)?e:[e],this.addShapeList(e,t),this.computeVertexNormals())}function Ra(e,t){mn.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new Ca(e,t)),this.mergeVertices()}function Ca(e,t){var r=(t=t||{}).font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new mn;var n=r.generateShapes(e,t.size,t.curveSegments);t.amount=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),za.call(this,n,t),this.type="TextBufferGeometry"}function La(e,t,r,n,i,a,o){mn.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new Pa(e,t,r,n,i,a,o)),this.mergeVertices()}function Pa(e,t,r,n,i,a,o){On.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:n,phiLength:i,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI;var s,u,c=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),l=0,f=[],p=new Ut,h=new Ut,d=[],m=[],g=[],v=[];for(u=0;u<=r;u++){var _=[],y=u/r;for(s=0;s<=t;s++){var b=s/t;p.x=-e*Math.cos(n+b*i)*Math.sin(a+y*o),p.y=e*Math.cos(a+y*o),p.z=e*Math.sin(n+b*i)*Math.sin(a+y*o),m.push(p.x,p.y,p.z),h.set(p.x,p.y,p.z).normalize(),g.push(h.x,h.y,h.z),v.push(b,1-y),_.push(l++)}f.push(_)}for(u=0;u<r;u++)for(s=0;s<t;s++){var x=f[u][s+1],w=f[u][s],$=f[u+1][s],E=f[u+1][s+1];(0!==u||a>0)&&d.push(x,w,E),(u!==r-1||c<Math.PI)&&d.push(w,$,E)}this.setIndex(d),this.addAttribute("position",new En(m,3)),this.addAttribute("normal",new En(g,3)),this.addAttribute("uv",new En(v,2))}function Ua(e,t,r,n,i,a){mn.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},this.fromBufferGeometry(new Ia(e,t,r,n,i,a)),this.mergeVertices()}function Ia(e,t,r,n,i,a){On.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:a},e=e||.5,t=t||1,i=void 0!==i?i:0,a=void 0!==a?a:2*Math.PI,r=void 0!==r?Math.max(3,r):8;var o,s,u,c=[],l=[],f=[],p=[],h=e,d=(t-e)/(n=void 0!==n?Math.max(1,n):1),m=new Ut,g=new Ct;for(s=0;s<=n;s++){for(u=0;u<=r;u++)o=i+u/r*a,m.x=h*Math.cos(o),m.y=h*Math.sin(o),l.push(m.x,m.y,m.z),f.push(0,0,1),g.x=(m.x/t+1)/2,g.y=(m.y/t+1)/2,p.push(g.x,g.y);h+=d}for(s=0;s<n;s++){var v=s*(r+1);for(u=0;u<r;u++){var _=o=u+v,y=o+r+1,b=o+r+2,x=o+1;c.push(_,y,x),c.push(y,b,x)}}this.setIndex(c),this.addAttribute("position",new En(l,3)),this.addAttribute("normal",new En(f,3)),this.addAttribute("uv",new En(p,2))}function Oa(e,t,r,n){mn.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},this.fromBufferGeometry(new Na(e,t,r,n)),this.mergeVertices()}function Na(e,t,r,n){On.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:n},t=Math.floor(t)||12,r=r||0,n=n||2*Math.PI,n=Rt.clamp(n,0,2*Math.PI);var i,a,o,s=[],u=[],c=[],l=1/t,f=new Ut,p=new Ct;for(a=0;a<=t;a++){var h=r+a*l*n,d=Math.sin(h),m=Math.cos(h);for(o=0;o<=e.length-1;o++)f.x=e[o].x*d,f.y=e[o].y,f.z=e[o].x*m,u.push(f.x,f.y,f.z),p.x=a/t,p.y=o/(e.length-1),c.push(p.x,p.y)}for(a=0;a<t;a++)for(o=0;o<e.length-1;o++){var g=i=o+a*e.length,v=i+e.length,_=i+e.length+1,y=i+1;s.push(g,v,y),s.push(v,_,y)}if(this.setIndex(s),this.addAttribute("position",new En(u,3)),this.addAttribute("uv",new En(c,2)),this.computeVertexNormals(),n===2*Math.PI){var b=this.attributes.normal.array,x=new Ut,w=new Ut,$=new Ut;for(i=t*e.length*3,a=0,o=0;a<e.length;a++,o+=3)x.x=b[o+0],x.y=b[o+1],x.z=b[o+2],w.x=b[i+o+0],w.y=b[i+o+1],w.z=b[i+o+2],$.addVectors(x,w).normalize(),b[o+0]=b[i+o+0]=$.x,b[o+1]=b[i+o+1]=$.y,b[o+2]=b[i+o+2]=$.z}}function ka(e,t){mn.call(this),this.type="ShapeGeometry","object"==typeof t&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new Da(e,t)),this.mergeVertices()}function Da(e,t){On.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var r=[],n=[],i=[],a=[],o=0,s=0;if(!1===Array.isArray(e))c(e);else for(var u=0;u<e.length;u++)c(e[u]),this.addGroup(o,s,u),o+=s,s=0;function c(e){var o,u,c,l=n.length/3,f=e.extractPoints(t),p=f.shape,h=f.holes;if(!1===Sa.isClockWise(p))for(p=p.reverse(),o=0,u=h.length;o<u;o++)c=h[o],!0===Sa.isClockWise(c)&&(h[o]=c.reverse());var d=Sa.triangulateShape(p,h);for(o=0,u=h.length;o<u;o++)c=h[o],p=p.concat(c);for(o=0,u=p.length;o<u;o++){var m=p[o];n.push(m.x,m.y,0),i.push(0,0,1),a.push(m.x,m.y)}for(o=0,u=d.length;o<u;o++){var g=d[o],v=g[0]+l,_=g[1]+l,y=g[2]+l;r.push(v,_,y),s+=3}}this.setIndex(r),this.addAttribute("position",new En(n,3)),this.addAttribute("normal",new En(i,3)),this.addAttribute("uv",new En(a,2))}function Fa(e,t){if(t.shapes=[],Array.isArray(e))for(var r=0,n=e.length;r<n;r++){var i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}function Ba(e,t){On.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=void 0!==t?t:1;var r,n,i,a,o=[],s=Math.cos(Rt.DEG2RAD*t),u=[0,0],c={},l=["a","b","c"];e.isBufferGeometry?(a=new mn).fromBufferGeometry(e):a=e.clone(),a.mergeVertices(),a.computeFaceNormals();for(var f=a.vertices,p=a.faces,h=0,d=p.length;h<d;h++)for(var m=p[h],g=0;g<3;g++)r=m[l[g]],n=m[l[(g+1)%3]],u[0]=Math.min(r,n),u[1]=Math.max(r,n),void 0===c[i=u[0]+","+u[1]]?c[i]={index1:u[0],index2:u[1],face1:h,face2:void 0}:c[i].face2=h;for(i in c){var v=c[i];if(void 0===v.face2||p[v.face1].normal.dot(p[v.face2].normal)<=s){var _=f[v.index1];o.push(_.x,_.y,_.z),_=f[v.index2],o.push(_.x,_.y,_.z)}}this.addAttribute("position",new En(o,3))}function Ga(e,t,r,n,i,a,o,s){mn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Va(e,t,r,n,i,a,o,s)),this.mergeVertices()}function Va(e,t,r,n,i,a,o,s){On.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:s};var u=this;e=void 0!==e?e:1,t=void 0!==t?t:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var c=[],l=[],f=[],p=[],h=0,d=[],m=r/2,g=0;function v(r){var i,a,d,v=new Ct,_=new Ut,y=0,b=!0===r?e:t,x=!0===r?1:-1;for(a=h,i=1;i<=n;i++)l.push(0,m*x,0),f.push(0,x,0),p.push(.5,.5),h++;for(d=h,i=0;i<=n;i++){var w=i/n*s+o,$=Math.cos(w),E=Math.sin(w);_.x=b*E,_.y=m*x,_.z=b*$,l.push(_.x,_.y,_.z),f.push(0,x,0),v.x=.5*$+.5,v.y=.5*E*x+.5,p.push(v.x,v.y),h++}for(i=0;i<n;i++){var M=a+i,T=d+i;!0===r?c.push(T,T+1,M):c.push(T+1,T,M),y+=3}u.addGroup(g,y,!0===r?1:2),g+=y}!function(){var a,v,_=new Ut,y=new Ut,b=0,x=(t-e)/r;for(v=0;v<=i;v++){var w=[],$=v/i,E=$*(t-e)+e;for(a=0;a<=n;a++){var M=a/n,T=M*s+o,S=Math.sin(T),A=Math.cos(T);y.x=E*S,y.y=-$*r+m,y.z=E*A,l.push(y.x,y.y,y.z),_.set(S,x,A).normalize(),f.push(_.x,_.y,_.z),p.push(M,1-$),w.push(h++)}d.push(w)}for(a=0;a<n;a++)for(v=0;v<i;v++){var z=d[v][a],R=d[v+1][a],C=d[v+1][a+1],L=d[v][a+1];c.push(z,R,L),c.push(R,C,L),b+=6}u.addGroup(g,b,0),g+=b}(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.addAttribute("position",new En(l,3)),this.addAttribute("normal",new En(f,3)),this.addAttribute("uv",new En(p,2))}function Ha(e,t,r,n,i,a,o){Ga.call(this,0,e,t,r,n,i,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function ja(e,t,r,n,i,a,o){Va.call(this,0,e,t,r,n,i,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:a,thetaLength:o}}function Wa(e,t,r,n){mn.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new qa(e,t,r,n)),this.mergeVertices()}function qa(e,t,r,n){On.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:n},e=e||1,t=void 0!==t?Math.max(3,t):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,a,o=[],s=[],u=[],c=[],l=new Ut,f=new Ct;for(s.push(0,0,0),u.push(0,0,1),c.push(.5,.5),a=0,i=3;a<=t;a++,i+=3){var p=r+a/t*n;l.x=e*Math.cos(p),l.y=e*Math.sin(p),s.push(l.x,l.y,l.z),u.push(0,0,1),f.x=(s[i]/e+1)/2,f.y=(s[i+1]/e+1)/2,c.push(f.x,f.y)}for(i=1;i<=t;i++)o.push(i,i+1,0);this.setIndex(o),this.addAttribute("position",new En(s,3)),this.addAttribute("normal",new En(u,3)),this.addAttribute("uv",new En(c,2))}Aa.prototype=Object.create(mn.prototype),Aa.prototype.constructor=Aa,za.prototype=Object.create(On.prototype),za.prototype.constructor=za,za.prototype.getArrays=function(){var e=this.getAttribute("position"),t=e?Array.prototype.slice.call(e.array):[],r=this.getAttribute("uv"),n=r?Array.prototype.slice.call(r.array):[],i=this.index;return{position:t,uv:n,index:i?Array.prototype.slice.call(i.array):[]}},za.prototype.addShapeList=function(e,t){var r=e.length;t.arrays=this.getArrays();for(var n=0;n<r;n++){var i=e[n];this.addShape(i,t)}this.setIndex(t.arrays.index),this.addAttribute("position",new En(t.arrays.position,3)),this.addAttribute("uv",new En(t.arrays.uv,2))},za.prototype.addShape=function(e,t){var r,n,i,a,o,s,u,c,l=t.arrays?t.arrays:this.getArrays(),f=l.position,p=l.index,h=l.uv,d=[],m=void 0!==t.amount?t.amount:100,g=void 0!==t.bevelThickness?t.bevelThickness:6,v=void 0!==t.bevelSize?t.bevelSize:g-2,_=void 0!==t.bevelSegments?t.bevelSegments:3,y=void 0===t.bevelEnabled||t.bevelEnabled,b=void 0!==t.curveSegments?t.curveSegments:12,x=void 0!==t.steps?t.steps:1,w=t.extrudePath,$=!1,E=void 0!==t.UVGenerator?t.UVGenerator:Aa.WorldUVGenerator;w&&(r=w.getSpacedPoints(x),$=!0,y=!1,n=void 0!==t.frames?t.frames:w.computeFrenetFrames(x,!1),i=new Ut,a=new Ut,o=new Ut),y||(_=0,g=0,v=0);var M=this,T=e.extractPoints(b),S=T.shape,A=T.holes;if(!Sa.isClockWise(S))for(S=S.reverse(),u=0,c=A.length;u<c;u++)s=A[u],Sa.isClockWise(s)&&(A[u]=s.reverse());var z=Sa.triangulateShape(S,A),R=S;for(u=0,c=A.length;u<c;u++)s=A[u],S=S.concat(s);function C(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}var L,P,U,I,O,N,k=S.length,D=z.length;function F(e,t,r){var n,i,a,o=e.x-t.x,s=e.y-t.y,u=r.x-e.x,c=r.y-e.y,l=o*o+s*s,f=o*c-s*u;if(Math.abs(f)>Number.EPSILON){var p=Math.sqrt(l),h=Math.sqrt(u*u+c*c),d=t.x-s/p,m=t.y+o/p,g=((r.x-c/h-d)*c-(r.y+u/h-m)*u)/(o*c-s*u),v=(n=d+o*g-e.x)*n+(i=m+s*g-e.y)*i;if(v<=2)return new Ct(n,i);a=Math.sqrt(v/2)}else{var _=!1;o>Number.EPSILON?u>Number.EPSILON&&(_=!0):o<-Number.EPSILON?u<-Number.EPSILON&&(_=!0):Math.sign(s)===Math.sign(c)&&(_=!0),_?(n=-s,i=o,a=Math.sqrt(l)):(n=o,i=s,a=Math.sqrt(l/2))}return new Ct(n/a,i/a)}for(var B=[],G=0,V=R.length,H=V-1,j=G+1;G<V;G++,H++,j++)H===V&&(H=0),j===V&&(j=0),B[G]=F(R[G],R[H],R[j]);var W,q,X=[],Y=B.concat();for(u=0,c=A.length;u<c;u++){for(s=A[u],W=[],G=0,H=(V=s.length)-1,j=G+1;G<V;G++,H++,j++)H===V&&(H=0),j===V&&(j=0),W[G]=F(s[G],s[H],s[j]);X.push(W),Y=Y.concat(W)}for(L=0;L<_;L++){for(U=L/_,I=g*Math.cos(U*Math.PI/2),P=v*Math.sin(U*Math.PI/2),G=0,V=R.length;G<V;G++)Z((O=C(R[G],B[G],P)).x,O.y,-I);for(u=0,c=A.length;u<c;u++)for(s=A[u],W=X[u],G=0,V=s.length;G<V;G++)Z((O=C(s[G],W[G],P)).x,O.y,-I)}for(P=v,G=0;G<k;G++)O=y?C(S[G],Y[G],P):S[G],$?(a.copy(n.normals[0]).multiplyScalar(O.x),i.copy(n.binormals[0]).multiplyScalar(O.y),o.copy(r[0]).add(a).add(i),Z(o.x,o.y,o.z)):Z(O.x,O.y,0);for(q=1;q<=x;q++)for(G=0;G<k;G++)O=y?C(S[G],Y[G],P):S[G],$?(a.copy(n.normals[q]).multiplyScalar(O.x),i.copy(n.binormals[q]).multiplyScalar(O.y),o.copy(r[q]).add(a).add(i),Z(o.x,o.y,o.z)):Z(O.x,O.y,m/x*q);for(L=_-1;L>=0;L--){for(U=L/_,I=g*Math.cos(U*Math.PI/2),P=v*Math.sin(U*Math.PI/2),G=0,V=R.length;G<V;G++)Z((O=C(R[G],B[G],P)).x,O.y,m+I);for(u=0,c=A.length;u<c;u++)for(s=A[u],W=X[u],G=0,V=s.length;G<V;G++)O=C(s[G],W[G],P),$?Z(O.x,O.y+r[x-1].y,r[x-1].x+I):Z(O.x,O.y,m+I)}function J(e,t){var r,n;for(G=e.length;--G>=0;){r=G,(n=G-1)<0&&(n=e.length-1);var i=0,a=x+2*_;for(i=0;i<a;i++){var o=k*i,s=k*(i+1);Q(t+r+o,t+n+o,t+n+s,t+r+s)}}}function Z(e,t,r){d.push(e),d.push(t),d.push(r)}function K(e,t,r){ee(e),ee(t),ee(r);var n=f.length/3,i=E.generateTopUV(M,f,n-3,n-2,n-1);te(i[0]),te(i[1]),te(i[2])}function Q(e,t,r,n){ee(e),ee(t),ee(n),ee(t),ee(r),ee(n);var i=f.length/3,a=E.generateSideWallUV(M,f,i-6,i-3,i-2,i-1);te(a[0]),te(a[1]),te(a[3]),te(a[1]),te(a[2]),te(a[3])}function ee(e){p.push(f.length/3),f.push(d[3*e+0]),f.push(d[3*e+1]),f.push(d[3*e+2])}function te(e){h.push(e.x),h.push(e.y)}!function(){var e=f.length/3;if(y){var r=0,n=k*r;for(G=0;G<D;G++)K((N=z[G])[2]+n,N[1]+n,N[0]+n);for(n=k*(r=x+2*_),G=0;G<D;G++)K((N=z[G])[0]+n,N[1]+n,N[2]+n)}else{for(G=0;G<D;G++)K((N=z[G])[2],N[1],N[0]);for(G=0;G<D;G++)K((N=z[G])[0]+k*x,N[1]+k*x,N[2]+k*x)}M.addGroup(e,f.length/3-e,void 0!==t.material?t.material:0)}(),function(){var e=f.length/3,r=0;for(J(R,r),r+=R.length,u=0,c=A.length;u<c;u++)J(s=A[u],r),r+=s.length;M.addGroup(e,f.length/3-e,void 0!==t.extrudeMaterial?t.extrudeMaterial:1)}(),t.arrays||(this.setIndex(p),this.addAttribute("position",new En(f,3)),this.addAttribute("uv",new En(h,2)))},Aa.WorldUVGenerator={generateTopUV:function(e,t,r,n,i){var a=t[3*r],o=t[3*r+1],s=t[3*n],u=t[3*n+1],c=t[3*i],l=t[3*i+1];return[new Ct(a,o),new Ct(s,u),new Ct(c,l)]},generateSideWallUV:function(e,t,r,n,i,a){var o=t[3*r],s=t[3*r+1],u=t[3*r+2],c=t[3*n],l=t[3*n+1],f=t[3*n+2],p=t[3*i],h=t[3*i+1],d=t[3*i+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(s-l)<.01?[new Ct(o,1-u),new Ct(c,1-f),new Ct(p,1-d),new Ct(m,1-v)]:[new Ct(s,1-u),new Ct(l,1-f),new Ct(h,1-d),new Ct(g,1-v)]}},Ra.prototype=Object.create(mn.prototype),Ra.prototype.constructor=Ra,Ca.prototype=Object.create(za.prototype),Ca.prototype.constructor=Ca,La.prototype=Object.create(mn.prototype),La.prototype.constructor=La,Pa.prototype=Object.create(On.prototype),Pa.prototype.constructor=Pa,Ua.prototype=Object.create(mn.prototype),Ua.prototype.constructor=Ua,Ia.prototype=Object.create(On.prototype),Ia.prototype.constructor=Ia,Oa.prototype=Object.create(mn.prototype),Oa.prototype.constructor=Oa,Na.prototype=Object.create(On.prototype),Na.prototype.constructor=Na,ka.prototype=Object.create(mn.prototype),ka.prototype.constructor=ka,ka.prototype.toJSON=function(){var e=mn.prototype.toJSON.call(this);return Fa(this.parameters.shapes,e)},Da.prototype=Object.create(On.prototype),Da.prototype.constructor=Da,Da.prototype.toJSON=function(){var e=On.prototype.toJSON.call(this);return Fa(this.parameters.shapes,e)},Ba.prototype=Object.create(On.prototype),Ba.prototype.constructor=Ba,Ga.prototype=Object.create(mn.prototype),Ga.prototype.constructor=Ga,Va.prototype=Object.create(On.prototype),Va.prototype.constructor=Va,Ha.prototype=Object.create(Ga.prototype),Ha.prototype.constructor=Ha,ja.prototype=Object.create(Va.prototype),ja.prototype.constructor=ja,Wa.prototype=Object.create(mn.prototype),Wa.prototype.constructor=Wa,qa.prototype=Object.create(On.prototype),qa.prototype.constructor=qa;var Xa=Object.freeze({WireframeGeometry:Fi,ParametricGeometry:Bi,ParametricBufferGeometry:Gi,TetrahedronGeometry:ji,TetrahedronBufferGeometry:Wi,OctahedronGeometry:qi,OctahedronBufferGeometry:Xi,IcosahedronGeometry:Yi,IcosahedronBufferGeometry:Ji,DodecahedronGeometry:Zi,DodecahedronBufferGeometry:Ki,PolyhedronGeometry:Vi,PolyhedronBufferGeometry:Hi,TubeGeometry:Qi,TubeBufferGeometry:ea,TorusKnotGeometry:ta,TorusKnotBufferGeometry:ra,TorusGeometry:na,TorusBufferGeometry:ia,TextGeometry:Ra,TextBufferGeometry:Ca,SphereGeometry:La,SphereBufferGeometry:Pa,RingGeometry:Ua,RingBufferGeometry:Ia,PlaneGeometry:Dn,PlaneBufferGeometry:Fn,LatheGeometry:Oa,LatheBufferGeometry:Na,ShapeGeometry:ka,ShapeBufferGeometry:Da,ExtrudeGeometry:Aa,ExtrudeBufferGeometry:za,EdgesGeometry:Ba,ConeGeometry:Ha,ConeBufferGeometry:ja,CylinderGeometry:Ga,CylinderBufferGeometry:Va,CircleGeometry:Wa,CircleBufferGeometry:qa,BoxGeometry:Nn,BoxBufferGeometry:kn});function Ya(e){Wr.call(this),this.type="ShadowMaterial",this.color=new zr(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(e)}function Ja(e){Gn.call(this,e),this.type="RawShaderMaterial"}function Za(e){Wr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new zr(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function Ka(e){Za.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(e)}function Qa(e){Wr.call(this),this.type="MeshPhongMaterial",this.color=new zr(16777215),this.specular=new zr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function eo(e){Qa.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(e)}function to(e){Wr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ct(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function ro(e){Wr.call(this),this.type="MeshLambertMaterial",this.color=new zr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new zr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ue,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}function no(e){Ri.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}Ya.prototype=Object.create(Wr.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isShadowMaterial=!0,Ja.prototype=Object.create(Gn.prototype),Ja.prototype.constructor=Ja,Ja.prototype.isRawShaderMaterial=!0,Za.prototype=Object.create(Wr.prototype),Za.prototype.constructor=Za,Za.prototype.isMeshStandardMaterial=!0,Za.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Ka.prototype=Object.create(Za.prototype),Ka.prototype.constructor=Ka,Ka.prototype.isMeshPhysicalMaterial=!0,Ka.prototype.copy=function(e){return Za.prototype.copy.call(this,e),this.defines={PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearCoat=e.clearCoat,this.clearCoatRoughness=e.clearCoatRoughness,this},Qa.prototype=Object.create(Wr.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isMeshPhongMaterial=!0,Qa.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},eo.prototype=Object.create(Qa.prototype),eo.prototype.constructor=eo,eo.prototype.isMeshToonMaterial=!0,eo.prototype.copy=function(e){return Qa.prototype.copy.call(this,e),this.gradientMap=e.gradientMap,this},to.prototype=Object.create(Wr.prototype),to.prototype.constructor=to,to.prototype.isMeshNormalMaterial=!0,to.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},ro.prototype=Object.create(Wr.prototype),ro.prototype.constructor=ro,ro.prototype.isMeshLambertMaterial=!0,ro.prototype.copy=function(e){return Wr.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},no.prototype=Object.create(Ri.prototype),no.prototype.constructor=no,no.prototype.isLineDashedMaterial=!0,no.prototype.copy=function(e){return Ri.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var io=Object.freeze({ShadowMaterial:Ya,SpriteMaterial:Ei,RawShaderMaterial:Ja,ShaderMaterial:Gn,PointsMaterial:Ui,MeshPhysicalMaterial:Ka,MeshStandardMaterial:Za,MeshPhongMaterial:Qa,MeshToonMaterial:eo,MeshNormalMaterial:to,MeshLambertMaterial:ro,MeshDepthMaterial:qr,MeshDistanceMaterial:Xr,MeshBasicMaterial:Bn,LineDashedMaterial:no,LineBasicMaterial:Ri,Material:Wr}),ao={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function oo(e,t,r){var n=this,i=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){o++,!1===i&&void 0!==n.onStart&&n.onStart(e,a,o),i=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,o),a===o&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this}}var so=new oo,uo={};function co(e){this.manager=void 0!==e?e:so}function lo(e){this.manager=void 0!==e?e:so,this._parser=null}function fo(e){this.manager=void 0!==e?e:so,this._parser=null}function po(e){this.manager=void 0!==e?e:so}function ho(e){this.manager=void 0!==e?e:so}function mo(e){this.manager=void 0!==e?e:so}function go(){this.type="Curve",this.arcLengthDivisions=200}function vo(e,t,r,n,i,a,o,s){go.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function _o(e,t,r,n,i,a){vo.call(this,e,t,r,r,n,i,a),this.type="ArcCurve"}function yo(){var e=0,t=0,r=0,n=0;function i(i,a,o,s){e=i,t=o,r=-3*i+3*a-2*o-s,n=2*i-2*a+o+s}return{initCatmullRom:function(e,t,r,n,a){i(t,r,a*(r-e),a*(n-t))},initNonuniformCatmullRom:function(e,t,r,n,a,o,s){var u=(t-e)/a-(r-e)/(a+o)+(r-t)/o,c=(r-t)/o-(n-t)/(o+s)+(n-r)/s;i(t,r,u*=o,c*=o)},calc:function(i){var a=i*i;return e+t*i+r*a+n*(a*i)}}}Object.assign(co.prototype,{load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=ao.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;if(void 0===uo[e]){var o=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],u=!!o[2],c=o[3];c=window.decodeURIComponent(c),u&&(c=window.atob(c));try{var l,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":for(var p=new Uint8Array(c.length),h=0;h<c.length;h++)p[h]=c.charCodeAt(h);l="blob"===f?new Blob([p.buffer],{type:s}):p.buffer;break;case"document":var d=new DOMParser;l=d.parseFromString(c,s);break;case"json":l=JSON.parse(c);break;default:l=c}window.setTimeout(function(){t&&t(l),i.manager.itemEnd(e)},0)}catch(t){window.setTimeout(function(){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},0)}}else{uo[e]=[],uo[e].push({onLoad:t,onProgress:r,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",e,!0),m.addEventListener("load",function(t){var r=this.response;ao.add(e,r);var n=uo[e];if(delete uo[e],200===this.status){for(var a=0,o=n.length;a<o;a++){(s=n[a]).onLoad&&s.onLoad(r)}i.manager.itemEnd(e)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(a=0,o=n.length;a<o;a++){(s=n[a]).onLoad&&s.onLoad(r)}i.manager.itemEnd(e)}else{for(a=0,o=n.length;a<o;a++){var s;(s=n[a]).onError&&s.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)}},!1),m.addEventListener("progress",function(t){for(var r=uo[e],n=0,i=r.length;n<i;n++){var a=r[n];a.onProgress&&a.onProgress(t)}},!1),m.addEventListener("error",function(t){var r=uo[e];delete uo[e];for(var n=0,a=r.length;n<a;n++){var o=r[n];o.onError&&o.onError(t)}i.manager.itemEnd(e),i.manager.itemError(e)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return i.manager.itemStart(e),m}uo[e].push({onLoad:t,onProgress:r,onError:n})},setPath:function(e){return this.path=e,this},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Object.assign(lo.prototype,{load:function(e,t,r,n){var i=this,a=[],o=new ki;o.image=a;var s=new co(this.manager);function u(u){s.load(e[u],function(e){var r=i._parser(e,!0);a[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},6===(c+=1)&&(1===r.mipmapCount&&(o.minFilter=Re),o.format=r.format,o.needsUpdate=!0,t&&t(o))},r,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(e))for(var c=0,l=0,f=e.length;l<f;++l)u(l);else s.load(e,function(e){var r=i._parser(e,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,s=0;s<n;s++){a[s]={mipmaps:[]};for(var u=0;u<r.mipmapCount;u++)a[s].mipmaps.push(r.mipmaps[s*r.mipmapCount+u]),a[s].format=r.format,a[s].width=r.width,a[s].height=r.height}else o.image.width=r.width,o.image.height=r.height,o.mipmaps=r.mipmaps;1===r.mipmapCount&&(o.minFilter=Re),o.format=r.format,o.needsUpdate=!0,t&&t(o)},r,n);return o},setPath:function(e){return this.path=e,this}}),Object.assign(fo.prototype,{load:function(e,t,r,n){var i=this,a=new Bt,o=new co(this.manager);return o.setResponseType("arraybuffer"),o.load(e,function(e){var r=i._parser(e);r&&(void 0!==r.image?a.image=r.image:void 0!==r.data&&(a.image.width=r.width,a.image.height=r.height,a.image.data=r.data),a.wrapS=void 0!==r.wrapS?r.wrapS:Me,a.wrapT=void 0!==r.wrapT?r.wrapT:Me,a.magFilter=void 0!==r.magFilter?r.magFilter:Re,a.minFilter=void 0!==r.minFilter?r.minFilter:Le,a.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(a.format=r.format),void 0!==r.type&&(a.type=r.type),void 0!==r.mipmaps&&(a.mipmaps=r.mipmaps),1===r.mipmapCount&&(a.minFilter=Re),a.needsUpdate=!0,t&&t(a,r))},r,n),a}}),Object.assign(po.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var i=this,a=ao.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");return o.addEventListener("load",function(){ao.add(e,this),t&&t(this),i.manager.itemEnd(e)},!1),o.addEventListener("error",function(t){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)},!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),i.manager.itemStart(e),o.src=e,o},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(ho.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,n){var i=new Gt,a=new po(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(r){a.load(e[r],function(e){i.images[r]=e,6===++o&&(i.needsUpdate=!0,t&&t(i))},void 0,n)}for(var u=0;u<e.length;++u)s(u);return i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(mo.prototype,{crossOrigin:"Anonymous",load:function(e,t,r,n){var i=new Nt,a=new po(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(r){i.image=r;var n=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data\:image\/jpeg/);i.format=n?We:qe,i.needsUpdate=!0,void 0!==t&&t(i)},r,n),i},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this}}),Object.assign(go.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var r=this.getUtoTmapping(e);return this.getPoint(r,t)},getPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return t},getSpacedPoints:function(e){void 0===e&&(e=5);for(var t=[],r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,r,n=[],i=this.getPoint(0),a=0;for(n.push(0),r=1;r<=e;r++)a+=(t=this.getPoint(r/e)).distanceTo(i),n.push(a),i=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var r,n=this.getLengths(),i=0,a=n.length;r=t||e*n[a-1];for(var o,s=0,u=a-1;s<=u;)if((o=n[i=Math.floor(s+(u-s)/2)]-r)<0)s=i+1;else{if(!(o>0)){u=i;break}u=i-1}if(n[i=u]===r)return i/(a-1);var c=n[i];return(i+(r-c)/(n[i+1]-c))/(a-1)},getTangent:function(e){var t=e-1e-4,r=e+1e-4;t<0&&(t=0),r>1&&(r=1);var n=this.getPoint(t);return this.getPoint(r).clone().sub(n).normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var r,n,i,a=new Ut,o=[],s=[],u=[],c=new Ut,l=new Lt;for(r=0;r<=e;r++)n=r/e,o[r]=this.getTangentAt(n),o[r].normalize();s[0]=new Ut,u[0]=new Ut;var f=Number.MAX_VALUE,p=Math.abs(o[0].x),h=Math.abs(o[0].y),d=Math.abs(o[0].z);for(p<=f&&(f=p,a.set(1,0,0)),h<=f&&(f=h,a.set(0,1,0)),d<=f&&a.set(0,0,1),c.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],c),u[0].crossVectors(o[0],s[0]),r=1;r<=e;r++)s[r]=s[r-1].clone(),u[r]=u[r-1].clone(),c.crossVectors(o[r-1],o[r]),c.length()>Number.EPSILON&&(c.normalize(),i=Math.acos(Rt.clamp(o[r-1].dot(o[r]),-1,1)),s[r].applyMatrix4(l.makeRotationAxis(c,i))),u[r].crossVectors(o[r],s[r]);if(!0===t)for(i=Math.acos(Rt.clamp(s[0].dot(s[e]),-1,1)),i/=e,o[0].dot(c.crossVectors(s[0],s[e]))>0&&(i=-i),r=1;r<=e;r++)s[r].applyMatrix4(l.makeRotationAxis(o[r],i*r)),u[r].crossVectors(o[r],s[r]);return{tangents:o,normals:s,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),vo.prototype=Object.create(go.prototype),vo.prototype.constructor=vo,vo.prototype.isEllipseCurve=!0,vo.prototype.getPoint=function(e,t){for(var r=t||new Ct,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,a=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=a?0:n),!0!==this.aClockwise||a||(i===n?i=-n:i-=n);var o=this.aStartAngle+e*i,s=this.aX+this.xRadius*Math.cos(o),u=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var c=Math.cos(this.aRotation),l=Math.sin(this.aRotation),f=s-this.aX,p=u-this.aY;s=f*c-p*l+this.aX,u=f*l+p*c+this.aY}return r.set(s,u)},vo.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},vo.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},vo.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},_o.prototype=Object.create(vo.prototype),_o.prototype.constructor=_o,_o.prototype.isArcCurve=!0;var bo=new Ut,xo=new yo,wo=new yo,$o=new yo;function Eo(e,t,r,n){go.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=r||"centripetal",this.tension=n||.5}function Mo(e,t,r,n,i){var a=.5*(n-t),o=.5*(i-r),s=e*e;return(2*r-2*n+a+o)*(e*s)+(-3*r+3*n-2*a-o)*s+a*e+r}function To(e,t,r,n){return function(e,t){var r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,n)}function So(e,t,r,n,i){return function(e,t){var r=1-e;return r*r*r*t}(e,t)+function(e,t){var r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,n)+function(e,t){return e*e*e*t}(e,i)}function Ao(e,t,r,n){go.call(this),this.type="CubicBezierCurve",this.v0=e||new Ct,this.v1=t||new Ct,this.v2=r||new Ct,this.v3=n||new Ct}function zo(e,t,r,n){go.call(this),this.type="CubicBezierCurve3",this.v0=e||new Ut,this.v1=t||new Ut,this.v2=r||new Ut,this.v3=n||new Ut}function Ro(e,t){go.call(this),this.type="LineCurve",this.v1=e||new Ct,this.v2=t||new Ct}function Co(e,t){go.call(this),this.type="LineCurve3",this.v1=e||new Ut,this.v2=t||new Ut}function Lo(e,t,r){go.call(this),this.type="QuadraticBezierCurve",this.v0=e||new Ct,this.v1=t||new Ct,this.v2=r||new Ct}function Po(e,t,r){go.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new Ut,this.v1=t||new Ut,this.v2=r||new Ut}function Uo(e){go.call(this),this.type="SplineCurve",this.points=e||[]}Eo.prototype=Object.create(go.prototype),Eo.prototype.constructor=Eo,Eo.prototype.isCatmullRomCurve3=!0,Eo.prototype.getPoint=function(e,t){var r,n,i,a,o=t||new Ut,s=this.points,u=s.length,c=(u-(this.closed?0:1))*e,l=Math.floor(c),f=c-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s.length)+1)*s.length:0===f&&l===u-1&&(l=u-2,f=1),this.closed||l>0?r=s[(l-1)%u]:(bo.subVectors(s[0],s[1]).add(s[0]),r=bo),n=s[l%u],i=s[(l+1)%u],this.closed||l+2<u?a=s[(l+2)%u]:(bo.subVectors(s[u-1],s[u-2]).add(s[u-1]),a=bo),"centripetal"===this.curveType||"chordal"===this.curveType){var p="chordal"===this.curveType?.5:.25,h=Math.pow(r.distanceToSquared(n),p),d=Math.pow(n.distanceToSquared(i),p),m=Math.pow(i.distanceToSquared(a),p);d<1e-4&&(d=1),h<1e-4&&(h=d),m<1e-4&&(m=d),xo.initNonuniformCatmullRom(r.x,n.x,i.x,a.x,h,d,m),wo.initNonuniformCatmullRom(r.y,n.y,i.y,a.y,h,d,m),$o.initNonuniformCatmullRom(r.z,n.z,i.z,a.z,h,d,m)}else"catmullrom"===this.curveType&&(xo.initCatmullRom(r.x,n.x,i.x,a.x,this.tension),wo.initCatmullRom(r.y,n.y,i.y,a.y,this.tension),$o.initCatmullRom(r.z,n.z,i.z,a.z,this.tension));return o.set(xo.calc(f),wo.calc(f),$o.calc(f)),o},Eo.prototype.copy=function(e){go.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Eo.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},Eo.prototype.fromJSON=function(e){go.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new Ut).fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},Ao.prototype=Object.create(go.prototype),Ao.prototype.constructor=Ao,Ao.prototype.isCubicBezierCurve=!0,Ao.prototype.getPoint=function(e,t){var r=t||new Ct,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(So(e,n.x,i.x,a.x,o.x),So(e,n.y,i.y,a.y,o.y)),r},Ao.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Ao.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Ao.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},zo.prototype=Object.create(go.prototype),zo.prototype.constructor=zo,zo.prototype.isCubicBezierCurve3=!0,zo.prototype.getPoint=function(e,t){var r=t||new Ut,n=this.v0,i=this.v1,a=this.v2,o=this.v3;return r.set(So(e,n.x,i.x,a.x,o.x),So(e,n.y,i.y,a.y,o.y),So(e,n.z,i.z,a.z,o.z)),r},zo.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},zo.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},zo.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Ro.prototype=Object.create(go.prototype),Ro.prototype.constructor=Ro,Ro.prototype.isLineCurve=!0,Ro.prototype.getPoint=function(e,t){var r=t||new Ct;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Ro.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Ro.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Ro.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Ro.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Ro.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Co.prototype=Object.create(go.prototype),Co.prototype.constructor=Co,Co.prototype.isLineCurve3=!0,Co.prototype.getPoint=function(e,t){var r=t||new Ut;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r},Co.prototype.getPointAt=function(e,t){return this.getPoint(e,t)},Co.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Co.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Co.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Lo.prototype=Object.create(go.prototype),Lo.prototype.constructor=Lo,Lo.prototype.isQuadraticBezierCurve=!0,Lo.prototype.getPoint=function(e,t){var r=t||new Ct,n=this.v0,i=this.v1,a=this.v2;return r.set(To(e,n.x,i.x,a.x),To(e,n.y,i.y,a.y)),r},Lo.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Lo.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Lo.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Po.prototype=Object.create(go.prototype),Po.prototype.constructor=Po,Po.prototype.isQuadraticBezierCurve3=!0,Po.prototype.getPoint=function(e,t){var r=t||new Ut,n=this.v0,i=this.v1,a=this.v2;return r.set(To(e,n.x,i.x,a.x),To(e,n.y,i.y,a.y),To(e,n.z,i.z,a.z)),r},Po.prototype.copy=function(e){return go.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Po.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Po.prototype.fromJSON=function(e){return go.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},Uo.prototype=Object.create(go.prototype),Uo.prototype.constructor=Uo,Uo.prototype.isSplineCurve=!0,Uo.prototype.getPoint=function(e,t){var r=t||new Ct,n=this.points,i=(n.length-1)*e,a=Math.floor(i),o=i-a,s=n[0===a?a:a-1],u=n[a],c=n[a>n.length-2?n.length-1:a+1],l=n[a>n.length-3?n.length-1:a+2];return r.set(Mo(o,s.x,u.x,c.x,l.x),Mo(o,s.y,u.y,c.y,l.y)),r},Uo.prototype.copy=function(e){go.prototype.copy.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push(n.clone())}return this},Uo.prototype.toJSON=function(){var e=go.prototype.toJSON.call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];e.points.push(n.toArray())}return e},Uo.prototype.fromJSON=function(e){go.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var n=e.points[t];this.points.push((new Ct).fromArray(n))}return this};var Io=Object.freeze({ArcCurve:_o,CatmullRomCurve3:Eo,CubicBezierCurve:Ao,CubicBezierCurve3:zo,EllipseCurve:vo,LineCurve:Ro,LineCurve3:Co,QuadraticBezierCurve:Lo,QuadraticBezierCurve3:Po,SplineCurve:Uo});function Oo(){go.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function No(e){Oo.call(this),this.type="Path",this.currentPoint=new Ct,e&&this.setFromPoints(e)}function ko(e){No.call(this,e),this.uuid=Rt.generateUUID(),this.type="Shape",this.holes=[]}function Do(e,t){cn.call(this),this.type="Light",this.color=new zr(e),this.intensity=void 0!==t?t:1,this.receiveShadow=void 0}function Fo(e,t,r){Do.call(this,e,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(cn.DefaultUp),this.updateMatrix(),this.groundColor=new zr(t)}function Bo(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new Ct(512,512),this.map=null,this.matrix=new Lt}function Go(){Bo.call(this,new mi(50,1,.5,500))}function Vo(e,t,r,n,i,a){Do.call(this,e,t),this.type="SpotLight",this.position.copy(cn.DefaultUp),this.updateMatrix(),this.target=new cn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==a?a:1,this.shadow=new Go}function Ho(e,t,r,n){Do.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new Bo(new mi(90,1,.5,500))}function jo(){Bo.call(this,new fn(-5,5,5,-5,.5,500))}function Wo(e,t){Do.call(this,e,t),this.type="DirectionalLight",this.position.copy(cn.DefaultUp),this.updateMatrix(),this.target=new cn,this.shadow=new jo}function qo(e,t){Do.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}function Xo(e,t,r,n){Do.call(this,e,t),this.type="RectAreaLight",this.position.set(0,1,0),this.updateMatrix(),this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function Yo(e,t,r,n){os.call(this,e,t,r,n)}function Jo(e,t,r){os.call(this,e,t,r)}function Zo(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r}function Ko(e,t,r,n){Zo.call(this,e,t,r,n)}function Qo(e,t,r,n){os.call(this,e,t,r,n)}function es(e,t,r,n){os.call(this,e,t,r,n)}function ts(e,t,r,n){os.call(this,e,t,r,n)}function rs(e,t,r,n){Zo.call(this,e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function ns(e,t,r,n){Zo.call(this,e,t,r,n)}function is(e,t,r,n){Zo.call(this,e,t,r,n)}Oo.prototype=Object.assign(Object.create(go.prototype),{constructor:Oo,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ro(t,e))},getPoint:function(e){for(var t=e*this.getLength(),r=this.getCurveLengths(),n=0;n<r.length;){if(r[n]>=t){var i=r[n]-t,a=this.curves[n],o=a.getLength(),s=0===o?0:1-i/o;return a.getPointAt(s)}n++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var t=[],r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t,r=[],n=0,i=this.curves;n<i.length;n++)for(var a=i[n],o=a&&a.isEllipseCurve?2*e:a&&a.isLineCurve?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),u=0;u<s.length;u++){var c=s[u];t&&t.equals(c)||(r.push(c),t=c)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(e){go.prototype.copy.call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=go.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var n=this.curves[t];e.curves.push(n.toJSON())}return e},fromJSON:function(e){go.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var n=e.curves[t];this.curves.push((new Io[n.type]).fromJSON(n))}return this}}),No.prototype=Object.assign(Object.create(Oo.prototype),{constructor:No,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y)},moveTo:function(e,t){this.currentPoint.set(e,t)},lineTo:function(e,t){var r=new Ro(this.currentPoint.clone(),new Ct(e,t));this.curves.push(r),this.currentPoint.set(e,t)},quadraticCurveTo:function(e,t,r,n){var i=new Lo(this.currentPoint.clone(),new Ct(e,t),new Ct(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(e,t,r,n,i,a){var o=new Ao(this.currentPoint.clone(),new Ct(e,t),new Ct(r,n),new Ct(i,a));this.curves.push(o),this.currentPoint.set(i,a)},splineThru:function(e){var t=new Uo([this.currentPoint.clone()].concat(e));this.curves.push(t),this.currentPoint.copy(e[e.length-1])},arc:function(e,t,r,n,i,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(e+o,t+s,r,n,i,a)},absarc:function(e,t,r,n,i,a){this.absellipse(e,t,r,r,n,i,a)},ellipse:function(e,t,r,n,i,a,o,s){var u=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(e+u,t+c,r,n,i,a,o,s)},absellipse:function(e,t,r,n,i,a,o,s){var u=new vo(e,t,r,n,i,a,o,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);this.currentPoint.copy(l)},copy:function(e){return Oo.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Oo.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Oo.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),ko.prototype=Object.assign(Object.create(No.prototype),{constructor:ko,getPointsHoles:function(e){for(var t=[],r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){No.prototype.copy.call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push(n.clone())}return this},toJSON:function(){var e=No.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var n=this.holes[t];e.holes.push(n.toJSON())}return e},fromJSON:function(e){No.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var n=e.holes[t];this.holes.push((new No).fromJSON(n))}return this}}),Do.prototype=Object.assign(Object.create(cn.prototype),{constructor:Do,isLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=cn.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}),Fo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Fo,isHemisphereLight:!0,copy:function(e){return Do.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),Object.assign(Bo.prototype,{copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),Go.prototype=Object.assign(Object.create(Bo.prototype),{constructor:Go,isSpotLightShadow:!0,update:function(e){var t=this.camera,r=2*Rt.RAD2DEG*e.angle,n=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&n===t.aspect&&i===t.far||(t.fov=r,t.aspect=n,t.far=i,t.updateProjectionMatrix())}}),Vo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Vo,isSpotLight:!0,copy:function(e){return Do.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),Ho.prototype=Object.assign(Object.create(Do.prototype),{constructor:Ho,isPointLight:!0,copy:function(e){return Do.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),jo.prototype=Object.assign(Object.create(Bo.prototype),{constructor:jo}),Wo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Wo,isDirectionalLight:!0,copy:function(e){return Do.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),qo.prototype=Object.assign(Object.create(Do.prototype),{constructor:qo,isAmbientLight:!0}),Xo.prototype=Object.assign(Object.create(Do.prototype),{constructor:Xo,isRectAreaLight:!0,copy:function(e){return Do.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Do.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}),Yo.prototype=Object.assign(Object.create(os.prototype),{constructor:Yo,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ft,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Jo.prototype=Object.assign(Object.create(os.prototype),{constructor:Jo,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ft,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Zo.prototype,{evaluate:function(e){var t=this.parameterPositions,r=this._cachedIndex,n=t[r],i=t[r-1];e:{t:{var a;r:{n:if(!(e<n)){for(var o=r+2;;){if(void 0===n){if(e<i)break n;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,i)}if(r===o)break;if(i=n,e<(n=t[++r]))break t}a=t.length;break r}if(e>=i)break e;var s=t[1];e<s&&(r=2,i=s);for(o=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,e,n);if(r===o)break;if(n=i,e>=(i=t[--r-1]))break t}a=r,r=0}for(;r<a;){var u=r+a>>>1;e<t[u]?a=u:r=u+1}if(n=t[r],void 0===(i=t[r-1]))return this._cachedIndex=0,this.beforeStart_(0,e,n);if(void 0===n)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,i,e)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,e,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=e*n,a=0;a!==n;++a)t[a]=r[i+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Zo.prototype,{beforeStart_:Zo.prototype.copySampleValue_,afterEnd_:Zo.prototype.copySampleValue_}),Ko.prototype=Object.assign(Object.create(Zo.prototype),{constructor:Ko,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=(r-t)/(n-t),c=s+o;s!==c;s+=4)Pt.slerpFlat(i,0,a,s-o,a,s,u);return i}}),Qo.prototype=Object.assign(Object.create(os.prototype),{constructor:Qo,ValueTypeName:"quaternion",DefaultInterpolation:pt,InterpolantFactoryMethodLinear:function(e){return new Ko(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),es.prototype=Object.assign(Object.create(os.prototype),{constructor:es,ValueTypeName:"color"}),ts.prototype=Object.assign(Object.create(os.prototype),{constructor:ts,ValueTypeName:"number"}),rs.prototype=Object.assign(Object.create(Zo.prototype),{constructor:rs,DefaultSettings_:{endingStart:dt,endingEnd:dt},intervalChanged_:function(e,t,r){var n=this.parameterPositions,i=e-2,a=e+1,o=n[i],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case mt:i=e,o=2*t-r;break;case gt:o=t+n[i=n.length-2]-n[i+1];break;default:i=e,o=r}if(void 0===s)switch(this.getSettings_().endingEnd){case mt:a=e,s=2*r-t;break;case gt:a=1,s=r+n[1]-n[0];break;default:a=e-1,s=t}var u=.5*(r-t),c=this.valueSize;this._weightPrev=u/(t-o),this._weightNext=u/(s-r),this._offsetPrev=i*c,this._offsetNext=a*c},interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=this._offsetPrev,l=this._offsetNext,f=this._weightPrev,p=this._weightNext,h=(r-t)/(n-t),d=h*h,m=d*h,g=-f*m+2*f*d-f*h,v=(1+f)*m+(-1.5-2*f)*d+(-.5+f)*h+1,_=(-1-p)*m+(1.5+p)*d+.5*h,y=p*m-p*d,b=0;b!==o;++b)i[b]=g*a[c+b]+v*a[u+b]+_*a[s+b]+y*a[l+b];return i}}),ns.prototype=Object.assign(Object.create(Zo.prototype),{constructor:ns,interpolate_:function(e,t,r,n){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,u=s-o,c=(r-t)/(n-t),l=1-c,f=0;f!==o;++f)i[f]=a[u+f]*l+a[s+f]*c;return i}}),is.prototype=Object.assign(Object.create(Zo.prototype),{constructor:is,interpolate_:function(e){return this.copySampleValue_(e-1)}});var as={arraySlice:function(e,t,r){return as.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,r=new Array(t),n=0;n!==t;++n)r[n]=n;return r.sort(function(t,r){return e[t]-e[r]}),r},sortedArray:function(e,t,r){for(var n=e.length,i=new e.constructor(n),a=0,o=0;o!==n;++a)for(var s=r[a]*t,u=0;u!==t;++u)i[o++]=e[s+u];return i},flattenJSON:function(e,t,r,n){for(var i=1,a=e[0];void 0!==a&&void 0===a[n];)a=e[i++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[n])&&(t.push(a.time),r.push.apply(r,o)),a=e[i++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[n])&&(t.push(a.time),o.toArray(r,r.length)),a=e[i++]}while(void 0!==a);else do{void 0!==(o=a[n])&&(t.push(a.time),r.push(o)),a=e[i++]}while(void 0!==a)}}};function os(e,t,r,n){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=as.convertArray(t,this.TimeBufferType),this.values=as.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function ss(e,t,r,n){os.call(this,e,t,r,n)}function us(e,t,r){this.name=e,this.tracks=r,this.duration=void 0!==t?t:-1,this.uuid=Rt.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function cs(e){this.manager=void 0!==e?e:so,this.textures={}}function ls(e){this.manager=void 0!==e?e:so}Object.assign(os,{parse:function(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=os._getTrackTypeForValueTypeName(e.type);if(void 0===e.times){var r=[],n=[];as.flattenJSON(e.keys,r,n,"value"),e.times=r,e.values=n}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)},toJSON:function(e){var t,r=e.constructor;if(void 0!==r.toJSON)t=r.toJSON(e);else{t={name:e.name,times:as.convertArray(e.times,Array),values:as.convertArray(e.values,Array)};var n=e.getInterpolation();n!==e.DefaultInterpolation&&(t.interpolation=n)}return t.type=e.ValueTypeName,t},_getTrackTypeForValueTypeName:function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ts;case"vector":case"vector2":case"vector3":case"vector4":return ss;case"color":return es;case"quaternion":return Qo;case"bool":case"boolean":return Jo;case"string":return Yo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}}),Object.assign(os.prototype,{constructor:os,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:pt,InterpolantFactoryMethodDiscrete:function(e){return new is(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new ns(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new rs(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case ft:t=this.InterpolantFactoryMethodDiscrete;break;case pt:t=this.InterpolantFactoryMethodLinear;break;case ht:t=this.InterpolantFactoryMethodSmooth}if(void 0!==t)this.createInterpolant=t;else{var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",r)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ft;case this.InterpolantFactoryMethodLinear:return pt;case this.InterpolantFactoryMethodSmooth:return ht}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]+=e;return this},scale:function(e){if(1!==e)for(var t=this.times,r=0,n=t.length;r!==n;++r)t[r]*=e;return this},trim:function(e,t){for(var r=this.times,n=r.length,i=0,a=n-1;i!==n&&r[i]<e;)++i;for(;-1!==a&&r[a]>t;)--a;if(++a,0!==i||a!==n){i>=a&&(i=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=as.arraySlice(r,i,a),this.values=as.arraySlice(this.values,i*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==i;o++){var s=r[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(void 0!==n&&as.isTypedArray(n)){o=0;for(var u=n.length;o!==u;++o){var c=n[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}}return e},optimize:function(){for(var e=this.times,t=this.values,r=this.getValueSize(),n=this.getInterpolation()===ht,i=1,a=e.length-1,o=1;o<a;++o){var s=!1,u=e[o];if(u!==e[o+1]&&(1!==o||u!==u[0]))if(n)s=!0;else for(var c=o*r,l=c-r,f=c+r,p=0;p!==r;++p){var h=t[c+p];if(h!==t[l+p]||h!==t[f+p]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];var d=o*r,m=i*r;for(p=0;p!==r;++p)t[m+p]=t[d+p]}++i}}if(a>0){e[i]=e[a];for(d=a*r,m=i*r,p=0;p!==r;++p)t[m+p]=t[d+p];++i}return i!==e.length&&(this.times=as.arraySlice(e,0,i),this.values=as.arraySlice(t,0,i*r)),this}}),ss.prototype=Object.assign(Object.create(os.prototype),{constructor:ss,ValueTypeName:"vector"}),Object.assign(us,{parse:function(e){for(var t=[],r=e.tracks,n=1/(e.fps||1),i=0,a=r.length;i!==a;++i)t.push(os.parse(r[i]).scale(n));return new us(e.name,e.duration,t)},toJSON:function(e){for(var t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t},i=0,a=r.length;i!==a;++i)t.push(os.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(e,t,r,n){for(var i=t.length,a=[],o=0;o<i;o++){var s=[],u=[];s.push((o+i-1)%i,o,(o+1)%i),u.push(0,1,0);var c=as.getKeyframeOrder(s);s=as.sortedArray(s,1,c),u=as.sortedArray(u,1,c),n||0!==s[0]||(s.push(i),u.push(u[0])),a.push(new ts(".morphTargetInfluences["+t[o].name+"]",s,u).scale(1/r))}return new us(e,-1,a)},findByName:function(e,t){var r=e;if(!Array.isArray(e)){var n=e;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null},CreateClipsFromMorphTargetSequences:function(e,t,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],u=s.name.match(i);if(u&&u.length>1){var c=n[f=u[1]];c||(n[f]=c=[]),c.push(s)}}var l=[];for(var f in n)l.push(us.CreateFromMorphTargetSequence(f,n[f],t,r));return l},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(e,t,r,n,i){if(0!==r.length){var a=[],o=[];as.flattenJSON(r,a,o,n),0!==a.length&&i.push(new e(t,a,o))}},n=[],i=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},f=0;f<c.length;f++)if(c[f].morphTargets)for(var p=0;p<c[f].morphTargets.length;p++)l[c[f].morphTargets[p]]=-1;for(var h in l){var d=[],m=[];for(p=0;p!==c[f].morphTargets.length;++p){var g=c[f];d.push(g.time),m.push(g.morphTarget===h?1:0)}n.push(new ts(".morphTargetInfluence["+h+"]",d,m))}a=l.length*(o||1)}else{var v=".bones["+t[u].name+"]";r(ss,v+".position",c,"pos",n),r(Qo,v+".quaternion",c,"rot",n),r(ss,v+".scale",c,"scl",n)}}return 0===n.length?null:new us(i,a,n)}}),Object.assign(us.prototype,{resetDuration:function(){for(var e=0,t=0,r=this.tracks.length;t!==r;++t){var n=this.tracks[t];e=Math.max(e,n.times[n.times.length-1])}this.duration=e},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}}),Object.assign(cs.prototype,{load:function(e,t,r,n){var i=this;new co(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},setTextures:function(e){this.textures=e},parse:function(e){var t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var n=new io[e.type];if(void 0!==e.uuid&&(n.uuid=e.uuid),void 0!==e.name&&(n.name=e.name),void 0!==e.color&&n.color.setHex(e.color),void 0!==e.roughness&&(n.roughness=e.roughness),void 0!==e.metalness&&(n.metalness=e.metalness),void 0!==e.emissive&&n.emissive.setHex(e.emissive),void 0!==e.specular&&n.specular.setHex(e.specular),void 0!==e.shininess&&(n.shininess=e.shininess),void 0!==e.clearCoat&&(n.clearCoat=e.clearCoat),void 0!==e.clearCoatRoughness&&(n.clearCoatRoughness=e.clearCoatRoughness),void 0!==e.uniforms&&(n.uniforms=e.uniforms),void 0!==e.vertexShader&&(n.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(n.fragmentShader=e.fragmentShader),void 0!==e.vertexColors&&(n.vertexColors=e.vertexColors),void 0!==e.fog&&(n.fog=e.fog),void 0!==e.flatShading&&(n.flatShading=e.flatShading),void 0!==e.blending&&(n.blending=e.blending),void 0!==e.side&&(n.side=e.side),void 0!==e.opacity&&(n.opacity=e.opacity),void 0!==e.transparent&&(n.transparent=e.transparent),void 0!==e.alphaTest&&(n.alphaTest=e.alphaTest),void 0!==e.depthTest&&(n.depthTest=e.depthTest),void 0!==e.depthWrite&&(n.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(n.colorWrite=e.colorWrite),void 0!==e.wireframe&&(n.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(n.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(n.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(n.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(n.rotation=e.rotation),1!==e.linewidth&&(n.linewidth=e.linewidth),void 0!==e.dashSize&&(n.dashSize=e.dashSize),void 0!==e.gapSize&&(n.gapSize=e.gapSize),void 0!==e.scale&&(n.scale=e.scale),void 0!==e.skinning&&(n.skinning=e.skinning),void 0!==e.morphTargets&&(n.morphTargets=e.morphTargets),void 0!==e.dithering&&(n.dithering=e.dithering),void 0!==e.visible&&(n.visible=e.visible),void 0!==e.userData&&(n.userData=e.userData),void 0!==e.shading&&(n.flatShading=1===e.shading),void 0!==e.size&&(n.size=e.size),void 0!==e.sizeAttenuation&&(n.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(n.map=r(e.map)),void 0!==e.alphaMap&&(n.alphaMap=r(e.alphaMap),n.transparent=!0),void 0!==e.bumpMap&&(n.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(n.bumpScale=e.bumpScale),void 0!==e.normalMap&&(n.normalMap=r(e.normalMap)),void 0!==e.normalScale){var i=e.normalScale;!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new Ct).fromArray(i)}return void 0!==e.displacementMap&&(n.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(n.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(n.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(n.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(n.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(n.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(n.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(n.specularMap=r(e.specularMap)),void 0!==e.envMap&&(n.envMap=r(e.envMap)),void 0!==e.reflectivity&&(n.reflectivity=e.reflectivity),void 0!==e.lightMap&&(n.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(n.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(n.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(n.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(n.gradientMap=r(e.gradientMap)),n}}),Object.assign(ls.prototype,{load:function(e,t,r,n){var i=this;new co(i.manager).load(e,function(e){t(i.parse(JSON.parse(e)))},r,n)},parse:function(e){var t=new On,r=e.data.index;if(void 0!==r){var n=new ms[r.type](r.array);t.setIndex(new gn(n,1))}var i=e.data.attributes;for(var a in i){var o=i[a];n=new ms[o.type](o.array);t.addAttribute(a,new gn(n,o.itemSize,o.normalized))}var s=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==s)for(var u=0,c=s.length;u!==c;++u){var l=s[u];t.addGroup(l.start,l.count,l.materialIndex)}var f=e.data.boundingSphere;if(void 0!==f){var p=new Ut;void 0!==f.center&&p.fromArray(f.center),t.boundingSphere=new Jr(p,f.radius)}return t}});var fs,ps,hs,ds,ms={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function gs(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}gs.Handlers={handlers:[],add:function(e,t){this.handlers.push(e,t)},get:function(e){for(var t=this.handlers,r=0,n=t.length;r<n;r+=2){var i=t[r],a=t[r+1];if(i.test(e))return a}return null}},Object.assign(gs.prototype,{crossOrigin:void 0,initMaterials:function(e,t,r){for(var n=[],i=0;i<e.length;++i)n[i]=this.createMaterial(e[i],t,r);return n},createMaterial:(fs={NoBlending:L,NormalBlending:P,AdditiveBlending:U,SubtractiveBlending:I,MultiplyBlending:O,CustomBlending:N},ps=new zr,hs=new mo,ds=new cs,function(e,t,r){var n={};function i(e,i,a,o,s){var u,c=t+e,l=gs.Handlers.get(c);null!==l?u=l.load(c):(hs.setCrossOrigin(r),u=hs.load(c)),void 0!==i&&(u.repeat.fromArray(i),1!==i[0]&&(u.wrapS=Ee),1!==i[1]&&(u.wrapT=Ee)),void 0!==a&&u.offset.fromArray(a),void 0!==o&&("repeat"===o[0]&&(u.wrapS=Ee),"mirror"===o[0]&&(u.wrapS=Te),"repeat"===o[1]&&(u.wrapT=Ee),"mirror"===o[1]&&(u.wrapT=Te)),void 0!==s&&(u.anisotropy=s);var f=Rt.generateUUID();return n[f]=u,f}var a={uuid:Rt.generateUUID(),type:"MeshLambertMaterial"};for(var o in e){var s=e[o];switch(o){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":a.name=s;break;case"blending":a.blending=fs[s];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",o,"is no longer supported.");break;case"colorDiffuse":a.color=ps.fromArray(s).getHex();break;case"colorSpecular":a.specular=ps.fromArray(s).getHex();break;case"colorEmissive":a.emissive=ps.fromArray(s).getHex();break;case"specularCoef":a.shininess=s;break;case"shading":"basic"===s.toLowerCase()&&(a.type="MeshBasicMaterial"),"phong"===s.toLowerCase()&&(a.type="MeshPhongMaterial"),"standard"===s.toLowerCase()&&(a.type="MeshStandardMaterial");break;case"mapDiffuse":a.map=i(s,e.mapDiffuseRepeat,e.mapDiffuseOffset,e.mapDiffuseWrap,e.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":a.emissiveMap=i(s,e.mapEmissiveRepeat,e.mapEmissiveOffset,e.mapEmissiveWrap,e.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":a.lightMap=i(s,e.mapLightRepeat,e.mapLightOffset,e.mapLightWrap,e.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":a.aoMap=i(s,e.mapAORepeat,e.mapAOOffset,e.mapAOWrap,e.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":a.bumpMap=i(s,e.mapBumpRepeat,e.mapBumpOffset,e.mapBumpWrap,e.mapBumpAnisotropy);break;case"mapBumpScale":a.bumpScale=s;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":a.normalMap=i(s,e.mapNormalRepeat,e.mapNormalOffset,e.mapNormalWrap,e.mapNormalAnisotropy);break;case"mapNormalFactor":a.normalScale=[s,s];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":a.specularMap=i(s,e.mapSpecularRepeat,e.mapSpecularOffset,e.mapSpecularWrap,e.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":a.metalnessMap=i(s,e.mapMetalnessRepeat,e.mapMetalnessOffset,e.mapMetalnessWrap,e.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":a.roughnessMap=i(s,e.mapRoughnessRepeat,e.mapRoughnessOffset,e.mapRoughnessWrap,e.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":a.alphaMap=i(s,e.mapAlphaRepeat,e.mapAlphaOffset,e.mapAlphaWrap,e.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":a.side=M;break;case"doubleSided":a.side=T;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),a.opacity=s;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":a[o]=s;break;case"vertexColors":!0===s&&(a.vertexColors=C),"face"===s&&(a.vertexColors=R);break;default:console.error("THREE.Loader.createMaterial: Unsupported",o,s)}}return"MeshBasicMaterial"===a.type&&delete a.emissive,"MeshPhongMaterial"!==a.type&&delete a.specular,a.opacity<1&&(a.transparent=!0),ds.setTextures(n),ds.parse(a)})});var vs={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);return t},extractUrlBase:function(e){var t=e.split("/");return 1===t.length?"./":(t.pop(),t.join("/")+"/")}};function _s(e){"boolean"==typeof e&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),e=void 0),this.manager=void 0!==e?e:so,this.withCredentials=!1}function ys(e){this.manager=void 0!==e?e:so,this.texturePath=""}Object.assign(_s.prototype,{load:function(e,t,r,n){var i=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:vs.extractUrlBase(e),o=new co(this.manager);o.setWithCredentials(this.withCredentials),o.load(e,function(r){var n=JSON.parse(r),o=n.metadata;if(void 0!==o){var s=o.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+e+" should be loaded with THREE.SceneLoader instead.")}}var u=i.parse(n,a);t(u.geometry,u.materials)},r,n)},setTexturePath:function(e){this.texturePath=e},parse:function(){return function(e,t){void 0!==e.data&&(e=e.data),void 0!==e.scale?e.scale=1/e.scale:e.scale=1;var r=new mn;return function(e,t){function r(e,t){return e&1<<t}var n,i,a,o,s,u,c,l,f,p,h,d,m,g,v,_,y,b,x,w,$,E,M,T,S,A=e.faces,z=e.vertices,R=e.normals,C=e.colors,L=e.scale,P=0;if(void 0!==e.uvs){for(n=0;n<e.uvs.length;n++)e.uvs[n].length&&P++;for(n=0;n<P;n++)t.faceVertexUvs[n]=[]}for(o=0,s=z.length;o<s;)(b=new Ut).x=z[o++]*L,b.y=z[o++]*L,b.z=z[o++]*L,t.vertices.push(b);for(o=0,s=A.length;o<s;)if(h=r(p=A[o++],0),d=r(p,1),m=r(p,3),g=r(p,4),v=r(p,5),_=r(p,6),y=r(p,7),h){if((w=new pn).a=A[o],w.b=A[o+1],w.c=A[o+3],($=new pn).a=A[o+1],$.b=A[o+2],$.c=A[o+3],o+=4,d&&(f=A[o++],w.materialIndex=f,$.materialIndex=f),a=t.faces.length,m)for(n=0;n<P;n++)for(T=e.uvs[n],t.faceVertexUvs[n][a]=[],t.faceVertexUvs[n][a+1]=[],i=0;i<4;i++)S=new Ct(T[2*(l=A[o++])],T[2*l+1]),2!==i&&t.faceVertexUvs[n][a].push(S),0!==i&&t.faceVertexUvs[n][a+1].push(S);if(g&&(c=3*A[o++],w.normal.set(R[c++],R[c++],R[c]),$.normal.copy(w.normal)),v)for(n=0;n<4;n++)c=3*A[o++],M=new Ut(R[c++],R[c++],R[c]),2!==n&&w.vertexNormals.push(M),0!==n&&$.vertexNormals.push(M);if(_&&(E=C[u=A[o++]],w.color.setHex(E),$.color.setHex(E)),y)for(n=0;n<4;n++)E=C[u=A[o++]],2!==n&&w.vertexColors.push(new zr(E)),0!==n&&$.vertexColors.push(new zr(E));t.faces.push(w),t.faces.push($)}else{if((x=new pn).a=A[o++],x.b=A[o++],x.c=A[o++],d&&(f=A[o++],x.materialIndex=f),a=t.faces.length,m)for(n=0;n<P;n++)for(T=e.uvs[n],t.faceVertexUvs[n][a]=[],i=0;i<3;i++)S=new Ct(T[2*(l=A[o++])],T[2*l+1]),t.faceVertexUvs[n][a].push(S);if(g&&(c=3*A[o++],x.normal.set(R[c++],R[c++],R[c])),v)for(n=0;n<3;n++)c=3*A[o++],M=new Ut(R[c++],R[c++],R[c]),x.vertexNormals.push(M);if(_&&(u=A[o++],x.color.setHex(C[u])),y)for(n=0;n<3;n++)u=A[o++],x.vertexColors.push(new zr(C[u]));t.faces.push(x)}}(e,r),function(e,t){var r=void 0!==e.influencesPerVertex?e.influencesPerVertex:2;if(e.skinWeights)for(var n=0,i=e.skinWeights.length;n<i;n+=r){var a=e.skinWeights[n],o=r>1?e.skinWeights[n+1]:0,s=r>2?e.skinWeights[n+2]:0,u=r>3?e.skinWeights[n+3]:0;t.skinWeights.push(new kt(a,o,s,u))}if(e.skinIndices)for(n=0,i=e.skinIndices.length;n<i;n+=r){var c=e.skinIndices[n],l=r>1?e.skinIndices[n+1]:0,f=r>2?e.skinIndices[n+2]:0,p=r>3?e.skinIndices[n+3]:0;t.skinIndices.push(new kt(c,l,f,p))}t.bones=e.bones,t.bones&&t.bones.length>0&&(t.skinWeights.length!==t.skinIndices.length||t.skinIndices.length!==t.vertices.length)&&console.warn("When skinning, number of vertices ("+t.vertices.length+"), skinIndices ("+t.skinIndices.length+"), and skinWeights ("+t.skinWeights.length+") should match.")}(e,r),function(e,t){var r=e.scale;if(void 0!==e.morphTargets)for(var n=0,i=e.morphTargets.length;n<i;n++){t.morphTargets[n]={},t.morphTargets[n].name=e.morphTargets[n].name,t.morphTargets[n].vertices=[];for(var a=t.morphTargets[n].vertices,o=e.morphTargets[n].vertices,s=0,u=o.length;s<u;s+=3){var c=new Ut;c.x=o[s]*r,c.y=o[s+1]*r,c.z=o[s+2]*r,a.push(c)}}if(void 0!==e.morphColors&&e.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=t.faces,f=e.morphColors[0].colors;for(n=0,i=l.length;n<i;n++)l[n].color.fromArray(f,3*n)}}(e,r),function(e,t){var r=[],n=[];void 0!==e.animation&&n.push(e.animation),void 0!==e.animations&&(e.animations.length?n=n.concat(e.animations):n.push(e.animations));for(var i=0;i<n.length;i++){var a=us.parseAnimation(n[i],t.bones);a&&r.push(a)}if(t.morphTargets){var o=us.CreateClipsFromMorphTargetSequences(t.morphTargets,10);r=r.concat(o)}r.length>0&&(t.animations=r)}(e,r),r.computeFaceNormals(),r.computeBoundingSphere(),void 0===e.materials||0===e.materials.length?{geometry:r}:{geometry:r,materials:gs.prototype.initMaterials(e.materials,t,this.crossOrigin)}}}()}),Object.assign(ys.prototype,{load:function(e,t,r,n){""===this.texturePath&&(this.texturePath=e.substring(0,e.lastIndexOf("/")+1));var i=this;new co(i.manager).load(e,function(r){var a=null;try{a=JSON.parse(r)}catch(t){return void 0!==n&&n(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?i.parse(a,t):console.error("THREE.ObjectLoader: Can't load "+e+". Use THREE.JSONLoader instead.")},r,n)},setTexturePath:function(e){this.texturePath=e},setCrossOrigin:function(e){this.crossOrigin=e},parse:function(e,t){var r=this.parseShape(e.shapes),n=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,function(){void 0!==t&&t(s)}),a=this.parseTextures(e.textures,i),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,n,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(s),s},parseShape:function(e){var t={};if(void 0!==e)for(var r=0,n=e.length;r<n;r++){var i=(new ko).fromJSON(e[r]);t[i.uuid]=i}return t},parseGeometries:function(e,t){var r={};if(void 0!==e)for(var n=new _s,i=new ls,a=0,o=e.length;a<o;a++){var s,u=e[a];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Xa[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Xa[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Xa[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Xa[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Xa[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Xa[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Xa[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Xa[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Xa[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Xa[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Xa[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Xa[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var c=[];for(a=0,o=u.shapes.length;a<o;a++){var l=t[u.shapes[a]];c.push(l)}s=new Xa[u.type](c,u.curveSegments);break;case"BufferGeometry":s=i.parse(u);break;case"Geometry":s=n.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),r[u.uuid]=s}return r},parseMaterials:function(e,t){var r={};if(void 0!==e){var n=new cs;n.setTextures(t);for(var i=0,a=e.length;i<a;i++){var o=e[i];if("MultiMaterial"===o.type){for(var s=[],u=0;u<o.materials.length;u++)s.push(n.parse(o.materials[u]));r[o.uuid]=s}else r[o.uuid]=n.parse(o)}}return r},parseAnimations:function(e){for(var t=[],r=0;r<e.length;r++){var n=us.parse(e[r]);t.push(n)}return t},parseImages:function(e,t){var r=this,n={};function i(e){return r.manager.itemStart(e),a.load(e,function(){r.manager.itemEnd(e)},void 0,function(){r.manager.itemEnd(e),r.manager.itemError(e)})}if(void 0!==e&&e.length>0){var a=new po(new oo(t));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=e.length;o<s;o++){var u=e[o],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:r.texturePath+u.url;n[u.uuid]=i(c)}}return n},parseTextures:function(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var n={};if(void 0!==e)for(var i=0,a=e.length;i<a;i++){var o=e[i];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new Nt(t[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=r(o.mapping,xs)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=r(o.wrap[0],ws),s.wrapT=r(o.wrap[1],ws)),void 0!==o.minFilter&&(s.minFilter=r(o.minFilter,$s)),void 0!==o.magFilter&&(s.magFilter=r(o.magFilter,$s)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),n[o.uuid]=s}return n},parseObject:function(){var e=new Lt;return function(t,r,n){var i;function a(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),r[e]}function o(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,i=e.length;r<i;r++){var a=e[r];void 0===n[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),t.push(n[a])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(t.type){case"Scene":i=new wi,void 0!==t.background&&Number.isInteger(t.background)&&(i.background=new zr(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?i.fog=new xi(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(i.fog=new bi(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":i=new mi(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(i.focus=t.focus),void 0!==t.zoom&&(i.zoom=t.zoom),void 0!==t.filmGauge&&(i.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(i.filmOffset=t.filmOffset),void 0!==t.view&&(i.view=Object.assign({},t.view));break;case"OrthographicCamera":i=new fn(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":i=new qo(t.color,t.intensity);break;case"DirectionalLight":i=new Wo(t.color,t.intensity);break;case"PointLight":i=new Ho(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":i=new Xo(t.color,t.intensity,t.width,t.height);break;case"SpotLight":i=new Vo(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":i=new Fo(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=a(t.geometry),u=o(t.material);i=s.bones&&s.bones.length>0?new zi(s,u):new Wn(s,u);break;case"LOD":i=new Ti;break;case"Line":i=new Ci(a(t.geometry),o(t.material),t.mode);break;case"LineLoop":i=new Pi(a(t.geometry),o(t.material));break;case"LineSegments":i=new Li(a(t.geometry),o(t.material));break;case"PointCloud":case"Points":i=new Ii(a(t.geometry),o(t.material));break;case"Sprite":i=new Mi(o(t.material));break;case"Group":i=new Oi;break;default:i=new cn}if(i.uuid=t.uuid,void 0!==t.name&&(i.name=t.name),void 0!==t.matrix?(e.fromArray(t.matrix),e.decompose(i.position,i.quaternion,i.scale)):(void 0!==t.position&&i.position.fromArray(t.position),void 0!==t.rotation&&i.rotation.fromArray(t.rotation),void 0!==t.quaternion&&i.quaternion.fromArray(t.quaternion),void 0!==t.scale&&i.scale.fromArray(t.scale)),void 0!==t.castShadow&&(i.castShadow=t.castShadow),void 0!==t.receiveShadow&&(i.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(i.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(i.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&i.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(i.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(i.visible=t.visible),void 0!==t.userData&&(i.userData=t.userData),void 0!==t.children)for(var c=t.children,l=0;l<c.length;l++)i.add(this.parseObject(c[l],r,n));if("LOD"===t.type)for(var f=t.levels,p=0;p<f.length;p++){var h=f[p],d=i.getObjectByProperty("uuid",h.object);void 0!==d&&i.addLevel(d,h.distance)}return i}}()});var bs,xs={UVMapping:ge,CubeReflectionMapping:ve,CubeRefractionMapping:_e,EquirectangularReflectionMapping:ye,EquirectangularRefractionMapping:be,SphericalReflectionMapping:xe,CubeUVReflectionMapping:we,CubeUVRefractionMapping:$e},ws={RepeatWrapping:Ee,ClampToEdgeWrapping:Me,MirroredRepeatWrapping:Te},$s={NearestFilter:Se,NearestMipMapNearestFilter:Ae,NearestMipMapLinearFilter:ze,LinearFilter:Re,LinearMipMapNearestFilter:Ce,LinearMipMapLinearFilter:Le};function Es(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==e?e:so,this.options=void 0}function Ms(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Ts(e){this.type="Font",this.data=e}function Ss(e){this.manager=void 0!==e?e:so}Es.prototype={constructor:Es,setOptions:function(e){return this.options=e,this},load:function(e,t,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e);var i=this,a=ao.get(e);if(void 0!==a)return i.manager.itemStart(e),setTimeout(function(){t&&t(a),i.manager.itemEnd(e)},0),a;fetch(e).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,i.options)}).then(function(r){ao.add(e,r),t&&t(r),i.manager.itemEnd(e)}).catch(function(t){n&&n(t),i.manager.itemEnd(e),i.manager.itemError(e)})},setCrossOrigin:function(){return this},setPath:function(e){return this.path=e,this}},Object.assign(Ms.prototype,{moveTo:function(e,t){this.currentPath=new No,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t)},lineTo:function(e,t){this.currentPath.lineTo(e,t)},quadraticCurveTo:function(e,t,r,n){this.currentPath.quadraticCurveTo(e,t,r,n)},bezierCurveTo:function(e,t,r,n,i,a){this.currentPath.bezierCurveTo(e,t,r,n,i,a)},splineThru:function(e){this.currentPath.splineThru(e)},toShapes:function(e,t){function r(e){for(var t=[],r=0,n=e.length;r<n;r++){var i=e[r],a=new ko;a.curves=i.curves,t.push(a)}return t}function n(e,t){for(var r=t.length,n=!1,i=r-1,a=0;a<r;i=a++){var o=t[i],s=t[a],u=s.x-o.x,c=s.y-o.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(o=t[a],u=-u,s=t[i],c=-c),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var l=c*(e.x-o.x)-u*(e.y-o.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return n}var i=Sa.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===t)return r(a);var o,s,u,c=[];if(1===a.length)return s=a[0],(u=new ko).curves=s.curves,c.push(u),c;var l=!i(a[0].getPoints());l=e?!l:l;var f,p,h=[],d=[],m=[],g=0;d[g]=void 0,m[g]=[];for(var v=0,_=a.length;v<_;v++)o=i(f=(s=a[v]).getPoints()),(o=e?!o:o)?(!l&&d[g]&&g++,d[g]={s:new ko,p:f},d[g].s.curves=s.curves,l&&g++,m[g]=[]):m[g].push({h:s,p:f[0]});if(!d[0])return r(a);if(d.length>1){for(var y=!1,b=[],x=0,w=d.length;x<w;x++)h[x]=[];for(x=0,w=d.length;x<w;x++)for(var $=m[x],E=0;E<$.length;E++){for(var M=$[E],T=!0,S=0;S<d.length;S++)n(M.p,d[S].p)&&(x!==S&&b.push({froms:x,tos:S,hole:E}),T?(T=!1,h[S].push(M)):y=!0);T&&h[x].push(M)}b.length>0&&(y||(m=h))}v=0;for(var A=d.length;v<A;v++){u=d[v].s,c.push(u);for(var z=0,R=(p=m[v]).length;z<R;z++)u.holes.push(p[z].h)}return c}}),Object.assign(Ts.prototype,{isFont:!0,generateShapes:function(e,t,r){function n(e,t,r,n){var a=i.glyphs[e]||i.glyphs["?"];if(a){var o,s,u,c,l,f,p,h,d,m=new Ms,g=[];if(a.o)for(var v=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),_=0,y=v.length;_<y;){switch(v[_++]){case"m":o=v[_++]*t+r,s=v[_++]*t+n,m.moveTo(o,s);break;case"l":o=v[_++]*t+r,s=v[_++]*t+n,m.lineTo(o,s);break;case"q":u=v[_++]*t+r,c=v[_++]*t+n,l=v[_++]*t+r,f=v[_++]*t+n,m.quadraticCurveTo(l,f,u,c),(d=g[g.length-1])&&(d.x,d.y);break;case"b":u=v[_++]*t+r,c=v[_++]*t+n,l=v[_++]*t+r,f=v[_++]*t+n,p=v[_++]*t+r,h=v[_++]*t+n,m.bezierCurveTo(l,f,p,h,u,c),(d=g[g.length-1])&&(d.x,d.y)}}return{offsetX:a.ha*t,path:m}}}void 0===t&&(t=100),void 0===r&&(r=4);for(var i=this.data,a=function(e){for(var r=String(e).split(""),a=t/i.resolution,o=(i.boundingBox.yMax-i.boundingBox.yMin+i.underlineThickness)*a,s=0,u=0,c=[],l=0;l<r.length;l++){var f=r[l];if("\n"===f)s=0,u-=o;else{var p=n(f,a,s,u);s+=p.offsetX,c.push(p.path)}}return c}(e),o=[],s=0,u=a.length;s<u;s++)Array.prototype.push.apply(o,a[s].toShapes());return o}}),Object.assign(Ss.prototype,{load:function(e,t,r,n){var i=this,a=new co(this.manager);a.setPath(this.path),a.load(e,function(e){var r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}var n=i.parse(r);t&&t(n)},r,n)},parse:function(e){return new Ts(e)},setPath:function(e){return this.path=e,this}});var As,zs,Rs,Cs,Ls,Ps,Us,Is,Os,Ns,ks,Ds,Fs,Bs,Gs,Vs,Hs={getContext:function(){return void 0===bs&&(bs=new(window.AudioContext||window.webkitAudioContext)),bs},setContext:function(e){bs=e}};function js(e){this.manager=void 0!==e?e:so}function Ws(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new mi,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new mi,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function qs(e,t,r){cn.call(this),this.type="CubeCamera";var n=new mi(90,1,e,t);n.up.set(0,-1,0),n.lookAt(new Ut(1,0,0)),this.add(n);var i=new mi(90,1,e,t);i.up.set(0,-1,0),i.lookAt(new Ut(-1,0,0)),this.add(i);var a=new mi(90,1,e,t);a.up.set(0,0,1),a.lookAt(new Ut(0,1,0)),this.add(a);var o=new mi(90,1,e,t);o.up.set(0,0,-1),o.lookAt(new Ut(0,-1,0)),this.add(o);var s=new mi(90,1,e,t);s.up.set(0,-1,0),s.lookAt(new Ut(0,0,1)),this.add(s);var u=new mi(90,1,e,t);u.up.set(0,-1,0),u.lookAt(new Ut(0,0,-1)),this.add(u);var c={format:We,magFilter:Re,minFilter:Re};this.renderTarget=new Ft(r,r,c),this.renderTarget.texture.name="CubeCamera",this.update=function(e,t){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,c=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,e.render(t,n,r),r.activeCubeFace=1,e.render(t,i,r),r.activeCubeFace=2,e.render(t,a,r),r.activeCubeFace=3,e.render(t,o,r),r.activeCubeFace=4,e.render(t,s,r),r.texture.generateMipmaps=c,r.activeCubeFace=5,e.render(t,u,r),e.setRenderTarget(null)},this.clear=function(e,t,r,n){for(var i=this.renderTarget,a=0;a<6;a++)i.activeCubeFace=a,e.setRenderTarget(i),e.clear(t,r,n);e.setRenderTarget(null)}}function Xs(){cn.call(this),this.type="AudioListener",this.context=Hs.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ys(e){cn.call(this),this.type="Audio",this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Js(e){Ys.call(this,e),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Zs(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=void 0!==t?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function Ks(e,t,r){this.binding=e,this.valueSize=r;var n,i=Float64Array;switch(t){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Qs(e,t,r){var n=r||eu.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}function eu(e,t,r){this.path=t,this.parsedPath=r||eu.parseTrackName(t),this.node=eu.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function tu(){this.uuid=Rt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function ru(e,t,r){this._mixer=e,this._clip=t,this._localRoot=r||null;for(var n=t.tracks,i=n.length,a=new Array(i),o={endingStart:dt,endingEnd:dt},s=0;s!==i;++s){var u=n[s].createInterpolant(null);a[s]=u,u.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ct,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function nu(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function iu(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}function au(){On.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function ou(e,t,r,n){this.uuid=Rt.generateUUID(),this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===n}function su(e,t){this.uuid=Rt.generateUUID(),this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function uu(e,t,r){su.call(this,e,t),this.meshPerAttribute=r||1}function cu(e,t,r){gn.call(this,e,t),this.meshPerAttribute=r||1}function lu(e,t,r,n){this.ray=new Vn(e,t),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function fu(e,t){return e.distance-t.distance}function pu(e,t,r,n){if(!1!==e.visible&&(e.raycast(t,r),!0===n))for(var i=e.children,a=0,o=i.length;a<o;a++)pu(i[a],t,r,!0)}function hu(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function du(e,t,r){return this.radius=void 0!==e?e:1,this.phi=void 0!==t?t:0,this.theta=void 0!==r?r:0,this}function mu(e,t,r){return this.radius=void 0!==e?e:1,this.theta=void 0!==t?t:0,this.y=void 0!==r?r:0,this}function gu(e){cn.call(this),this.material=e,this.render=function(){}}function vu(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var u=new On,c=new En(2*o*3,3);u.addAttribute("position",c),Li.call(this,u,new Ri({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function _u(e,t){cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var r=new On,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,a=1;i<32;i++,a++){var o=i/32*Math.PI*2,s=a/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}r.addAttribute("position",new En(n,3));var u=new Ri({fog:!1});this.cone=new Li(r,u),this.add(this.cone),this.update()}function yu(e){for(var t=function e(t){var r=[];t&&t.isBone&&r.push(t);for(var n=0;n<t.children.length;n++)r.push.apply(r,e(t.children[n]));return r}(e),r=new On,n=[],i=[],a=new zr(0,0,1),o=new zr(0,1,0),s=0;s<t.length;s++){var u=t[s];u.parent&&u.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(a.r,a.g,a.b),i.push(o.r,o.g,o.b))}r.addAttribute("position",new En(n,3)),r.addAttribute("color",new En(i,3));var c=new Ri({vertexColors:C,depthTest:!1,depthWrite:!1,transparent:!0});Li.call(this,r,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function bu(e,t,r){this.light=e,this.light.updateMatrixWorld(),this.color=r;var n=new Pa(t,4,2),i=new Bn({wireframe:!0,fog:!1});Wn.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function xu(e,t){cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;var r=new Ri({fog:!1}),n=new On;n.addAttribute("position",new gn(new Float32Array(15),3)),this.line=new Ci(n,r),this.add(this.line),this.update()}function wu(e,t,r){cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new Xi(t);n.rotateY(.5*Math.PI),this.material=new Bn({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=C);var i=n.getAttribute("position"),a=new Float32Array(3*i.count);n.addAttribute("color",new gn(a,3)),this.add(new Wn(n,this.material)),this.update()}function $u(e,t,r,n){e=e||10,t=t||10,r=new zr(void 0!==r?r:4473924),n=new zr(void 0!==n?n:8947848);for(var i=t/2,a=e/t,o=e/2,s=[],u=[],c=0,l=0,f=-o;c<=t;c++,f+=a){s.push(-o,0,f,o,0,f),s.push(f,0,-o,f,0,o);var p=c===i?r:n;p.toArray(u,l),l+=3,p.toArray(u,l),l+=3,p.toArray(u,l),l+=3,p.toArray(u,l),l+=3}var h=new On;h.addAttribute("position",new En(s,3)),h.addAttribute("color",new En(u,3));var d=new Ri({vertexColors:C});Li.call(this,h,d)}function Eu(e,t,r,n,i,a){e=e||10,t=t||16,r=r||8,n=n||64,i=new zr(void 0!==i?i:4473924),a=new zr(void 0!==a?a:8947848);var o,s,u,c,l,f,p,h=[],d=[];for(c=0;c<=t;c++)u=c/t*(2*Math.PI),o=Math.sin(u)*e,s=Math.cos(u)*e,h.push(0,0,0),h.push(o,0,s),p=1&c?i:a,d.push(p.r,p.g,p.b),d.push(p.r,p.g,p.b);for(c=0;c<=r;c++)for(p=1&c?i:a,f=e-e/r*c,l=0;l<n;l++)u=l/n*(2*Math.PI),o=Math.sin(u)*f,s=Math.cos(u)*f,h.push(o,0,s),d.push(p.r,p.g,p.b),u=(l+1)/n*(2*Math.PI),o=Math.sin(u)*f,s=Math.cos(u)*f,h.push(o,0,s),d.push(p.r,p.g,p.b);var m=new On;m.addAttribute("position",new En(h,3)),m.addAttribute("color",new En(d,3));var g=new Ri({vertexColors:C});Li.call(this,m,g)}function Mu(e,t,r,n){this.object=e,this.size=void 0!==t?t:1;var i=void 0!==r?r:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new On,c=new En(2*o*3,3);u.addAttribute("position",c),Li.call(this,u,new Ri({color:i,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Tu(e,t,r){cn.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);var n=new On;n.addAttribute("position",new En([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var i=new Ri({fog:!1});this.lightPlane=new Ci(n,i),this.add(this.lightPlane),(n=new On).addAttribute("position",new En([0,0,0,0,0,1],3)),this.targetLine=new Ci(n,i),this.add(this.targetLine),this.update()}function Su(e){var t=new On,r=new Ri({color:16777215,vertexColors:R}),n=[],i=[],a={},o=new zr(16755200),s=new zr(16711680),u=new zr(43775),c=new zr(16777215),l=new zr(3355443);function f(e,t,r){p(e,r),p(t,r)}function p(e,t){n.push(0,0,0),i.push(t.r,t.g,t.b),void 0===a[e]&&(a[e]=[]),a[e].push(n.length/3-1)}f("n1","n2",o),f("n2","n4",o),f("n4","n3",o),f("n3","n1",o),f("f1","f2",o),f("f2","f4",o),f("f4","f3",o),f("f3","f1",o),f("n1","f1",o),f("n2","f2",o),f("n3","f3",o),f("n4","f4",o),f("p","n1",s),f("p","n2",s),f("p","n3",s),f("p","n4",s),f("u1","u2",u),f("u2","u3",u),f("u3","u1",u),f("c","t",c),f("p","c",l),f("cn1","cn2",l),f("cn3","cn4",l),f("cf1","cf2",l),f("cf3","cf4",l),t.addAttribute("position",new En(n,3)),t.addAttribute("color",new En(i,3)),Li.call(this,t,r),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Au(e,t){this.object=e,void 0===t&&(t=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new On;i.setIndex(new gn(r,1)),i.addAttribute("position",new gn(n,3)),Li.call(this,i,new Ri({color:t})),this.matrixAutoUpdate=!1,this.update()}function zu(e,t){this.type="Box3Helper",this.box=e;var r=void 0!==t?t:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new On;i.setIndex(new gn(n,1)),i.addAttribute("position",new En([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Li.call(this,i,new Ri({color:r})),this.geometry.computeBoundingSphere()}function Ru(e,t,r){this.type="PlaneHelper",this.plane=e,this.size=void 0===t?1:t;var n=void 0!==r?r:16776960,i=new On;i.addAttribute("position",new En([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),i.computeBoundingSphere(),Ci.call(this,i,new Ri({color:n}));var a=new On;a.addAttribute("position",new En([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Wn(a,new Bn({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function Cu(e,t,r,n,i,a){cn.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===a&&(a=.2*i),void 0===Fs&&((Fs=new On).addAttribute("position",new En([0,0,0,0,1,0],3)),(Bs=new Va(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Ci(Fs,new Ri({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Wn(Bs,new Bn({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,i,a)}function Lu(e){var t=[0,0,0,e=e||1,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new On;r.addAttribute("position",new En(t,3)),r.addAttribute("color",new En([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new Ri({vertexColors:C});Li.call(this,r,n)}Object.assign(js.prototype,{load:function(e,t,r,n){var i=new co(this.manager);i.setResponseType("arraybuffer"),i.load(e,function(e){Hs.getContext().decodeAudioData(e,function(e){t(e)})},r,n)}}),Object.assign(Ws.prototype,{update:(Os=new Lt,Ns=new Lt,function(e){if(As!==this||zs!==e.focus||Rs!==e.fov||Cs!==e.aspect*this.aspect||Ls!==e.near||Ps!==e.far||Us!==e.zoom||Is!==this.eyeSep){As=this,zs=e.focus,Rs=e.fov,Cs=e.aspect*this.aspect,Ls=e.near,Ps=e.far,Us=e.zoom;var t,r,n=e.projectionMatrix.clone(),i=(Is=this.eyeSep/2)*Ls/zs,a=Ls*Math.tan(Rt.DEG2RAD*Rs*.5)/Us;Ns.elements[12]=-Is,Os.elements[12]=Is,t=-a*Cs+i,r=a*Cs+i,n.elements[0]=2*Ls/(r-t),n.elements[8]=(r+t)/(r-t),this.cameraL.projectionMatrix.copy(n),t=-a*Cs-i,r=a*Cs-i,n.elements[0]=2*Ls/(r-t),n.elements[8]=(r+t)/(r-t),this.cameraR.projectionMatrix.copy(n)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Ns),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Os)})}),qs.prototype=Object.create(cn.prototype),qs.prototype.constructor=qs,Xs.prototype=Object.assign(Object.create(cn.prototype),{constructor:Xs,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(e){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){this.gain.gain.value=e},updateMatrixWorld:function(){var e=new Ut,t=new Pt,r=new Ut,n=new Ut;return function(i){cn.prototype.updateMatrixWorld.call(this,i);var a=this.context.listener,o=this.up;this.matrixWorld.decompose(e,t,r),n.set(0,0,-1).applyQuaternion(t),a.positionX?(a.positionX.setValueAtTime(e.x,this.context.currentTime),a.positionY.setValueAtTime(e.y,this.context.currentTime),a.positionZ.setValueAtTime(e.z,this.context.currentTime),a.forwardX.setValueAtTime(n.x,this.context.currentTime),a.forwardY.setValueAtTime(n.y,this.context.currentTime),a.forwardZ.setValueAtTime(n.z,this.context.currentTime),a.upX.setValueAtTime(o.x,this.context.currentTime),a.upY.setValueAtTime(o.y,this.context.currentTime),a.upZ.setValueAtTime(o.z,this.context.currentTime)):(a.setPosition(e.x,e.y,e.z),a.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z))}}()}),Ys.prototype=Object.assign(Object.create(cn.prototype),{constructor:Ys,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.onended=this.onEnded.bind(this),e.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,e.start(this.startTime,this.offset),this.isPlaying=!0,this.source=e,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.value=e,this}}),Js.prototype=Object.assign(Object.create(Ys.prototype),{constructor:Js,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){this.panner.refDistance=e},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){this.panner.rolloffFactor=e},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){this.panner.distanceModel=e},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){this.panner.maxDistance=e},updateMatrixWorld:function(){var e=new Ut;return function(t){cn.prototype.updateMatrixWorld.call(this,t),e.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(e.x,e.y,e.z)}}()}),Object.assign(Zs.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),r=0;r<t.length;r++)e+=t[r];return e/t.length}}),Object.assign(Ks.prototype,{accumulate:function(e,t){var r=this.buffer,n=this.valueSize,i=e*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)r[i+o]=r[o];a=t}else{var s=t/(a+=t);this._mixBufferRegion(r,i,0,s,n)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,r=this.buffer,n=e*t+t,i=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,i<1){var o=3*t;this._mixBufferRegion(r,n,o,1-i,t)}for(var s=t,u=t+t;s!==u;++s)if(r[s]!==r[s+t]){a.setValue(r,n);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,r=this.valueSize,n=3*r;e.getValue(t,n);for(var i=r,a=n;i!==a;++i)t[i]=t[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)},_select:function(e,t,r,n,i){if(n>=.5)for(var a=0;a!==i;++a)e[t+a]=e[r+a]},_slerp:function(e,t,r,n){Pt.slerpFlat(e,t,e,t,e,r,n)},_lerp:function(e,t,r,n,i){for(var a=1-n,o=0;o!==i;++o){var s=t+o;e[s]=e[s]*a+e[r+o]*n}}}),Object.assign(Qs.prototype,{getValue:function(e,t){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,t)},setValue:function(e,t){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}),Object.assign(eu,{Composite:Qs,create:function(e,t,r){return e&&e.isAnimationObjectGroup?new eu.Composite(e,t,r):new eu(e,t,r)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(/[^\w-]/g,"")},parseTrackName:(ks=new RegExp("^"+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+"$"),Ds=["material","materials","bones"],function(e){var t=ks.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==Ds.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}),findNode:function(e,t){if(!t||""===t||"root"===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var r=function(e){for(var r=0;r<e.bones.length;r++){var n=e.bones[r];if(n.name===t)return n}return null}(e.skeleton);if(r)return r}if(e.children){var n=function(e){for(var r=0;r<e.length;r++){var i=e[r];if(i.name===t||i.uuid===t)return i;var a=n(i.children);if(a)return a}return null},i=n(e.children);if(i)return i}return null}}),Object.assign(eu.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)e[t++]=r[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++]},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,i=t.propertyIndex;if(e||(e=eu.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(r){var a=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==a){if(void 0===e[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[a]}}var s=e[n];if(void 0!==s){var u=this.Versioning.None;void 0!==e.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=e):void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=e);var c=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===i){i=o;break}}else{if(!e.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===i){i=o;break}}}c=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(c=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(c=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][u]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(eu.prototype,{_getValue_unbound:eu.prototype.getValue,_setValue_unbound:eu.prototype.setValue}),Object.assign(tu.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,u=0,c=arguments.length;u!==c;++u){var l=arguments[u],f=l.uuid,p=n[f],h=void 0;if(void 0===p){p=t++,n[f]=p,e.push(l);for(var d=0,m=s;d!==m;++d)o[d].push(new eu(l,i[d],a[d]))}else if(p<r){h=e[p];var g=--r,v=e[g];n[v.uuid]=p,e[p]=v,n[f]=g,e[g]=l;for(d=0,m=s;d!==m;++d){var _=o[d],y=_[g],b=_[p];_[p]=y,void 0===b&&(b=new eu(l,i[d],a[d])),_[g]=b}}else e[p]!==h&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],u=s.uuid,c=r[u];if(void 0!==c&&c>=t){var l=t++,f=e[l];r[f.uuid]=c,e[c]=f,r[u]=l,e[l]=s;for(var p=0,h=i;p!==h;++p){var d=n[p],m=d[l],g=d[c];d[c]=m,d[l]=g}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,a=i.length,o=0,s=arguments.length;o!==s;++o){var u=arguments[o].uuid,c=n[u];if(void 0!==c)if(delete n[u],c<r){var l=--r,f=e[l],p=e[v=--t];n[f.uuid]=c,e[c]=f,n[p.uuid]=l,e[l]=p,e.pop();for(var h=0,d=a;h!==d;++h){var m=(_=i[h])[l],g=_[v];_[c]=m,_[l]=g,_.pop()}}else{var v;n[(p=e[v=--t]).uuid]=c,e[c]=p,e.pop();for(h=0,d=a;h!==d;++h){var _;(_=i[h])[c]=_[v],_.pop()}}}this.nCachedObjects_=r},subscribe_:function(e,t){var r=this._bindingsIndicesByPath,n=r[e],i=this._bindings;if(void 0!==n)return i[n];var a=this._paths,o=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);n=i.length,r[e]=n,a.push(e),o.push(t),i.push(l);for(var f=c,p=s.length;f!==p;++f){var h=s[f];l[f]=new eu(h,e,t)}return l},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){var n=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];t[e[o]]=r,a[r]=s,a.pop(),i[r]=i[o],i.pop(),n[r]=n[o],n.pop()}}}),Object.assign(ru.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){var n=this._clip.duration,i=e._clip.duration,a=i/n,o=n/i;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,r){return e.crossFadeFrom(this,t,r)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,r){var n=this._mixer,i=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,u=a.sampleValues;return s[0]=i,s[1]=i+r,u[0]=e/o,u[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var a=(e-i)*r;if(a<0||0===r)return;this._startTime=null,t=r*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,f=u.length;l!==f;++l)u[l].evaluate(o),c[l].accumulate(n,s)}else this._updateWeight(e)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(e)[0];t*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r)t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e;if(0===e)return t;var r=this._clip.duration,n=this.loop,i=this._loopCount;if(n===ut){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=r)t=r;else{if(!(t<0))break e;t=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{var a=n===lt;if(-1===i&&(e>=0?(i=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),t>=r||t<0){var o=Math.floor(t/r);t-=r*o,i+=Math.abs(o);var s=this.repetitions-i;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(0===s){var u=e<0;this._setEndings(u,!u,a)}else this._setEndings(!1,!1,a);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&i))return this.time=t,r-t}return this.time=t,t},_setEndings:function(e,t,r){var n=this._interpolantSettings;r?(n.endingStart=mt,n.endingEnd=mt):(n.endingStart=e?this.zeroSlopeAtStart?mt:dt:gt,n.endingEnd=t?this.zeroSlopeAtEnd?mt:dt:gt)},_scheduleFading:function(e,t,r){var n=this._mixer,i=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=i,s[0]=t,o[1]=i+e,s[1]=r,this}}),nu.prototype=Object.assign(Object.create(n.prototype),{constructor:nu,_bindAction:function(e,t){var r=e._localRoot||this._root,n=e._clip.tracks,i=n.length,a=e._propertyBindings,o=e._interpolants,s=r.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var f=n[l],p=f.name,h=c[p];if(void 0!==h)a[l]=h;else{if(void 0!==(h=a[l])){null===h._cacheIndex&&(++h.referenceCount,this._addInactiveBinding(h,s,p));continue}var d=t&&t._propertyBindings[l].binding.parsedPath;++(h=new Ks(eu.create(r,p,d),f.ValueTypeName,f.getValueSize())).referenceCount,this._addInactiveBinding(h,s,p),a[l]=h}o[l].resultBuffer=h.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,t)}for(var i=e._propertyBindings,a=0,o=i.length;a!==o;++a){var s=i[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions},_addInactiveAction:function(e,t,r){var n=this._actions,i=this._actionsByClip,a=i[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,i[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e},_removeInactiveAction:function(e){var t=this._actions,r=t[t.length-1],n=e._cacheIndex;r._cacheIndex=n,t[n]=r,t.pop(),e._cacheIndex=null;var i=e._clip.uuid,a=this._actionsByClip,o=a[i],s=o.knownActions,u=s[s.length-1],c=e._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete a[i],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,r=0,n=t.length;r!==n;++r){var i=t[r];0==--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(e){var t=this._actions,r=e._cacheIndex,n=this._nActiveActions++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackAction:function(e){var t=this._actions,r=e._cacheIndex,n=--this._nActiveActions,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_addInactiveBinding:function(e,t,r){var n=this._bindingsByRootAndName,i=n[t],a=this._bindings;void 0===i&&(i={},n[t]=i),i[r]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,r=e.binding,n=r.rootNode.uuid,i=r.path,a=this._bindingsByRootAndName,o=a[n],s=t[t.length-1],u=e._cacheIndex;s._cacheIndex=u,t[u]=s,t.pop(),delete o[i];e:{for(var c in o)break e;delete a[n]}},_lendBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_takeBackBinding:function(e){var t=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,i=t[n];e._cacheIndex=n,t[n]=e,i._cacheIndex=r,t[r]=i},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,r=e[t];return void 0===r&&((r=new ns(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=r),r},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,i=t[n];e.__cacheIndex=n,t[n]=e,i.__cacheIndex=r,t[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?us.findByName(r,e):e,a=null!==i?i.uuid:e,o=this._actionsByClip[a],s=null;if(void 0!==o){var u=o.actionByRoot[n];if(void 0!==u)return u;s=o.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new ru(this,i,t);return this._bindAction(c,s),this._addInactiveAction(c,a,n),c},existingAction:function(e,t){var r=t||this._root,n=r.uuid,i="string"==typeof e?us.findByName(r,e):e,a=i?i.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==t;++i)e[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,r=this._nActiveActions,n=this.time+=e,i=Math.sign(e),a=this._accuIndex^=1,o=0;o!==r;++o){t[o]._update(n,e,i,a)}var s=this._bindings,u=this._nActiveBindings;for(o=0;o!==u;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,r=e.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var a=i.knownActions,o=0,s=a.length;o!==s;++o){var u=a[o];this._deactivateAction(u);var c=u._cacheIndex,l=t[t.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,t[c]=l,t.pop(),this._removeInactiveBindingsForAction(u)}delete n[r]}},uncacheRoot:function(e){var t=e.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}var a=this._bindingsByRootAndName[t];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(e,t){var r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),iu.prototype.clone=function(){return new iu(void 0===this.value.clone?this.value:this.value.clone())},au.prototype=Object.assign(Object.create(On.prototype),{constructor:au,isInstancedBufferGeometry:!0,copy:function(e){return On.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(ou.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(ou.prototype,{isInterleavedBufferAttribute:!0,setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this},setXYZ:function(e,t,r,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this},setXYZW:function(e,t,r,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=i,this}}),Object.defineProperty(su.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(su.prototype,{isInterleavedBuffer:!0,setArray:function(e){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==e?e.length/this.stride:0,this.array=e},setDynamic:function(e){return this.dynamic=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.dynamic=e.dynamic,this},copyAt:function(e,t,r){e*=this.stride,r*=t.stride;for(var n=0,i=this.stride;n<i;n++)this.array[e+n]=t.array[r+n];return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),uu.prototype=Object.assign(Object.create(su.prototype),{constructor:uu,isInstancedInterleavedBuffer:!0,copy:function(e){return su.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),cu.prototype=Object.assign(Object.create(gn.prototype),{constructor:cu,isInstancedBufferAttribute:!0,copy:function(e){return gn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),Object.assign(lu.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize()):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t){var r=[];return pu(e,this,r,t),r.sort(fu),r},intersectObjects:function(e,t){var r=[];if(!1===Array.isArray(e))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var n=0,i=e.length;n<i;n++)pu(e[n],this,r,t);return r.sort(fu),r}}),Object.assign(hu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),Object.assign(du.prototype,{set:function(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.radius=e.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e.x,e.z),this.phi=Math.acos(Rt.clamp(e.y/this.radius,-1,1))),this}}),Object.assign(mu.prototype,{set:function(e,t,r){return this.radius=e,this.theta=t,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.radius=Math.sqrt(e.x*e.x+e.z*e.z),this.theta=Math.atan2(e.x,e.z),this.y=e.y,this}}),gu.prototype=Object.create(cn.prototype),gu.prototype.constructor=gu,gu.prototype.isImmediateRenderObject=!0,vu.prototype=Object.create(Li.prototype),vu.prototype.constructor=vu,vu.prototype.update=function(){var e=new Ut,t=new Ut,r=new It;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,u=o.faces,c=0,l=0,f=u.length;l<f;l++)for(var p=u[l],h=0,d=p.vertexNormals.length;h<d;h++){var m=s[p[n[h]]],g=p.vertexNormals[h];e.copy(m).applyMatrix4(i),t.copy(g).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),a.setXYZ(c,e.x,e.y,e.z),c+=1,a.setXYZ(c,t.x,t.y,t.z),c+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,_=o.attributes.normal;for(c=0,h=0,d=v.count;h<d;h++)e.set(v.getX(h),v.getY(h),v.getZ(h)).applyMatrix4(i),t.set(_.getX(h),_.getY(h),_.getZ(h)),t.applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),a.setXYZ(c,e.x,e.y,e.z),c+=1,a.setXYZ(c,t.x,t.y,t.z),c+=1}a.needsUpdate=!0}}(),_u.prototype=Object.create(cn.prototype),_u.prototype.constructor=_u,_u.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},_u.prototype.update=function(){var e=new Ut,t=new Ut;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(t.sub(e)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),yu.prototype=Object.create(Li.prototype),yu.prototype.constructor=yu,yu.prototype.updateMatrixWorld=function(){var e=new Ut,t=new Lt,r=new Lt;return function(n){var i=this.bones,a=this.geometry,o=a.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var s=0,u=0;s<i.length;s++){var c=i[s];c.parent&&c.parent.isBone&&(t.multiplyMatrices(r,c.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(u,e.x,e.y,e.z),t.multiplyMatrices(r,c.parent.matrixWorld),e.setFromMatrixPosition(t),o.setXYZ(u+1,e.x,e.y,e.z),u+=2)}a.getAttribute("position").needsUpdate=!0,cn.prototype.updateMatrixWorld.call(this,n)}}(),bu.prototype=Object.create(Wn.prototype),bu.prototype.constructor=bu,bu.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},bu.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},xu.prototype=Object.create(cn.prototype),xu.prototype.constructor=xu,xu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},xu.prototype.update=function(){var e=.5*this.light.width,t=.5*this.light.height,r=this.line.geometry.attributes.position,n=r.array;n[0]=e,n[1]=-t,n[2]=0,n[3]=e,n[4]=t,n[5]=0,n[6]=-e,n[7]=t,n[8]=0,n[9]=-e,n[10]=-t,n[11]=0,n[12]=e,n[13]=-t,n[14]=0,r.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},wu.prototype=Object.create(cn.prototype),wu.prototype.constructor=wu,wu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},wu.prototype.update=function(){var e=new Ut,t=new zr,r=new zr;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");t.copy(this.light.color),r.copy(this.light.groundColor);for(var a=0,o=i.count;a<o;a++){var s=a<o/2?t:r;i.setXYZ(a,s.r,s.g,s.b)}i.needsUpdate=!0}n.lookAt(e.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),$u.prototype=Object.create(Li.prototype),$u.prototype.constructor=$u,Eu.prototype=Object.create(Li.prototype),Eu.prototype.constructor=Eu,Mu.prototype=Object.create(Li.prototype),Mu.prototype.constructor=Mu,Mu.prototype.update=function(){var e=new Ut,t=new Ut,r=new It;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,u=0,c=0,l=s.length;c<l;c++){var f=s[c],p=f.normal;e.copy(o[f.a]).add(o[f.b]).add(o[f.c]).divideScalar(3).applyMatrix4(n),t.copy(p).applyMatrix3(r).normalize().multiplyScalar(this.size).add(e),i.setXYZ(u,e.x,e.y,e.z),u+=1,i.setXYZ(u,t.x,t.y,t.z),u+=1}i.needsUpdate=!0}}(),Tu.prototype=Object.create(cn.prototype),Tu.prototype.constructor=Tu,Tu.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Tu.prototype.update=function(){var e=new Ut,t=new Ut,r=new Ut;return function(){e.setFromMatrixPosition(this.light.matrixWorld),t.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(t,e),this.lightPlane.lookAt(r),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(r),this.targetLine.scale.z=r.length()}}(),Su.prototype=Object.create(Li.prototype),Su.prototype.constructor=Su,Su.prototype.update=function(){var e,t,r=new Ut,n=new ln;function i(i,a,o,s){r.set(a,o,s).unproject(n);var u=t[i];if(void 0!==u)for(var c=e.getAttribute("position"),l=0,f=u.length;l<f;l++)c.setXYZ(u[l],r.x,r.y,r.z)}return function(){e=this.geometry,t=this.pointMap;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-1,-1,-1),i("n2",1,-1,-1),i("n3",-1,1,-1),i("n4",1,1,-1),i("f1",-1,-1,1),i("f2",1,-1,1),i("f3",-1,1,1),i("f4",1,1,1),i("u1",.7,1.1,-1),i("u2",-.7,1.1,-1),i("u3",0,2,-1),i("cf1",-1,0,1),i("cf2",1,0,1),i("cf3",0,-1,1),i("cf4",0,1,1),i("cn1",-1,0,-1),i("cn2",1,0,-1),i("cn3",0,-1,-1),i("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),Au.prototype=Object.create(Li.prototype),Au.prototype.constructor=Au,Au.prototype.update=function(){var e=new Yr;return function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&e.setFromObject(this.object),!e.isEmpty()){var r=e.min,n=e.max,i=this.geometry.attributes.position,a=i.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=r.x,a[4]=n.y,a[5]=n.z,a[6]=r.x,a[7]=r.y,a[8]=n.z,a[9]=n.x,a[10]=r.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=r.z,a[15]=r.x,a[16]=n.y,a[17]=r.z,a[18]=r.x,a[19]=r.y,a[20]=r.z,a[21]=n.x,a[22]=r.y,a[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Au.prototype.setFromObject=function(e){return this.object=e,this.update(),this},zu.prototype=Object.create(Li.prototype),zu.prototype.constructor=zu,zu.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),cn.prototype.updateMatrixWorld.call(this,e))},Ru.prototype=Object.create(Ci.prototype),Ru.prototype.constructor=Ru,Ru.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.lookAt(this.plane.normal),cn.prototype.updateMatrixWorld.call(this,e)},Cu.prototype=Object.create(cn.prototype),Cu.prototype.constructor=Cu,Cu.prototype.setDirection=(Vs=new Ut,function(e){e.y>.99999?this.quaternion.set(0,0,0,1):e.y<-.99999?this.quaternion.set(1,0,0,0):(Vs.set(e.z,0,-e.x).normalize(),Gs=Math.acos(e.y),this.quaternion.setFromAxisAngle(Vs,Gs))}),Cu.prototype.setLength=function(e,t,r){void 0===t&&(t=.2*e),void 0===r&&(r=.2*t),this.line.scale.set(1,Math.max(0,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()},Cu.prototype.setColor=function(e){this.line.material.color.copy(e),this.cone.material.color.copy(e)},Lu.prototype=Object.create(Li.prototype),Lu.prototype.constructor=Lu;var Pu={createMultiMaterialObject:function(e,t){for(var r=new Oi,n=0,i=t.length;n<i;n++)r.add(new Wn(e,t[n]));return r},detach:function(e,t,r){e.applyMatrix(t.matrixWorld),t.remove(e),r.add(e)},attach:function(e,t,r){e.applyMatrix((new Lt).getInverse(r.matrixWorld)),t.remove(e),r.add(e)}};function Uu(e,t,r,n,i,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new pn(e,t,r,i,a,o)}var Iu=0,Ou=1;function Nu(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function ku(e){return void 0===e&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function Du(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ii(e,t)}function Fu(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Mi(e)}function Bu(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ii(e,t)}function Gu(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ui(e)}function Vu(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ui(e)}function Hu(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ui(e)}function ju(e,t,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ut(e,t,r)}function Wu(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new gn(e,t).setDynamic(!0)}function qu(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new vn(e,t)}function Xu(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new _n(e,t)}function Yu(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new yn(e,t)}function Ju(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new bn(e,t)}function Zu(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new xn(e,t)}function Ku(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new wn(e,t)}function Qu(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new $n(e,t)}function ec(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new En(e,t)}function tc(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Mn(e,t)}function rc(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Eo.call(this,e),this.type="catmullrom",this.closed=!0}function nc(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Eo.call(this,e),this.type="catmullrom"}function ic(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Eo.call(this,e),this.type="catmullrom"}function ac(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Lu(e)}function oc(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Au(e,t)}function sc(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Li(new Ba(e.geometry),new Ri({color:void 0!==t?t:16777215}))}function uc(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Li(new Fi(e.geometry),new Ri({color:void 0!==t?t:16777215}))}function cc(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new co(e)}function lc(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new fo(e)}go.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(go.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Object.assign(Oo.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new mn,r=0,n=e.length;r<n;r++){var i=e[r];t.vertices.push(new Ut(i.x,i.y,i.z||0))}return t}}),Object.assign(No.prototype,{fromPoints:function(e){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),rc.prototype=Object.create(Eo.prototype),nc.prototype=Object.create(Eo.prototype),ic.prototype=Object.create(Eo.prototype),Object.assign(ic.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),$u.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},yu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(gs.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),vs.extractUrlBase(e)}}),Object.assign(Ur.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(Yr.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Hn.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Rt,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Rt.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Rt.ceilPowerOfTwo(e)}}),Object.assign(It.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Lt.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){var e;return function(){return void 0===e&&(e=new Ut),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),e.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(e){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(e)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,r,n,i,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,n,r,i,a)}}),Zr.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Pt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(Vn.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(ko.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Aa(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ka(this,e)}}),Object.assign(Ct.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ut.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(kt.prototype,{fromAttribute:function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),mn.prototype.computeTangents=function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},Object.assign(cn.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)}}),Object.defineProperties(cn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ti.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Si.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(go.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),mi.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Do.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(gn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(On.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addDrawCall:function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(On.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(iu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Wr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new zr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===S}}}),Object.defineProperties(Qa.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Gn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(yi.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}}),Object.defineProperties(yi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace."),this.shadowMap.cullFace=e}}}),Object.defineProperties(Qr.prototype,{cullFace:{get:function(){return this.renderReverseSided?v:g},set:function(e){var t=e!==g;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+t+"."),this.renderReverseSided=t}}}),Object.defineProperties(Dt.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.assign(vi.prototype,{getStandingMatrix:function(){console.warn("THREE.WebVRManager: .getStandingMatrix() has been removed.")}}),Object.defineProperties(vi.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ys.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new js).load(e,function(e){t.setBuffer(e)}),this},Zs.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},qs.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};var fc={merge:function(e,t,r){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),t.isMesh&&(t.matrixAutoUpdate&&t.updateMatrix(),n=t.matrix,t=t.geometry),e.merge(t,n,r)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},pc={crossOrigin:void 0,loadTexture:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new mo;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},loadTextureCube:function(e,t,r,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new ho;i.setCrossOrigin(this.crossOrigin);var a=i.load(e,r,void 0,n);return t&&(a.mapping=t),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function hc(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function dc(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}},function(e,t,r){var n=r(61),i=r(62),a=r(63),o=r(64),s=r(65),u=r(66),c=r(67);c.alea=n,c.xor128=i,c.xorwow=a,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var r=new function(e){var t,r=this,n=(t=4022871197,function(e){e=e.toString();for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});r.next=function(){var e=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=e-(r.c=0|e)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(e),r.s0<0&&(r.s0+=1),r.s1-=n(e),r.s1<0&&(r.s1+=1),r.s2-=n(e),r.s2<0&&(r.s2+=1),n=null}(e),n=t&&t.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+1.1102230246251565e-16*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.alea=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var r=new function(e){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),t.next()}(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xor128=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var r=new function(e){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),n==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xorwow=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var r=new function(e){var t=this;t.next=function(){var e,r,n=t.x,i=t.i;return e=n[i],r=(e^=e>>>7)^e<<24,r^=(e=n[i+1&7])^e>>>10,r^=(e=n[i+3&7])^e>>>3,r^=(e=n[i+4&7])^e<<7,e=n[i+7&7],r^=(e^=e<<13)^e<<9,n[i]=r,t.i=i+1&7,r},function(e,t){var r,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,r=0;r<t.length;++r)n[7&r]=n[7&r]<<15^t.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],e.x=n,e.i=0,r=256;r>0;--r)e.next()}(t,e)}(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.x&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xorshift7=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var r=new function(e){var t=this;t.next=function(){var e,r,n=t.w,i=t.X,a=t.i;return t.w=n=n+1640531527|0,r=i[a+34&127],e=i[a=a+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,r=i[a]=r^e,t.i=a,r+(n^n>>>16)|0},function(e,t){var r,n,i,a,o,s=[],u=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,u=Math.max(u,t.length)),i=0,a=-32;a<u;++a)t&&(n^=t.charCodeAt((a+32)%t.length)),0===a&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,a>=0&&(o=o+1640531527|0,i=0==(r=s[127&a]^=n+o)?i+1:0);for(i>=128&&(s[127&(t&&t.length||0)]=-1),i=127,a=512;a>0;--a)n=s[i+34&127],r=s[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,s[i]=n^r;e.w=o,e.X=s,e.i=i}(t,e)}(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&(n.X&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.xor4096=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){(function(e){var n;!function(e,i,a){function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var r=new function(e){var t=this,r="";t.next=function(){var e=t.b,r=t.c,n=t.d,i=t.a;return e=e<<25^e>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^r,t.c=r=r-n|0,t.d=n<<16^r>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):r+=e;for(var n=0;n<r.length+20;n++)t.b^=0|r.charCodeAt(n),t.next()}(e),n=t&&t.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&o(n,r),i.state=function(){return o(r,{})}),i}i&&i.exports?i.exports=s:r(3)&&r(15)?void 0===(n=function(){return s}.call(t,r,t,i))||(i.exports=n):this.tychei=s}(0,"object"==typeof e&&e,r(3))}).call(t,r(14)(e))},function(e,t,r){var n;!function(i,a){var o,s=this,u=256,c=6,l="random",f=a.pow(u,c),p=a.pow(2,52),h=2*p,d=u-1;function m(e,t,r){var n=[],m=v(function e(t,r){var n,i=[],a=typeof t;if(r&&"object"==a)for(n in t)try{i.push(e(t[n],r-1))}catch(e){}return i.length?i:"string"==a?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,_(i)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),_(e)}catch(e){var t=s.navigator,r=t&&t.plugins;return[+new Date,s,r,s.screen,_(i)]}}():e,3),n),y=new function(e){var t,r=e.length,n=this,i=0,a=n.i=n.j=0,o=n.S=[];r||(e=[r++]);for(;i<u;)o[i]=i++;for(i=0;i<u;i++)o[i]=o[a=d&a+e[i%r]+(t=o[i])],o[a]=t;(n.g=function(e){for(var t,r=0,i=n.i,a=n.j,o=n.S;e--;)t=o[i=d&i+1],r=r*u+o[d&(o[i]=o[a=d&a+t])+(o[a]=t)];return n.i=i,n.j=a,r})(u)}(n),b=function(){for(var e=y.g(c),t=f,r=0;e<p;)e=(e+r)*u,t*=u,r=y.g(1);for(;e>=h;)e/=2,t/=2,r>>>=1;return(e+r)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(_(y.S),i),(t.pass||r||function(e,t,r,n){return n&&(n.S&&g(n,y),e.state=function(){return g(y,{})}),r?(a[l]=e,t):e})(b,m,"global"in t?t.global:this==a,t.state)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var r,n=e+"",i=0;i<n.length;)t[d&i]=d&(r^=19*t[d&i])+n.charCodeAt(i++);return _(t)}function _(e){return String.fromCharCode.apply(0,e)}if(a["seed"+l]=m,v(a.random(),i),"object"==typeof e&&e.exports){e.exports=m;try{o=r(68)}catch(e){}}else void 0===(n=function(){return m}.call(t,r,t,e))||(e.exports=n)}([],Math)},function(e,t){},function(e,t,r){"use strict";var n=r(70);t.createReset=function(e){return console.log(e),n(e)}},function(e,t){e.exports=function(e){var t=e.getParameter(e.MAX_VERTEX_ATTRIBS),r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r);for(var n=0;n<t;++n)e.disableVertexAttribArray(n),e.vertexAttribPointer(n,4,e.FLOAT,!1,0,0),e.vertexAttrib1f(n,0);e.deleteBuffer(r);for(var i=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),n=0;n<i;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.bindTexture(e.TEXTURE_2D,null);return e.activeTexture(e.TEXTURE0),e.useProgram(null),e.bindBuffer(e.ARRAY_BUFFER,null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindRenderbuffer(e.RENDERBUFFER,null),e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.DITHER),e.disable(e.SCISSOR_TEST),e.blendColor(0,0,0,0),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.clearColor(0,0,0,0),e.clearDepth(1),e.clearStencil(-1),e.colorMask(!0,!0,!0,!0),e.cullFace(e.BACK),e.depthFunc(e.LESS),e.depthMask(!0),e.depthRange(0,1),e.frontFace(e.CCW),e.hint(e.GENERATE_MIPMAP_HINT,e.DONT_CARE),e.lineWidth(1),e.pixelStorei(e.PACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_ALIGNMENT,4),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.polygonOffset(0,0),e.sampleCoverage(1,!1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilMask(4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e}},function(e,t,r){"use strict";var n=r(26),i=r(2).create("Memoize-Rts.Bug");t.Bug=i,t.setMemoizeId=function(e){if(null==e.memoizeId){var t,r=n.$$window.memoizeId;if(null==r)throw i;return t=r+1|0,console.log(["id",t]),e.memoizeId=t,n.$$window.memoizeId=t,0}return 0}},function(e,t,r){"use strict";var n=r(5),i=r(40),a=r(84),o=r(26),s=r(19),u=[0],c=r(2).create("ConfigUI-Rts.DatGuiNotInitialized"),l={};function f(e){var t=function(r){var n,i=s.js2(159043596,1,e,r),a=l[i];if(void 0!==a)return a;if(r){n=t(r[1]).addFolder(r[0])}else{var o=u[0];if(!o)throw c;n=o[0]}return l[i]=n,n};return t(n.tl(n.rev(s.js1(-900602459,2,e))))}function p(e){var t={},r=n.hd(n.rev(s.js1(-900602459,3,e)));return t[r]=s.js2(5144726,4,e,0),[r,f(e),t]}function h(){var e=function(e,t){return s.js2(5741474,5,e,t)};return i.addCreateVarCallBack(function(t){return o.onReady(function(){var r;switch(0|t.tag){case 0:var n,i=t[0],a=s.js1(-652757518,6,i);if(a){var o=a[0];n=o.tag?[[-828482075,o[0]]]:[[-943830454,o[0]]]}else n=0;var u=p(i),c=u[2],l=[-29044833,function(t){return e(i,t)}];r=[u[1].add(c,u[0],n?n[0][1]:void 0),l];break;case 1:var f,h=t[0],d=s.js1(-652757518,7,h);if(d){var m=d[0];f=m.tag?[[393554194,m[0]]]:[[987317885,m[0]]]}else f=0;var g=p(h),v=g[2];r=[g[1].add(v,g[0],f?f[0][1]:void 0),[-1027178484,function(t){return e(h,t)}]];break;case 2:var _,y=t[0],b=s.js1(-652757518,8,y);if(b){var x=b[0];_=x.tag?[[-350818553,x[0]]]:[[348436200,x[0]]]}else _=0;var w=p(y),$=w[2],E=[383610177,function(t){return e(y,t)}];r=[w[1].add($,w[0],_?_[0][1]:void 0),E];break;case 3:var M=t[0],T=p(M),S=[-707937517,function(t){return e(M,t)}];r=[T[1].addColor(T[2],T[0]),S]}return r[0].onChange(r[1][1]),0})})}t.dg=u,t.DatGuiNotInitialized=c,t.uiFolders=l,t.createFolders=f,t.getNameFolderAndStorageObject=p,t.registerCreateHandlers=h,t.init=function(){h();var e=a.create(0);return u[0]=[e],0},t.destroy=function(){var e=u[0];return e?(e[0].destroy(),0):0}},function(e,t,r){"use strict";var n=r(74),i=r(5),a=r(21),o=r(0),s=r(41),u=r(12),c=r(11),l=r(8),f=r(76),p=r(9),h=r(81),d=r(2),m=r(1);function g(e){for(var t=0,r=0,n=e.length-1|0;r<=n;++r)t=l.imul(223,t)+p.get(e,r)|0;return(t&=2147483647)>1073741823?t- -2147483648|0:t}var v=[0,[0],h.empty,f.empty,0,0,h.empty,0],_=[0],y=[];function b(e){_[0]=_[0]+1|0;var t=e.length,r=c.caml_make_vect(2+(t<<1)|0,y);c.caml_array_set(r,0,t),c.caml_array_set(r,1,((function e(t){return t<=2?t:e((t+1|0)/2|0)<<1}(t)<<5)/8|0)-1|0);for(var n=0,i=t-1|0;n<=i;++n)c.caml_array_set(r,3+(n<<1)|0,c.caml_array_get(e,n));return[2,r,h.empty,f.empty,0,0,h.empty,0]}function x(e,t){var r=e[1].length;if(t>r){var n=c.caml_make_vect(t,y);return a.blit(e[1],0,n,0,r),e[1]=n,0}return 0}var w=[0],$=[0];function E(e){var t=e[1].length;return x(e,t+1|0),t}function M(e,t){var r=h.getUndefined(e[2],t);if(void 0!==r)return r;var n=E(e);return e[2]=h.set(e[2],t,n),e[3]=f.set(e[3],n,1),n}function T(e,t,r){if(w[0]=w[0]+1|0,f.getExn(e[3],t)){var n=e,i=t,a=r;return x(n,i+1|0),c.caml_array_set(n[1],i,a)}return e[5]=[[t,r],e[5]],0}function S(e,t){try{return i.assoc(t,e[5])}catch(r){if(r===m.not_found)return c.caml_array_get(e[1],t);throw r}}function A(e){return e?a.to_list(e):0}function z(e,t,r,n){var a=A(t),o=A(r),s=A(n),u=i.map(function(t){return M(e,t)},o),c=i.map(function(t){return M(e,t)},s);e[4]=[[e[2],e[3],e[5],e[6],u,a],e[4]],e[6]=h.reduceU(e[6],h.empty,function(e,t,r){return i.mem(t,a)?h.set(e,t,r):e});var l=[h.empty],p=[f.empty];return i.iter2(function(t,r){return l[0]=h.set(l[0],t,r),p[0]=f.set(p[0],r,f.getWithDefault(e[3],r,1)),0},s,c),i.iter2(function(e,t){return l[0]=h.set(l[0],e,t),p[0]=f.set(p[0],t,0),0},o,u),e[2]=l[0],e[3]=p[0],e[5]=i.fold_right(function(e,t){return i.mem(e[0],u)?t:[e,t]},e[5],0),0}function R(e){var t=i.hd(e[4]),r=t[4];return e[4]=i.tl(e[4]),e[6]=i.fold_left(function(t,r){return h.set(t,r,h.getExn(e[6],r))},t[3],t[5]),e[2]=t[0],e[3]=t[1],e[5]=i.fold_right(function(e,t){return i.mem(e[0],r)?t:[e,t]},e[5],t[2]),0}function C(e,t){var r=h.getUndefined(e[6],t);if(void 0!==r)return r;var n=function(e){var t=e[0];return e[0]=t+1|0,t}(e);return""!==t&&(e[6]=h.set(e[6],t,n)),n}function L(e){return u.caml_equal(e,0)?[]:e}function P(e){if(e){var t=b(a.map(g,e));return a.iteri(function(e,r){var n=2+(e<<1)|0;return t[2]=h.set(t[2],r,n),t[3]=f.set(t[3],n,1),0},e),t}return b([])}function U(e){return $[0]=($[0]+e[0]|0)-1|0,e[7]=i.rev(e[7]),x(e,3+((c.caml_array_get(e[1],1)<<4)/32|0)|0)}function I(e){var t=u.caml_obj_block(n.object_tag,e[0]);return t[0]=e[1],d.caml_set_oo_id(t)}function O(e,t){for(;;){var r=t;if(!r)return 0;o._1(r[0],e),t=r[1]}}function N(e,t){var r=t[7];return 0!==r?O(e,r):0}function k(e,t,r){for(var n=[0,0,0],i=n,a=0;a<=e;++a)i=[c.caml_array_get(t,a),i,0];return r[1]=i,n}function D(e){var t=E(e),r=t%2==0||t>(2+((c.caml_array_get(e[1],1)<<4)/32|0)|0)?t:E(e);return c.caml_array_set(e[1],r,0),r}function F(e,t,r){var n=function(){return t[0]=t[0]+1|0,c.caml_array_get(r,t[0])},i=n();if("number"!=typeof i)return i;switch(i){case 0:var a=n();return function(){return a};case 1:var u=n();return function(e){return e[u]};case 2:var l=n(),f=n();return function(e){return e[l][f]};case 3:var p=n();return function(e){return o._1(e[0][p],e)};case 4:var h=n();return function(e,t){return e[h]=t,0};case 5:var d=n(),m=n();return function(){return o._1(d,m)};case 6:var g=n(),v=n();return function(e){return o._1(g,e[v])};case 7:var _=n(),y=n(),b=n();return function(e){return o._1(_,e[y][b])};case 8:var x=n(),w=n();return function(e){return o._1(x,o._1(e[0][w],e))};case 9:var $=n(),E=n(),M=n();return function(){return o._2($,E,M)};case 10:var T=n(),S=n(),A=n();return function(e){return o._2(T,S,e[A])};case 11:var z=n(),R=n(),C=n(),L=n();return function(e){return o._2(z,R,e[C][L])};case 12:var P=n(),U=n(),I=n();return function(e){return o._2(P,U,o._1(e[0][I],e))};case 13:var O=n(),N=n(),k=n();return function(e){return o._2(O,e[N],k)};case 14:var F=n(),B=n(),G=n(),V=n();return function(e){return o._2(F,e[B][G],V)};case 15:var H=n(),j=n(),W=n();return function(e){return o._2(H,o._1(e[0][j],e),W)};case 16:var q=n(),X=n();return function(e){return o._2(e[0][q],e,X)};case 17:var Y=n(),J=n();return function(e){return o._2(e[0][Y],e,e[J])};case 18:var Z=n(),K=n(),Q=n();return function(e){return o._2(e[0][Z],e,e[K][Q])};case 19:var ee=n(),te=n();return function(e){return o._2(e[0][ee],e,o._1(e[0][te],e))};case 20:var re=n(),ne=n();return D(e),function(){return o._1(o._3(s.caml_get_public_method,ne,re,1),ne)};case 21:var ie=n(),ae=n();return D(e),function(e){var t=e[ae];return o._1(o._3(s.caml_get_public_method,t,ie,2),t)};case 22:var oe=n(),se=n(),ue=n();return D(e),function(e){var t=e[se][ue];return o._1(o._3(s.caml_get_public_method,t,oe,3),t)};case 23:var ce=n(),le=n();return D(e),function(e){var t=o._1(e[0][le],e);return o._1(o._3(s.caml_get_public_method,t,ce,4),t)}}}t.public_method_label=g,t.new_method=E,t.new_variable=C,t.new_methods_variables=function(e,t,r){for(var n=L(t),i=n.length,a=r.length,o=c.caml_make_vect(i+a|0,0),s=0,u=i-1|0;s<=u;++s)c.caml_array_set(o,s,M(e,c.caml_array_get(n,s)));for(var l=0,f=a-1|0;l<=f;++l)c.caml_array_set(o,l+i|0,C(e,c.caml_array_get(r,l)));return o},t.get_variable=function(e,t){return h.getExn(e[6],t)},t.get_variables=function(e,t){return a.map(function(t){return h.getExn(e[6],t)},t)},t.get_method_label=M,t.get_method_labels=function(e,t){return a.map(function(t){return M(e,t)},t)},t.get_method=S,t.set_method=T,t.set_methods=function(e,t){for(var r=t.length,n=[0];n[0]<r;)T(e,c.caml_array_get(t,n[0]),F(e,n,t)),n[0]=n[0]+1|0;return 0},t.narrow=z,t.widen=R,t.add_initializer=function(e,t){return e[7]=[t,e[7]],0},t.dummy_table=v,t.create_table=P,t.init_class=U,t.inherits=function(e,t,r,n,i,s){var u=i[1];z(e,t,r,n);var l=s?o._2(u,e,i[3]):o._1(u,e);return R(e),c.caml_array_concat([[l],[a.map(function(t){return h.getExn(e[6],t)},L(t)),[a.map(function(t){return S(e,M(e,t))},L(n)),0]]])},t.make_class=function(e,t){var r=P(e),n=o._1(t,r);return U(r),[o._1(n,0),t,n,0]},t.make_class_store=function(e,t,r){var n=P(e),i=o._1(t,n);return U(n),r[1]=t,r[0]=i,0},t.copy=function(e){return d.caml_set_oo_id(u.caml_obj_dup(e))},t.create_object=I,t.create_object_opt=function(e,t){if(e)return e;var r=u.caml_obj_block(n.object_tag,t[0]);return r[0]=t[1],d.caml_set_oo_id(r)},t.run_initializers=N,t.run_initializers_opt=function(e,t,r){if(e)return t;var n=r[7];return 0!==n&&O(t,n),t},t.create_object_and_run_initializers=function(e,t){if(e)return e;var r=I(t);return N(r,t),r},t.lookup_tables=function(e,t){return 0!==e[1]?function e(t,r,n){if(t<0)return n;for(var i=c.caml_array_get(r,t),a=n;;){var o=a;if(o[0]===i)return e(t-1|0,r,o[1]);if(0===o[2]){var s=[i,0,0];return o[2]=s,k(t-1|0,r,s)}a=o[2]}}(t.length-1|0,t,e[1]):k(t.length-1|0,t,e)},t.params=[1,1,1,3,16],t.stats=function(){return[_[0],w[0],$[0]]}},function(e,t,r){"use strict";var n=r(75),i=r(11),a=r(25),o=r(1),s=i.caml_array_get,u=i.caml_array_set;function c(e){var t=void 0!==e.length&&248!=(0|e.tag)&&e.length>=1?e[0]:e;if(void 0===t.length||248!==t.tag)throw o.not_found;if(252===t[0].tag)return t;throw o.not_found}t.double_field=s,t.set_double_field=u,t.first_non_constant_constructor_tag=0,t.last_non_constant_constructor_tag=245,t.lazy_tag=246,t.closure_tag=247,t.object_tag=248,t.infix_tag=249,t.forward_tag=250,t.no_scan_tag=251,t.abstract_tag=251,t.string_tag=252,t.double_tag=253,t.double_array_tag=254,t.custom_tag=255,t.final_tag=255,t.int_tag=1e3,t.out_of_heap_tag=1001,t.unaligned_tag=1002,t.extension_name=function(e){try{return c(e)[0]}catch(e){throw e===o.not_found?[o.invalid_argument,"Obj.extension_name"]:e}},t.extension_id=function(e){try{return c(e)[1]}catch(e){throw e===o.not_found?[o.invalid_argument,"Obj.extension_id"]:e}},t.extension_slot=function(e){try{return c(e)}catch(e){throw e===o.not_found?[o.invalid_argument,"Obj.extension_slot"]:e}},t.marshal=function(){return a.not_implemented("caml_output_value_to_string not implemented by bucklescript yet\n")},t.unmarshal=function(e,t){return[n.from_bytes(e,t),t+n.total_size(e,t)|0]}},function(e,t,r){"use strict";var n=r(9),i=r(25),a=r(1);function o(e,t){if(t<0||t>(e.length-20|0))throw[a.invalid_argument,"Marshal.data_size"];return i.not_implemented("caml_marshal_data_size not implemented by bucklescript yet\n")}function s(e,t){if(t<0||t>(e.length-20|0))throw[a.invalid_argument,"Marshal.from_bytes"];var r=i.not_implemented("caml_marshal_data_size not implemented by bucklescript yet\n");if(t>(e.length-(20+r|0)|0))throw[a.invalid_argument,"Marshal.from_bytes"];return i.not_implemented("caml_input_value_from_string not implemented by bucklescript yet\n")}t.to_channel=function(e,t,r){return i.not_implemented("caml_output_value not implemented by bucklescript yet\n")},t.to_buffer=function(e,t,r,n,o){if(t<0||r<0||t>(e.length-r|0))throw[a.invalid_argument,"Marshal.to_buffer: substring out of bounds"];return i.not_implemented("caml_output_value_to_buffer not implemented by bucklescript yet\n")},t.from_channel=function(){return i.not_implemented("caml_input_value not implemented by bucklescript yet\n")},t.from_bytes=s,t.from_string=function(e,t){return s(n.bytes_of_string(e),t)},t.header_size=20,t.data_size=o,t.total_size=function(e,t){return 20+o(e,t)|0}},function(e,t,r){"use strict";var n=r(0),i=r(77),a=r(22);function o(e,t,r){if(null!==e){var n=e.key;if(t===n)return a.updateValue(e,r);var i=e.value;return t<n?a.bal(o(e.left,t,r),n,i,e.right):a.bal(e.left,n,i,o(e.right,t,r))}return a.singleton(t,r)}function s(e,t,r){if(null!==e){var n=e.key;if(t===n){var i=r([e.value]);if(i)return a.updateValue(e,i[0]);var o=e.left,u=e.right;if(null!==o){if(null!==u){var c=[u.key],l=[u.value],f=a.removeMinAuxWithRef(u,c,l);return a.bal(o,c[0],l[0],f)}return o}return u}var p=e.left,h=e.right,d=e.value;if(t<n){var m=s(p,t,r);return p===m?e:a.bal(m,n,d,h)}var g=s(h,t,r);return h===g?e:a.bal(p,n,d,g)}var v=r(0);return v?a.singleton(t,v[0]):e}function u(e,t){var r=e.left,n=e.key,i=e.right;if(t===n){if(null!==r){if(null!==i){var o=[i.key],s=[i.value],c=a.removeMinAuxWithRef(i,o,s);return a.bal(r,o[0],s[0],c)}return r}return i}if(t<n){if(null!==r){var l=u(r,t);return l===r?e:a.bal(l,n,e.value,i)}return e}if(null!==i){var f=u(i,t);return a.bal(r,n,e.value,f)}return e}var c=a.empty,l=a.isEmpty,f=i.has,p=i.cmpU,h=i.cmp,d=i.eqU,m=i.eq,g=a.forEachU,v=a.forEach,_=a.reduceU,y=a.reduce,b=a.everyU,x=a.every,w=a.someU,$=a.some,E=a.size,M=a.toList,T=a.toArray,S=i.ofArray,A=a.keysToArray,z=a.valuesToArray,R=a.minKey,C=a.minKeyUndefined,L=a.maxKey,P=a.maxKeyUndefined,U=a.minimum,I=a.minUndefined,O=a.maximum,N=a.maxUndefined,k=i.get,D=i.getUndefined,F=i.getWithDefault,B=i.getExn,G=i.mergeU,V=i.merge,H=a.keepSharedU,j=a.keepShared,W=a.partitionSharedU,q=a.partitionShared,X=i.split,Y=a.mapU,J=a.map,Z=a.mapWithKeyU,K=a.mapWithKey,Q=a.checkInvariantInternal;t.empty=c,t.isEmpty=l,t.has=f,t.cmpU=p,t.cmp=h,t.eqU=d,t.eq=m,t.forEachU=g,t.forEach=v,t.reduceU=_,t.reduce=y,t.everyU=b,t.every=x,t.someU=w,t.some=$,t.size=E,t.toList=M,t.toArray=T,t.ofArray=S,t.keysToArray=A,t.valuesToArray=z,t.minKey=R,t.minKeyUndefined=C,t.maxKey=L,t.maxKeyUndefined=P,t.minimum=U,t.minUndefined=I,t.maximum=O,t.maxUndefined=N,t.get=k,t.getUndefined=D,t.getWithDefault=F,t.getExn=B,t.remove=function(e,t){return null!==e?u(e,t):a.empty},t.removeMany=function(e,t){var r=t.length;if(null===e)return a.empty;for(var n=e,i=t,o=0,s=r;;){var c=o,l=n;if(c<s){var f=u(l,i[c]);if(null!==f){o=c+1|0,n=f;continue}return f}return l}},t.set=o,t.updateU=s,t.update=function(e,t,r){return s(e,t,n.__1(r))},t.mergeArray=function(e,t){for(var r=e,n=0,i=t.length-1|0;n<=i;++n){var a=t[n];r=o(r,a[0],a[1])}return r},t.mergeU=G,t.merge=V,t.keepU=H,t.keep=j,t.partitionU=W,t.partition=q,t.split=X,t.mapU=Y,t.map=J,t.mapWithKeyU=Z,t.mapWithKey=K,t.checkInvariantInternal=Q},function(e,t,r){"use strict";var n=r(0),i=r(27),a=r(6),o=r(22);function s(e,t){var r=t.left,n=t.key,i=t.value,a=t.right;if(e===n)return[r,[i],a];if(e<n){if(null!==r){var u=s(e,r);return[u[0],u[1],o.join(u[2],n,i,a)]}return[o.empty,0,t]}if(null!==a){var c=s(e,a);return[o.join(r,n,i,c[0]),c[1],c[2]]}return[t,0,o.empty]}function u(e,t){return null!==t?s(e,t):[o.empty,0,o.empty]}function c(e,t,r){var n=0;if(null!==e){if(e.h>=(null!==t?t.h:0)){var i=e.left,a=e.key,s=e.value,l=e.right,f=u(a,t);return o.concatOrJoin(c(i,f[0],r),a,r(a,[s],f[1]),c(l,f[2],r))}n=1}else{if(null===t)return o.empty;n=1}if(1===n){if(null!==t){var p=t.left,h=t.key,d=t.value,m=t.right,g=u(h,e);return o.concatOrJoin(c(g[0],p,r),h,r(h,g[1],[d]),c(g[2],m,r))}return 0}}function l(e,t,r){for(;;){var n=t,i=e;if(i){if(n){var s=n[0],u=i[0],c=a.caml_int_compare(u.key,s.key);if(c)return c;var l=r(u.value,s.value);if(l)return l;t=o.stackAllLeft(s.right,n[1]),e=o.stackAllLeft(u.right,i[1]);continue}return 0}return 0}}function f(e,t,r){var n=o.size(e),i=o.size(t);return n===i?l(o.stackAllLeft(e,0),o.stackAllLeft(t,0),r):n<i?-1:1}function p(e,t,r){for(;;){var n=t,i=e;if(i){if(n){var a=n[0],s=i[0];if(s.key===a.key&&r(s.value,a.value)){t=o.stackAllLeft(a.right,n[1]),e=o.stackAllLeft(s.right,i[1]);continue}return 0}return 1}return 1}}function h(e,t,r){return o.size(e)===o.size(t)?p(o.stackAllLeft(e,0),o.stackAllLeft(t,0),r):0}function d(e,t,r){if(null!==e){var n=e.key;if(t===n)return e.key=t,e.value=r,e;var i=e.left,a=e.right;if(t<n){var s=d(i,t,r);e.left=s}else e.right=d(a,t,r);return o.balMutate(e)}return o.singleton(t,r)}t.N=0,t.A=0,t.S=0,t.add=function e(t,r,n){if(null!==t){var i=t.key;if(r===i)return o.updateValue(t,n);var a=t.value;return r<i?o.bal(e(t.left,r,n),i,a,t.right):o.bal(t.left,i,a,e(t.right,r,n))}return o.singleton(r,n)},t.get=function(e,t){for(;;){var r=e;if(null===r)return 0;var n=r.key;if(t===n)return[r.value];e=t<n?r.left:r.right}},t.getUndefined=function(e,t){for(;;){var r=e;if(null===r)return;var n=r.key;if(t===n)return r.value;e=t<n?r.left:r.right}},t.getExn=function(e,t){for(;;){var r=e;if(null===r)throw new Error("getExn");var n=r.key;if(t===n)return r.value;e=t<n?r.left:r.right}},t.getWithDefault=function(e,t,r){for(;;){var n=e;if(null===n)return r;var i=n.key;if(t===i)return n.value;e=t<i?n.left:n.right}},t.has=function(e,t){for(;;){var r=e;if(null===r)return 0;var n=r.key;if(t===n)return 1;e=t<n?r.left:r.right}},t.remove=function e(t,r){if(null!==t){var n=t.left,i=t.key,a=t.right;if(r===i){if(null!==n){if(null!==a){var s=[a.key],u=[a.value],c=o.removeMinAuxWithRef(a,s,u);return o.bal(n,s[0],u[0],c)}return n}return a}return r<i?o.bal(e(n,r),i,t.value,a):o.bal(n,i,t.value,e(a,r))}return t},t.splitAux=s,t.split=u,t.mergeU=c,t.merge=function(e,t,r){return c(e,t,n.__3(r))},t.compareAux=l,t.cmpU=f,t.cmp=function(e,t,r){return f(e,t,n.__2(r))},t.eqAux=p,t.eqU=h,t.eq=function(e,t,r){return h(e,t,n.__2(r))},t.addMutate=d,t.ofArray=function(e){var t=e.length;if(t){var r,n=i.strictlySortedLengthU(e,function(e,t){return+(e[0]<t[0])});n>=0?r=o.ofSortedArrayAux(e,0,n):(n=0|-n,r=o.ofSortedArrayRevAux(e,n-1|0,n));for(var a=n,s=t-1|0;a<=s;++a){var u=e[a];r=d(r,u[0],u[1])}return r}return o.empty}},function(e,t,r){"use strict";var n=r(0),i=r(79),a=r(6);function o(e){for(var t=e.length,r=new Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e[n];return r}function s(e,t,r){var n=e[t];return e[t]=e[r],e[r]=n,0}function u(e){for(var t=e.length,r=0,n=t-1|0;r<=n;++r)s(e,r,i.random_int(r,t));return 0}function c(e,t){if(e<=0)return[];for(var r=new Array(e),n=0,i=e-1|0;n<=i;++n)r[n]=t(n);return r}function l(e,t){var r=c(e,t);return u(r),r}function f(e,t,r){for(var n=e.length,i=t.length,a=n<i?n:i,o=new Array(a),s=0,u=a-1|0;s<=u;++s)o[s]=r(e[s],t[s]);return o}function p(e,t){for(var r=0,n=e.length-1|0;r<=n;++r)t(e[r]);return 0}function h(e,t){for(var r=e.length,n=new Array(r),i=0,a=r-1|0;i<=a;++i)n[i]=t(e[i]);return n}function d(e,t){for(var r=e.length,n=new Array(r),i=0,a=0,o=r-1|0;a<=o;++a){var s=e[a];t(s)&&(n[i]=s,i=i+1|0)}return n.length=i,n}function m(e,t){for(var r=e.length,n=new Array(r),i=0,a=0,o=r-1|0;a<=o;++a){var s=t(e[a]);s&&(n[i]=s[0],i=i+1|0)}return n.length=i,n}function g(e,t){for(var r=0,n=e.length-1|0;r<=n;++r)t(r,e[r]);return 0}function v(e,t){for(var r=e.length,n=new Array(r),i=0,a=r-1|0;i<=a;++i)n[i]=t(i,e[i]);return n}function _(e,t,r){for(var n=t,i=0,a=e.length-1|0;i<=a;++i)n=r(n,e[i]);return n}function y(e,t,r){for(var n=t,i=e.length-1|0;i>=0;--i)n=r(n,e[i]);return n}function b(e,t,r,n){for(var i=r,o=a.caml_int_min(e.length,t.length)-1|0;o>=0;--o)i=n(i,e[o],t[o]);return i}function x(e,t){for(var r=e,n=0,i=t,a=e.length;;){var o=n;if(o===a)return 1;if(!i(r[o]))return 0;n=o+1|0}}function w(e,t){for(var r=e,n=0,i=t,a=e.length;;){var o=n;if(o===a)return 0;if(i(r[o]))return 1;n=o+1|0}}function $(e,t,r,n,i){for(;;){var a=r;if(a===i)return 1;if(!n(e[a],t[a]))return 0;r=a+1|0}}function E(e,t,r){return $(e,t,0,r,a.caml_int_min(e.length,t.length))}function M(e,t,r){for(var n=e,i=t,o=0,s=r,u=a.caml_int_min(e.length,t.length);;){var c=o;if(c===u)return 0;if(s(n[c],i[c]))return 1;o=c+1|0}}function T(e,t,r){var n=e.length;return n===t.length?$(e,t,0,r,n):0}function S(e,t,r){var n=e.length,i=t.length;if(n>i)return 1;if(n<i)return-1;for(var a=e,o=t,s=0,u=r,c=n;;){var l=s;if(l===c)return 0;var f=u(a[l],o[l]);if(f)return f;s=l+1|0}}t.get=function(e,t){return t>=0&&t<e.length?[e[t]]:0},t.getExn=function(e,t){if(!(t>=0&&t<e.length))throw new Error('File "belt_Array.ml", line 25, characters 6-12');return e[t]},t.set=function(e,t,r){return t>=0&&t<e.length?(e[t]=r,1):0},t.setExn=function(e,t,r){if(!(t>=0&&t<e.length))throw new Error('File "belt_Array.ml", line 31, characters 4-10');return e[t]=r,0},t.shuffleInPlace=u,t.shuffle=function(e){var t=o(e);return u(t),t},t.reverseInPlace=function(e){for(var t=e,r=e.length,n=0,i=(r/2|0)-1|0;n<=i;++n)s(t,0+n|0,((0+r|0)-n|0)-1|0);return 0},t.reverse=function(e){for(var t=e.length,r=new Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=e[(t-1|0)-n|0];return r},t.make=function(e,t){if(e<=0)return[];for(var r=new Array(e),n=0,i=e-1|0;n<=i;++n)r[n]=t;return r},t.range=function(e,t){var r=t-e|0;if(r<0)return[];for(var n=new Array(r+1|0),i=0;i<=r;++i)n[i]=e+i|0;return n},t.rangeBy=function(e,t,r){var n=t-e|0;if(n<0||r<=0)return[];for(var i=1+(n/r|0)|0,a=new Array(i),o=e,s=0,u=i-1|0;s<=u;++s)a[s]=o,o=o+r|0;return a},t.makeByU=c,t.makeBy=function(e,t){return c(e,n.__1(t))},t.makeByAndShuffleU=l,t.makeByAndShuffle=function(e,t){return l(e,n.__1(t))},t.zip=function(e,t){for(var r=e.length,n=t.length,i=r<n?r:n,a=new Array(i),o=0,s=i-1|0;o<=s;++o)a[o]=[e[o],t[o]];return a},t.zipByU=f,t.zipBy=function(e,t,r){return f(e,t,n.__2(r))},t.concat=function(e,t){for(var r=e.length,n=t.length,i=new Array(r+n|0),a=0,o=r-1|0;a<=o;++a)i[a]=e[a];for(var s=0,u=n-1|0;s<=u;++s)i[r+s|0]=t[s];return i},t.concatMany=function(e){for(var t=e.length,r=0,n=0,i=t-1|0;n<=i;++n)r=r+e[n].length|0;var a=new Array(r);r=0;for(var o=0,s=t-1|0;o<=s;++o)for(var u=e[o],c=0,l=u.length-1|0;c<=l;++c)a[r]=u[c],r=r+1|0;return a},t.slice=function(e,t,r){if(r<=0)return[];var n=e.length,i=t<0?a.caml_int_max(n+t|0,0):t,o=n-i|0,s=o<r?o:r;if(s<=0)return[];for(var u=new Array(s),c=0,l=s-1|0;c<=l;++c)u[c]=e[i+c|0];return u},t.copy=o,t.fill=function(e,t,r,n){if(r>0){var i=e.length,o=t<0?a.caml_int_max(i+t|0,0):t,s=i-o|0,u=s<r?s:r;if(u>0){for(var c=o,l=(o+u|0)-1|0;c<=l;++c)e[c]=n;return 0}return 0}return 0},t.blit=function(e,t,r,n,i){var o=e.length,s=r.length,u=t<0?a.caml_int_max(o+t|0,0):t,c=n<0?a.caml_int_max(s+n|0,0):n,l=a.caml_int_min(i,a.caml_int_min(o-u|0,s-c|0));if(c<=u){for(var f=0,p=l-1|0;f<=p;++f)r[f+c|0]=e[f+u|0];return 0}for(var h=l-1|0;h>=0;--h)r[h+c|0]=e[h+u|0];return 0},t.blitUnsafe=function(e,t,r,n,i){if(n<=t){for(var a=0,o=i-1|0;a<=o;++a)r[a+n|0]=e[a+t|0];return 0}for(var s=i-1|0;s>=0;--s)r[s+n|0]=e[s+t|0];return 0},t.forEachU=p,t.forEach=function(e,t){return p(e,n.__1(t))},t.mapU=h,t.map=function(e,t){return h(e,n.__1(t))},t.keepU=d,t.keep=function(e,t){return d(e,n.__1(t))},t.keepMapU=m,t.keepMap=function(e,t){return m(e,n.__1(t))},t.forEachWithIndexU=g,t.forEachWithIndex=function(e,t){return g(e,n.__2(t))},t.mapWithIndexU=v,t.mapWithIndex=function(e,t){return v(e,n.__2(t))},t.reduceU=_,t.reduce=function(e,t,r){return _(e,t,n.__2(r))},t.reduceReverseU=y,t.reduceReverse=function(e,t,r){return y(e,t,n.__2(r))},t.reduceReverse2U=b,t.reduceReverse2=function(e,t,r,i){return b(e,t,r,n.__3(i))},t.someU=w,t.some=function(e,t){return w(e,n.__1(t))},t.everyU=x,t.every=function(e,t){return x(e,n.__1(t))},t.every2U=E,t.every2=function(e,t,r){return E(e,t,n.__2(r))},t.some2U=M,t.some2=function(e,t,r){return M(e,t,n.__2(r))},t.cmpU=S,t.cmp=function(e,t,r){return S(e,t,n.__2(r))},t.eqU=T,t.eq=function(e,t,r){return T(e,t,n.__2(r))}},function(e,t,r){"use strict";var n=r(80);function i(e){return e>n.max?n.max:e<n.min?n.min:Math.ceil(e)}function a(e){return e>n.max?n.max:e<n.min?n.min:Math.floor(e)}var o=i,s=a;t.unsafe_ceil=function(e){return Math.ceil(e)},t.ceil_int=i,t.ceil=o,t.unsafe_floor=function(e){return Math.floor(e)},t.floor_int=a,t.floor=s,t.random_int=function(e,t){return a(Math.random()*(t-e|0))+e|0}},function(e,t,r){"use strict";t.equal=function(e,t){return+(e===t)},t.max=2147483647,t.min=-2147483648},function(e,t,r){"use strict";var n=r(0),i=r(22),a=r(82);function o(e,t,r){if(null!==e){var n=e.key;if(t===n)return i.updateValue(e,r);var a=e.value;return t<n?i.bal(o(e.left,t,r),n,a,e.right):i.bal(e.left,n,a,o(e.right,t,r))}return i.singleton(t,r)}function s(e,t,r){if(null!==e){var n=e.key;if(t===n){var a=r([e.value]);if(a)return i.updateValue(e,a[0]);var o=e.left,u=e.right;if(null!==o){if(null!==u){var c=[u.key],l=[u.value],f=i.removeMinAuxWithRef(u,c,l);return i.bal(o,c[0],l[0],f)}return o}return u}var p=e.left,h=e.right,d=e.value;if(t<n){var m=s(p,t,r);return p===m?e:i.bal(m,n,d,h)}var g=s(h,t,r);return h===g?e:i.bal(p,n,d,g)}var v=r(0);return v?i.singleton(t,v[0]):e}function u(e,t){var r=e.left,n=e.key,a=e.right;if(t===n){if(null!==r){if(null!==a){var o=[a.key],s=[a.value],c=i.removeMinAuxWithRef(a,o,s);return i.bal(r,o[0],s[0],c)}return r}return a}if(t<n){if(null!==r){var l=u(r,t);return l===r?e:i.bal(l,n,e.value,a)}return e}if(null!==a){var f=u(a,t);return i.bal(r,n,e.value,f)}return e}var c=i.empty,l=i.isEmpty,f=a.has,p=a.cmpU,h=a.cmp,d=a.eqU,m=a.eq,g=i.forEachU,v=i.forEach,_=i.reduceU,y=i.reduce,b=i.everyU,x=i.every,w=i.someU,$=i.some,E=i.size,M=i.toList,T=i.toArray,S=a.ofArray,A=i.keysToArray,z=i.valuesToArray,R=i.minKey,C=i.minKeyUndefined,L=i.maxKey,P=i.maxKeyUndefined,U=i.minimum,I=i.minUndefined,O=i.maximum,N=i.maxUndefined,k=a.get,D=a.getUndefined,F=a.getWithDefault,B=a.getExn,G=a.mergeU,V=a.merge,H=i.keepSharedU,j=i.keepShared,W=i.partitionSharedU,q=i.partitionShared,X=a.split,Y=i.mapU,J=i.map,Z=i.mapWithKeyU,K=i.mapWithKey,Q=i.checkInvariantInternal;t.empty=c,t.isEmpty=l,t.has=f,t.cmpU=p,t.cmp=h,t.eqU=d,t.eq=m,t.forEachU=g,t.forEach=v,t.reduceU=_,t.reduce=y,t.everyU=b,t.every=x,t.someU=w,t.some=$,t.size=E,t.toList=M,t.toArray=T,t.ofArray=S,t.keysToArray=A,t.valuesToArray=z,t.minKey=R,t.minKeyUndefined=C,t.maxKey=L,t.maxKeyUndefined=P,t.minimum=U,t.minUndefined=I,t.maximum=O,t.maxUndefined=N,t.get=k,t.getUndefined=D,t.getWithDefault=F,t.getExn=B,t.remove=function(e,t){return null!==e?u(e,t):i.empty},t.removeMany=function(e,t){var r=t.length;if(null===e)return i.empty;for(var n=e,a=t,o=0,s=r;;){var c=o,l=n;if(c<s){var f=u(l,a[c]);if(null!==f){o=c+1|0,n=f;continue}return f}return l}},t.set=o,t.updateU=s,t.update=function(e,t,r){return s(e,t,n.__1(r))},t.mergeArray=function(e,t){for(var r=e,n=0,i=t.length-1|0;n<=i;++n){var a=t[n];r=o(r,a[0],a[1])}return r},t.mergeU=G,t.merge=V,t.keepU=H,t.keep=j,t.partitionU=W,t.partition=q,t.split=X,t.mapU=Y,t.map=J,t.mapWithKeyU=Z,t.mapWithKey=K,t.checkInvariantInternal=Q},function(e,t,r){"use strict";var n=r(0),i=r(27),a=r(6),o=r(22);function s(e,t){var r=t.left,n=t.key,i=t.value,a=t.right;if(e===n)return[r,[i],a];if(e<n){if(null!==r){var u=s(e,r);return[u[0],u[1],o.join(u[2],n,i,a)]}return[o.empty,0,t]}if(null!==a){var c=s(e,a);return[o.join(r,n,i,c[0]),c[1],c[2]]}return[t,0,o.empty]}function u(e,t){return null!==t?s(e,t):[o.empty,0,o.empty]}function c(e,t,r){var n=0;if(null!==e){if(e.h>=(null!==t?t.h:0)){var i=e.left,a=e.key,s=e.value,l=e.right,f=u(a,t);return o.concatOrJoin(c(i,f[0],r),a,r(a,[s],f[1]),c(l,f[2],r))}n=1}else{if(null===t)return o.empty;n=1}if(1===n){if(null!==t){var p=t.left,h=t.key,d=t.value,m=t.right,g=u(h,e);return o.concatOrJoin(c(g[0],p,r),h,r(h,g[1],[d]),c(g[2],m,r))}return 0}}function l(e,t,r){for(;;){var n=t,i=e;if(i){if(n){var s=n[0],u=i[0],c=a.caml_string_compare(u.key,s.key);if(c)return c;var l=r(u.value,s.value);if(l)return l;t=o.stackAllLeft(s.right,n[1]),e=o.stackAllLeft(u.right,i[1]);continue}return 0}return 0}}function f(e,t,r){var n=o.size(e),i=o.size(t);return n===i?l(o.stackAllLeft(e,0),o.stackAllLeft(t,0),r):n<i?-1:1}function p(e,t,r){for(;;){var n=t,i=e;if(i){if(n){var a=n[0],s=i[0];if(s.key===a.key&&r(s.value,a.value)){t=o.stackAllLeft(a.right,n[1]),e=o.stackAllLeft(s.right,i[1]);continue}return 0}return 1}return 1}}function h(e,t,r){return o.size(e)===o.size(t)?p(o.stackAllLeft(e,0),o.stackAllLeft(t,0),r):0}function d(e,t,r){if(null!==e){var n=e.key;if(t===n)return e.key=t,e.value=r,e;var i=e.left,a=e.right;if(t<n){var s=d(i,t,r);e.left=s}else e.right=d(a,t,r);return o.balMutate(e)}return o.singleton(t,r)}t.N=0,t.A=0,t.S=0,t.add=function e(t,r,n){if(null!==t){var i=t.key;if(r===i)return o.updateValue(t,n);var a=t.value;return r<i?o.bal(e(t.left,r,n),i,a,t.right):o.bal(t.left,i,a,e(t.right,r,n))}return o.singleton(r,n)},t.get=function(e,t){for(;;){var r=e;if(null===r)return 0;var n=r.key;if(t===n)return[r.value];e=t<n?r.left:r.right}},t.getUndefined=function(e,t){for(;;){var r=e;if(null===r)return;var n=r.key;if(t===n)return r.value;e=t<n?r.left:r.right}},t.getExn=function(e,t){for(;;){var r=e;if(null===r)throw new Error("getExn");var n=r.key;if(t===n)return r.value;e=t<n?r.left:r.right}},t.getWithDefault=function(e,t,r){for(;;){var n=e;if(null===n)return r;var i=n.key;if(t===i)return n.value;e=t<i?n.left:n.right}},t.has=function(e,t){for(;;){var r=e;if(null===r)return 0;var n=r.key;if(t===n)return 1;e=t<n?r.left:r.right}},t.remove=function e(t,r){if(null!==t){var n=t.left,i=t.key,a=t.right;if(r===i){if(null!==n){if(null!==a){var s=[a.key],u=[a.value],c=o.removeMinAuxWithRef(a,s,u);return o.bal(n,s[0],u[0],c)}return n}return a}return r<i?o.bal(e(n,r),i,t.value,a):o.bal(n,i,t.value,e(a,r))}return t},t.splitAux=s,t.split=u,t.mergeU=c,t.merge=function(e,t,r){return c(e,t,n.__3(r))},t.compareAux=l,t.cmpU=f,t.cmp=function(e,t,r){return f(e,t,n.__2(r))},t.eqAux=p,t.eqU=h,t.eq=function(e,t,r){return h(e,t,n.__2(r))},t.addMutate=d,t.ofArray=function(e){var t=e.length;if(t){var r,n=i.strictlySortedLengthU(e,function(e,t){return+(e[0]<t[0])});n>=0?r=o.ofSortedArrayAux(e,0,n):(n=0|-n,r=o.ofSortedArrayRevAux(e,n-1|0,n));for(var a=n,s=t-1|0;a<=s;++a){var u=e[a];r=d(r,u[0],u[1])}return r}return o.empty}},function(e,t,r){"use strict";var n=r(10),i=r(24),a=r(42);t.setInt=function(e,t){return window.localStorage.setItem(e,n.string_of_int(t)),0},t.setFloat=function(e,t){return window.localStorage.setItem(e,n.string_of_float(t)),0},t.setString=function(e,t){return window.localStorage.setItem(e,t),0},t.getInt=function(e){var t=window.localStorage.getItem(e);return null==t?0:[i.caml_int_of_string(t)]},t.getFloat=function(e){var t=window.localStorage.getItem(e);return null==t?0:[i.caml_float_of_string(t)]},t.getString=function(e){return a.null_undefined_to_opt(window.localStorage.getItem(e))}},function(e,t,r){"use strict";var n=r(85);t.create=function(){return new n.default.GUI}},function(e,t,r){"use strict";function n(e,t){var r=e.__state.conversionName.toString(),n=Math.round(e.r),i=Math.round(e.g),a=Math.round(e.b),o=e.a,s=Math.round(e.h),u=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===r||"SIX_CHAR_HEX"===r){for(var l=e.hex.toString(16);l.length<6;)l="0"+l;return"#"+l}return"CSS_RGB"===r?"rgb("+n+","+i+","+a+")":"CSS_RGBA"===r?"rgba("+n+","+i+","+a+","+o+")":"HEX"===r?"0x"+e.hex.toString(16):"RGB_ARRAY"===r?"["+n+","+i+","+a+"]":"RGBA_ARRAY"===r?"["+n+","+i+","+a+","+o+"]":"RGB_OBJ"===r?"{r:"+n+",g:"+i+",b:"+a+"}":"RGBA_OBJ"===r?"{r:"+n+",g:"+i+",b:"+a+",a:"+o+"}":"HSV_OBJ"===r?"{h:"+s+",s:"+u+",v:"+c+"}":"HSVA_OBJ"===r?"{h:"+s+",s:"+u+",v:"+c+",a:"+o+"}":"unknown format"}Object.defineProperty(t,"__esModule",{value:!0});var i=Array.prototype.forEach,a=Array.prototype.slice,o={BREAK:{},extend:function(e){return this.each(a.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))},this),e},defaults:function(e){return this.each(a.call(arguments,1),function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))},this),e},compose:function(){var e=a.call(arguments);return function(){for(var t=a.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e)if(i&&e.forEach&&e.forEach===i)e.forEach(t,r);else if(e.length===e.length+0){var n,a=void 0;for(a=0,n=e.length;a<n;a++)if(a in e&&t.call(r,e[a],a)===this.BREAK)return}else for(var o in e)if(t.call(r,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var n=void 0;return function(){var i=this,a=arguments;var o=r||!n;clearTimeout(n),n=setTimeout(function(){n=null,r||e.apply(i,a)},t),o&&e.apply(i,a)}},toArray:function(e){return e.toArray?e.toArray():a.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},s=[{litmus:o.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:n},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:n},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:n},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:n}}},{litmus:o.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:o.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:o.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(o.isNumber(e.r)&&o.isNumber(e.g)&&o.isNumber(e.b)&&o.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(o.isNumber(e.r)&&o.isNumber(e.g)&&o.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(o.isNumber(e.h)&&o.isNumber(e.s)&&o.isNumber(e.v)&&o.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(o.isNumber(e.h)&&o.isNumber(e.s)&&o.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],u=void 0,c=void 0,l=function(){c=!1;var e=arguments.length>1?o.toArray(arguments):arguments[0];return o.each(s,function(t){if(t.litmus(e))return o.each(t.conversions,function(t,r){if(u=t.read(e),!1===c&&!1!==u)return c=u,u.conversionName=r,u.conversion=t,o.BREAK}),o.BREAK}),c},f=void 0,p={hsv_to_rgb:function(e,t,r){var n=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),a=r*(1-t),o=r*(1-i*t),s=r*(1-(1-i)*t),u=[[r,s,a],[o,r,a],[a,r,s],[a,o,r],[s,a,r],[r,a,o]][n];return{r:255*u[0],g:255*u[1],b:255*u[2]}},rgb_to_hsv:function(e,t,r){var n=Math.min(e,t,r),i=Math.max(e,t,r),a=i-n,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-r)/a:t===i?2+(r-e)/a:4+(e-t)/a,(o/=6)<0&&(o+=1),{h:360*o,s:a/i,v:i/255})},rgb_to_hex:function(e,t,r){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),n=this.hex_with_component(n,0,r)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,r){return r<<(f=8*t)|e&~(255<<f)}},h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},m=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),g=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},v=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},_=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},y=function(){function e(){if(d(this,e),this.__state=l.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return m(e,[{key:"toString",value:function(){return n(this)}},{key:"toHexString",value:function(){return n(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function b(e,t,r){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(y.recalculateRGB(this,t,r),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(y.recalculateRGB(this,t,r),this.__state.space="RGB"),this.__state[t]=e}})}function x(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(y.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(y.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}y.recalculateRGB=function(e,t,r){if("HEX"===e.__state.space)e.__state[t]=p.component_from_hex(e.__state.hex,r);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");o.extend(e.__state,p.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},y.recalculateHSV=function(e){var t=p.rgb_to_hsv(e.r,e.g,e.b);o.extend(e.__state,{s:t.s,v:t.v}),o.isNaN(t.h)?o.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},y.COMPONENTS=["r","g","b","h","s","v","hex","a"],b(y.prototype,"r",2),b(y.prototype,"g",1),b(y.prototype,"b",0),x(y.prototype,"h"),x(y.prototype,"s"),x(y.prototype,"v"),Object.defineProperty(y.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(y.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=p.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var w=function(){function e(t,r){d(this,e),this.initialValue=t[r],this.domElement=document.createElement("div"),this.object=t,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return m(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),$={};o.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){o.each(e,function(e){$[e]=t})});var E=/(\d+(\.\d+)?)px/;function M(e){if("0"===e||o.isUndefined(e))return 0;var t=e.match(E);return o.isNull(t)?0:parseFloat(t[1])}var T={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var n=r,i=t;o.isUndefined(i)&&(i=!0),o.isUndefined(n)&&(n=!0),e.style.position="absolute",i&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,n){var i=r||{},a=$[t];if(!a)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(a);switch(a){case"MouseEvents":var u=i.x||i.clientX||0,c=i.y||i.clientY||0;s.initMouseEvent(t,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,u,c,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var l=s.initKeyboardEvent||s.initKeyEvent;o.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),l(t,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:s.initEvent(t,i.bubbles||!1,i.cancelable||!0)}o.defaults(s,n),e.dispatchEvent(s)},bind:function(e,t,r,n){var i=n||!1;return e.addEventListener?e.addEventListener(t,r,i):e.attachEvent&&e.attachEvent("on"+t,r),T},unbind:function(e,t,r,n){var i=n||!1;return e.removeEventListener?e.removeEventListener(t,r,i):e.detachEvent&&e.detachEvent("on"+t,r),T},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return T},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))}else e.className=void 0;return T},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return M(t["border-left-width"])+M(t["border-right-width"])+M(t["padding-left"])+M(t["padding-right"])+M(t.width)},getHeight:function(e){var t=getComputedStyle(e);return M(t["border-top-width"])+M(t["border-bottom-width"])+M(t["padding-top"])+M(t["padding-bottom"])+M(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do{r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent}while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},S=function(e){function t(e,r){d(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),i=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),T.bind(n.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return v(t,w),m(t,[{key:"setValue",value:function(e){var r=g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),A=function(e){function t(e,r,n){d(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),a=n,s=i;if(i.__select=document.createElement("select"),o.isArray(a)){var u={};o.each(a,function(e){u[e]=e}),a=u}return o.each(a,function(e,t){var r=document.createElement("option");r.innerHTML=t,r.setAttribute("value",e),s.__select.appendChild(r)}),i.updateDisplay(),T.bind(i.__select,"change",function(){var e=this.options[this.selectedIndex].value;s.setValue(e)}),i.domElement.appendChild(i.__select),i}return v(t,w),m(t,[{key:"setValue",value:function(e){var r=g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return T.isActive(this.__select)?this:(this.__select.value=this.getValue(),g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(),z=function(e){function t(e,r){d(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),i=n;function a(){i.setValue(i.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),T.bind(n.__input,"keyup",a),T.bind(n.__input,"change",a),T.bind(n.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),T.bind(n.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return v(t,w),m(t,[{key:"updateDisplay",value:function(){return T.isActive(this.__input)||(this.__input.value=this.getValue()),g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function R(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var C=function(e){function t(e,r,n){d(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),a=n||{};return i.__min=a.min,i.__max=a.max,i.__step=a.step,o.isUndefined(i.__step)?0===i.initialValue?i.__impliedStep=1:i.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(i.initialValue))/Math.LN10))/10:i.__impliedStep=i.__step,i.__precision=R(i.__impliedStep),i}return v(t,w),m(t,[{key:"setValue",value:function(e){var r=e;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=R(e),this}}]),t}();var L=function(e){function t(e,r,n){d(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));i.__truncationSuspended=!1;var a=i,s=void 0;function u(){a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function c(e){var t=s-e.clientY;a.setValue(a.getValue()+t*a.__impliedStep),s=e.clientY}function l(){T.unbind(window,"mousemove",c),T.unbind(window,"mouseup",l),u()}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),T.bind(i.__input,"change",function(){var e=parseFloat(a.__input.value);o.isNaN(e)||a.setValue(e)}),T.bind(i.__input,"blur",function(){u()}),T.bind(i.__input,"mousedown",function(e){T.bind(window,"mousemove",c),T.bind(window,"mouseup",l),s=e.clientY}),T.bind(i.__input,"keydown",function(e){13===e.keyCode&&(a.__truncationSuspended=!0,this.blur(),a.__truncationSuspended=!1,u())}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return v(t,C),m(t,[{key:"updateDisplay",value:function(){var e,r,n;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),r=this.__precision,n=Math.pow(10,r),Math.round(e*n)/n),g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}();function P(e,t,r,n,i){return n+(e-t)/(r-t)*(i-n)}var U=function(e){function t(e,r,n,i,a){d(this,t);var o=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,{min:n,max:i,step:a})),s=o;function u(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(P(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function c(){T.unbind(window,"mousemove",u),T.unbind(window,"mouseup",c),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function l(e){var t=e.touches[0].clientX,r=s.__background.getBoundingClientRect();s.setValue(P(t,r.left,r.right,s.__min,s.__max))}function f(){T.unbind(window,"touchmove",l),T.unbind(window,"touchend",f),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),T.bind(o.__background,"mousedown",function(e){document.activeElement.blur(),T.bind(window,"mousemove",u),T.bind(window,"mouseup",c),u(e)}),T.bind(o.__background,"touchstart",function(e){if(1!==e.touches.length)return;T.bind(window,"touchmove",l),T.bind(window,"touchend",f),l(e)}),T.addClass(o.__background,"slider"),T.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return v(t,C),m(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",g(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(),I=function(e){function t(e,r,n){d(this,t);var i=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),a=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===n?"Fire":n,T.bind(i.__button,"click",function(e){return e.preventDefault(),a.fire(),!1}),T.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return v(t,w),m(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(),O=function(e){function t(e,r){d(this,t);var n=_(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));n.__color=new y(n.getValue()),n.__temp=new y(0);var i=n;n.domElement=document.createElement("div"),T.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",T.bind(n.__input,"keydown",function(e){13===e.keyCode&&h.call(this)}),T.bind(n.__input,"blur",h),T.bind(n.__selector,"mousedown",function(){T.addClass(this,"drag").bind(window,"mouseup",function(){T.removeClass(i.__selector,"drag")})}),T.bind(n.__selector,"touchstart",function(){T.addClass(this,"drag").bind(window,"touchend",function(){T.removeClass(i.__selector,"drag")})});var a,s=document.createElement("div");function u(e){g(e),T.bind(window,"mousemove",g),T.bind(window,"touchmove",g),T.bind(window,"mouseup",f),T.bind(window,"touchend",f)}function c(e){v(e),T.bind(window,"mousemove",v),T.bind(window,"touchmove",v),T.bind(window,"mouseup",p),T.bind(window,"touchend",p)}function f(){T.unbind(window,"mousemove",g),T.unbind(window,"touchmove",g),T.unbind(window,"mouseup",f),T.unbind(window,"touchend",f),m()}function p(){T.unbind(window,"mousemove",v),T.unbind(window,"touchmove",v),T.unbind(window,"mouseup",p),T.unbind(window,"touchend",p),m()}function h(){var e=l(this.value);!1!==e?(i.__color.__state=e,i.setValue(i.__color.toOriginal())):this.value=i.__color.toString()}function m(){i.__onFinishChange&&i.__onFinishChange.call(i,i.__color.toOriginal())}function g(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__saturation_field.getBoundingClientRect(),r=e.touches&&e.touches[0]||e,n=r.clientX,a=r.clientY,o=(n-t.left)/(t.right-t.left),s=1-(a-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),o>1?o=1:o<0&&(o=0),i.__color.v=s,i.__color.s=o,i.setValue(i.__color.toOriginal()),!1}function v(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=i.__hue_field.getBoundingClientRect(),r=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),i.__color.h=360*r,i.setValue(i.__color.toOriginal()),!1}return o.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),o.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),o.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),o.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),o.extend(s.style,{width:"100%",height:"100%",background:"none"}),k(s,"top","rgba(0,0,0,0)","#000"),o.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(a=n.__hue_field).style.background="",a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",o.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),T.bind(n.__saturation_field,"mousedown",u),T.bind(n.__saturation_field,"touchstart",u),T.bind(n.__field_knob,"mousedown",u),T.bind(n.__field_knob,"touchstart",u),T.bind(n.__hue_field,"mousedown",c),T.bind(n.__hue_field,"touchstart",c),n.__saturation_field.appendChild(s),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return v(t,w),m(t,[{key:"updateDisplay",value:function(){var e=l(this.getValue());if(!1!==e){var t=!1;o.each(y.COMPONENTS,function(r){if(!o.isUndefined(e[r])&&!o.isUndefined(this.__color.__state[r])&&e[r]!==this.__color.__state[r])return t=!0,{}},this),t&&o.extend(this.__color.__state,e)}o.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,n=255-r;o.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,k(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),o.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(),N=["-moz-","-o-","-webkit-","-ms-",""];function k(e,t,r,n){e.style.background="",o.each(N,function(i){e.style.cssText+="background: "+i+"linear-gradient("+t+", "+r+" 0%, "+n+" 100%); "})}var D=function(e,t){var r=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var i=r.getElementsByTagName("head")[0];try{i.appendChild(n)}catch(e){}},F=function(e,t){var r=e[t];return o.isArray(arguments[2])||o.isObject(arguments[2])?new A(e,t,arguments[2]):o.isNumber(r)?o.isNumber(arguments[2])&&o.isNumber(arguments[3])?o.isNumber(arguments[4])?new U(e,t,arguments[2],arguments[3],arguments[4]):new U(e,t,arguments[2],arguments[3]):o.isNumber(arguments[4])?new L(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new L(e,t,{min:arguments[2],max:arguments[3]}):o.isString(r)?new z(e,t):o.isFunction(r)?new I(e,t,""):o.isBoolean(r)?new S(e,t):null};var B=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},G=function(){function e(){d(this,e),this.backgroundElement=document.createElement("div"),o.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),T.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),o.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;T.bind(this.backgroundElement,"click",function(){t.hide()})}return m(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),o.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",T.unbind(e.domElement,"webkitTransitionEnd",t),T.unbind(e.domElement,"transitionend",t),T.unbind(e.domElement,"oTransitionEnd",t)};T.bind(this.domElement,"webkitTransitionEnd",t),T.bind(this.domElement,"transitionend",t),T.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-T.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-T.getHeight(this.domElement)/2+"px"}}]),e}();D(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid transparent}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var V="Default",H=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),j=void 0,W=!0,q=void 0,X=!1,Y=[],J=function e(t){var r=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),T.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=o.defaults(n,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),n=o.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),o.isUndefined(n.load)?n.load={preset:V}:n.preset&&(n.load.preset=n.preset),o.isUndefined(n.parent)&&n.hideable&&Y.push(this),n.resizable=o.isUndefined(n.parent)&&n.resizable,n.autoPlace&&o.isUndefined(n.scrollable)&&(n.scrollable=!0);var i,a=H&&"true"===localStorage.getItem(re(this,"isLocal")),s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return r.parent?r.getRoot().preset:n.load.preset},set:function(e){r.parent?r.getRoot().preset=e:n.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),r.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,oe(r,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,titleRowName&&(titleRowName.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(t){n.closed=t,n.closed?T.addClass(r.__ul,e.CLASS_CLOSED):T.removeClass(r.__ul,e.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return a},set:function(e){H&&(a=e,e?T.bind(window,"unload",s):T.unbind(window,"unload",s),localStorage.setItem(re(r,"isLocal"),e))}}}),o.isUndefined(n.parent)){if(n.closed=!1,T.addClass(this.domElement,e.CLASS_MAIN),T.makeSelectable(this.domElement,!1),H&&a){r.useLocalStorage=!0;var u=localStorage.getItem(re(this,"gui"));u&&(n.load=JSON.parse(u))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,T.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),n.closeOnTop?(T.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(T.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),T.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===n.closed&&(n.closed=!0);var c=document.createTextNode(n.name);T.addClass(c,"controller-name");var l=Z(r,c);T.addClass(this.__ul,e.CLASS_CLOSED),T.addClass(l,"title"),T.bind(l,"click",function(e){return e.preventDefault(),r.closed=!r.closed,!1}),n.closed||(this.closed=!1)}n.autoPlace&&(o.isUndefined(n.parent)&&(W&&(q=document.createElement("div"),T.addClass(q,"dg"),T.addClass(q,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(q),W=!1),q.appendChild(this.domElement),T.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||oe(r,n.width)),this.__resizeHandler=function(){r.onResizeDebounced()},T.bind(window,"resize",this.__resizeHandler),T.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),T.bind(this.__ul,"transitionend",this.__resizeHandler),T.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&ae(this),s=function(){H&&"true"===localStorage.getItem(re(r,"isLocal"))&&localStorage.setItem(re(r,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=s,n.parent||((i=r.getRoot()).width+=1,o.defer(function(){i.width-=1}))};function Z(e,t,r){var n=document.createElement("li");return t&&n.appendChild(t),r?e.__ul.insertBefore(n,r):e.__ul.appendChild(n),e.onResize(),n}function K(e){T.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&T.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function Q(e,t){var r=e.__preset_select[e.__preset_select.selectedIndex];r.innerHTML=t?r.value+"*":r.value}function ee(e,t){var r=e.getRoot(),n=r.__rememberedObjects.indexOf(t.object);if(-1!==n){var i=r.__rememberedObjectIndecesToControllers[n];if(void 0===i&&(i={},r.__rememberedObjectIndecesToControllers[n]=i),i[t.property]=t,r.load&&r.load.remembered){var a=r.load.remembered,o=void 0;if(a[e.preset])o=a[e.preset];else{if(!a[V])return;o=a[V]}if(o[n]&&void 0!==o[n][t.property]){var s=o[n][t.property];t.initialValue=s,t.setValue(s)}}}}function te(e,t,r,n){if(void 0===t[r])throw new Error('Object "'+t+'" has no property "'+r+'"');var i=void 0;if(n.color)i=new O(t,r);else{var a=[t,r].concat(n.factoryArgs);i=F.apply(e,a)}n.before instanceof w&&(n.before=n.before.__li),ee(e,i),T.addClass(i.domElement,"c");var s=document.createElement("span");T.addClass(s,"property-name"),s.innerHTML=i.property;var u=document.createElement("div");u.appendChild(s),u.appendChild(i.domElement);var c=Z(e,u,n.before);return T.addClass(c,J.CLASS_CONTROLLER_ROW),i instanceof O?T.addClass(c,"color"):T.addClass(c,h(i.getValue())),function(e,t,r){if(r.__li=t,r.__gui=e,o.extend(r,{options:function(t){if(arguments.length>1){var n=r.__li.nextElementSibling;return r.remove(),te(e,r.object,r.property,{before:n,factoryArgs:[o.toArray(arguments)]})}if(o.isArray(t)||o.isObject(t)){var i=r.__li.nextElementSibling;return r.remove(),te(e,r.object,r.property,{before:i,factoryArgs:[t]})}},name:function(e){return r.__li.firstElementChild.firstElementChild.innerHTML=e,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof U){var n=new L(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});o.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var t=r[e],i=n[e];r[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return i.apply(n,e),t.apply(r,e)}}),T.addClass(t,"has-slider"),r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof L){var i=function(t){if(o.isNumber(r.__min)&&o.isNumber(r.__max)){var n=r.__li.firstElementChild.firstElementChild.innerHTML,i=r.__gui.__listening.indexOf(r)>-1;r.remove();var a=te(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]});return a.name(n),i&&a.listen(),a}return t};r.min=o.compose(i,r.min),r.max=o.compose(i,r.max)}else r instanceof S?(T.bind(t,"click",function(){T.fakeEvent(r.__checkbox,"click")}),T.bind(r.__checkbox,"click",function(e){e.stopPropagation()})):r instanceof I?(T.bind(t,"click",function(){T.fakeEvent(r.__button,"click")}),T.bind(t,"mouseover",function(){T.addClass(r.__button,"hover")}),T.bind(t,"mouseout",function(){T.removeClass(r.__button,"hover")})):r instanceof O&&(T.addClass(t,"color"),r.updateDisplay=o.compose(function(e){return t.style.borderLeftColor=r.__color.toString(),e},r.updateDisplay),r.updateDisplay());r.setValue=o.compose(function(t){return e.getRoot().__preset_select&&r.isModified()&&Q(e.getRoot(),!0),t},r.setValue)}(e,c,i),e.__controllers.push(i),i}function re(e,t){return document.location.href+"."+t}function ne(e,t,r){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),r&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function ie(e,t){t.style.display=e.useLocalStorage?"block":"none"}function ae(e){var t=void 0;function r(r){return r.preventDefault(),e.width+=t-r.clientX,e.onResize(),t=r.clientX,!1}function n(){T.removeClass(e.__closeButton,J.CLASS_DRAG),T.unbind(window,"mousemove",r),T.unbind(window,"mouseup",n)}function i(i){return i.preventDefault(),t=i.clientX,T.addClass(e.__closeButton,J.CLASS_DRAG),T.bind(window,"mousemove",r),T.bind(window,"mouseup",n),!1}e.__resize_handle=document.createElement("div"),o.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),T.bind(e.__resize_handle,"mousedown",i),T.bind(e.__closeButton,"mousedown",i),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function oe(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function se(e,t){var r={};return o.each(e.__rememberedObjects,function(n,i){var a={},s=e.__rememberedObjectIndecesToControllers[i];o.each(s,function(e,r){a[r]=t?e.initialValue:e.getValue()}),r[i]=a}),r}J.toggleHide=function(){X=!X,o.each(Y,function(e){e.domElement.style.display=X?"none":""})},J.CLASS_AUTO_PLACE="a",J.CLASS_AUTO_PLACE_CONTAINER="ac",J.CLASS_MAIN="main",J.CLASS_CONTROLLER_ROW="cr",J.CLASS_TOO_TALL="taller-than-window",J.CLASS_CLOSED="closed",J.CLASS_CLOSE_BUTTON="close-button",J.CLASS_CLOSE_TOP="close-top",J.CLASS_CLOSE_BOTTOM="close-bottom",J.CLASS_DRAG="drag",J.DEFAULT_WIDTH=245,J.TEXT_CLOSED="Close Controls",J.TEXT_OPEN="Open Controls",J._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||J.toggleHide()},T.bind(window,"keydown",J._keydownHandler,!1),o.extend(J.prototype,{add:function(e,t){return te(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return te(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;o.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&q.removeChild(this.domElement);var e=this;o.each(this.__folders,function(t){e.removeFolder(t)}),T.unbind(window,"keydown",J._keydownHandler,!1),K(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new J(t);this.__folders[e]=r;var n=Z(this,r.domElement);return T.addClass(n,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],K(e);var t=this;o.each(e.__folders,function(t){e.removeFolder(t)}),o.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=T.getOffset(e.__ul).top,r=0;o.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(r+=T.getHeight(t))}),window.innerHeight-t-20<r?(T.addClass(e.domElement,J.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(T.removeClass(e.domElement,J.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&o.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:o.debounce(function(){this.onResize()},50),remember:function(){if(o.isUndefined(j)&&((j=new G).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;o.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");T.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),T.addClass(t,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",T.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save",T.addClass(n,"button"),T.addClass(n,"save");var i=document.createElement("span");i.innerHTML="New",T.addClass(i,"button"),T.addClass(i,"save-as");var a=document.createElement("span");a.innerHTML="Revert",T.addClass(a,"button"),T.addClass(a,"revert");var s=e.__preset_select=document.createElement("select");e.load&&e.load.remembered?o.each(e.load.remembered,function(t,r){ne(e,r,r===e.preset)}):ne(e,V,!1);if(T.bind(s,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(s),t.appendChild(r),t.appendChild(n),t.appendChild(i),t.appendChild(a),H){var u=document.getElementById("dg-local-explain"),c=document.getElementById("dg-local-storage"),l=document.getElementById("dg-save-locally");l.style.display="block","true"===localStorage.getItem(re(e,"isLocal"))&&c.setAttribute("checked","checked"),ie(e,u),T.bind(c,"change",function(){e.useLocalStorage=!e.useLocalStorage,ie(e,u)})}var f=document.getElementById("dg-new-constructor");T.bind(f,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||j.hide()}),T.bind(r,"click",function(){f.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),j.show(),f.focus(),f.select()}),T.bind(n,"click",function(){e.save()}),T.bind(i,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),T.bind(a,"click",function(){e.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&oe(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=se(this)),e.folders={},o.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=se(this),Q(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[V]=se(this,!0)),this.load.remembered[e]=se(this),this.preset=e,ne(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){o.each(this.__controllers,function(t){this.getRoot().load.remembered?ee(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),o.each(this.__folders,function(e){e.revert(e)}),e||Q(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&B.call(window,function(){e(t)});o.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){o.each(this.__controllers,function(e){e.updateDisplay()}),o.each(this.__folders,function(e){e.updateDisplay()})}});var ue={color:{Color:y,math:p,interpret:l},controllers:{Controller:w,BooleanController:S,OptionController:A,StringController:z,NumberController:C,NumberControllerBox:L,NumberControllerSlider:U,FunctionController:I,ColorController:O},dom:{dom:T},gui:{GUI:J},GUI:J};t.default=ue},function(e,t,r){"use strict";var n=r(5),i=r(21),a=r(10);t.lineNumbers=function(e){var t=i.to_list(e.split("\n")),r=[0];return n.fold_left(function(e,t){return r[0]=r[0]+1|0,e+"\n"+a.string_of_int(r[0])+": "+t},"",t)}},function(e,t,r){"use strict";var n=r(5),i=r(0),a=r(37),o=r(88),s=r(2),u=r(39),c=s.create("WebGL2Util-Rts.WebGL2Exception"),l=s.create("WebGL2Util-Rts.CacheNotWorking");var f=[0];function p(e,t,r){var n;if(2===e.MY_VERSION){var i=e.createVertexArray();e.bindVertexArray(i),n=[i]}else n=0;var s=r[3];s?e.bindBuffer(e.ARRAY_BUFFER,s[0]):e.MY_VERSION<2&&console.log("no floatIndexBuffer");var u=2===e.MY_VERSION?-1:e.getAttribLocation(t,"a_VertexIDFloat");if(-1!==u){2===e.MY_VERSION&&e.enableVertexAttribArray(u);var c=o.to_js_boolean(0);e.vertexAttribPointer(u,1,e.FLOAT,c,0,0)}var l=e.getAttribLocation(t,a.positionAttrName);if(e.bindBuffer(e.ARRAY_BUFFER,r[0]),-1!==l){2===e.MY_VERSION&&e.enableVertexAttribArray(l);var f=o.to_js_boolean(0);e.vertexAttribPointer(l,3,e.FLOAT,f,0,0)}else console.log("warning: unused "+a.positionAttrName);e.bindBuffer(e.ARRAY_BUFFER,r[1]);var p=e.getAttribLocation(t,"a_uv");if(-1!==p){2===e.MY_VERSION&&e.enableVertexAttribArray(p);var h=o.to_js_boolean(0);e.vertexAttribPointer(p,2,e.FLOAT,h,0,0)}return[n,u,l,p]}var h=window.partialMemoize2(function(e,t){return[e.createBuffer(),e.getUniformBlockIndex(t,"u_PerScene")]});var d=window.partialMemoize1(function(e){var t=document.createElement("div");document.body.appendChild(t);var r=t.style;return r.position="fixed",r.top="120px",r.left="0px",t.innerHTML=e,0});t.WebGL2Exception=c,t.CacheNotWorking=l,t.createShader=function(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?[n]:(console.log(e.getShaderInfoLog(n)),e.deleteShader(n),0)},t.createProgram=function(e,t,r){var n=e.createProgram();return e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)?[n]:(console.log(e.getProgramInfoLog(n)),e.deleteProgram(n),0)},t.preRender=function(e,t,r){return e.viewport(0,0,t,r),e.enable(e.DEPTH_TEST),e.clearColor(.9,.9,.9,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),0},t.cbCounter=f,t.createBuffers=function(e,t){if(f[0]=f[0]+1|0,f[0]>10)throw l;console.log("createBuffers");var r=t[0],n=t[2],i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW);var a,o=e.createBuffer();if(e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t[1],e.STATIC_DRAW),1===e.MY_VERSION){var s=function(e){for(var t=e.length,r=new Float32Array(t),n=0,i=t-1|0;n<=i;++n)r[n]=n;return r}(n),u=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,u),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),a=[u]}else a=0;var c=e.createBuffer();return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),[i,o,c,a,0,n.length]},t.createAttributes=p,t.getUniformBufferAndLocation=h,t.renderObject=function(e,t,r,a,o,s,u,c){e.useProgram(t);var l=p(e,t,r),f=l[0];if(f?e.bindVertexArray(f[0]):(-1!==l[1]&&e.enableVertexAttribArray(l[1]),-1!==l[2]?e.enableVertexAttribArray(l[2]):console.log("no position"),-1!==l[3]&&e.enableVertexAttribArray(l[3])),2===e.MY_VERSION){var d=i._2(h,e,t),m=d[0];e.uniformBlockBinding(t,d[1],0),e.bindBuffer(e.UNIFORM_BUFFER,m),e.bufferData(e.UNIFORM_BUFFER,u,e.DYNAMIC_DRAW),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,0,m)}else i._1(s,t);var g=[e.TEXTURE0,[e.TEXTURE1,[e.TEXTURE2,[e.TEXTURE3,[e.TEXTURE4,[e.TEXTURE5,[e.TEXTURE6,[e.TEXTURE7,[e.TEXTURE8,[e.TEXTURE9,[e.TEXTURE10,[e.TEXTURE11,[e.TEXTURE12,[e.TEXTURE13,[e.TEXTURE14,[e.TEXTURE15,0]]]]]]]]]]]]]]]];return n.iteri(function(r,i){var a=e.getUniformLocation(t,i[0]);return e.uniform1i(a,r),e.activeTexture(n.nth(g,r)),e.bindTexture(e.TEXTURE_2D,i[1]),0},a),e.bindBuffer(e.ARRAY_BUFFER,r[0]),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r[2]),i._1(c,function(){return e.drawElements(e.TRIANGLES,r[5],e.UNSIGNED_INT,r[4]),0}),l[0]?0:(-1!==l[1]&&e.disableVertexAttribArray(l[1]),-1!==l[2]?e.disableVertexAttribArray(l[2]):console.log("no position"),-1!==l[3]&&e.disableVertexAttribArray(l[3]),0)},t.showWarning=d,t.createRenderTarget=function(e,t,r){var n=e.RGBA32F;if(1===e.MY_VERSION)if(null==e.getExtension("OES_texture_float")){var a=e.getExtension("OES_texture_half_float");if(null==a)throw[c,"missing extension OES_texture_float and half_foat"];n=a.RGBA16F_EXT}else n=e.RGBA;if(null===e.getExtension("OES_texture_float_linear"))throw[c,"missing extension OES_texture_float_linear"];var o=2===e.MY_VERSION?"EXT_color_buffer_float":"WEBGL_color_buffer_float",s=e.getExtension(o),l=e.FLOAT;null===s&&null===e.getExtension("EXT_color_buffer_half_float")&&(l=e.UNSIGNED_BYTE,i._1(d,"Warning: No color buffer floats. Water will look bad. Try Chrome >= 64."));var f=e.createTexture();e.bindTexture(e.TEXTURE_2D,f);var p=e.RGBA,h=l;e.texImage2D(e.TEXTURE_2D,0,n,t,r,0,p,h,null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE);var m=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,u.from_opt([m]));var g=e.COLOR_ATTACHMENT0;return e.framebufferTexture2D(e.FRAMEBUFFER,g,e.TEXTURE_2D,f,0),e.bindFramebuffer(e.FRAMEBUFFER,null),[t,r,m,f]},t.renderToTarget=function(e,t,r){return e.bindFramebuffer(e.FRAMEBUFFER,u.from_opt([t[2]])),e.viewport(0,0,t[0],t[1]),e.clearColor(0,0,1,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),i._1(r,0),e.bindFramebuffer(e.FRAMEBUFFER,null),0}},function(e,t,r){"use strict";t.to_js_boolean=function(e){return!!e}},function(e,t,r){"use strict";var n=r(4),i=r(17),a=r(29),o=r(2),s=r(13),u=r(18),c=r(43),l=o.create("ShaderTrees-Rts.Bug"),f=n.floatuniform("objectId"),p=n.sampler2Duniform("t_tree"),h=n.sampler2Duniform("heightMap"),d=n.vec2attr("a_uv"),m=n.vec2varying("v_uv"),g=n.vec2varying("v_position"),v=n.body(function(){n.$eq$at(m,n.$neg(n.f(1),d));var e=n.floatvar("vertexId");n.$eq$at(e,n.$slash(n.int2float(n.idiv(n.gl_VertexId,n.i(4))),n.f(1e5)));var t=n.vec3var("position"),r=n.$plus(n.$star(e,n.f(.239543)),n.f(.243254)),o=n.fmod(r,n.f(1.2345)),s=n.$plus(n.$star(e,n.f(7.823579)),n.f(.432423)),c=n.fmod(s,n.f(.23404)),l=n.$star(e,n.f(3.7812314)),p=n.fmod(l,n.f(.254654)),v=n.$plus(n.f(.01),n.$star(n.f(.02),n.$plus(n.$neg(a.rand(n.vec22f(r,o)),n.f(.5)),n.f(1)))),_=n.$star(v,n.f(i.getTileWidth(0))),y=n.f(2);n.$eq$at(t,n.$star(n.$star$star$dot(n.gl_Vertex,n.xyz$prime),_));var b=n.vec2var("uv"),x=n.f(2);n.$star$eq(n.$star$star$dot(t,n.y$prime),y);var w=n.floatvar("xoffset");n.$eq$at(w,n.$star(x,n.$neg(a.rand(n.vec22f(s,c)),n.f(.5))));var $=n.floatvar("zoffset");n.$eq$at($,n.$star(x,n.$neg(a.rand(n.vec22f(l,p)),n.f(.5))));var E=n.vec2var("ixy");n.$eq$at(E,i.getIXY(f)),n.$plus$eq(n.$star$star$dot(t,n.x$prime),w),n.$plus$eq(n.$star$star$dot(t,n.z$prime),$),n.$eq$at(b,n.$plus(n.$star(n.vec22f(w,$),n.f(.5)),n.f(.5))),n.$eq$at(b,n.$star(n.$plus(b,E),i.getHMMul(0))),n.ifstmt(n.$great(n.$star$star$dot(t,n.y$prime),n.f(0)),function(){return n.$plus$eq(n.$star$star$dot(t,n.x$prime),n.$star(n.f(.0025),u.snoise(n.$plus(b,n.$star(n.u_time,n.f(.5))))))});var M=n.vec4var("heightNormal");n.$eq$at(M,n.texture(h,b));var T=n.$star(n.$star(n.f(1),_),y),S=n.floatvar("yoffset");return n.$eq$at(S,n.$star(n.$star$star$dot(M,n.x$prime),i.heightMultiplier)),n.ifelsestmt(n.$unknown$unknown(n.$great(S,n.f(.05)),n.$unknown$unknown(n.$less(n.abs(w),n.f(.9)),n.$less(n.abs($),n.f(1.9)))),function(){return n.$plus$eq(n.$star$star$dot(t,n.y$prime),n.$plus(S,T))},function(){return n.$eq$at(n.$star$star$dot(t,n.y$prime),n.f(1e3))}),n.$eq$at(g,b),n.$plus$eq(n.$star$star$dot(t,n.xz$prime),i.getTiledOffset(f)),n.$eq$at(n.gl_Position,n.$star(n.$star(n.u_projectionMatrix,n.u_modelViewMatrix),n.vec4(n.$pipe$plus$pipe(t,n.f(1)))))}),_=n.body(function(){var e=n.vec4var("color");return n.$eq$at(e,n.$star(n.texture(p,m),n.f(1.5))),n.ifelsestmt(n.$less(n.$star$star$dot(e,n.a$prime),n.f(.5)),function(){return n.discard(0)},function(){return n.$star$eq(n.$star$star$dot(e,n.a$prime),n.f(1.5))}),n.$star$eq(e,n.$plus(n.f(.75),n.$star(n.f(.25),c.getClouds(g,n.u_time)))),n.$eq$at(n.gl_FragColor,e)}),y=[0],b=s.registerTextureUniform(p,function(e){var t=y[0],r=t?t[0]:s.getNewTexture(e[0],"resources/tree.png");return y[0]=[r],r});function x(e){return[s.registerUniform(n.u_modelViewMatrix,function(e){return e[6]}),[s.registerUniform(n.u_projectionMatrix,function(e){return e[7]}),[s.registerUniform(n.u_time,function(e){return[e[1]]}),[s.registerUniform(f,function(e){return[e[9]]}),[b,[s.registerTextureUniform(h,function(){var t=e[0];if(t)return t[0];throw[l,"uninitialized shader texture copy"]}),0]]]]]]}var w=window.partialMemoize1(function(e){var t=x(e);return[t,n.getProgram(t,v,_)]}),$=s.registerUniform;t.Bug=l,t.objectId=f,t.tree=p,t.heightMap=h,t.a_uv=d,t.v_uv=m,t.v_position_uv=g,t.vertexShader=v,t.fragmentShader=_,t.r=$,t.treeTexture=y,t.registeredTrees=b,t.getUniforms=x,t.makeProgramSource=w},function(e,t,r){"use strict";var n=r(4),i=r(13),a=r(18),o=n.vec2attr("a_uv"),s=n.vec2varying("v_uv"),u=n.vec4attr("a_position"),c=n.mat4uniform("modelViewMatrix"),l=n.mat4uniform("projectionMatrix"),f=n.vec4uniform("u_color1"),p=n.vec4uniform("u_color2"),h=n.vec2uniform("u_resolution"),d=n.floatuniform("u_time");function m(e){return[e[0]/256,e[1]/256,e[2]/256,1]}function g(e,t){return[i.registerUniform(c,function(e){return e[6]}),[i.registerUniform(l,function(e){return e[7]}),[i.registerUniform(f,function(){return m(e)}),[i.registerUniform(p,function(){return m(t)}),[i.registerUniform(h,function(e){return[e[3],e[4]]}),[i.registerUniform(d,function(e){return[e[1]]}),0]]]]]]}var v=n.body(function(){n.$eq$at(s,o);var e=n.vec4var("position");return n.$eq$at(e,n.$star$star$dot(u,n.xyzw$prime)),n.$eq$at(n.$star$star$dot(e,n.z$prime),n.$star(a.snoise(n.$plus(n.$star$star$dot(u,n.xy$prime),n.$star(n.f(2),d))),n.f(.2))),n.$eq$at(n.gl_Position,n.$star(l,n.$star(c,n.$star$star$dot(e,n.xyzw$prime))))}),_=n.body(function(){var e=n.vec2var("position"),t=n.vec2var("resolution");n.$eq$at(t,h),n.$eq$at(e,s);var r=n.floatvar("color");return n.$eq$at(r,n.f(0)),n.$plus$eq(r,n.$plus(n.sin(n.$star(n.$star(n.$star$star$dot(e,n.x$prime),n.cos(n.$slash(d,n.f(15)))),n.f(80))),n.cos(n.$star(n.$star(n.$star$star$dot(e,n.y$prime),n.cos(n.$slash(d,n.f(15)))),n.f(10))))),n.$plus$eq(r,n.$plus(n.sin(n.$star(n.$star(n.$star$star$dot(e,n.y$prime),n.sin(n.$slash(d,n.f(10)))),n.f(40))),n.cos(n.$star(n.$star(n.$star$star$dot(e,n.x$prime),n.sin(n.$slash(d,n.f(25)))),n.f(40))))),n.$plus$eq(r,n.$plus(n.sin(n.$star(n.$star(n.$star$star$dot(e,n.x$prime),n.sin(n.$slash(d,n.f(5)))),n.f(10))),n.sin(n.$star(n.$star(n.$star$star$dot(e,n.y$prime),n.sin(n.$slash(d,n.f(35)))),n.f(80))))),n.$star$eq(r,n.$star(n.sin(n.$slash(d,n.f(10))),n.f(.5))),n.$eq$at(n.outColor,n.vec4(n.$pipe$plus$pipe(n.vec33f(r,n.$star(r,n.f(.5)),n.$star(n.sin(n.$plus(r,n.$slash(d,n.f(3)))),n.f(.75))),n.f(1)))),n.$plus$eq(n.outColor,n.$plus(f,p)),n.$plus$eq(n.$star$star$dot(n.outColor,n.r$prime),a.snoise(s)),n.$plus$eq(n.$star$star$dot(n.outColor,n.g$prime),a.snoise(n.$plus(s,n.f(123.234)))),n.$plus$eq(n.$star$star$dot(n.outColor,n.b$prime),a.snoise(n.$neg(s,n.f(323.234))))});var y=i.registerUniform;t.a_uv=o,t.v_uv=s,t.a_position=u,t.u_modelViewMatrix=c,t.u_projectionMatrix=l,t.u_color1=f,t.u_color2=p,t.u_resolution=h,t.u_time=d,t.fmtColor=m,t.r=y,t.getUniforms=g,t.mainVertex=v,t.mainFragment=_,t.makeProgramSource=function(e,t){var r=g(e,t);return[r,n.getProgram(r,v,_)]}},function(e,t,r){"use strict";var n=r(0),i=r(4),a=r(17),o=r(19),s=r(29),u=r(28),c=r(13),l=r(18),f=i.vec2uniform("u_resolution"),p=i.vec3uniform("u_eye"),h=i.sampler2Duniform("t_water"),d=i.sampler2Duniform("t_heightmap"),m=i.floatuniform("u_time"),g=i.floatuniform("u_waterOffset"),v=window.partialMemoize3(function(e,t,r){return c.getNewRandomTexture(e,function(e){var n=e%4;return 0!==n?0:Math.random()*t+r})}),_=i.vec22f(i.$slash(i.f(2),i.f(a.getWidth(0))),i.$slash(i.f(2),i.f(a.getHeight(0)))),y=i.vec33f(i.$slash(i.f(2),i.f(a.getWidth(0))),i.f(1),i.$slash(i.f(2),i.f(a.getHeight(0)))),b=i.floatuniform("objectId"),x=i.vec2varying("heightMapOffset"),w=i.vec2varying("ocoord"),$=i.floatuniform("u_isCaustics"),E=i.floatuniform("u_waterHeight"),M=i.vec3uniform("u_light"),T=i.vec3uniform("u_sphereCenter"),S=i.floatuniform("u_sphereRadius"),A=i.sampler2Duniform("t_tiles"),z=i.sampler2Duniform("t_terrain"),R=i.sampler2Duniform("t_causticTex"),C=i.$$const(i.floatif(1)),L=i.$$const(i.floatif(1.333)),P=i.$$const(i.$star(i.vec3i3f(.25,1,1.25),i.f(1.5))),U=i.$$const(i.vec3i3f(.4,.9,1)),I=i.floatuniform("poolHeight"),O=i.vec3arg("origin"),N=i.vec3arg("ray"),k=i.vec3arg("cubeMin"),D=i.vec3arg("cubeMax"),F=i.vec3varying("v_position"),B=i.floatvarying("v_waterDepth"),G=i.f(25),V=i.$neg(G,i.f(.001)),H=i.vec33f(i.$star(G,i.f(-1)),i.$neg(i.f(0),I),i.$star(G,i.f(-1))),j=i.vec33f(i.$star(G,i.f(1)),i.f(2),i.$star(G,i.f(1))),W=i.sampler2Duniform("u_sky"),q=i.floatuniform("u_isAboveWater"),X=i.vec3arg("rayOrigin"),Y=i.vec3arg("rayDelta"),J=i.f(2),Z=i.body(function(){var e=i.f(0),t=i.$slash(J,i.f(10)),r=i.floatvar("lh"),n=i.floatvar("ly");i.$eq$at(r,i.f(0)),i.$eq$at(n,i.f(0));var o=i.floatvar("t");return i.$eq$at(o,e),i.forstmt(function(){return i.$eq$at(o,e)},i.$less(o,J),function(){return i.$plus$eq(o,t)},function(){var e=i.vec3var("p");i.$eq$at(e,i.$plus(X,i.$star(Y,o)));var s=i.floatvar("h");return i.$eq$at(s,i.$neg(i.$star(i.$star$star$dot(i.texture(d,i.fract(i.$plus(i.$star(i.$star$star$dot(e,i.xz$prime),i.f(.5)),i.f(.5)))),i.x$prime),a.heightMultiplier),I)),i.$eq$at(s,i.min(i.$star$star$dot(X,i.y$prime),s)),i.ifstmt(i.$less$eq(i.$star$star$dot(e,i.y$prime),s),function(){return i.$$return(i.$plus(i.$neg(o,t),i.$slash(i.$star(t,i.$neg(r,n)),i.$plus(i.$neg(i.$neg(i.$star$star$dot(e,i.y$prime),n),s),r))))}),i.$eq$at(r,s),i.$eq$at(n,i.$star$star$dot(e,i.y$prime))}),i.$$return(i.$star(J,i.f(2)))});var K=i.body(function(){var e=i.vec3var("tMin");i.$eq$at(e,i.$slash(i.$neg(k,O),N));var t=i.vec3var("tMax");i.$eq$at(t,i.$slash(i.$neg(D,O),N));var r=i.vec3var("t1");i.$eq$at(r,i.min(e,t));var n=i.vec3var("t2");i.$eq$at(n,i.max(e,t));var a=i.floatvar("tNear"),o=i.floatvar("tFar");return i.$eq$at(a,i.max(i.max(i.$star$star$dot(r,i.x$prime),i.$star$star$dot(r,i.y$prime)),i.$star$star$dot(r,i.z$prime))),i.$eq$at(o,i.min(i.min(i.$star$star$dot(n,i.x$prime),i.$star$star$dot(n,i.y$prime)),i.$star$star$dot(n,i.z$prime))),i.$$return(i.vec2(i.$pipe$plus$pipe(a,o)))});function Q(e,t,r,n){return i.fundecl4(i.vec2fun("intersectCube"),[O,N,k,D],K,e,t,r,n)}var ee=i.vec3arg("sphereCenter"),te=i.floatarg("sphereRadius"),re=i.body(function(){var e=i.vec3i1(i.$neg(O,ee)),t=i.floati1(i.dot(N,N)),r=i.floati1(i.$star(i.f(2),i.dot(e,N))),n=i.floati1(i.$neg(i.dot(e,e),i.$star(te,te))),a=i.floatvar("discriminant");return i.$eq$at(a,i.$neg(i.$star(r,r),i.$star(i.$star(i.f(4),t),n))),i.ifstmt(i.$great(a,i.f(0)),function(){var e=i.floatvar("t");return i.$eq$at(e,i.$slash(i.$neg(i.$neg(i.f(0),r),i.sqrt(a)),i.$star(i.f(2),t))),i.ifstmt(i.$great(e,i.f(0)),function(){return i.$$return(e)})}),i.$$return(i.f(1e6))});var ne=i.vec3arg("point"),ie=i.body(function(){var e=i.vec3var("color");i.$eq$at(e,i.vec31f(i.f(.5))),i.$star$eq(e,i.$neg(i.f(1),i.$slash(i.f(.9),i.pow(i.$slash(i.$neg(i.$plus(i.f(1),S),i.abs(i.$star$star$dot(ne,i.x$prime))),S),i.f(3))))),i.$star$eq(e,i.$neg(i.f(1),i.$slash(i.f(.9),i.pow(i.$slash(i.$neg(i.$plus(i.f(1),S),i.abs(i.$star$star$dot(ne,i.z$prime))),S),i.f(3))))),i.$star$eq(e,i.$neg(i.f(1),i.$slash(i.f(.9),i.pow(i.$slash(i.$plus(i.$plus(i.$star$star$dot(ne,i.y$prime),i.f(1)),S),S),i.f(3)))));var t=i.vec3var("sphereNormal");i.$eq$at(t,i.$slash(i.$neg(ne,T),S));var r=i.vec3var("refractedLight");i.$eq$at(r,i.refract(i.$neg(i.f(0),M),i.vec33f(i.f(0),i.f(1),i.f(0)),i.$slash(C,L)));var n=i.floatvar("diffuse");i.$eq$at(n,i.$star(i.max(i.f(0),i.dot(i.$neg(i.f(0),r),t)),i.f(.5)));var a=i.vec4var("info");return i.$eq$at(a,i.texture(h,i.$plus(i.$star(i.$star(i.$star$star$dot(ne,i.xz$prime),i.f(.5)),_),i.f(.5)))),i.ifstmt(i.$less(i.$star$star$dot(ne,i.y$prime),i.$star$star$dot(a,i.r$prime)),function(){var e=i.vec4var("caustic");return i.$eq$at(e,i.texture(R,i.$plus(i.$star(i.$star(i.f(.75),i.$neg(i.$star(i.$star$star$dot(ne,i.xz$prime),_),i.$slash(i.$star(i.$star$star$dot(ne,i.y$prime),i.$star$star$dot(r,i.xz$prime)),i.$star$star$dot(r,i.y$prime)))),i.f(.5)),i.f(.5)))),i.$star$eq(n,i.$star(i.$star$star$dot(e,i.r$prime),i.f(4)))}),i.$plus$eq(e,n),i.$$return(e)});function ae(e){return i.fundecl1(i.vec3fun("getSphereColor"),ne,ie,e)}var oe=i.vec3arg("displacementPoint"),se=i.body(function(){var e=i.vec3var("point");return i.$eq$at(e,oe),i.$eq$at(i.$star$star$dot(e,i.y$prime),i.$star(i.$star$star$dot(oe,i.y$prime),l.snoise(i.$plus(i.$star(i.$star$star$dot(oe,i.xz$prime),i.f(10)),m)))),i.$$return(e)});var ue=i.body(function(){var e=i.floatvar("scale");i.$eq$at(e,i.f(.5));var t=i.vec3var("wallColor");i.$eq$at(t,i.vec31f(i.f(0)));var r=i.vec3var("normal");i.$eq$at(r,i.vec31f(i.f(0)));var n=i.vec2var("uv");i.$eq$at(n,i.$plus(i.$star(i.$star(i.$star$star$dot(ne,i.xz$prime),i.f(.5)),_),i.f(.5)));var o=i.vec2var("ixy");i.$eq$at(o,a.getIXY(b)),i.$eq$at(n,i.$star(i.$plus(n,o),a.getHMMul(0))),i.$eq$at(n,i.abs(i.$neg(i.fmod(n,i.f(2)),i.f(1))));var s=i.texture(z,n),u=i.dot(i.$star$star$dot(s,i.rgb$prime),i.vec33f(i.f(.299),i.f(.587),i.f(.114)));i.$eq$at(t,i.vec31f(u)),i.$eq$at(r,i.$star$star$dot(i.texture(d,n),i.yzw$prime)),i.$slash$eq(e,i.length(i.$star(ne,y)));var c=i.vec3var("refractedLight");i.$eq$at(c,i.$neg(i.f(0),i.refract(i.$neg(i.f(0),M),i.vec33f(i.f(0),i.f(1),i.f(0)),i.$slash(C,L))));var l=i.floatvar("diffuse");i.$eq$at(l,i.max(i.f(0),i.dot(c,r)));var f=i.vec4var("info");return i.$eq$at(f,i.texture(h,i.$plus(i.$star(i.$star(i.$star$star$dot(ne,i.xz$prime),i.f(.5)),_),i.f(.5)))),i.ifelsestmt(i.$less(i.$star$star$dot(ne,i.y$prime),i.$star$star$dot(f,i.r$prime)),function(){var t=i.vec4var("caustic"),r=i.vec2var("causticUV");i.$eq$at(r,i.$plus(i.$star(i.$star(i.f(.75),i.$neg(i.$star(i.$star$star$dot(ne,i.xz$prime),_),i.$slash(i.$star(i.$star$star$dot(ne,i.y$prime),i.$star$star$dot(c,i.xz$prime)),i.$star$star$dot(c,i.y$prime)))),i.f(.5)),i.f(.5)));var n=i.f(.25);return i.$eq$at(i.$star$star$dot(r,i.x$prime),i.ternary(i.$less(i.$star$star$dot(r,i.x$prime),n),i.$neg(i.$star(i.f(2),n),i.$star$star$dot(r,i.x$prime)),i.$star$star$dot(r,i.x$prime))),i.$eq$at(i.$star$star$dot(r,i.x$prime),i.ternary(i.$great(i.$star$star$dot(r,i.x$prime),i.$neg(i.f(1),n)),i.$neg(i.$star(i.f(2),i.$neg(i.f(1),n)),i.$star$star$dot(r,i.x$prime)),i.$star$star$dot(r,i.x$prime))),i.$eq$at(i.$star$star$dot(r,i.y$prime),i.ternary(i.$less(i.$star$star$dot(r,i.y$prime),n),i.$neg(i.$star(i.f(2),n),i.$star$star$dot(r,i.y$prime)),i.$star$star$dot(r,i.y$prime))),i.$eq$at(i.$star$star$dot(r,i.y$prime),i.ternary(i.$great(i.$star$star$dot(r,i.y$prime),i.$neg(i.f(1),n)),i.$neg(i.$star(i.f(2),i.$neg(i.f(1),n)),i.$star$star$dot(r,i.y$prime)),i.$star$star$dot(r,i.y$prime))),i.$eq$at(t,i.texture(R,r)),i.$plus$eq(e,i.$star(i.$star(i.$star(l,i.$star$star$dot(t,i.r$prime)),i.f(2)),i.$star$star$dot(t,i.g$prime)))},function(){return 0}),i.$$return(i.$star(i.$star(t,e),i.f(1.5)))});function ce(e){return i.fundecl1(i.vec3fun("getWallColor"),ne,ue,e)}var le=i.vec3arg("origin"),fe=i.vec3arg("ray"),pe=i.vec3arg("waterColor"),he=i.body(function(){var e=i.vec3var("color");return i.$eq$at(e,i.vec31f(i.f(0))),i.ifelsestmt(i.$less(i.$star$star$dot(fe,i.y$prime),i.f(0)),function(){var t=i.vec2var("t1");i.$eq$at(t,Q(le,fe,H,j));var r=i.vec3var("hit1");return i.$eq$at(r,i.$plus(le,i.$star(fe,i.$star$star$dot(t,i.y$prime)))),i.$eq$at(e,ce(r))},function(){var t=i.vec2var("t2");i.$eq$at(t,Q(le,fe,H,j));var r=i.vec3var("hit2");return i.$eq$at(r,i.$plus(le,i.$star(fe,i.$star$star$dot(t,i.y$prime)))),i.ifelsestmt(i.$less(i.$star$star$dot(r,i.y$prime),i.$slash(i.f(2),i.f(12))),function(){return i.$eq$at(e,ce(r))},function(){var t=i.$star(fe,i.vec33f(i.$star$star$dot(_,i.x$prime),i.f(1),i.$star$star$dot(_,i.y$prime))),r=i.vec2var("uv");i.$eq$at(r,i.$star$star$dot(t,i.xz$prime));var n=i.vec2var("ixy");return i.$eq$at(n,a.getIXY(b)),i.$eq$at(r,i.$star(i.$plus(r,n),a.getHMMul(0))),i.$eq$at(e,i.$star$star$dot(i.texture(W,r),i.rgb$prime)),i.$plus$eq(e,i.$star(i.vec31f(i.pow(i.max(i.f(0),i.dot(M,fe)),i.f(5e3))),i.vec33f(i.f(10),i.f(8),i.f(6))))})}),i.ifstmt(i.$less(i.$star$star$dot(fe,i.y$prime),i.f(0)),function(){return i.$star$eq(e,pe)}),i.$$return(e)});function de(e,t,r){return i.fundecl3(i.vec3fun("getSurfaceRayColor"),[le,fe,pe],he,e,t,r)}var me=i.f(0),ge=i.floatvarying("isWater"),ve=i.body(function(){i.$eq$at(i.v_uv,i.a_uv),i.$eq$at(F,i.$star$star$dot(i.gl_Vertex,i.xzy$prime)),i.$eq$at(w,i.$plus(i.$star(i.$star(i.$star$star$dot(F,i.xz$prime),i.f(.5)),_),i.f(.5)));var e=i.vec2var("ixy");i.$eq$at(e,a.getIXY(b));var t=i.$star(a.getHMMul(0),e),r=i.vec4var("info"),n=i.vec2var("uvc");i.$eq$at(n,i.$plus(i.$star(w,a.getHMMul(0)),t)),i.$eq$at(w,n),i.$eq$at(r,i.texture(h,n));var o=i.floatvar("height");i.$eq$at(o,i.$star$star$dot(i.texture(d,n),i.x$prime));var s=i.floatvar("waterHeight2");i.$eq$at(s,i.$star$star$dot(r,i.r$prime)),i.$eq$at(ge,i.$neg(s,i.$star(i.$neg(i.f(1),me),o))),i.$eq$at(B,i.$plus(i.$star$star$dot(F,i.y$prime),i.$star(i.$star(o,a.heightMultiplier),i.f(5)))),i.ifelsestmt(i.$less(ge,i.f(0)),function(){return i.$plus$eq(i.$star$star$dot(F,i.y$prime),i.$star(o,a.heightMultiplier))},function(){return i.$plus$eq(i.$star$star$dot(F,i.y$prime),i.$star(s,a.heightMultiplier))});var u=i.vec3var("glposition");return i.$eq$at(u,F),i.$plus$eq(i.$star$star$dot(u,i.xz$prime),a.getTiledOffset(b)),i.$eq$at(i.gl_Position,i.$star(i.$star(i.u_projectionMatrix,i.u_modelViewMatrix),i.vec4(i.$pipe$plus$pipe(i.$star$star$dot(u,i.xyz$prime),i.f(1)))))}),_e=i.body(function(){var e=i.vec3var("position2");i.$eq$at(e,F);var t=i.vec2var("ocoord"),r=i.vec4var("info");i.$eq$at(t,w),i.$eq$at(r,i.texture(h,w)),i.$star(i.f(.5),l.snoise(i.$plus(i.$star(i.$star$star$dot(F,i.xz$prime),i.f(40)),m)));var n=i.vec3var("normal"),a=i.vec3var("incomingRay");return i.$eq$at(n,i.vec33f(i.$star$star$dot(r,i.b$prime),i.sqrt(i.$neg(i.f(1),i.dot(i.$star$star$dot(r,i.ba$prime),i.$star$star$dot(r,i.ba$prime)))),i.$star$star$dot(r,i.a$prime))),i.$eq$at(a,i.normalize(i.$neg(e,p))),i.ifelsestmt(i.$less(q,i.f(0)),function(){i.$eq$at(n,i.$neg(i.f(0),n));var t=i.vec3var("reflectedRay1"),r=i.vec3var("refractedRay1"),o=i.floatvar("fresnel1");i.$eq$at(t,i.reflect(a,n)),i.$eq$at(r,i.refract(a,n,i.$slash(L,C))),i.$eq$at(o,i.mix(i.f(.5),i.f(1),i.pow(i.$neg(i.f(1),i.dot(n,i.$neg(i.f(0),a))),i.f(3))));var s=i.vec3var("reflectedColor1"),u=i.vec3var("refractedColor1");return i.$eq$at(s,de(e,t,U)),i.$eq$at(u,i.$star(de(e,r,i.vec31f(i.f(1))),i.vec33f(i.f(.8),i.f(1),i.f(1.1)))),i.$eq$at(i.gl_FragColor,i.vec4(i.$pipe$plus$pipe(i.mix(s,u,i.$star(i.$neg(i.f(1),o),i.length(r))),i.f(1))))},function(){var t=i.vec3var("reflectedRay2"),r=i.vec3var("refractedRay2"),o=i.floatvar("fresnel2");i.$eq$at(t,i.reflect(a,n)),i.$eq$at(r,i.refract(a,n,i.$slash(C,L))),i.$eq$at(o,i.mix(i.f(.25),i.f(1),i.pow(i.$neg(i.f(1),i.dot(n,i.$neg(i.f(0),a))),i.f(3))));var s=i.vec3var("reflectedColor2"),u=i.vec3var("refractedColor2");i.$eq$at(s,de(e,t,P)),i.$eq$at(u,de(e,r,P)),i.$eq$at(i.gl_FragColor,i.vec4(i.$pipe$plus$pipe(i.mix(u,s,o),i.f(1))));var c=i.$star$star$dot(i.texture(z,i.fract(i.$star(w,i.f(1)))),i.rgb$prime);return i.$eq$at(i.gl_FragColor,i.ternary(i.$less(ge,i.f(0)),i.vec4(i.$pipe$plus$pipe(c,i.f(1))),i.gl_FragColor))})}),ye=i.body(function(){return i.$eq$at(F,i.$plus(T,i.$star(i.$star$star$dot(i.gl_Vertex,i.xyz$prime),S))),i.$eq$at(i.gl_Position,i.$star(i.$star(i.u_projectionMatrix,i.u_modelViewMatrix),i.vec4(i.$pipe$plus$pipe(F,i.f(1)))))}),be=i.body(function(){i.$eq$at(i.gl_FragColor,i.vec4(i.$pipe$plus$pipe(ae(F),i.f(1))));var e=i.vec4var("info");return i.$eq$at(e,i.texture(h,i.$plus(i.$star(i.$star$star$dot(F,i.xz$prime),i.f(.5)),i.f(.5)))),i.ifstmt(i.$less(i.$star$star$dot(F,i.y$prime),i.$star$star$dot(e,i.r$prime)),function(){return i.$star$eq(i.$star$star$dot(i.gl_FragColor,i.rgb$prime),i.$star(U,i.f(1.2)))})}),xe=i.body(function(){return i.$eq$at(F,i.$star$star$dot(i.gl_Vertex,i.xyz$prime)),i.$eq$at(i.$star$star$dot(F,i.y$prime),i.$star(i.$neg(i.$star(i.$neg(i.f(1),i.$star$star$dot(F,i.y$prime)),i.$slash(i.f(7),i.f(12))),i.f(1)),I)),i.$eq$at(i.gl_Position,i.$star(i.$star(i.u_projectionMatrix,i.u_modelViewMatrix),i.vec4(i.$pipe$plus$pipe(F,i.f(1)))))}),we=i.body(function(){i.$eq$at(i.gl_FragColor,i.vec4(i.$pipe$plus$pipe(ce(F),i.f(1))));var e=i.vec4var("info");return i.$eq$at(e,i.texture(h,i.$plus(i.$star(i.$star$star$dot(F,i.xz$prime),i.f(.5)),i.f(.5)))),i.ifstmt(i.$less(i.$star$star$dot(F,i.y$prime),i.$star$star$dot(e,i.r$prime)),function(){return i.$star$eq(i.$star$star$dot(i.gl_FragColor,i.rgb$prime),i.$star(U,i.f(1.2)))})}),$e=i.vec3varying("oldPos"),Ee=i.vec3varying("newPos"),Me=i.vec3varying("ray"),Te=i.vec3arg("refractedLight"),Se=i.body(function(){var e=i.vec2var("tcube");i.$eq$at(e,Q(le,Me,H,j)),i.$plus$eq(le,i.$star(Me,i.$star$star$dot(e,i.y$prime)));var t=i.floatvar("tplane");return i.$eq$at(t,i.$slash(i.$neg(i.$neg(i.f(0),i.$star$star$dot(le,i.y$prime)),i.f(1)),i.$star$star$dot(Te,i.y$prime))),i.$$return(i.$plus(le,i.$star(Te,t)))});function Ae(e,t,r){return i.fundecl3(i.vec3fun("project"),[le,Me,Te],Se,e,t,r)}var ze=i.body(function(){var e=i.vec4var("info"),t=i.vec3(i.$pipe$plus$pipe(i.$star(i.$star$star$dot(i.gl_Vertex,i.xy$prime),_),i.$star$star$dot(i.gl_Vertex,i.z$prime)));i.$eq$at(e,i.texture(h,i.$plus(i.$star(i.$star$star$dot(t,i.xy$prime),i.f(.5)),i.f(.5)))),i.$star$eq(i.$star$star$dot(e,i.ba$prime),i.f(.5));var r=i.vec3var("normal");i.$eq$at(r,i.vec33f(i.$star$star$dot(e,i.b$prime),i.sqrt(i.$neg(i.f(1),i.dot(i.$star$star$dot(e,i.ba$prime),i.$star$star$dot(e,i.ba$prime)))),i.$star$star$dot(e,i.a$prime)));var n=i.vec3var("refractedLight");return i.$eq$at(n,i.refract(i.$neg(i.f(0),M),i.vec33f(i.f(0),i.f(1),i.f(0)),i.$slash(C,L))),i.$eq$at(Me,i.refract(i.$neg(i.f(0),M),r,i.$slash(C,L))),i.$eq$at($e,Ae(i.$star$star$dot(t,i.xzy$prime),n,n)),i.$eq$at(Ee,Ae(i.$plus(i.$star$star$dot(t,i.xzy$prime),i.vec33f(i.f(0),i.$star$star$dot(e,i.r$prime),i.f(0))),Me,n)),i.$eq$at(i.gl_Position,i.vec4(i.$pipe$plus$pipe(i.$pipe$plus$pipe(i.$star(i.f(.75),i.$plus(i.$star$star$dot(Ee,i.xz$prime),i.$slash(i.$star$star$dot(n,i.xz$prime),i.$star$star$dot(n,i.y$prime)))),i.f(0)),i.f(1))))}),Re=i.body(function(){var e=i.floatvar("oldArea"),t=i.floatvar("newArea");i.$eq$at(e,i.$star(i.length(i.dFdx($e)),i.length(i.dFdy($e)))),i.$eq$at(t,i.$star(i.length(i.dFdx(Ee)),i.length(i.dFdy(Ee)))),i.$eq$at(i.gl_FragColor,i.vec44f(i.$star(i.$slash(e,t),i.f(.2)),i.f(1),i.f(0),i.f(0)));var r=i.vec3var("refractedLight");i.$eq$at(r,i.refract(i.$neg(i.f(0),M),i.vec33f(i.f(0),i.f(1),i.f(0)),i.$slash(C,L)));var n=i.vec3var("dir");i.$eq$at(n,i.$slash(i.$neg(T,Ee),S));var a=i.vec3var("area");i.$eq$at(a,i.cross(n,r));var o=i.floatvar("shadow");i.$eq$at(o,i.dot(a,a));var s=i.floatvar("dist");i.$eq$at(s,i.dot(n,i.$neg(i.f(0),r))),i.$eq$at(o,i.$plus(i.f(1),i.$slash(i.$neg(o,i.f(1)),i.$plus(i.f(.05),i.$star(s,i.f(.025)))))),i.$eq$at(o,i.clamp(i.$slash(i.f(1),i.$plus(i.f(1),i.exp(i.$neg(i.f(0),o)))),i.f(0),i.f(1))),i.$eq$at(o,i.mix(i.f(1),o,i.clamp(i.$star(s,i.f(2)),i.f(0),i.f(1)))),i.$eq$at(i.$star$star$dot(i.gl_FragColor,i.g$prime),o);var u=i.vec2var("t");return i.$eq$at(u,Q(Ee,i.$neg(i.f(0),r),H,j)),i.$star$eq(i.$star$star$dot(i.gl_FragColor,i.r$prime),i.$slash(i.f(1),i.$plus(i.f(1),i.exp(i.$star(i.$slash(i.f(-200),i.$plus(i.f(1),i.$star(i.f(10),i.$neg(i.$star$star$dot(u,i.y$prime),i.$star$star$dot(u,i.x$prime))))),i.$neg(i.$neg(i.$star$star$dot(Ee,i.y$prime),i.$star(i.$star$star$dot(r,i.y$prime),i.$star$star$dot(u,i.y$prime))),i.$slash(i.f(2),i.f(12))))))))}),Ce=[0],Le=c.registerTextureUniform(A,function(e){var t=Ce[0],r=t?t[0]:c.getNewTexture(e[0],"resources/tiles.jpg");return Ce[0]=[r],r}),Pe=[0],Ue=c.registerTextureUniform(W,function(e){var t=Pe[0],r=t?t[0]:c.getNewTexture(e[0],"resources/ypos.jpg");return Pe[0]=[r],r});function Ie(e,t,r,a,l){return[c.registerUniform(i.u_modelMatrix,function(e){return e[5]}),[c.registerUniform(i.u_modelViewMatrix,function(e){return e[6]}),[c.registerUniform(i.u_projectionMatrix,function(e){return e[7]}),[c.registerUniform(b,function(e){return[e[9]]}),[c.registerUniform($,function(){return[l]}),[c.registerUniform(T,function(){return[10,0,10]}),[c.registerUniform(S,function(){return[.25]}),[c.registerUniform(q,function(){return[1]}),[c.registerUniform(E,function(){return[o.js2(5144726,1,u.waterHeight,0)]}),[c.registerUniform(g,function(){return[o.js2(5144726,2,u.waveHeight,0)]}),[c.registerUniform(M,function(){var e=o.js2(5144726,3,u.lightX,0),t=o.js2(5144726,4,u.lightY,0),r=o.js2(5144726,5,u.lightZ,0),n=s.normalize(e,t,r);return[n[0],n[1],n[2]]}),[c.registerUniform(p,function(){return[o.js2(5144726,6,u.eyeX,0),o.js2(5144726,7,u.eyeY,0),o.js2(5144726,8,u.eyeZ,0)]}),[c.registerUniform(m,function(e){return[e[1]]}),[c.registerUniform(I,function(){return[o.js2(5144726,9,u.poolHeight,0)]}),[Le,[c.registerTextureUniform(z,function(e){var t=r[0];return t?t[0]:n._3(v,e[0],0,0)}),[c.registerTextureUniform(h,function(t){var r=e[0];return r?r[0]:n._3(v,t[0],0,0)}),[c.registerTextureUniform(R,function(e){var r=t[0];return r?r[0]:n._3(v,e[0],0,0)}),[c.registerTextureUniform(d,function(e){var t=a[0];return t?t[0]:n._3(v,e[0],0,0)}),[Ue,0]]]]]]]]]]]]]]]]]]]]}var Oe=window.partialMemoize4(function(e,t,r,n){var a=Ie(e,t,r,n,-1);return[a,i.getProgram(a,ve,_e)]}),Ne=window.partialMemoize1(function(e){var t=Ie(e,[0],[0],[0],1);return[t,i.getProgram(t,ze,Re)]}),ke=[_,y,b,x,w,$,E,M,T,S,A,z,R,C,L,P,U,I,k,D,F,B,G,V,H,j,W,q,i.gl_Vertex,X,Y,J,Z,function(e,t){return i.fundecl2(i.floatfun("castRay"),[X,Y],Z,e,t)},K,Q,ee,te,re,function(e,t,r,n){return i.fundecl4(i.floatfun("intersectSphere"),[O,N,ee,te],re,e,t,r,n)},ne,ie,ae,oe,se,function(e){return i.fundecl1(i.vec3fun("displacement"),oe,se,e)},ue,ce,le,pe,he,de,me,ge,ve,_e,ye,be,xe,we,$e,Ee,Me,Te,Se,Ae,ze,Re,c.registerUniform,Ce,Le,Pe,Ue,Ie,Oe,Ne],De=i.$slash(i.$star$star$dot(i.gl_FragCoord,i.xy$prime),f),Fe=i.body(function(){return i.$eq$at(i.gl_Position,i.$star(i.$star(i.u_projectionMatrix,i.u_modelViewMatrix),i.vec4(i.$pipe$plus$pipe(i.$star$star$dot(i.gl_Vertex,i.xyz$prime),i.f(1)))))}),Be=i.vec2uniform("delta"),Ge=i.body(function(){var e=i.vec4var("info");i.$eq$at(e,i.texture(h,De));var t=i.vec2var("dx"),r=i.vec2var("dy");i.$eq$at(t,i.vec22f(i.$star$star$dot(Be,i.x$prime),i.f(0))),i.$eq$at(r,i.vec22f(i.f(0),i.$star$star$dot(Be,i.y$prime)));var n=i.floatvar("average");return i.$eq$at(n,i.$star(i.$plus(i.$plus(i.$plus(i.$star$star$dot(i.texture(h,i.$neg(De,t)),i.r$prime),i.$star$star$dot(i.texture(h,i.$neg(De,r)),i.r$prime)),i.$star$star$dot(i.texture(h,i.$plus(De,t)),i.r$prime)),i.$star$star$dot(i.texture(h,i.$plus(De,r)),i.r$prime)),i.f(.25))),i.$plus$eq(i.$star$star$dot(e,i.g$prime),i.$star(i.$neg(n,i.$star$star$dot(e,i.r$prime)),i.f(2))),i.$plus$eq(i.$star$star$dot(e,i.r$prime),i.$star(i.$star$star$dot(e,i.g$prime),i.f(.1))),i.$eq$at(i.gl_FragColor,e)}),Ve=i.body(function(){var e=i.vec4var("info");i.$eq$at(e,i.$star(i.texture(h,De),g));var t=i.vec3var("dx"),r=i.vec3var("dy");return i.$eq$at(t,i.vec33f(i.$star$star$dot(Be,i.x$prime),i.$neg(i.$star(i.$star$star$dot(i.texture(h,i.vec22f(i.$plus(i.$star$star$dot(De,i.x$prime),i.$star$star$dot(Be,i.x$prime)),i.$star$star$dot(De,i.y$prime))),i.r$prime),g),i.$star$star$dot(e,i.r$prime)),i.f(0))),i.$eq$at(r,i.vec33f(i.f(0),i.$neg(i.$star(i.$star$star$dot(i.texture(h,i.vec22f(i.$star$star$dot(De,i.x$prime),i.$plus(i.$star$star$dot(De,i.y$prime),i.$star$star$dot(Be,i.y$prime)))),i.r$prime),g),i.$star$star$dot(e,i.r$prime)),i.$star$star$dot(Be,i.y$prime))),i.$eq$at(i.$star$star$dot(e,i.ba$prime),i.$star$star$dot(i.normalize(i.cross(r,t)),i.xz$prime)),i.$eq$at(i.gl_FragColor,e)});function He(e){return[c.registerUniform(i.u_modelViewMatrix,function(e){return e[6]}),[c.registerUniform(i.u_projectionMatrix,function(e){return e[7]}),[c.registerUniform(f,function(e){return[e[3],e[4]]}),[c.registerUniform(Be,function(e){return[1/e[3],1/e[4]]}),[c.registerUniform(g,function(){return[o.js2(5144726,10,u.waveHeight,0)]}),[c.registerTextureUniform(h,function(t){var r=e[0];return r?r[0]:n._3(v,t[0],0,0)}),0]]]]]]}var je=[De,Fe,Be,Ge,Ve,c.registerUniform,He,function(e){var t=He(e);return[t,i.getProgram(t,Fe,Ge)]},function(e){var t=He(e);return[t,i.getProgram(t,Fe,Ve)]}],We=a.heightMultiplier;t.u_resolution=f,t.eye=p,t.water=h,t.heightMap=d,t.heightMultiplier=We,t.u_time=m,t.waveHeight=g,t.memGRT=v,t.Renderer=ke,t.Water=je}]);